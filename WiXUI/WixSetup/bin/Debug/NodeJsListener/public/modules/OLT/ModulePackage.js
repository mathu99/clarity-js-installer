Ember.TEMPLATES.CashSalePaymentView=Ember.Handlebars.template(function(e,t,a,s,o){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var n=this.escapeExpression;return o.buffer.push("<div>\r\n  "),o.buffer.push(n(a.view.call(t,"Komodo.Application.PaymentView",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.UseCreditView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push("\r\n            <tr>\r\n              <td>\r\n                "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.invoiceNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              </td>\r\n              <td>\r\n                "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentDate"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n              <td align="right">\r\n                '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.totalAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n              <td style="text-align:center; border-bottom: none">\r\n                '),s=a.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"row"},hashTypes:{contentBinding:"STRING"},hashContexts:{contentBinding:e},inverse:m.noop,fn:m.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n            "),""}function r(e,t){return t.buffer.push("\r\n                "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"row.isSelected"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                "),""}function i(e,t){var s;return t.buffer.push("\r\n            <tr>\r\n              <td>\r\n                "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.invoiceNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              </td>\r\n              <td>\r\n                "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.dueDate"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n              <td align="right">\r\n                '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.totalAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n              <td style="text-align:center; border-bottom: none">\r\n                '),s=a.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"row"},hashTypes:{contentBinding:"STRING"},hashContexts:{contentBinding:e},inverse:m.noop,fn:m.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n            "),""}function l(e,t){var s,o;return t.buffer.push("\r\n    "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Apply Credit",o):f.call(e,"loc","Apply Credit",o)))),t.buffer.push("\r\n    "),""}function c(e,t){var s,o;return t.buffer.push("\r\n    "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Cancel",o):f.call(e,"loc","Cancel",o)))),t.buffer.push("\r\n    "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var u,h,d,p=this.escapeExpression,m=this,f=a.helperMissing;return o.buffer.push('<div class="modal-max-size" style="overflow-y: auto;">\r\n  <div style="height:490px; overflow-y: auto;">\r\n  <table  class="table table-bordered komodo-datagrid" width="100%">\r\n\r\n    <tr>\r\n      <td>\r\n        <b>Available Payments</b>\r\n        <table id="tblPaymentInvoices" '),o.buffer.push(p(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n          <thead>\r\n            <tr>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Invoice Number",d):f.call(t,"loc","Invoice Number",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Payment Date",d):f.call(t,"loc","Payment Date",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Total Amount",d):f.call(t,"loc","Total Amount",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Apply",d):f.call(t,"loc","Apply",d)))),o.buffer.push("</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            "),u=a.each.call(t,"row","in","data.paymentInvoices",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(1,n,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push('\r\n          </tbody>\r\n        </table>\r\n        <div align="left">\r\n          '),o.buffer.push(p(a.view.call(t,"Komodo.Controls.TablePager",{hash:{tableId:"tblPaymentInvoices",contentBinding:"data.paymentInvoices",itemsPerPage:"3",headerRows:"1",visiblePageCount:"5"},hashTypes:{tableId:"STRING",contentBinding:"STRING",itemsPerPage:"STRING",headerRows:"STRING",visiblePageCount:"STRING"},hashContexts:{tableId:t,contentBinding:t,itemsPerPage:t,headerRows:t,visiblePageCount:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n        </div>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <b>Customer Invoices</b>\r\n        <table id="tblInvoices" '),o.buffer.push(p(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n          <thead>\r\n            <tr>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Invoice Number",d):f.call(t,"loc","Invoice Number",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Due Date",d):f.call(t,"loc","Due Date",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Total Amount",d):f.call(t,"loc","Total Amount",d)))),o.buffer.push("</th>\r\n              <th>"),o.buffer.push(p((h=a.loc||t&&t.loc,d={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},h?h.call(t,"Apply",d):f.call(t,"loc","Apply",d)))),o.buffer.push("</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            "),u=a.each.call(t,"row","in","data.invoices",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(4,i,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push('\r\n          </tbody>\r\n        </table>\r\n        <div align="left">\r\n          '),o.buffer.push(p(a.view.call(t,"Komodo.Controls.TablePager",{hash:{tableId:"tblInvoices",contentBinding:"data.invoices",itemsPerPage:"5",headerRows:"1",visiblePageCount:"5"},hashTypes:{tableId:"STRING",contentBinding:"STRING",itemsPerPage:"STRING",headerRows:"STRING",visiblePageCount:"STRING"},hashContexts:{tableId:t,contentBinding:t,itemsPerPage:t,headerRows:t,visiblePageCount:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n        </div>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  </div>\r\n  <br/>\r\n  <div class="float-right">\r\n    '),u=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"useAvailableCredit"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:m.noop,fn:m.program(6,l,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push(" &nbsp;\r\n    "),u=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"cancel"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:m.noop,fn:m.program(8,c,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push("\r\n  </div>\r\n</div>\r\n"),""}),Komodo.Application.ReceiptManagement=Ember.Object.extend({smartcardNumber:void 0,genericController:void 0,init:function(){},start:function(){this.set("genericController",Komodo.Services.uiService.getController("genericPayment"))},populateReceiptModel:function(e,t,a){var s=this,o=[];if(!Ember.isEmpty(e)){var n=e;if(n&&n.SplitPayments&&n.SplitPayments.length>1&&(n=s.populateSingleReceipts(n,e.SplitPayments)),n.length)$(n).each(function(n,r){var i=s.mapReceiptData(r,e,t,a);o.push(i)});else{var r=s.mapReceiptData(n,e,t,a);o.push(r)}}return o},populateSingleReceipts:function(e,t){var a=[];if(!Ember.isEmpty(t)){var s=[],o=void 0;$(t).each(function(e,t){-1===jQuery.inArray(t.CustomerId,s)&&s.push(t.CustomerId)}),$($.makeArray(s)).each(function(e,s){var n=$.grep(t,function(e){return e.CustomerId===s});if(n&&n.length>0){o=n[0];var r=0,i=0,l=0,c=[],u=[];$(n).each(function(e,t){u.push(t.ReceiptNumber),void 0!==t.Amount&&void 0!==t.Amount.Value&&(r=parseFloat(r)+parseFloat(t.Amount.Value)),void 0!==t.Amount.ListOfTax&&null!==t.Amount.ListOfTax&&$(t.Amount.ListOfTax).each(function(e,t){c.pushObject(t)}),void 0!==t.AmountTendered&&void 0!==t.AmountTendered.Value&&(i=parseFloat(i)+parseFloat(t.AmountTendered.Value)),void 0!==t.ChangeOwed&&void 0!==t.ChangeOwed.Value&&(l=parseFloat(l)+parseFloat(t.ChangeOwed.Value))});var h=0;$($.makeArray(c)).each(function(e,t){h+=parseFloat(t.Amount)});var d=parseFloat(r)-parseFloat(h);o.ReceiptNumber=u.join("/"),o.Amount.Value=parseFloat(r).toFixed(2),o.Amount.ValueWithoutTax=parseFloat(d).toFixed(2),o.Amount.ListOfTax=c,o.AmountTendered.Value=parseFloat(i).toFixed(2),o.ChangeOwed.Value=parseFloat(l).toFixed(2)}a.push(o)}),1===s.length&&1===a.length&&(a[0].AmountTendered.Value=parseFloat(e.AmountTendered.Value).toFixed(2),a[0].ChangeOwed.Value=parseFloat(e.ChangeOwed.Value).toFixed(2))}return a},populateOfflineReceiptModel:function(e){var t=this,a=[],s=Komodo.Models.OnlineTill.ReceiptModel.create();s.IsReprint=0,s.IsCancelled=0,s.IsRefund=0,s.IsOffline=1,s.ReceiptDate=(new moment).format("DD/MM/YYYY h:mm"),s.CashierName=t.get("paymentController").userName(),s.ReceiptNumber="0",s.CustomerID=e.customerNumber,s.MethodOfPayment=e.methodOfPayment,s.Amount=parseFloat(e.amountTendered).toFixed(2),s.TotalAmountExclTax="0.00",s.TotalAmountInclTax="0.00",s.Tax=0;var o=e.allowedCurrencies.find(function(t){return t.key===e.currency.key});return s.Currency=Ember.isEmpty(o)?"":o.value,s.ExchangeRate=Ember.isEmpty(o)?"":o.rate,s.AccountID="",s.CustomerName="",s.Address="",s.CellNumber="",s.Change="0.00",s.Package="",s.ViewingPeriod="",s.Hardware="",s.Insurance="",s.SmartcardNumber="",s.NextPaymentDate="",a.push(s),a},mapReceiptData:function(e,t,a,s){var o=this,n=Komodo.Models.OnlineTill.ReceiptModel.create();n.IsReprint="true"===t.IsReprint||!0===t.IsReprint?"1":"0",n.IsCancelled="true"===t.IsCancelled||!0===t.IsCancelled?"1":"0",n.IsRefund="true"===t.IsRefund||!0===t.IsRefund?"1":"0",n.IsCashSale="true"===t.IsCashSale||!0===t.IsCashSale,n.IsSplit="true"===t.IsSplit||!0===t.IsSplit,n.IsOffline=0,n.ReceiptDate=new moment(t.ReceiptDate).format("DD/MM/YYYY h:mm"),n.CashierName=t.CashierName,n.ReceiptNumber=e.ReceiptNumber,n.CustomerID=void 0===e.CustomerID?e.CustomerId:e.CustomerID,n.QuotationID=void 0===e.QuotationID?e.QuotationId:e.QuotationID,n.AccountID=e.AccountID,n.CustomerName=e.CustomerName,n.Address=e.Address,n.CellNumber=e.CellphoneNumber,n.MethodOfPayment=t.MethodOfPayment,n.BaseCurrencyAmount=e.BaseCurrencyAmount,n.BaseTenderedAmount=n.BaseCurrencyAmount.Value,n.TotalAmountExclTax=Ember.isEmpty(e.Amount.ValueWithoutTax)||"0"===e.Amount.ValueWithoutTax?parseFloat(e.Amount.Value).toFixed(2):Math.abs(parseFloat(e.Amount.ValueWithoutTax).toFixed(2)),n.TotalAmountInclTax=Math.abs(parseFloat(e.Amount.Value).toFixed(2)),n.ChangeOwed=e.ChangeOwed,n.Change=Ember.isEmpty(e.ChangeOwed)?"0.00":parseFloat(e.ChangeOwed.Value).toFixed(2),n.CountryCode=Ember.isEmpty(s)?"":s.toUpperCase(),n.IsMultiCurrency=!!(a.allowedCurrencies&&a.allowedCurrencies.length>1),o.mapInvoiceDetailAndFiscalDocument(n,e,a.enableFiscalization,a.enableInvoice),a&&n.IsCashSale&&n.QuotationID&&(n.ReceiptNumber=n.ReceiptNumber+" - "+n.QuotationID,a.quote&&a.quote.UID===n.QuotationID&&a.quote.BusinessUnit&&(n.BusinessUnit=a.quote.BusinessUnit.toUpperCase())),n.Amount="Cash"===t.MethodOfPayment?Math.abs(parseFloat(e.AmountTendered.Value).toFixed(2)):Math.abs(parseFloat(e.Amount.Value).toFixed(2)),Ember.isEmpty(n.ChangeOwed)||Ember.isEmpty(n.ChangeOwed.Value)||(n.BaseTenderedAmount=(parseFloat(n.BaseTenderedAmount)+parseFloat(n.ChangeOwed.Value)).toFixed(2)),o.mapTaxFromPayment(n,e);var r=a.allowedCurrencies.find(function(t){return t.systemId.toString()===e.Amount.CurrencyCode.toString()});n.Currency=Ember.isEmpty(r)?"":r.value,n.ExchangeRate=Ember.isEmpty(r)?"":r.rate;var i=a.allowedCurrencies.find(function(t){return t.systemId.toString()===e.BaseCurrencyAmount.CurrencyCode.toString()});n.BaseCurrencyNeumonic=Ember.isEmpty(i)?"":i.value;var l=o.mapCustomerIfPresent(a,n);o.mapInformationIfCustomerExists(n,l),Ember.isEmpty(n.SmartCardNumber)&&(n.SmartcardNumber=Ember.isEmpty(t.SmartcardNumber)?n.IsSplit?e.SmartcardNumber:o.get("smartcardNumber"):n.IsSplit?e.SmartcardNumber:t.SmartcardNumber),(a.enableFiscalization||o.enableInvoice)&&(t&&(n.IsCashSale||"1"===n.IsRefund)&&!n.BusinessUnit&&t.BusinessUnit&&(n.BusinessUnit=t.BusinessUnit.toUpperCase()),(n.IsSplit||n.IsCashSale||!e.Address)&&(n.Address=e.CustomerAddress),n.IsFiscalInvoice=a.enableFiscalization);var c=o.retrieveStaticDataForReceipt(a.receiptTemplateConstants,a.allowedCurrencies.length>1);return n.IsSplit?$.each(t.SplitPayments,function(r,i){i.IsCancelled=t.IsCancelled,i.IsReprint=t.IsReprint,Ember.isEmpty(n.BusinessUnit)&&e.BusinessUnit&&(n.BusinessUnit=e.BusinessUnit.toUpperCase()),o.mapStaticInformationToReceipt(n,i,a,c,s)}):o.mapStaticInformationToReceipt(n,t,a,c,s),n},mapTaxFromPayment:function(e,t){var a=0,s=0;$($.makeArray(t.Amount.ListOfTax)).each(function(e,t){a+=parseFloat(t.Amount),s=t.Percent}),e.Tax=parseFloat(a).toFixed(2),e.TaxPercentage=s},mapCustomerIfPresent:function(e,t){var a=void 0;return $(e.gridData).each(function(e,s){if(s&&s.customerNumber.toString()===t.CustomerID.toString())return void(a=s)}),void 0===a&&$(e.customers).each(function(e,s){if(s&&s.customerNumber.toString()===t.CustomerID.toString())return void(a=s)}),a},mapInformationIfCustomerExists:function(e,t){var a=this;if(!Ember.isEmpty(t)){e.BusinessUnit=e.IsCashSale&&e.QuotationID&&e.BusinessUnit?e.BusinessUnit:t.businessUnit,Ember.isEmpty(e.AccountID)&&!Ember.isEmpty(t.account)&&(e.AccountID=t.account.accountNumber),Ember.isEmpty(e.Address)&&(e.Address=t.address),Ember.isEmpty(e.CellNumber)&&(e.CellNumber=Ember.isEmpty(t.telNo)?"":t.telNo.split(",").join("</br>")),a.mapPackageInformation(e,t);var s="";a.get("genericController")&&(s=a.get("genericController").getCustomerInformation(t)),Ember.isEmpty(s)||(e.Hardware=s.Hardware,e.Insurance=s.Insurance,e.SmartcardNumber=s.SmartCardNumber),e.NextPaymentDate=Ember.isEmpty(t.dueDate)?"":new moment(t.dueDate).format("DD/MM/YYYY")}},mapPackageInformation:function(e,t){if(!Ember.isEmpty(t.quote)&&Ember.isEmpty(t)){var a=0,s=0,o=[],n="";$(t.quote.quoteLineItems).each(function(e,t){a+=parseFloat(t.taxAmount),s+=parseFloat(t.baseAmount),o.push(t.invoiceText),Ember.isEmpty(t.startDate)||Ember.isEmpty(t.endDate)||(n=t.startDate.substring(0,10)+" - "+t.endDate.substring(0,10))}),e.Package=o.join("</br>"),e.TotalAmountExclTax=Math.abs(parseFloat(s).toFixed(2)),e.Tax=parseFloat(a).toFixed(2),e.TotalAmountInclTax=Ember.isEmpty(t.quote.totalAmount)?"0.00":Math.abs(parseFloat(t.quote.totalAmount).toFixed(2)),e.ViewingPeriod=n}},mapInvoiceDetailAndFiscalDocument:function(e,t,a,s){if(s||a){if(e.InvoiceDetail=t.InvoiceDetail?t.InvoiceDetail:null,null!=e.InvoiceDetail){e.InvoiceDetail.CreateDate=new moment(e.InvoiceDetail.CreateDate).format("DD/MM/YYYY"),e.InvoiceDetail.DueDate=e.InvoiceDetail.DueDate?new moment(e.InvoiceDetail.DueDate).format("DD/MM/YYYY"):e.InvoiceDetail.CreateDate,e.InvoiceDetail.BalanceBroughtForward=0;var o=0,n=0;$(e.InvoiceDetail.LineItems).each(function(e,t){t.PeriodTo&&t.PeriodFrom&&(t.PeriodTo=new moment(t.PeriodTo).format("DD/MM/YYYY"),t.PeriodFrom=new moment(t.PeriodFrom).format("DD/MM/YYYY")),o+=t.AmountIncludingTax,n+=t.AmountExcludingTax}),e.InvoiceDetail.BalanceBroughtForward=parseFloat(o-n).toFixed(2)}e.FiscalDocument=t.FiscalDocument?t.FiscalDocument:null}},mapStaticInformationToReceipt:function(e,t,a,s,o){e.Header=Ember.Object.create(),e.Footer=Ember.Object.create();var n=s.title,r="",i="";$.each(n,function(e,s){s&&t&&("YES"===t.IsRefund.toUpperCase()&&s.IsRefund&&Ember.isEmpty(i)?i=s.IsRefund:(a.enableInvoice||t.FiscalDocument&&Ember.isEmpty(t.FiscalDocument.ElectronicSignature))&&s.enableInvoice&&Ember.isEmpty(i)&&!t.IsCancelled?i=s.enableInvoice:a.enableInvoice&&!a.enableFiscalization&&s.enableFiscalization&&Ember.isEmpty(i)&&!t.IsCancelled?i=s.enableFiscalization:a.enableFiscalization&&s.enableFiscalization&&t.FiscalDocument&&!Ember.isEmpty(t.FiscalDocument.ElectronicSignature)&&Ember.isEmpty(i)&&!t.IsCancelled?i=s.enableFiscalization:!t||t.InvoiceDetail||t.FiscalDocument||t.IsRefund||!s.receipt||a.isOffLine||!Ember.isEmpty(i)?a.isOffLine&&s.IsOffline&&Ember.isEmpty(i)&&(i=s.IsOffline):i=s.receipt),r=i}),e.Header.set("Title",r);var l,c=s.subtitle,u="";$.each(c,function(e,a){a&&t&&(!t.IsReprint||Ember.isEmpty(a.IsReprint)||t.IsCancelled?t.IsCancelled&&!t.IsReprint?u=a.IsCancelled:t.IsReprint&&t.IsCancelled&&(0===e?u=a.IsReprint+"<br>":u+=a.IsCancelled):u=a.IsReprint,l=u)}),e.Header.set("SubTitle",u);var h=s.headerImageUrl,d="";$.each(h,function(a,s){s&&t&&(e.BusinessUnit&&"GOTV"===e.BusinessUnit.toUpperCase()&&s.GOTV?d=s.GOTV:e.BusinessUnit&&"DSTV"===e.BusinessUnit.toUpperCase()&&s.DSTV?d=s.DSTV:Ember.isEmpty(e.BusinessUnit)&&s.DSTV&&(d=s.DSTV))}),e.Header.set("ImageUrl",d);var p=s.footerImageUrl,m=[];$.each(p,function(a,s){s&&t&&("ZAF"===o.toUpperCase()&&s.DSTVZAF&&m.push(s.DSTVZAF),"ZAF"!==o.toUpperCase()&&e.BusinessUnit&&"DSTV"===e.BusinessUnit.toUpperCase()&&(s.DSTV||s.DSTV1)&&m.push(Ember.isEmpty(s.DSTV)?s.DSTV1:s.DSTV),"ZAF"!==o.toUpperCase()&&Ember.isEmpty(e.BusinessUnit)&&m.push(Ember.isEmpty(s.DSTV)?s.DSTV1:s.DSTV))}),e.Footer.set("ImageUrl",m);var f=s.footerAddress,y="";f&&($.each(f,function(a,s){s&&t&&(e.BusinessUnit&&"GOTV"===e.BusinessUnit.toUpperCase()&&s.GOTV?y=s.GOTV:e.BusinessUnit&&"DSTV"===e.BusinessUnit.toUpperCase()?t.IsCashSale&&s&&s["DSTV.IsCashSale"]?y=s["DSTV.IsCashSale"]:!t.IsCashSale&&s.DSTV?y=s.DSTV:t.IsCashSale&&"KEN"!==e.CountryCode.toUpperCase()&&s.DSTV&&(y=s.DSTV):Ember.isEmpty(e.BusinessUnit)&&s.DSTV&&(y=s.DSTV))}),e.Footer.set("Address",y)),e.Header.set("RegistrationInfo",s.registrationInfo)},retrieveStaticDataForReceipt:function(e,t){return this.mapStaticReceiptDataIntoTheModel(e,t)},mapStaticReceiptDataIntoTheModel:function(e,t){var a=Ember.Object.create();return $.each(e,function(e,s){s&&s.headerRegistrationInfo?a.set("registrationInfo",s.headerRegistrationInfo):s&&s.headerSubtitle?a.set("subtitle",s.headerSubtitle):s&&s.headerTitle?a.set("title",s.headerTitle):s&&s.headerImageUrl?a.set("headerImageUrl",s.headerImageUrl):s&&s.footerAddress?a.set("footerAddress",s.footerAddress):s&&s.footerImageUrl?a.set("footerImageUrl",s.footerImageUrl):t&&s&&s.bodyTaxTypeTwoDescription&&a.set("bodyTaxTypeTwoDescription",s.bodyTaxTypeTwoDescription)}),a},retrieveSmartcardForReceipt:function(e){var t,a,s=this;return e&&e.customer&&e.customer.account&&e.customer.account.products.length>0?t=e.customer.account.products:e&&e.account&&e.account.products.length>0?t=e.account.products:e&&e.quotes&&e.quotes.length>0&&Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+e.customerNumber,{async:!1}).done(function(e){$.each(e.Account,function(e,t){$.each(t.ListOfAgreement.Agreement,function(e,o){$.each(o.ListOfHardware.Hardware,function(e,o){$.each(o.ListOfService.Service,function(e,n){n&&n.ProductDetail&&n.ProductDetail.Type&&"PRINCIPAL"===n.ProductDetail.Type.toUpperCase()&&(3===t.AccountTypeId&&o&&o.SmartcardDetail&&!Ember.isEmpty(o.SmartcardDetail.Name)?(s.set("smartcardNumber",o.LinkedSmartcard),a=o.LinkedSmartcard):(s.set("smartcardNumber",o.SerialNumber),a=o.SerialNumber))})})})})}).fail(function(e){var t=JSON.stringify(e);Komodo.log("Get Account Profile ajax call failed. Error: "+t)}),t&&$.each(t,function(e,t){"PRINCIPAL"===t.productType.toUpperCase()&&(Ember.isEmpty(t.smartcardNumber)?-1!==t.hardware.toUpperCase().indexOf("DEVICE")&&Komodo.Services.queryService.getJSON("/AccountProfile/GetAgreementDetailViews?agreementDetailId="+t.productId,{async:!1}).done(function(e){$.each(e.AgreementDetailViewCollection,function(e,t){s.set("smartcardNumber",t.ProvisionedDevices)})}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetAgreementDetailViews ajax call failed. Error: "+t)}):(s.set("smartcardNumber",t.smartcardNumber),a=t.smartcardNumber))}),a}}),Ember.TEMPLATES.SupervisorApprovalView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push("\r\n      "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"OK",o):u.call(e,"loc","OK",o)))),t.buffer.push("\r\n      "),""}function r(e,t){var s,o;return t.buffer.push("\r\n      "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Cancel",o):u.call(e,"loc","Cancel",o)))),t.buffer.push("\r\n      "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var i,l,c,u=a.helperMissing,h=this.escapeExpression,d=this;return o.buffer.push('<table border="0" cellSpacing="2" cellPadding="2" width="100%">\r\n  <tr>\r\n    <td>\r\n      <fieldset>\r\n        <legend>'),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"locale.onlinetill:payment.supervisorApproval",c):u.call(t,"loc","locale.onlinetill:payment.supervisorApproval",c)))),o.buffer.push('</legend>\r\n        <table border="0" cellSpacing="5" cellPadding="5" width="100%">\r\n          <tr>\r\n            <td style="padding-right:10px">\r\n              '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"200",valueBinding:"data.supervisorUsername",label:"~locale.onlinetill:payment.supervisorName~",validatorBinding:"view.context.validators.supervisorUsernameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t,validatorBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),o.buffer.push(h(a.view.call(t,"Komodo.Controls.TextField",{hash:{type:"password",tabindex:"201",valueBinding:"data.passCode",label:"~locale.onlinetill:payment.passCode~",validatorBinding:"view.context.validators.passCodeValidator"},hashTypes:{type:"STRING",tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{type:t,tabindex:t,valueBinding:t,label:t,validatorBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </fieldset>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td align="right">\r\n      '),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"202",action:"ok",disabledBinding:"view.context.data.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:d.noop,fn:d.program(1,n,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n      "),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:d.noop,fn:d.program(3,r,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n    </td>\r\n  </tr>\r\n</table>\r\n"),""}),"undefined"==typeof TrimPath&&(TrimPath={}),function(){null==TrimPath.evalEx&&(TrimPath.evalEx=function(src){return eval(src)});var UNDEFINED;null==Array.prototype.pop&&(Array.prototype.pop=function(){return 0===this.length?UNDEFINED:this[--this.length]}),null==Array.prototype.push&&(Array.prototype.push=function(){for(var e=0;e<arguments.length;++e)this[this.length]=arguments[e];return this.length}),TrimPath.parseTemplate=function(e,t,a){null==a&&(a=TrimPath.parseTemplate_etc);var s=parse(e,t,a),o=TrimPath.evalEx(s,t,1);return null!=o?new a.Template(t,e,s,o,a):null};var exceptionDetails=function(e){return e.toString()+";\n "+e.message+";\n "+e.name+";\n "+(e.stack||"no stack trace")+";\n "+(e.description||"no further description")+";\n "+(e.fileName||"no file name")+";\n "+(e.lineNumber||"no line number")};try{String.prototype.process=function(e,t){var a=TrimPath.parseTemplate(this,null);return null!=a?a.process(e,t):this}}catch(e){}TrimPath.parseTemplate_etc={},TrimPath.parseTemplate_etc.statementTag="forelse|for|if|elseif|else|var|macro",TrimPath.parseTemplate_etc.statementDef={if:{delta:1,prefix:"if (",suffix:") {",paramMin:1},else:{delta:0,prefix:"} else {"},elseif:{delta:0,prefix:"} else if (",suffix:") {",paramDefault:"true"},"/if":{delta:-1,prefix:"}"},for:{delta:1,paramMin:3,prefixFunc:function(e,t,a,s){if("in"!=e[2])throw new s.ParseError(a,t.line,"bad for loop statement: "+e.join(" "));var o=e[1],n="__LIST__"+o;return["var ",n," = ",e[3],";","var __LENGTH_STACK__;","if (typeof(__LENGTH_STACK__) == 'undefined' || !__LENGTH_STACK__.length) __LENGTH_STACK__ = new Array();","__LENGTH_STACK__[__LENGTH_STACK__.length] = 0;","if ((",n,") != null) { ","var ",o,"_ct = 0;","for (var ",o,"_index = 0; ",o,"_index < ",n,".length; ",o,"_index++) { ",o,"_ct++;","if (typeof(",n,"[",o,"_index]) == 'function') {continue;}","__LENGTH_STACK__[__LENGTH_STACK__.length - 1]++;","var ",o," = ",n,"[",o,"_index];"].join("")}},forelse:{delta:0,prefix:"} } if (__LENGTH_STACK__[__LENGTH_STACK__.length - 1] == 0) { if (",suffix:") {",paramDefault:"true"},"/for":{delta:-1,prefix:"} }; delete __LENGTH_STACK__[__LENGTH_STACK__.length - 1];"},var:{delta:0,prefix:"var ",suffix:";"},macro:{delta:1,prefixFunc:function(e,t,a,s){var o=e[1].split("(")[0];return["var ",o," = function",e.slice(1).join(" ").substring(o.length),"{ var _OUT_arr = []; var _OUT = { write: function(m) { if (m) _OUT_arr.push(m); } }; "].join("")}},"/macro":{delta:-1,prefix:" return _OUT_arr.join(''); };"}},TrimPath.parseTemplate_etc.modifierDef={eat:function(e){return""},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},capitalize:function(e){return String(e).toUpperCase()},default:function(e,t){return null!=e?e:t}},TrimPath.parseTemplate_etc.modifierDef.h=TrimPath.parseTemplate_etc.modifierDef.escape,TrimPath.parseTemplate_etc.Template=function(e,t,a,s,o){this.process=function(e,t){null==e&&(e={}),null==e._MODIFIERS&&(e._MODIFIERS={}),null==e.defined&&(e.defined=function(t){return void 0!=e[t]});for(var a in o.modifierDef)null==e._MODIFIERS[a]&&(e._MODIFIERS[a]=o.modifierDef[a]);null==t&&(t={});var n=[],r={write:function(e){n.push(e)}};try{s(r,e,t)}catch(e){if(1==t.throwExceptions)throw e;var i=new String(n.join("")+"[ERROR: template: <pre>"+exceptionDetails(e)+"</pre>]");return i.exception=e,i}return n.join("")},this.name=e,this.source=t,this.sourceFunc=a,this.toString=function(){return"TrimPath.Template ["+e+"]"}},TrimPath.parseTemplate_etc.ParseError=function(e,t,a){this.name=e,this.line=t,this.message=a},TrimPath.parseTemplate_etc.ParseError.prototype.toString=function(){return"TrimPath template ParseError in "+this.name+": line "+this.line+", "+this.message};var parse=function(e,t,a){e=cleanWhiteSpace(e);for(var s=["var TrimPath_Template_TEMP = function(_OUT, _CONTEXT, _FLAGS) { with (_CONTEXT) {"],o={stack:[],line:1},n=-1;n+1<e.length;){var r=n;for(r=e.indexOf("{",r+1);r>=0;){var i=e.indexOf("}",r+1),l=e.substring(r,i),c=l.match(/^\{(cdata|minify|eval)/);if(c){var u=c[1],h=r+u.length+1,d=e.indexOf("}",h);if(d>=0){var p;p=d-h<=0?"{/"+u+"}":e.substring(h+1,d);var m=e.indexOf(p,d+1);if(m>=0){emitSectionText(e.substring(n+1,r),s);var f=e.substring(d+1,m);"cdata"==u?emitText(f,s):"minify"==u?emitText(scrubWhiteSpace(f),s):"eval"==u&&null!=f&&f.length>0&&s.push("_OUT.write( (function() { "+f+" })() );"),r=n=m+p.length-1}}}else if("$"!=e.charAt(r-1)&&"\\"!=e.charAt(r-1)){var y="/"==e.charAt(r+1)?2:1;if(0==e.substring(r+y,r+10+y).search(TrimPath.parseTemplate_etc.statementTag))break}r=e.indexOf("{",r+1)}if(r<0)break;var i=e.indexOf("}",r+1);if(i<0)break;emitSectionText(e.substring(n+1,r),s),emitStatement(e.substring(r,i+1),o,s,t,a),n=i}if(emitSectionText(e.substring(n+1),s),0!=o.stack.length)throw new a.ParseError(t,o.line,"unclosed, unmatched statement(s): "+o.stack.join(","));return s.push("}}; TrimPath_Template_TEMP"),s.join("")},emitStatement=function(e,t,a,s,o){var n=e.slice(1,-1).split(" "),r=o.statementDef[n[0]];if(null==r)return void emitSectionText(e,a);if(r.delta<0){if(t.stack.length<=0)throw new o.ParseError(s,t.line,"close tag does not match any previous statement: "+e);t.stack.pop()}if(r.delta>0&&t.stack.push(e),null!=r.paramMin&&r.paramMin>=n.length)throw new o.ParseError(s,t.line,"statement needs more parameters: "+e);if(null!=r.prefixFunc?a.push(r.prefixFunc(n,t,s,o)):a.push(r.prefix),null!=r.suffix){if(n.length<=1)null!=r.paramDefault&&a.push(r.paramDefault);else for(var i=1;i<n.length;i++)i>1&&a.push(" "),a.push(n[i]);a.push(r.suffix)}},emitSectionText=function(e,t){if(!(e.length<=0)){for(var a=0,s=e.length-1;a<e.length&&"\n"==e.charAt(a);)a++;for(;s>=0&&(" "==e.charAt(s)||"\t"==e.charAt(s));)s--;if(s<a&&(s=a),a>0){t.push('if (_FLAGS.keepWhitespace == true) _OUT.write("');var o=e.substring(0,a).replace("\n","\\n");"\n"==o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),t.push(o),t.push('");')}for(var n=e.substring(a,s+1).split("\n"),r=0;r<n.length;r++)emitSectionTextLine(n[r],t),r<n.length-1&&t.push('_OUT.write("\\n");\n');if(s+1<e.length){t.push('if (_FLAGS.keepWhitespace == true) _OUT.write("');var o=e.substring(s+1).replace("\n","\\n");"\n"==o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),t.push(o),t.push('");')}}},emitSectionTextLine=function(e,t){for(var a="}",s=-1;s+a.length<e.length;){var o="${",n="}",r=e.indexOf(o,s+a.length);if(r<0)break;"%"==e.charAt(r+2)&&(o="${%",n="%}");var i=e.indexOf(n,r+o.length);if(i<0)break;emitText(e.substring(s+a.length,r),t);var l=e.substring(r+o.length,i).replace(/\|\|/g,"#@@#").split("|");for(var c in l)void 0!==l[c]&&l[c].replace&&(l[c]=l[c].replace(/#@@#/g,"||"));t.push("_OUT.write("),emitExpression(l,l.length-1,t),t.push(");"),s=i,a=n}
emitText(e.substring(s+a.length),t)},emitText=function(e,t){null==e||e.length<=0||(e=e.replace(/\\/g,"\\\\"),e=e.replace(/\n/g,"\\n"),e=e.replace(/"/g,'\\"'),t.push('_OUT.write("'),t.push(e),t.push('");'))},emitExpression=function(e,t,a){var s=e[t];if(t<=0)return void a.push(s);var o=s.split(":");a.push('_MODIFIERS["'),a.push(o[0]),a.push('"]('),emitExpression(e,t-1,a),o.length>1&&(a.push(","),a.push(o[1])),a.push(")")},cleanWhiteSpace=function(e){return e=e.replace(/\t/g,"    "),e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e=e.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1")},scrubWhiteSpace=function(e){return e=e.replace(/^\s+/g,""),e=e.replace(/\s+$/g,""),e=e.replace(/\s+/g," "),e=e.replace(/^(\s*\S*(\s+\S+)*)\s*$/,"$1")};TrimPath.parseDOMTemplate=function(e,t,a){null==t&&(t=document);var s=t.getElementById(e),o=s.value;return null==o&&(o=s.innerHTML),o=o.replace(/&lt;/g,"<").replace(/&gt;/g,">"),TrimPath.parseTemplate(o,e,a)},TrimPath.parseDOMTemplate=function(e,t,a,s){null==a&&(a=document);var o=a.getElementById(e);return null==t&&(t=o.innerHTML),t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">"),TrimPath.parseTemplate(t,e,s)},TrimPath.processDOMTemplate=function(e,t,a,s,o){return TrimPath.parseDOMTemplate(e,s,o).process(t,a)}}(),Ember.TEMPLATES.SplitPaymentView=Ember.Handlebars.template(function(e,t,a,s,o){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var n=this.escapeExpression;return o.buffer.push("<div>\r\n  "),o.buffer.push(n(a.view.call(t,"Komodo.Application.PaymentView",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.ShiftManagementView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push('\r\n  <table width="100%">\r\n    <tr>\r\n      <td width="50%">\r\n        '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"1",valueBinding:"data.shiftType",contentBinding:"data.shiftTypes",optionLabelPath:"content.value",optionValuePath:"content",label:"~locale.onlinetill:shift.shiftType~",validatorBinding:"validators.shiftTypeValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n      <td width="50%">\r\n        '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"2",valueBinding:"data.shiftId",label:"~locale.onlinetill:shift.shiftNumber~",validatorBinding:"validators.shiftIdValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"3",valueBinding:"data.cashierName",label:"~locale.onlinetill:shift.cashierName~",validatorBinding:"validators.cashierNameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"4",valueBinding:"data.bdNumber",label:"~locale.onlinetill:shift.bankDepositNumber~",validatorBinding:"validators.bdNumberValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"5",valueBinding:"data.startDate",label:"~locale.onlinetill:shift.startDate~",validatorBinding:"validators.startDateValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"6",valueBinding:"data.endDate",label:"~locale.onlinetill:shift.endDate~",validatorBinding:"validators.endDateValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td align="right" colspan="2">\r\n        '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"7",action:"searchShifts"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:e,action:e},inverse:m.noop,fn:m.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        &nbsp;\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"8",action:"clearShifts",type:"inverse"},hashTypes:{tabindex:"STRING",action:"STRING",type:"STRING"},hashContexts:{tabindex:e,action:e,type:e},inverse:m.noop,fn:m.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  "),""}function r(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.searchShiftButton",o):d.call(e,"loc","locale.onlinetill:shift.searchShiftButton",o)))),t.buffer.push("\r\n        "),""}function i(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.clear",o):d.call(e,"loc","locale.onlinetill:customer.clear",o)))),t.buffer.push("\r\n        "),""}function l(e,t){return t.buffer.push("\r\n  "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.searchResult~",visibleBinding:"data.isMessageVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DataGrid",{hash:{tabindex:"9",canSort:!0,pageSize:10,performsValidation:!0,canDelete:!1,canEdit:!1,canSelect:!1,selectedItemBinding:"data.selectedGridItem",commandItemBinding:"data.commandGridItem",commandItemTypeBinding:"data.commandGridItemType",contentBinding:"data.shiftData",columnsBinding:"gridColumns",visibleBinding:"data.isGridVisible"},hashTypes:{tabindex:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING",visibleBinding:"STRING"},hashContexts:{tabindex:e,canSort:e,pageSize:e,performsValidation:e,canDelete:e,canEdit:e,canSelect:e,selectedItemBinding:e,commandItemBinding:e,commandItemTypeBinding:e,contentBinding:e,columnsBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var c,u,h,d=a.helperMissing,p=this.escapeExpression,m=this;return o.buffer.push('<div class="no-banner-padding">\r\n  <table width="100%">\r\n    <tr>\r\n      <td>\r\n        <p class="komodo-heading">'),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:home.useCaseCloseShiftsTitle",h):d.call(t,"loc","locale.onlinetill:home.useCaseCloseShiftsTitle",h)))),o.buffer.push('</p>\r\n      </td>\r\n      <td align="right">       \r\n        '),o.buffer.push(p(a.view.call(t,"Komodo.Controls.Link",{hash:{tabindex:"18",text:"~locale.onlinetill:home.back~",href:"#/home"},hashTypes:{tabindex:"STRING",text:"STRING",href:"STRING"},hashContexts:{tabindex:t,text:t,href:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <hr />\r\n  "),c=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:shift.searchShift~"},hashTypes:{title:"STRING"},hashContexts:{title:t},inverse:m.noop,fn:m.program(1,n,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n  "),c=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:shift.shiftList~",visibleBinding:"showResultView"},hashTypes:{title:"STRING",visibleBinding:"STRING"},hashContexts:{title:t,visibleBinding:t},inverse:m.noop,fn:m.program(6,l,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n</div>"),""}),Komodo.Models.OnlineTill=Ember.Namespace.createWithMixins(LoggingMixin,{name:"Komodo.Models.OnlineTill"}),Komodo.Application.CashSalePaymentRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"cashSalePayment",useCaseDisplayName:kl.value("locale.onlinetill:home.subTitleCashSale"),renderTemplate:function(){this.render("shiftDetailsContainer",{outlet:"summaryDetails",controller:"payment"}),this.render("cashSalePayment",{controller:"payment"})},init:function(){this._super()}}),Komodo.Application.SplitPaymentRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"splitPayment",useCaseDisplayName:kl.value("locale.onlinetill:home.subTitleSplitPayment"),renderTemplate:function(){this.render("shiftDetailsContainer",{outlet:"summaryDetails",controller:"payment"}),this.render("splitPayment",{controller:"payment"})},init:function(){this._super()}}),Komodo.Application.CustomerPaymentRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"customerPayment",useCaseDisplayName:kl.value("locale.onlinetill:home.subTitleCustomerPayment"),renderTemplate:function(){this.render("shiftDetailsContainer",{outlet:"summaryDetails",controller:"payment"}),this.render("customerPayment",{controller:"payment"})},init:function(){this._super()}}),Komodo.Application.BatchPaymentRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"batchPayment",useCaseDisplayName:kl.value("locale.onlinetill:home.subTitleAgencyBatchPayment"),renderTemplate:function(){this.render("shiftDetailsContainer",{outlet:"summaryDetails",controller:"payment"}),this.render("batchPayment",{controller:"payment"})},init:function(){this._super()}}),Komodo.Application.SearchRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"search",useCaseDisplayName:kl.value("locale.onlinetill:customer.search"),init:function(){this._super()}}),Komodo.Application.PaymentReportRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"paymentReport",init:function(){this.useCaseDisplayName=kl.value("locale.onlinetill:home.useCaseReportTitle"),this._super()}}),Komodo.Application.ShiftManagementRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"shiftManagement",init:function(){this.useCaseDisplayName=kl.value("locale.onlinetill:home.useCaseCloseShiftsTitle"),this._super()}}),Komodo.Application.UpdateExchangeRatesRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"updateExchangeRates",useCaseDisplayName:void 0,init:function(){this.useCaseDisplayName=kl.value("locale.onlinetill:updateExchangeRate.updateExchangeRateTitle"),this._super()}}),Komodo.UI.Route.registerRoutes(function(){this.resource("search"),this.resource("cashSalePayment"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"cashSalePayment",title:kl.value("locale.onlinetill:home.title"),type:Komodo.NavigationTypes.HomeTile,imageurl:"Content/Images/Home/onlineTill.svg",desiredLocation:2,conditionalCallback:function(){return Komodo.Services.ProductAndServiceMaintenanceHelper.create().isCustomerIdIsAvailableToRetriveData()?Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleCustomerPayment")}):Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleCashSales")}),!0}}),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"cashSalePayment",type:Komodo.NavigationTypes.HomeTileSubLink,title:kl.value("locale.onlinetill:home.subTitleCashSale"),desiredLocation:1,conditionalCallback:function(){return Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleCashSales")}),!0}}),this.resource("customerPayment"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"customerPayment",type:Komodo.NavigationTypes.HomeTileSubLink,title:kl.value("locale.onlinetill:home.subTitleCustomerPayment"),desiredLocation:2,conditionalCallback:function(){return Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleCustomerPayment")}),!0}}),this.resource("splitPayment"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"splitPayment",type:Komodo.NavigationTypes.HomeTileSubLink,title:kl.value("locale.onlinetill:home.subTitleSplitPayment"),desiredLocation:3,conditionalCallback:function(){return Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleSplitPayment")}),!0}}),this.resource("batchPayment"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"batchPayment",type:Komodo.NavigationTypes.HomeTileSubLink,title:kl.value("locale.onlinetill:home.subTitleAgencyBatchPayment"),desiredLocation:4,conditionalCallback:function(){return Komodo.Services.eventAggregator.publish("PublishMakePayment",{value:kl.value("locale.onlinetill:home.subTitleBatchPayment")}),!0}}),this.resource("updateExchangeRates"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"updateExchangeRates",title:kl.value("locale.onlinetill:updateExchangeRate.updateExchangeRateTitle"),type:Komodo.NavigationTypes.Normal,desiredLocation:6}),this.resource("paymentReport"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"paymentReport",title:kl.value("locale.onlinetill:home.useCaseReportTitle"),type:Komodo.NavigationTypes.Normal,desiredLocation:7}),this.resource("shiftManagement"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.OnlineTill,routeName:"shiftManagement",title:kl.value("locale.onlinetill:home.useCaseCloseShiftsTitle"),type:Komodo.NavigationTypes.Normal,desiredLocation:8}),Komodo.Services.eventAggregator.subscribe("PublishShiftClosed",function(){Komodo.Services.uiService.getRoute("application").transitionTo("home")}),Komodo.Services.eventAggregator.subscribe("PublishPaymentForQuotation",function(e){Komodo.Services.navigationService.activateGroup(Komodo.NavigationGroupNames.OnlineTill),Komodo.Services.uiService.getRoute("application").transitionTo("cashSalePayment");var t=Komodo.Services.uiService.getController("payment");t.start(),t.setPaymentType("Cash Sales"),void 0!==e&&void 0!==e.QuoteNumber&&""!==e.QuoteNumber&&(t.set("QuotationPayment",!0),Komodo.Services.eventAggregator.publish("PublishQuotationPayment",e))}),Komodo.Services.eventAggregator.subscribe("PublishMakePayment",function(e){var t=Komodo.Services.uiService.getController("payment");t.setPaymentType(e),t.start()}),Komodo.Services.eventAggregator.subscribe("PublishCustomerPayment",function(e){var t=Komodo.Services.uiService.getController("payment");t.set("autoPopulateFlag",!1),t.start(),void 0!==e&&void 0!==e.length&&e.length>0&&(t.data.set("paymentType","Customer Payment"),t.data.set("customers",e),t.setCustomerDetailsForCustomerPayment())}),Komodo.Services.eventAggregator.subscribe("PublishSplitPayment",function(e){var t=Komodo.Services.uiService.getController("payment");t.set("autoPopulateFlag",!1),t.start(),void 0!==e&&void 0!==e.length&&e.length>0&&(t.data.set("paymentType","Split Payment"),t.data.set("customers",e),t.setCustomerDetailsForSplitPayment())}),Komodo.Services.eventAggregator.subscribe(Komodo.EventNames.userLoggedOut,function(){var e=Komodo.Services.uiService.getController("payment"),t=Komodo.Application.ShiftManagement.create();e&&(e.clearModelData(),t.clearShiftDetails(Ember.Object.create()),e.clearQuoteData())})}),Komodo.Services.OLTReportService=Ember.Object.extend(Komodo.Dependency,{currentReportData:void 0,showOfflinePaymentView:!1,isMultipleBusinessUnit:!1,init:function(){this._super(),this.requiresDependency("_securityService",{singleton:Komodo.Services.securityService}),this.requiresDependency("_eventAggregator",{singleton:Komodo.Services.eventAggregator}),this.requiresDependency("_featureToggleService",{singleton:Komodo.Services.featureToggleService}),this.getEventAggregator().subscribe(Komodo.EventNames.applicationInitialized,this,this._configure),this.getEventAggregator().subscribe(Komodo.EventNames.userLoggedIn,this,this._configure),this.set("currentReportData",void 0)},getSecurityService:function(){return this.get("_securityService")},getEventAggregator:function(){return this.get("_eventAggregator")},getFeatureToggleService:function(){return this.get("_featureToggleService")},_configure:function(){var e=this;this.getFeatureToggleService().isEnabled("OnlineTill","EnableOfflinePaymentView").done(function(t){Ember.run(function(){e.set("showOfflinePaymentView",t)})}),this.getFeatureToggleService().isEnabled("CreateQuotation","DoNotAllowDstvGotvSplit").done(function(t){Ember.run(function(){e.set("isMultipleBusinessUnit",!t)})}).fail(function(e){Komodo.Services.log("Error while checking DoNotAllowDstvGotvSplit feature toggle. Error Details:"+e)})},destroy:function(){this.getEventAggregator().unsubscribe(Komodo.EventNames.applicationInitialized,this,this._configure),this._super()},retrievedReportData:function(e){this.set("currentReportData",e)}}),Komodo.Services.OLTReportService=Komodo.Services.OLTReportService.create(),Komodo.Services.OLTService=Ember.Object.extend(Komodo.Dependency,{init:function(){this._super(),this.requiresDependency("_securityService",{singleton:Komodo.Services.securityService}),this.requiresDependency("_eventAggregator",{singleton:Komodo.Services.eventAggregator}),this.requiresDependency("_featureToggleService",{singleton:Komodo.Services.featureToggleService}),this.getEventAggregator().subscribe(Komodo.EventNames.applicationInitialized,this,this._configure),this.getEventAggregator().subscribe(Komodo.EventNames.userLoggedIn,this,this._configure)},publishOLTEvent:function(e,t,a,s,o,n,r){void 0===n&&e.startNewProcess(),o=void 0!==o&&o;var i=$.Deferred(),l={eventName:a,eventVersion:s,eventValidityInMinutes:0,eventPriority:null,fireAndForget:o,parameters:r};return e.sendMessage(t,l).done(function(){i.resolve(),Komodo.log(a+" is done.")}).fail(function(e){i.fail(e),Komodo.log(a+" is failed.")}),i},publishElevatedPrivilegeEvent:function(e,t,a,s,o,n){e.startNewProcess(),o=void 0!==o&&o;var r=$.Deferred(),i={eventName:a,eventVersion:s,parameters:[{key:"elevatedPrivilegeSessionToken",value:n}],eventValidityInMinutes:0,eventPriority:null,fireAndForget:o};return e.sendMessage(t,i).done(function(){r.resolve(),Komodo.log(a+" is done.")}).fail(function(e){r.fail(e),Komodo.log(a+" is failed.")}),r},getSecurityService:function(){return this.get("_securityService")},getEventAggregator:function(){return this.get("_eventAggregator")},getFeatureToggleService:function(){return this.get("_featureToggleService")},_configure:function(){var e=this;this.getFeatureToggleService().isEnabled("OnlineTill","EnableAgencyBatchPayment").done(function(t){Ember.run(function(){t||e.getSecurityService().overrideRouteAccess({routeName:"batchPayment",permissionType:"HIDE"})})})},destroy:function(){this.getEventAggregator().unsubscribe(Komodo.EventNames.applicationInitialized,this,this._configure),this._super()}}),Komodo.Services.OLTService=Komodo.Services.OLTService.create(),Ember.TEMPLATES.BatchPaymentReportView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){return t.buffer.push('\r\n    <div class="text-center">\r\n      <img src="Content/Images/busy-indicator.svg"/>\r\n      <br/>\r\n      '),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.messageSpooling~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"view.context.data.spoolingPercentage",id:"percentage"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    </div>\r\n  "),""}function r(e,t){var s,o,n;return t.buffer.push('\r\n  <div class="print-button">\r\n    <a '),t.buffer.push(b(a.action.call(e,"printReport",{hash:{target:"view.context"},hashTypes:{target:"STRING"},hashContexts:{target:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('>\r\n      <img name="print_01" alt="print" src="./Content/Images/report_print.gif" />'),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:report.print",n):g.call(e,"loc","locale.onlinetill:report.print",n)))),t.buffer.push('\r\n    </a>\r\n  </div>\r\n  <div class="panel panel-default printing">\r\n    <div class="panel-body" id="reportView">\r\n      <h5 class="text-center"><img src="Content/Images/main_logo.svg" /></h5>\r\n      <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.country",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</h5>\r\n      <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.header",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.batchPaymentReport~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</h5>\r\n      <br/>\r\n      "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      <br/>\r\n      "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.paymentDetails~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(":\r\n      <table "),t.buffer.push(b(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n        <thead>\r\n          <tr>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.paymentNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.receiptNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.customerNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.accountNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.customerName~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.payAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          "),s=a.each.call(e,"row","in","view.context.data.detailGridData",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(9,u,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n        </tbody>\r\n      </table>\r\n      <br/>\r\n      <div class="center-block column-width">\r\n        <table '),t.buffer.push(b(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(" >\r\n          <thead>\r\n            <tr>\r\n              <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.paymentType~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n              <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionCount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n              <th>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            "),s=a.each.call(e,"row","in","view.context.data.summaryGridData",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(17,f,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  "),""}function i(e,t){var s;return t.buffer.push("\r\n      "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(5,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(7,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),""}function l(e,t){var s;return t.buffer.push("\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.company~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.country",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br/>\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.batch~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : <b>"),s=a._triageMustache.call(e,"view.context.data.status",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</b> "),s=a._triageMustache.call(e,"view.context.data.batchNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <b>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.on~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b> "),s=a._triageMustache.call(e,"view.context.data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <b>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.online~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b> <br/>\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.userName~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.userName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br/>\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.currency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.currency",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br/>\r\n      "),""}function c(e,t){var s;return t.buffer.push("\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.date~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br/>\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.time~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.time",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br/>\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.stockHandler~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.stockHandlerDescription",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br />\r\n      <strong>"),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.bankDepositNumber~",visibleBinding:"view.context.data.isBankDepositNumberVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:":",visibleBinding:"view.context.data.isBankDepositNumberVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{
textBinding:"view.context.data.bankDepositNumber",visibleBinding:"view.context.data.isBankDepositNumberVisible"},hashTypes:{textBinding:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" <br/>\r\n      "),""}function u(e,t){var s;return t.buffer.push("\r\n          "),s=a.each.call(e,"item","in","row.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(10,h,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n          "),""}function h(e,t){var s;return t.buffer.push("\r\n          <tr>\r\n            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:v.program(13,p,t),fn:v.program(11,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            <td>\r\n              "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.customerName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:v.program(13,p,t),fn:v.program(15,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n          </tr>\r\n          "),""}function d(e,t){return t.buffer.push('\r\n            <td class="top">\r\n              '),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            "),""}function p(e,t){t.buffer.push('\r\n            <td class="bottom"></td>\r\n            ')}function m(e,t){return t.buffer.push('\r\n            <td class="top text-right">\r\n              '),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            "),""}function f(e,t){return t.buffer.push("\r\n            <tr>\r\n              <td>\r\n                "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              </td>\r\n              <td>\r\n                "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.count"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n              <td class="text-right">\r\n                '),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n            "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var y,b=this.escapeExpression,v=this,g=a.helperMissing;return o.buffer.push('<div class="modal-max-size">\r\n  '),y=a.if.call(t,"view.context.data.spooling",{hash:{},hashTypes:{},hashContexts:{},inverse:v.program(3,r,o),fn:v.program(1,n,o),contexts:[t],types:["ID"],data:o}),(y||0===y)&&o.buffer.push(y),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.BatchPaymentView=Ember.Handlebars.template(function(e,t,a,s,o){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var n=this.escapeExpression;return o.buffer.push("<div>\r\n  "),o.buffer.push(n(a.view.call(t,"Komodo.Application.PaymentView",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.ShiftDetailsView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push("\r\n  "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.search",o):N.call(e,"loc","locale.onlinetill:customer.search",o)))),t.buffer.push("\r\n  "),""}function r(e,t){var s;return t.buffer.push("\r\n      "),s=a.each.call(e,"item","in","row.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:B.noop,fn:B.program(4,i,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),""}function i(e,t){var s;return t.buffer.push("\r\n      <tr>\r\n        "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:B.program(18,y,t),fn:B.program(5,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:B.program(18,y,t),fn:B.program(20,b,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        <td>\r\n          "),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.quoteId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:B.program(24,g,t),fn:B.program(22,v,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      </tr>\r\n      "),""}function l(e,t){var s;return t.buffer.push('\r\n        <td class="top">\r\n            '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"reprintReceipt",size:"xs"},hashTypes:{action:"STRING",size:"STRING"},hashContexts:{action:e,size:e},inverse:B.noop,fn:B.program(6,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"cancelPayment",size:"xs",disabledBinding:"row.disableCancel"},hashTypes:{action:"STRING",size:"STRING",disabledBinding:"STRING"},hashContexts:{action:e,size:e,disabledBinding:e},inverse:B.noop,fn:B.program(8,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"rePublish",size:"xs",visible:!1},hashTypes:{action:"STRING",size:"STRING",visible:"BOOLEAN"},hashContexts:{action:e,size:e,visible:e},inverse:B.noop,fn:B.program(10,h,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.if.call(e,"row.enableInvoice",{hash:{},hashTypes:{},hashContexts:{},inverse:B.noop,fn:B.program(12,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        "),""}function c(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.reprint",o):N.call(e,"loc","locale.onlinetill:shift.reprint",o)))),t.buffer.push("\r\n            "),""}function u(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.cancelPayment",o):N.call(e,"loc","locale.onlinetill:shift.cancelPayment",o)))),t.buffer.push("\r\n            "),""}function h(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Publish",o):N.call(e,"loc","Publish",o)))),t.buffer.push("\r\n            "),""}function d(e,t){var s;return t.buffer.push("\r\n            <br/> <br/>\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"getHardwareInvoice",size:"xs"},hashTypes:{action:"STRING",size:"STRING"},hashContexts:{action:e,size:e},inverse:B.noop,fn:B.program(13,p,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function p(e,t){var s;return t.buffer.push("\r\n            "),s=a.if.call(e,"row.isRefund",{hash:{},hashTypes:{},hashContexts:{},inverse:B.program(16,f,t),fn:B.program(14,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function m(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.retrieveCreditNote",o):N.call(e,"loc","locale.onlinetill:shift.retrieveCreditNote",o)))),t.buffer.push("\r\n            "),""}function f(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.retrieveInvoice",o):N.call(e,"loc","locale.onlinetill:shift.retrieveInvoice",o)))),t.buffer.push("\r\n            "),""}function y(e,t){t.buffer.push('\r\n        <td class="bottom"></td>\r\n        ')}function b(e,t){return t.buffer.push('\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        "),""}function v(e,t){return t.buffer.push('\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.currency.value"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top text-right">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top text-right">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.baseCurrencyAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.date"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.isRefund"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.isSplit"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        </td>\r\n        <td class="top">\r\n          '),t.buffer.push(D(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.isCancelled"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        "),""}function g(e,t){t.buffer.push('\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        <td class="bottom"></td>\r\n        ')}function C(e,t){var s,o;return t.buffer.push("\r\n    "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.previous",o):N.call(e,"loc","locale.onlinetill:shift.previous",o)))),t.buffer.push("\r\n    "),""}function x(e,t){var s,o;return t.buffer.push("\r\n    "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.next",o):N.call(e,"loc","locale.onlinetill:shift.next",o)))),t.buffer.push("\r\n    "),""}function S(e,t){var s,o;return t.buffer.push("\r\n    "),t.buffer.push(D((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.close",o):N.call(e,"loc","locale.onlinetill:shift.close",o)))),t.buffer.push("\r\n    "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var T,I,R,N=a.helperMissing,D=this.escapeExpression,B=this;return o.buffer.push('<div class="modal-max-size">\r\n  '),o.buffer.push(D(a.view.call(t,"Komodo.Controls.CoreTextField",{hash:{tabindex:"1",placeholderBinding:"view.context.searchTextPlaceholder",valueBinding:"view.context.searchText"},hashTypes:{tabindex:"STRING",placeholderBinding:"STRING",valueBinding:"STRING"},hashContexts:{tabindex:t,placeholderBinding:t,valueBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("&nbsp;\r\n  "),T=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"2",action:"searchReceipt",class:"button-no-margin"},hashTypes:{tabindex:"STRING",action:"STRING",class:"STRING"},hashContexts:{tabindex:t,action:t,class:t},inverse:B.noop,fn:B.program(1,n,o),contexts:[t],types:["ID"],data:o}),(T||0===T)&&o.buffer.push(T),o.buffer.push('\r\n  <br/><br/>\r\n  <div style="height:420px; overflow-x: auto; overflow-y: auto;">\r\n    <table '),o.buffer.push(D(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid :print-table :text-nowrap"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n      <tr>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.actions",R):N.call(t,"loc","locale.onlinetill:shift.actions",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.paymentNumber",R):N.call(t,"loc","locale.onlinetill:shift.paymentNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.transactionNumber",R):N.call(t,"loc","locale.onlinetill:shift.transactionNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.receiptNumber",R):N.call(t,"loc","locale.onlinetill:shift.receiptNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:customer.customerNumber",R):N.call(t,"loc","locale.onlinetill:customer.customerNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.accountNumber",R):N.call(t,"loc","locale.onlinetill:shift.accountNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:quote.quoteNumber",R):N.call(t,"loc","locale.onlinetill:quote.quoteNumber",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:payment.paymentType",R):N.call(t,"loc","locale.onlinetill:payment.paymentType",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.currency",R):N.call(t,"loc","locale.onlinetill:shift.currency",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:customer.payAmount",R):N.call(t,"loc","locale.onlinetill:customer.payAmount",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:quote.baseAmount",R):N.call(t,"loc","locale.onlinetill:quote.baseAmount",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.date",R):N.call(t,"loc","locale.onlinetill:shift.date",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.isRefund",R):N.call(t,"loc","locale.onlinetill:shift.isRefund",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.isSplit",R):N.call(t,"loc","locale.onlinetill:shift.isSplit",R)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(D((I=a.loc||t&&t.loc,R={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},I?I.call(t,"locale.onlinetill:shift.isCancelled",R):N.call(t,"loc","locale.onlinetill:shift.isCancelled",R)))),o.buffer.push("</th>\r\n      </tr>\r\n      "),T=a.each.call(t,"row","in","data",{hash:{},hashTypes:{},hashContexts:{},inverse:B.noop,fn:B.program(3,r,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(T||0===T)&&o.buffer.push(T),o.buffer.push('\r\n    </table>\r\n  </div>\r\n  <div style="float:right; width:60%;">\r\n    '),T=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"previousPage",id:"btnPreviousbottom",disabledBinding:"view.context.isPreviousDisable.value"},hashTypes:{action:"STRING",id:"STRING",disabledBinding:"STRING"},hashContexts:{action:t,id:t,disabledBinding:t},inverse:B.noop,fn:B.program(26,C,o),contexts:[t],types:["ID"],data:o}),(T||0===T)&&o.buffer.push(T),o.buffer.push("\r\n\r\n    "),T=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"nextPage",id:"btnNextbottom",disabledBinding:"view.context.isNextDisable.value"},hashTypes:{action:"STRING",id:"STRING",disabledBinding:"STRING"},hashContexts:{action:t,id:t,disabledBinding:t},inverse:B.noop,fn:B.program(28,x,o),contexts:[t],types:["ID"],data:o}),(T||0===T)&&o.buffer.push(T),o.buffer.push('\r\n  </div>\r\n  <br/><br/>\r\n  <div style="float:right;">\r\n    '),T=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"3",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:B.noop,fn:B.program(30,S,o),contexts:[t],types:["ID"],data:o}),(T||0===T)&&o.buffer.push(T),o.buffer.push("\r\n  </div>\r\n</div>"),""}),Ember.TEMPLATES.CancelPaymentView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(6,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function r(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.shiftNumber",n):y.call(e,"loc","locale.onlinetill:shift.shiftNumber",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.shiftNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong> <br/>\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.payAmount",n):y.call(e,"loc","locale.onlinetill:customer.payAmount",n)))),t.buffer.push(" ("),s=a._triageMustache.call(e,"data.currency.value",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("): <strong>"),s=a._triageMustache.call(e,"data.amount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function i(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.paymentNumber",n):y.call(e,"loc","locale.onlinetill:shift.paymentNumber",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.paymentId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong> <br/>\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.date",n):y.call(e,"loc","locale.onlinetill:shift.date",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function l(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:payment.paymentType",n):y.call(e,"loc","locale.onlinetill:payment.paymentType",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function c(e,t){var s;return t.buffer.push("\r\n      "),s=a.with.call(e,"item",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(9,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),""}function u(e,t){return t.buffer.push("\r\n      <tr>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"quoteId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n      "),""}function h(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(b((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.ok",o):y.call(e,"loc","locale.onlinetill:shift.ok",o)))),t.buffer.push("\r\n        "),""}function d(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(b((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.cancel",o):y.call(e,"loc","locale.onlinetill:shift.cancel",o)))),t.buffer.push("\r\n        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var p,m,f,y=a.helperMissing,b=this.escapeExpression,v=this;return o.buffer.push('<div class="modal-max-size">\r\n  <fieldset>\r\n    <legend>'),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.receiptDetails",f):y.call(t,"loc","locale.onlinetill:shift.receiptDetails",f)))),o.buffer.push("</legend>\r\n    "),p=a.view.call(t,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(1,n,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n    <br/>\r\n    <b>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.details",f):y.call(t,"loc","locale.onlinetill:shift.details",f)))),o.buffer.push(":</b>\r\n    <table "),o.buffer.push(b(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n      <tr>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.transactionNumber",f):y.call(t,"loc","locale.onlinetill:shift.transactionNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.receiptNumber",f):y.call(t,"loc","locale.onlinetill:shift.receiptNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:customer.customerNumber",f):y.call(t,"loc","locale.onlinetill:customer.customerNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.accountNumber",f):y.call(t,"loc","locale.onlinetill:shift.accountNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:quote.quoteNumber",f):y.call(t,"loc","locale.onlinetill:quote.quoteNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:customer.payAmount",f):y.call(t,"loc","locale.onlinetill:customer.payAmount",f)))),o.buffer.push("</th>\r\n      </tr>\r\n      "),p=a.each.call(t,"item","in","data.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(8,c,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push('\r\n    </table>\r\n  </fieldset>\r\n  <table border="0" width="100%">\r\n    <tr>\r\n      <td valign="top">\r\n        <fieldset>\r\n          <legend>'),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:payment.cancellationReason",f):y.call(t,"loc","locale.onlinetill:payment.cancellationReason",f)))),o.buffer.push("</legend>\r\n          "),o.buffer.push(b(a.view.call(t,"Komodo.Controls.Select",{hash:{tabindex:"201",valueBinding:"view.context.data.reason",contentBinding:"view.context.cancelReason",optionLabelPath:"content.value",optionValuePath:"content",label:"~locale.onlinetill:payment.reason~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n        </fieldset>\r\n      </td>\r\n      <td valign="top">\r\n        <fieldset>\r\n          <legend>'),
o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:payment.supervisorApproval",f):y.call(t,"loc","locale.onlinetill:payment.supervisorApproval",f)))),o.buffer.push('</legend>\r\n          <table border="0" width="100%">\r\n            <tr>\r\n              <td>\r\n                  '),o.buffer.push(b(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"202",valueBinding:"view.context.data.supervisorUsername",label:"~locale.onlinetill:payment.supervisorName~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n              </td>\r\n              <td>\r\n                  "),o.buffer.push(b(a.view.call(t,"Komodo.Controls.TextField",{hash:{type:"password",tabindex:"203",valueBinding:"view.context.data.passCode",label:"~locale.onlinetill:payment.passCode~"},hashTypes:{type:"STRING",tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{type:t,tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n              </td>\r\n            </tr>\r\n          </table>\r\n        </fieldset>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td class="text-right" colspan="2">\r\n        '),p=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"ok",disabledBinding:"view.context.data.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:v.noop,fn:v.program(11,h,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n        "),p=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"205",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:v.noop,fn:v.program(13,d,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</div>"),""}),Ember.TEMPLATES.UpdateExchangeRatesView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o,n;return t.buffer.push('\r\n    \x3c!--datagrid start--\x3e\r\n    <table id="quotesGrid" class="table table-bordered komodo-datagrid" width="100%">\r\n        <tr>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.baseCurrencycode",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.baseCurrencycode",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.baseCurrencydescription",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.baseCurrencydescription",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.currencyId",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.currencyId",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.currencyCode",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.currencyCode",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.currencyDescription",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.currencyDescription",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.exchangeRate",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.exchangeRate",n)))),t.buffer.push('</th>\r\n            <th width="12%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.activeDate",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.activeDate",n)))),t.buffer.push('</th>\r\n            <th width="15%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.action",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.action",n)))),t.buffer.push("</th>\r\n        </tr>\r\n        "),s=a.each.call(e,"item","in","updateExchangeRatesModel.updateExchangeRatesInformation",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(2,r,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    </table>\r\n\r\n    \x3c!--datagrid end--\x3e\r\n    "),""}function r(e,t){var s;return t.buffer.push("\r\n        <tr>\r\n            "),s=a.with.call(e,"item",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(3,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            <td>\r\n                "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{contentBinding:"item",action:"selectExchangeRate",size:"xs",type:"success",tabindex:"5"},hashTypes:{contentBinding:"STRING",action:"STRING",size:"STRING",type:"STRING",tabindex:"STRING"},hashContexts:{contentBinding:e,action:e,size:e,type:e,tabindex:e},inverse:C.noop,fn:C.program(5,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{contentBinding:"item",action:"ViewCurrencyExchangeRateHistory",size:"xs",tabindex:"5"},hashTypes:{contentBinding:"STRING",action:"STRING",size:"STRING",tabindex:"STRING"},hashContexts:{contentBinding:e,action:e,size:e,tabindex:e},inverse:C.noop,fn:C.program(7,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            </td>\r\n        </tr>\r\n        "),""}function i(e,t){var s;return t.buffer.push("\r\n            <td>"),s=a._triageMustache.call(e,"item.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.baseCurrencyDescription",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.currencyId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.currencyCode",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.currencyDescription",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n            <td align="right">'),s=a._triageMustache.call(e,"item.exchangeRate",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.activeDate",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            "),""}function l(e,t){var s,o;t.buffer.push(g((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:updateExchangeRate.add",o):v.call(e,"loc","locale.onlinetill:updateExchangeRate.add",o))))}function c(e,t){var s,o;t.buffer.push(g((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:updateExchangeRate.view",o):v.call(e,"loc","locale.onlinetill:updateExchangeRate.view",o))))}function u(e,t){var s;return t.buffer.push('\r\n\r\n    <table width="100%">\r\n        <tr>\r\n            <td>\r\n                '),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:updateExchangeRate.currencyCode~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:updateExchangeRate.currencyDescription~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n\r\n        </tr>\r\n\r\n        <tr>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"updateExchangeRatesInformation.currencyCode"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"updateExchangeRatesInformation.currencyDescription"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td>&nbsp;</td>\r\n            <td>&nbsp;</td>\r\n        </tr>\r\n        <tr>\r\n            <td>"),t.buffer.push(g(a.view.call(e,"Komodo.Controls.TextField",{hash:{valueBinding:"updateExchangeRatesInformation.exchangeRate",tabindex:"3",label:"~locale.onlinetill:updateExchangeRate.exchangeRate~",validatorBinding:"validators.exchangeRateValidator"},hashTypes:{valueBinding:"STRING",tabindex:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{valueBinding:e,tabindex:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</td>\r\n            <td>  "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"4",valueBinding:"updateExchangeRatesInformation.dateActive",label:"~locale.onlinetill:updateExchangeRate.activeDate~",visibleBinding:"",validatorBinding:"validators.dateActiveValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",visibleBinding:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,visibleBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</td>\r\n        </tr>\r\n\r\n    </table>\r\n    <br /><br />\r\n    <div style="float:right;">\r\n        '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"updateExchange",tabindex:"5"},hashTypes:{action:"STRING",tabindex:"STRING"},hashContexts:{action:e,tabindex:e},inverse:C.noop,fn:C.program(10,h,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    </div>\r\n    <br /><br />\r\n    "),""}function h(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(g((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:updateExchangeRate.addExchangeRate",o):v.call(e,"loc","locale.onlinetill:updateExchangeRate.addExchangeRate",o)))),""}function d(e,t){var s,o,n;return t.buffer.push('\r\n    <table width="100%">\r\n        <tr>\r\n            <td>\r\n                '),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:updateExchangeRate.currencyCode~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:updateExchangeRate.currencyDescription~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n\r\n        </tr>\r\n\r\n        <tr>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"updateExchangeRatesInformation.currencyCode"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n                "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"updateExchangeRatesInformation.currencyDescription"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td>&nbsp;</td>\r\n            <td>&nbsp;</td>\r\n        </tr>\r\n        <tr></tr>\r\n\r\n    </table>\r\n    \x3c!--datagrid start--\x3e\r\n    <table id="exchangeRateHistoryGrid" class="table table-bordered komodo-datagrid" width="30%">\r\n        <tr>\r\n            <th width="20%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.exchangeRate",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.exchangeRate",n)))),t.buffer.push('</th>\r\n            <th width="20%">'),t.buffer.push(g((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:updateExchangeRate.activeDate",n):v.call(e,"loc","locale.onlinetill:updateExchangeRate.activeDate",n)))),t.buffer.push("</th>\r\n        </tr>\r\n        "),s=a.each.call(e,"item","in","updateExchangeRatesModel.exchangeRatesHistory",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(13,p,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    </table>\r\n    "),t.buffer.push(g(a.view.call(e,"Komodo.Controls.TablePager",{hash:{tableId:"exchangeRateHistoryGrid",contentBinding:"updateExchangeRatesModel.exchangeRatesHistory",itemsPerPage:"10",headerRows:"1"},hashTypes:{tableId:"STRING",contentBinding:"STRING",itemsPerPage:"STRING",headerRows:"STRING"},hashContexts:{tableId:e,contentBinding:e,itemsPerPage:e,headerRows:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    \x3c!--datagrid end--\x3e\r\n    "),""}function p(e,t){var s;return t.buffer.push("\r\n        <tr>\r\n            "),s=a.with.call(e,"item",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(14,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </tr>\r\n        "),""}function m(e,t){var s;return t.buffer.push('\r\n            <td align="right">'),s=a._triageMustache.call(e,"item.exchangeRate",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            <td>"),s=a._triageMustache.call(e,"item.startDate",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n            "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var f,y,b,v=a.helperMissing,g=this.escapeExpression,C=this;return o.buffer.push('<div class="no-banner-padding">\r\n\r\n    <span class="komodo-heading">'),o.buffer.push(g((y=a.loc||t&&t.loc,b={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},y?y.call(t,"locale.onlinetill:updateExchangeRate.updateExchangeRateTitle",b):v.call(t,"loc","locale.onlinetill:updateExchangeRate.updateExchangeRateTitle",b)))),o.buffer.push('</span>\r\n    <span class="float-right">\r\n        <b>\r\n            <a href="#/cashSalePayment">&lt;'),o.buffer.push(g((y=a.loc||t&&t.loc,b={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},y?y.call(t,"locale.manageaccount:viewAccountInformation.back",b):v.call(t,"loc","locale.manageaccount:viewAccountInformation.back",b)))),o.buffer.push("</a>\r\n        </b>\r\n    </span>\r\n    <hr />\r\n\r\n    "),o.buffer.push(g(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:updateExchangeRate.noexchangerate~",class:"info-heading",visibleBinding:"noexchangeratemsg"},hashTypes:{text:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{text:t,class:t,visibleBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n    "),f=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:updateExchangeRate.currencyInformation~",visibleBinding:"observeProperty"},hashTypes:{title:"STRING",visibleBinding:"STRING"},hashContexts:{title:t,visibleBinding:t},inverse:C.noop,fn:C.program(1,n,o),contexts:[t],types:["ID"],data:o}),(f||0===f)&&o.buffer.push(f),o.buffer.push("\r\n    <div></div>\r\n    "),f=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:updateExchangeRate.exchangeRateInformation~",visibleBinding:"showExchangeRateInfo"},hashTypes:{title:"STRING",visibleBinding:"STRING"},hashContexts:{title:t,visibleBinding:t},inverse:C.noop,fn:C.program(9,u,o),contexts:[t],types:["ID"],data:o}),(f||0===f)&&o.buffer.push(f),o.buffer.push("\r\n\r\n    "),f=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:updateExchangeRate.viewExchangeRateInformation~",visibleBinding:"showExchangeRateHistoryInfo"},hashTypes:{title:"STRING",visibleBinding:"STRING"},hashContexts:{title:t,visibleBinding:t},inverse:C.noop,fn:C.program(12,d,o),contexts:[t],types:["ID"],data:o}),(f||0===f)&&o.buffer.push(f),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.CreditCardView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push('\r\n      <div class="text-center">\r\n        <img src="Content/Images/busy-indicator.svg"/>\r\n        <br/>\r\n        '),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Please follow the instructions on device...",o):u.call(e,"loc","Please follow the instructions on device...",o)))),t.buffer.push("\r\n      </div>\r\n      "),""}function r(e,t){var s,o;return t.buffer.push("\r\n              "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.makePayment",o):u.call(e,"loc","locale.onlinetill:shift.makePayment",o)))),t.buffer.push("\r\n              "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var i,l,c,u=a.helperMissing,h=this.escapeExpression,d=this;return o.buffer.push('<table width="100%">\r\n  <tr>\r\n    <td>\r\n      '),i=a.if.call(t,"data.showBusyIndicator",{hash:{},hashTypes:{},hashContexts:{},inverse:d.noop,fn:d.program(1,n,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      <br/>\r\n      <table>\r\n        <tr>\r\n          <td>\r\n            "),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"Select Device",c):u.call(t,"loc","Select Device",c)))),o.buffer.push("\r\n          </td>\r\n          <td>\r\n            "),o.buffer.push(h(a.view.call(t,"Komodo.Controls.CoreSelect",{hash:{valueBinding:"data.printer",contentBinding:"data.printers",tabindex:"1",selectionBinding:"data.selectedPrinter",optionLabelPath:"content.value",optionValuePath:"content",disableBinding:"data.disablePayment"},hashTypes:{valueBinding:"STRING",contentBinding:"STRING",tabindex:"STRING",selectionBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",disableBinding:"STRING"},hashContexts:{valueBinding:t,contentBinding:t,tabindex:t,selectionBinding:t,optionLabelPath:t,optionValuePath:t,disableBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td colspan="2">\r\n            <div class="text-right">\r\n              '),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"2",action:"makePayment",disableBinding:"data.disablePayment"},hashTypes:{tabindex:"STRING",action:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:t,action:t,disableBinding:t},inverse:d.noop,fn:d.program(3,r,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n            </div>\r\n          </td>\r\n\r\n        </tr>\r\n      </table>\r\n\r\n    </td>\r\n  </tr>\r\n\r\n</table>\r\n"),""}),Ember.TEMPLATES.CustomerDetailsView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push("\r\n      <tr>\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"product.accountNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"product.productId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"product.hardware",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>        \r\n        <td>\r\n          "),s=a._triageMustache.call(e,"product.productType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"product.productName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n    "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var r,i,l,c=a.helperMissing,u=this.escapeExpression,h=this;return o.buffer.push('<div class="modal-max-size">\r\n  <table class="table table-bordered komodo-datagrid" width="100%">\r\n    <tr>\r\n      <td colspan="5">\r\n        '),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.accounts",l):c.call(t,"loc","locale.onlinetill:customer.accounts",l)))),o.buffer.push(" : "),o.buffer.push(u(a.view.call(t,"Komodo.Controls.CoreSelect",{hash:{tabindex:"1",valueBinding:"data.account",contentBinding:"data.accounts",optionLabelPath:"content.displayText",optionValuePath:"content"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING"},hashContexts:{tabindex:t,valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <th class="text-center">'),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.account",l):c.call(t,"loc","locale.onlinetill:customer.account",l)))),o.buffer.push('</th>\r\n      <th class="text-center">'),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.productId",l):c.call(t,"loc","locale.onlinetill:customer.productId",l)))),o.buffer.push('</th>\r\n      <th class="text-center">'),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.hardware",l):c.call(t,"loc","locale.onlinetill:customer.hardware",l)))),o.buffer.push('</th>\r\n      <th class="text-center">'),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.productType",l):c.call(t,"loc","locale.onlinetill:customer.productType",l)))),o.buffer.push('</th>\r\n      <th class="text-center">'),o.buffer.push(u((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:customer.productName",l):c.call(t,"loc","locale.onlinetill:customer.productName",l)))),o.buffer.push("</th>\r\n    </tr>     \r\n    "),r=a.each.call(t,"product","in","data.account.products",{hash:{},hashTypes:{},hashContexts:{},inverse:h.noop,fn:h.program(1,n,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(r||0===r)&&o.buffer.push(r),o.buffer.push("\r\n  </table>\r\n</div>\r\n"),""}),Ember.TEMPLATES.CustomerPaymentView=Ember.Handlebars.template(function(e,t,a,s,o){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var n=this.escapeExpression;return o.buffer.push("<div>\r\n  "),o.buffer.push(n(a.view.call(t,"Komodo.Application.PaymentView",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.EmailReceiptConfirmView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){return t.buffer.push('\r\n      <tr>\r\n        <td align="center">\r\n         '),t.buffer.push(c(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.or~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td>\r\n          "),t.buffer.push(c(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"202",valueBinding:"data.selectedEmail",optionLabelPath:"content.Value",optionValuePath:"content.Value",contentBinding:"data.email",label:"~locale.onlinetill:report.email~",prompt:"~locale.onlinetill:report.emailPrompt~",validatorBinding:"validators.selectedEmailValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",contentBinding:"STRING",label:"STRING",prompt:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,optionLabelPath:e,optionValuePath:e,contentBinding:e,label:e,prompt:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n      "),""}function r(e,t){var s,o;return t.buffer.push("\r\n          "),t.buffer.push(c((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:report.ok",o):u.call(e,"loc","locale.onlinetill:report.ok",o)))),t.buffer.push("\r\n          "),""}function i(e,t){var s,o;return t.buffer.push("\r\n          "),t.buffer.push(c((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:report.cancel",o):u.call(e,"loc","locale.onlinetill:report.cancel",o)))),t.buffer.push("\r\n          "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var l,c=this.escapeExpression,u=a.helperMissing,h=this;return o.buffer.push('<div class="modal-max-size">\r\n  <div style="width:250px;overflow-x: auto; overflow-y: auto;">\r\n    <table border="0" width="100%">\r\n      <tr>\r\n        <td>\r\n          '),o.buffer.push(c(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"201",valueBinding:"data.selectedEmail",label:"~locale.onlinetill:report.enterEmail~",validatorBinding:"validators.selectedEmailValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t,validatorBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n        </td>\r\n      </tr>\r\n      "),l=a.if.call(t,"data.displayEmailSelectList",{hash:{},hashTypes:{},hashContexts:{},inverse:h.noop,fn:h.program(1,n,o),contexts:[t],types:["ID"],data:o}),(l||0===l)&&o.buffer.push(l),o.buffer.push('\r\n      <tr>\r\n        <td align="right">\r\n          '),l=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"emailReceipt",disabledBinding:"view.context.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:h.noop,fn:h.program(3,r,o),contexts:[t],types:["ID"],data:o}),(l||0===l)&&o.buffer.push(l),o.buffer.push("\r\n          "),l=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:h.noop,fn:h.program(5,i,o),contexts:[t],types:["ID"],data:o}),(l||0===l)&&o.buffer.push(l),o.buffer.push("\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  </div>\r\n</div>"),""}),Ember.TEMPLATES.OfflinePaymentSyncingView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push('\r\n      <div class="text-center">\r\n        <img src="Content/Images/busy-indicator.svg"/>\r\n        <br/>\r\n        '),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Syncing...",o):d.call(e,"loc","Syncing...",o)))),t.buffer.push("\r\n      </div>\r\n      "),""}function r(e,t){return t.buffer.push("\r\n          <tr>\r\n            <td>\r\n              "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.accountType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentDate"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.isCancelled"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n            </td>\r\n            <td class="text-right">\r\n              '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.payAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n            </td>\r\n            <td class="text-center">\r\n              '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.Link",{hash:{textBinding:"row.syncStatus",action:"paymentSyncStatus"},hashTypes:{textBinding:"STRING",action:"STRING"},hashContexts:{textBinding:e,action:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("              \r\n            </td>           \r\n          </tr>\r\n          "),""}function i(e,t){var s,o;return t.buffer.push("\r\n      "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Start Syncing",o):d.call(e,"loc","Start Syncing",o)))),t.buffer.push("\r\n      "),""}function l(e,t){var s,o
;return t.buffer.push("\r\n      "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Close",o):d.call(e,"loc","Close",o)))),t.buffer.push("\r\n      "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var c,u,h,d=a.helperMissing,p=this.escapeExpression,m=this;return o.buffer.push('<table width="100%">\r\n  <tr>\r\n    <td>\r\n      '),c=a.if.call(t,"data.disableClose",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(1,n,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push('\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      <br/>\r\n      <table id="tblOfflinePayments" '),o.buffer.push(p(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n        <thead>\r\n          <tr>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:customer.customerNumber",h):d.call(t,"loc","locale.onlinetill:customer.customerNumber",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:customer.accountType",h):d.call(t,"loc","locale.onlinetill:customer.accountType",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:payment.paymentType",h):d.call(t,"loc","locale.onlinetill:payment.paymentType",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:shift.date",h):d.call(t,"loc","locale.onlinetill:shift.date",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:shift.isCancelled",h):d.call(t,"loc","locale.onlinetill:shift.isCancelled",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:customer.payAmount",h):d.call(t,"loc","locale.onlinetill:customer.payAmount",h)))),o.buffer.push("</th>\r\n            <th>"),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:payment.syncStatus",h):d.call(t,"loc","locale.onlinetill:payment.syncStatus",h)))),o.buffer.push("</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          "),c=a.each.call(t,"row","in","data.payments",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(3,r,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push('\r\n        </tbody>\r\n      </table>\r\n      <div align="left">\r\n        '),o.buffer.push(p(a.view.call(t,"Komodo.Controls.TablePager",{hash:{tableId:"tblOfflinePayments",contentBinding:"data.payments",itemsPerPage:"5",headerRows:"1",visiblePageCount:"5"},hashTypes:{tableId:"STRING",contentBinding:"STRING",itemsPerPage:"STRING",headerRows:"STRING",visiblePageCount:"STRING"},hashContexts:{tableId:t,contentBinding:t,itemsPerPage:t,headerRows:t,visiblePageCount:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </div>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td align="right">\r\n      '),c=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"startSyncing",disabledBinding:"data.disableSync"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:m.noop,fn:m.program(5,i,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n      "),c=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"close",disabledBinding:"data.disableClose"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:m.noop,fn:m.program(7,l,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n    </td>\r\n  </tr>\r\n</table>\r\n"),""}),Ember.TEMPLATES.PaymentOverrideView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push("\r\n      "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.ok",o):u.call(e,"loc","locale.onlinetill:shift.ok",o)))),t.buffer.push("\r\n      "),""}function r(e,t){var s,o;return t.buffer.push("\r\n      "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.cancel",o):u.call(e,"loc","locale.onlinetill:shift.cancel",o)))),t.buffer.push("\r\n      "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var i,l,c,u=a.helperMissing,h=this.escapeExpression,d=this;return o.buffer.push('<table border="0" cellSpacing="2" cellPadding="2" width="100%">\r\n  <tr>\r\n    <td>\r\n      '),i=a._triageMustache.call(t,"data.message",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push('\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      <br/>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td>\r\n      <table border="0" cellSpacing="5" cellPadding="5" width="100%">\r\n        <tr>\r\n          <td valign="top">\r\n            <fieldset>\r\n              <legend>'),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"locale.onlinetill:payment.supervisorApproval",c):u.call(t,"loc","locale.onlinetill:payment.supervisorApproval",c)))),o.buffer.push('</legend>\r\n              <table border="0" cellSpacing="5" cellPadding="5" width="100%">\r\n                <tr>\r\n                  <td>\r\n                    '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"201",valueBinding:"view.context.data.supervisorUsername",label:"~locale.onlinetill:payment.supervisorName~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n                  </td>\r\n                  <td>\r\n                    "),o.buffer.push(h(a.view.call(t,"Komodo.Controls.TextField",{hash:{type:"password",tabindex:"202",valueBinding:"view.context.data.passCode",label:"~locale.onlinetill:payment.passCode~"},hashTypes:{type:"STRING",tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{type:t,tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </fieldset>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td align="right">\r\n      '),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"ok",disabledBinding:"view.context.data.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:d.noop,fn:d.program(1,n,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n      "),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:d.noop,fn:d.program(3,r,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n    </td>\r\n  </tr>\r\n</table>"),""}),Ember.TEMPLATES.PaymentReportView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push('\r\n  <table width="100%">\r\n    <tr>\r\n      <td width="50%">\r\n        '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"1",valueBinding:"data.report",contentBinding:"data.reports",optionLabelPath:"content",optionValuePath:"content",label:"~locale.onlinetill:shift.report~",validatorBinding:"validators.reportValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n      <td width="50%">\r\n        '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"2",valueBinding:"data.shiftStatus",contentBinding:"data.shiftStatuses",optionLabelPath:"content.value",optionValuePath:"content",label:"~locale.onlinetill:shift.shiftStatus~",validatorBinding:"validators.shiftStatusValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"2",valueBinding:"data.shiftId",label:"~locale.onlinetill:shift.shiftNumber~",validatorBinding:"validators.shiftIdValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"3",valueBinding:"data.cashierName",label:"~locale.onlinetill:shift.cashierName~",validatorBinding:"validators.cashierNameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"4",valueBinding:"data.bdNumber",label:"~locale.onlinetill:shift.bankDepositNumber~",validatorBinding:"validators.bdNumberValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td>\r\n        "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"4",valueBinding:"data.startDate",label:"~locale.onlinetill:shift.startDate~",validatorBinding:"validators.startDateValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td colspan="2">\r\n        '),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"5",valueBinding:"data.endDate",label:"~locale.onlinetill:shift.endDate~",validatorBinding:"validators.endDateValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td align="right" colspan="2">\r\n        '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"6",action:"searchReport"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:e,action:e},inverse:m.noop,fn:m.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        &nbsp;\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"7",action:"clearReport",type:"inverse"},hashTypes:{tabindex:"STRING",action:"STRING",type:"STRING"},hashContexts:{tabindex:e,action:e,type:e},inverse:m.noop,fn:m.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  "),""}function r(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:report.searchReportButton",o):d.call(e,"loc","locale.onlinetill:report.searchReportButton",o)))),t.buffer.push("\r\n        "),""}function i(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(p((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.clear",o):d.call(e,"loc","locale.onlinetill:customer.clear",o)))),t.buffer.push("\r\n        "),""}function l(e,t){return t.buffer.push("\r\n  "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.searchResult~",visibleBinding:"data.isMessageVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(p(a.view.call(e,"Komodo.Controls.DataGrid",{hash:{tabindex:"8",canSort:!0,pageSize:10,performsValidation:!0,canDelete:!1,canEdit:!1,canSelect:!1,selectedItemBinding:"data.selectedGridItem",commandItemBinding:"data.commandGridItem",commandItemTypeBinding:"data.commandGridItemType",contentBinding:"data.shiftData",columnsBinding:"gridColumns",visibleBinding:"data.isGridVisible"},hashTypes:{tabindex:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING",visibleBinding:"STRING"},hashContexts:{tabindex:e,canSort:e,pageSize:e,performsValidation:e,canDelete:e,canEdit:e,canSelect:e,selectedItemBinding:e,commandItemBinding:e,commandItemTypeBinding:e,contentBinding:e,columnsBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var c,u,h,d=a.helperMissing,p=this.escapeExpression,m=this;return o.buffer.push('<div class="no-banner-padding">\r\n  <table width="100%">\r\n    <tr>\r\n      <td>\r\n        <p class="komodo-heading">'),o.buffer.push(p((u=a.loc||t&&t.loc,h={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},u?u.call(t,"locale.onlinetill:home.useCaseReportTitle",h):d.call(t,"loc","locale.onlinetill:home.useCaseReportTitle",h)))),o.buffer.push('</p>\r\n      </td>\r\n      <td align="right">\r\n        '),o.buffer.push(p(a.view.call(t,"Komodo.Controls.Link",{hash:{tabindex:"18",text:"~locale.onlinetill:home.back~",href:"#/home"},hashTypes:{tabindex:"STRING",text:"STRING",href:"STRING"},hashContexts:{tabindex:t,text:t,href:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <hr />\r\n  "),c=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:report.searchReport~"},hashTypes:{title:"STRING"},hashContexts:{title:t},inverse:m.noop,fn:m.program(1,n,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n  "),c=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:report.reportList~",visibleBinding:"showResultView"},hashTypes:{title:"STRING",visibleBinding:"STRING"},hashContexts:{title:t,visibleBinding:t},inverse:m.noop,fn:m.program(6,l,o),contexts:[t],types:["ID"],data:o}),(c||0===c)&&o.buffer.push(c),o.buffer.push("\r\n</div>"),""}),Ember.TEMPLATES.PaymentView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:E.noop,fn:E.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    <br/>\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:E.noop,fn:E.program(14,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function r(e,t){var s;return t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top full-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:E.noop,fn:E.program(3,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function i(e,t){var s;return t.buffer.push("\r\n        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{placeholderBinding:"data.searchTextPlaceholder",valueBinding:"data.quoteId",visibleBinding:"data.isCashSalePayment",tabindex:"2"},hashTypes:{placeholderBinding:"STRING",valueBinding:"STRING",visibleBinding:"STRING",tabindex:"STRING"},hashContexts:{placeholderBinding:e,valueBinding:e,visibleBinding:e,tabindex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"3",action:"retrieveQuote",visibleBinding:"data.isCashSalePayment",size:"nextto-control",type:"success"},hashTypes:{tabindex:"STRING",action:"STRING",visibleBinding:"STRING",size:"STRING",type:"STRING"},hashContexts:{tabindex:e,action:e,visibleBinding:e,size:e,type:e},inverse:E.noop,fn:E.program(4,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),s=a.if.call(e,"hide",{hash:{},hashTypes:{},hashContexts:{},inverse:E.noop,fn:E.program(6,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),s=a.if.call(e,"data.isOffLine",{hash:{},hashTypes:{},hashContexts:{},inverse:E.program(11,d,t),fn:E.program(9,h,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function l(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:quote.retrieveQuote",o):P.call(e,"loc","locale.onlinetill:quote.retrieveQuote",o)))),t.buffer.push("\r\n        "),""}function c(e,t){var s;return t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"4",action:"retrieveQuoteHardware",visibleBinding:"data.isCashSalePayment",size:"nextto-control",type:"success"},hashTypes:{tabindex:"STRING",action:"STRING",visibleBinding:"STRING",size:"STRING",type:"STRING"},hashContexts:{tabindex:e,action:e,visibleBinding:e,size:e,type:e},inverse:E.noop,fn:E.program(7,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),""}function u(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:quote.retrieveHardware",o):P.call(e,"loc","locale.onlinetill:quote.retrieveHardware",o)))),t.buffer.push("\r\n        "),""}function h(e,t){return t.buffer.push("\r\n        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{valueBinding:"data.customerNumber",visibleBinding:"data.isOffLine",tabindex:"5",label:"~locale.onlinetill:customer.customerNumber~"},hashTypes:{valueBinding:"STRING",visibleBinding:"STRING",tabindex:"STRING",label:"STRING"},hashContexts:{valueBinding:e,visibleBinding:e,tabindex:e,label:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),""}function d(e,t){var s;return t.buffer.push("\r\n        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{placeholderBinding:"data.searchTextPlaceholder",valueBinding:"data.searchText",visibleBinding:"data.isCustomerPayment",tabindex:"6"},hashTypes:{placeholderBinding:"STRING",valueBinding:"STRING",visibleBinding:"STRING",tabindex:"STRING"},hashContexts:{placeholderBinding:e,valueBinding:e,visibleBinding:e,tabindex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"7",action:"addCustomer",visibleBinding:"data.isCustomerPayment",size:"nextto-control",type:"success"},hashTypes:{tabindex:"STRING",action:"STRING",visibleBinding:"STRING",size:"STRING",type:"STRING"},hashContexts:{tabindex:e,action:e,visibleBinding:e,size:e,type:e},inverse:E.noop,fn:E.program(12,p,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),""}function p(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.addCustomer",o):P.call(e,"loc","locale.onlinetill:customer.addCustomer",o)))),t.buffer.push("\r\n        "),""}function m(e,t){var s;return t.buffer.push("\r\n    \x3c!--Column 1--\x3e\r\n  "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:E.noop,fn:E.program(15,f,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n  \x3c!--Column 2--\x3e\r\n  "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:E.noop,fn:E.program(17,y,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function f(e,t){return t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"8",valueBinding:"data.methodOfPayment",contentBinding:"data.methodOfPayments",optionLabelPath:"content",optionValuePath:"content",label:"~locale.onlinetill:payment.methodOfPayment~",validatorBinding:"validators.methodOfPaymentValidator",disableBinding:"data.refundPayment"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING",validatorBinding:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,label:e,validatorBinding:e,disableBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"10",valueBinding:"data.paymentAmount",labelBinding:"labelPaymentAmount",label:"~locale.onlinetill:payment.paymentAmount~",validatorBinding:"validators.paymentAmountValidator",disabledBinding:"data.refundPayment"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",labelBinding:"STRING",label:"STRING",validatorBinding:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,labelBinding:e,label:e,validatorBinding:e,disabledBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"12",valueBinding:"data.baseAmount",labelBinding:"labelBaseAmount",label:"~locale.onlinetill:quote.baseAmount~",disabled:"true"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",labelBinding:"STRING",label:"STRING",disabled:"STRING"},hashContexts:{tabindex:e,valueBinding:e,labelBinding:e,label:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"8",valueBinding:"data.drawerName",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.drawerName~",validatorBinding:"validators.drawerNameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"14",valueBinding:"data.cardType",contentBinding:"data.methodOfPaymentSubs",optionLabelPath:"content.key",optionValuePath:"content",visibleBinding:"data.isCardPaymentVisible",disabledBinding:"data.useIntegratedCardPayment",label:"~locale.onlinetill:payment.cardType~",validationBinding:"validators.cardTypeValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",visibleBinding:"STRING",disabledBinding:"STRING",label:"STRING",validationBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,visibleBinding:e,disabledBinding:e,label:e,validationBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.DatePicker",{hash:{tabindex:"17",valueBinding:"data.chequeDate",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.chequeDate~",validatorBinding:"validators.chequeDateValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"19",valueBinding:"data.chequeBranch",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.chequeBranch~",validatorBinding:"validators.chequeBranchValidator",contentBinding:"bankBranches",optionLabelPath:"content.CanonicalValue",optionValuePath:"content",prompt:"~locale.onlinetill:payment.branchNamePrompt~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",prompt:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,prompt:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"21",valueBinding:"data.cardNumber",visibleBinding:"data.isCardPaymentVisible",label:"~locale.onlinetill:payment.cardNumberLastFourDigit~",validatorBinding:"validators.cardNumberValidator",disabledBinding:"data.useIntegratedCardPayment"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e,disabledBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function y(e,t){return t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"9",valueBinding:"data.currency",contentBinding:"data.allowedCurrencies",optionLabelPath:"content.value",optionValuePath:"content",label:"~locale.onlinetill:shift.currency~",validatorBinding:"validators.currencyValidator",disabledBinding:"data.disableCurrency"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING",validatorBinding:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,label:e,validatorBinding:e,disabledBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"11",valueBinding:"data.amountTendered",labelBinding:"labelAmountTendered",label:"~locale.onlinetill:payment.amountTendered~",validatorBinding:"validators.amountTenderedValidator",disabledBinding:"data.disableAmountTendered"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",labelBinding:"STRING",label:"STRING",validatorBinding:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,labelBinding:e,label:e,validatorBinding:e,disabledBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"13",valueBinding:"data.changeOwed",labelBinding:"labelChangeOwed",label:"~locale.onlinetill:payment.changeOwed~",disabled:"true"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",labelBinding:"STRING",label:"STRING",disabled:"STRING"},hashContexts:{tabindex:e,valueBinding:e,labelBinding:e,label:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"15",valueBinding:"data.chequeNumber",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.chequeNumber~",validatorBinding:"validators.chequeNumberValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"16",valueBinding:"data.cardHolder",visibleBinding:"data.isCardPaymentVisible",label:"~locale.onlinetill:payment.cardHolder~",validatorBinding:"validators.cardHolderValidator",disabledBinding:"data.useIntegratedCardPayment"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e,disabledBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.Select",{hash:{tabindex:"18",valueBinding:"data.chequeBank",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.chequeBank~",validatorBinding:"validators.chequeBankValidator",contentBinding:"banks",optionLabelPath:"content.CanonicalValue",optionValuePath:"content",prompt:"~locale.onlinetill:payment.bankPrompt~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",prompt:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,prompt:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  \x3c!--"),t.buffer.push(w(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"20",valueBinding:"data.chequeBranchCode",visibleBinding:"data.isChequePaymentVisible",label:"~locale.onlinetill:payment.chequeBranchCode~",validatorBinding:"validators.chequeBranchCodeValidator",disabled:"true"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",visibleBinding:"STRING",label:"STRING",validatorBinding:"STRING",disabled:"STRING"},hashContexts:{tabindex:e,valueBinding:e,visibleBinding:e,label:e,validatorBinding:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("--\x3e\r\n    "),""}function b(e,t){var s;return t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:E.noop,fn:E.program(20,v,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),""}function v(e,t){var s
;return t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top full-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:E.noop,fn:E.program(21,g,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),""}function g(e,t){var s,o,n;return t.buffer.push("\r\n        <div "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:"showAmountSpan:komodo-hidden"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(' style="float: left;">\r\n        <b>   \r\n            '),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"labelAmountCaptured",text:"~locale.onlinetill:shift.amountCaptured~",visibleBinding:"data.isSplitPayment"},hashTypes:{textBinding:"STRING",text:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:":",visibleBinding:"data.isSplitPayment"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.amountCaptured",visibleBinding:"data.isSplitPayment"},hashTypes:{textBinding:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            &nbsp;&nbsp;\r\n            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"labelAmountLeft",text:"~locale.onlinetill:shift.amountLeft~",visibleBinding:"data.isSplitPayment"},hashTypes:{textBinding:"STRING",text:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:":",visibleBinding:"data.isSplitPayment"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.amountLeft",visibleBinding:"data.isSplitPayment"},hashTypes:{textBinding:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n         </b>\r\n        </div>\r\n        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.DataGrid",{hash:{tabindex:"21",canSort:!0,pageSize:10,performsValidation:!0,canDelete:!1,canEdit:!1,canSelect:!1,selectedItemBinding:"data.selectedGridItem",commandItemBinding:"data.commandGridItem",commandItemTypeBinding:"data.commandGridItemType",contentBinding:"data.quoteGridData",columnsBinding:"quoteGridColumns",visibleBinding:"data.showQuoteGrid"},hashTypes:{tabindex:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING",visibleBinding:"STRING"},hashContexts:{tabindex:e,canSort:e,pageSize:e,performsValidation:e,canDelete:e,canEdit:e,canSelect:e,selectedItemBinding:e,commandItemBinding:e,commandItemTypeBinding:e,contentBinding:e,columnsBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n        <div class="float-right">\r\n            <b>\r\n                '),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~",visibleBinding:"data.showQuoteInformation"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:":",visibleBinding:"data.showQuoteInformation"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.quoteAmount",visibleBinding:"data.showQuoteInformation"},hashTypes:{textBinding:"STRING",visibleBinding:"STRING"},hashContexts:{textBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            </b>\r\n        </div>\r\n        <div "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:"showCustomerGrid:komodo-hidden:table-responsive"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n            <table "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push('>\r\n                <thead>\r\n                    <tr>\r\n                        <th width="15%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.customerNumber",n):P.call(e,"loc","locale.onlinetill:customer.customerNumber",n)))),t.buffer.push('</th>\r\n                        <th width="25%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.customerName",n):P.call(e,"loc","locale.onlinetill:customer.customerName",n)))),t.buffer.push('</th>\r\n                        <th width="15%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.accounts",n):P.call(e,"loc","locale.onlinetill:customer.accounts",n)))),t.buffer.push('</th>\r\n                        <th width="10%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.payAmount",n):P.call(e,"loc","locale.onlinetill:customer.payAmount",n)))),t.buffer.push('</th>\r\n                        <th width="15%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.quoteDetails",n):P.call(e,"loc","locale.onlinetill:customer.quoteDetails",n)))),t.buffer.push('</th>\r\n                        <th width="10%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.products",n):P.call(e,"loc","locale.onlinetill:customer.products",n)))),t.buffer.push('</th>\r\n                        <th width="10%">'),t.buffer.push(w((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.action",n):P.call(e,"loc","locale.onlinetill:customer.action",n)))),t.buffer.push("</th>\r\n                    </tr>\r\n                </thead>\r\n                "),s=a.each.call(e,"row","in","data.gridData",{hash:{},hashTypes:{},hashContexts:{},inverse:E.noop,fn:E.program(22,C,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            </table>\r\n        </div>\r\n        <div "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:"showBatchSpan:komodo-hidden"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push('>\r\n            <table>\r\n                <tr>\r\n                    <td valign="top">\r\n                        '),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.batchUpload~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("&nbsp;\r\n                    </td>\r\n                    <td>\r\n                        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.FileReader",{hash:{action:"readTextFile",id:"fileReaderControl",tabindex:"27"},hashTypes:{action:"STRING",id:"STRING",tabindex:"STRING"},hashContexts:{action:e,id:e,tabindex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                    </td>                      \r\n                </tr>                  \r\n            </table>\r\n        </div>\r\n        <br />\r\n        <div "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:"isAutoReconnectVisible:komodo-hidden"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n            <table>\r\n                <tr>\r\n                    <td>\r\n                        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.autoReconnectProducts~",visibleBinding:"data.isAutoReconnectVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:":",visibleBinding:"data.isAutoReconnectVisible"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{tabindex:"28",checkedBinding:"data.autoReconnectProducts",visibleBinding:"data.isAutoReconnectVisible",disableBinding:"data.disableReconnectProducts"},hashTypes:{tabindex:"STRING",checkedBinding:"STRING",visibleBinding:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:e,checkedBinding:e,visibleBinding:e,disableBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        "),""}function C(e,t){var s;return t.buffer.push("\r\n                <tbody>\r\n                    <tr>\r\n                        <td>\r\n                            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),s=a._triageMustache.call(e,"row.customerName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </td>\r\n                        <td "),t.buffer.push(w(a["bind-attr"].call(e,{hash:{class:"row.multiAccount:otp-accounts"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n                            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{valueBinding:"row.account",contentBinding:"row.accounts",optionLabelPath:"content.displayText",optionValuePath:"content",tabindex:"22",class:"komodo-grid-edit"},hashTypes:{valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",tabindex:"STRING",class:"STRING"},hashContexts:{valueBinding:e,contentBinding:e,optionLabelPath:e,optionValuePath:e,tabindex:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),s=a._triageMustache.call(e,"row.accountCount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),t.buffer.push(w(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{valueBinding:"row.payAmount",class:"input-table",tabindex:"23",disableBinding:"showAmountSpan"},hashTypes:{valueBinding:"STRING",class:"STRING",tabindex:"STRING",disableBinding:"STRING"},hashContexts:{valueBinding:e,class:e,tabindex:e,disableBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),s=a.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"row",action:"viewQuoteDetails"},hashTypes:{contentBinding:"STRING",action:"STRING"},hashContexts:{contentBinding:e,action:e},inverse:E.noop,fn:E.program(23,x,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"viewProductDetails",size:"xs",tabindex:"25"},hashTypes:{action:"STRING",size:"STRING",tabindex:"STRING"},hashContexts:{action:e,size:e,tabindex:e},inverse:E.noop,fn:E.program(26,T,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"removeCustomer",size:"xs",type:"danger",tabindex:"26"},hashTypes:{action:"STRING",size:"STRING",type:"STRING",tabindex:"STRING"},hashContexts:{action:e,size:e,type:e,tabindex:e},inverse:E.noop,fn:E.program(28,I,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n                "),""}function x(e,t){var s;return t.buffer.push("\r\n                            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{size:"xs",tabindex:"24",disableBinding:"row.disableQuoteDetails"},hashTypes:{size:"STRING",tabindex:"STRING",disableBinding:"STRING"},hashContexts:{size:e,tabindex:e,disableBinding:e},inverse:E.noop,fn:E.program(24,S,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),""}function S(e,t){var s,o;return t.buffer.push("\r\n                            "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.quoteDetails",o):P.call(e,"loc","locale.onlinetill:customer.quoteDetails",o)))),t.buffer.push("\r\n                            "),""}function T(e,t){var s,o;return t.buffer.push("\r\n                            "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.products",o):P.call(e,"loc","locale.onlinetill:customer.products",o)))),t.buffer.push("\r\n                            "),""}function I(e,t){var s,o;return t.buffer.push("\r\n                            "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.delete",o):P.call(e,"loc","locale.onlinetill:customer.delete",o)))),t.buffer.push("\r\n                            "),""}function R(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.customerprofile.customerprofile:amountPayable.useAvailableCredit",o):P.call(e,"loc","locale.customerprofile.customerprofile:amountPayable.useAvailableCredit",o)))),t.buffer.push("\r\n        "),""}function N(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:home.subTitleRefundPayment",o):P.call(e,"loc","locale.onlinetill:home.subTitleRefundPayment",o)))),t.buffer.push("\r\n        "),""}function D(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(w((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.makePayment",o):P.call(e,"loc","locale.onlinetill:shift.makePayment",o)))),t.buffer.push("\r\n        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var B,P=a.helperMissing,w=this.escapeExpression,E=this;return o.buffer.push('<div id="komodo-shift-page" class="no-banner-padding">\r\n    <table width="100%">\r\n        <tr>\r\n            <td>\r\n                <p class="komodo-heading">'),B=a._triageMustache.call(t,"data.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push('</p>\r\n            </td>\r\n            <td align="right">\r\n                '),o.buffer.push(w(a.view.call(t,"Komodo.Controls.Link",{hash:{tabindex:"28",text:"~locale.onlinetill:home.back~",href:"#/home"},hashTypes:{tabindex:"STRING",text:"STRING",href:"STRING"},hashContexts:{tabindex:t,text:t,href:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n            </td>\r\n        </tr>\r\n    </table>\r\n    <hr />\r\n    "),B=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.onlinetill:customer.paymentDetails~",isCollapsed:!1},hashTypes:{title:"STRING",isCollapsed:"BOOLEAN"},hashContexts:{title:t,isCollapsed:t},inverse:E.noop,fn:E.program(1,n,o),contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push("\r\n    <div "),o.buffer.push(w(a["bind-attr"].call(t,{hash:{class:"data.isOffLine:komodo-hidden"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n        "),B=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{titleBinding:"data.paymentType",isCollapsed:!1},hashTypes:{titleBinding:"STRING",isCollapsed:"BOOLEAN"},hashContexts:{titleBinding:t,isCollapsed:t},inverse:E.noop,fn:E.program(19,b,o),contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push('\r\n    </div>\r\n    <br />\r\n    <div class="float-right">\r\n        '),B=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"29",action:"useCredit",visibleBinding:"data.isCommercialCustomer"},hashTypes:{tabindex:"STRING",action:"STRING",visibleBinding:"STRING"},hashContexts:{tabindex:t,action:t,visibleBinding:t},inverse:E.noop,fn:E.program(30,R,o),contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push("\r\n        "),B=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"29",action:"refundPayment",visibleBinding:"data.refundPayment"},hashTypes:{tabindex:"STRING",action:"STRING",visibleBinding:"STRING"},hashContexts:{tabindex:t,action:t,visibleBinding:t},inverse:E.noop,fn:E.program(32,N,o),contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push("\r\n        "),B=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"30",action:"makePayment",disableBinding:"data.enableMakePayment"},hashTypes:{tabindex:"STRING",action:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:t,action:t,disableBinding:t},inverse:E.noop,fn:E.program(34,D,o),contexts:[t],types:["ID"],data:o}),(B||0===B)&&o.buffer.push(B),o.buffer.push("\r\n    </div>\r\n</div>\r\n"),""}),Ember.TEMPLATES.PrintReceiptView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push('\r\n        <td>\r\n          <div class="print-button">\r\n            <a '),t.buffer.push(c(a.action.call(e,"emailReceiptconfirm",{hash:{target:"view.context"},hashTypes:{target:"STRING"},hashContexts:{target:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('>\r\n              <img name="email_01" alt="email" src="./Content/Images/report_email.gif" style="border:0px; padding-right:5px; width: 25px; height: 20px;" />'),t.buffer.push(c((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:report.email",o):u.call(e,"loc","locale.onlinetill:report.email",o)))),t.buffer.push("\r\n            </a>\r\n          </div>\r\n        </td>\r\n        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var r,i,l,c=this.escapeExpression,u=a.helperMissing,h=this;return o.buffer.push('<div>\r\n  <div>\r\n    <table>\r\n      <tr>\r\n        <td>\r\n          <div class="print-button">\r\n            '),o.buffer.push(c(a.view.call(t,"Komodo.Controls.CoreSelect",{hash:{valueBinding:"data.printer",contentBinding:"data.printers",selectionBinding:"data.selectedPrinter",tabindex:"1",optionLabelPath:"content.value",optionValuePath:"content"},hashTypes:{valueBinding:"STRING",contentBinding:"STRING",selectionBinding:"STRING",tabindex:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING"},hashContexts:{valueBinding:t,contentBinding:t,selectionBinding:t,tabindex:t,optionLabelPath:t,optionValuePath:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n            <a "),o.buffer.push(c(a.action.call(t,"printReceipt",{hash:{target:"view.context"},hashTypes:{target:"STRING"},hashContexts:{target:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('>\r\n              <img name="print_01" alt="print" src="./Content/Images/report_print.gif" style="border:0px; padding-right:5px; width: 25px; height: 20px;" />'),o.buffer.push(c((i=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},i?i.call(t,"locale.onlinetill:report.print",l):u.call(t,"loc","locale.onlinetill:report.print",l)))),o.buffer.push("\r\n            </a>\r\n          </div>\r\n        </td>\r\n        "),r=a.if.call(t,"data.displayEmailReceiptOption",{hash:{},hashTypes:{},hashContexts:{},inverse:h.noop,fn:h.program(1,n,o),contexts:[t],types:["ID"],data:o}),(r||0===r)&&o.buffer.push(r),o.buffer.push('\r\n      </tr>\r\n    </table>\r\n  </div>\r\n  <div style="display: none" id="print">\r\n  </div>\r\n  <div class="receipt" id="printPreview">\r\n  </div>\r\n</div>'),""}),Ember.TEMPLATES.QuoteDetailsView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){t.buffer.push('\r\n        <th width="5%" style="text-align:center;">Invoice Number</th>\r\n        <th width="5%" style="text-align:center;">Is Disputed Invoice</th>\r\n        ')}function r(e,t){t.buffer.push('\r\n        <th width="5%" colspan="2" style="text-align:center;">Quote Number</th>\r\n        ')}function i(e,t){t.buffer.push('\r\n          <th width="40%" style="text-align:center">Description</th>\r\n          ')}function l(e,t){t.buffer.push('\r\n          <th width="50%" style="text-align:center">Description</th>\r\n          ')}function c(e,t){t.buffer.push('\r\n        <th width="5%" style="text-align:center;">No. of Units</th>\r\n        ')}function u(e,t){var s;return t.buffer.push("\r\n      "),s=a.each.call(e,"lineItem","in","item.quoteLineItems",{hash:{},hashTypes:{},hashContexts:{},inverse:R.noop,fn:R.program(12,h,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),""}function h(e,t){var s;return t.buffer.push("\r\n      <tr>\r\n        "),s=a.if.call(e,"lineItem.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:R.program(18,f,t),fn:R.program(13,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"lineItem.invoiceText",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),s=a._triageMustache.call(e,"lineItem.period",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        "),s=a.if.call(e,"data.customer.isCommercialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:R.noop,fn:R.program(20,y,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        "),s=a.if.call(e,"lineItem.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:R.program(25,g,t),fn:R.program(22,b,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      </tr>\r\n      "),""}function d(e,t){var s;return t.buffer.push("\r\n        "),s=a.if.call(e,"data.customer.isCommercialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:R.program(16,m,t),fn:R.program(14,p,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('        \r\n        <td style="border-bottom: none">\r\n          '),s=a._triageMustache.call(e,"item.quoteDateTime",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        "),""}function p(e,t){var s;return t.buffer.push('\r\n          <td style="border-bottom: none">\r\n            '),s=a._triageMustache.call(e,"item.quoteId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n          </td>\r\n          <td style="text-align:center;border-bottom: none">\r\n            '),s=a._triageMustache.call(e,"item.srqStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n          </td>\r\n        "),""}function m(e,t){var s;return t.buffer.push('\r\n          <td colspan="2" style="border-bottom: none">              \r\n            '),s=a._triageMustache.call(e,"item.quoteId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n          </td>\r\n        "),""}function f(e,t){t.buffer.push('\r\n        <td style="border:none;"></td>\r\n          <td style="border:none;"></td>\r\n          <td style="border-top:none;border-bottom:none;"></td>\r\n        ')}function y(e,t){var s;return t.buffer.push("       \r\n        <td>\r\n          "),s=a._triageMustache.call(e,"lineItem.numberOfUnits",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>    \r\n        "),""}function b(e,t){var s;return t.buffer.push('\r\n        <td style="text-align:right; border-bottom: none">'),s=a._triageMustache.call(e,"item.totalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n        <td style="text-align:center; border-bottom: none">\r\n          '),s=a.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"item",action:"selectedQuote"},hashTypes:{contentBinding:"STRING",action:"STRING"},hashContexts:{contentBinding:e,action:e},inverse:R.noop,fn:R.program(23,v,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n        "),""}function v(e,t){return t.buffer.push("\r\n          "),t.buffer.push(N(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"item.isSelected"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n          "),""}function g(e,t){t.buffer.push('\r\n        <td style="border-bottom: none; border-top: none"></td>\r\n        <td style="border-bottom: none; border-top: none"></td>\r\n        ')}function C(e,t){var s,o;t.buffer.push(N((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Select",o):D.call(e,"loc","Select",o))))}function x(e,t){var s,o;t.buffer.push(N((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Cancel",o):D.call(e,"loc","Cancel",o))))}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var S,T,I,R=this,N=this.escapeExpression,D=a.helperMissing;return o.buffer.push('<div class="modal-max-size">\r\n  <div style="height:490px; overflow-y: auto;">\r\n    <table id="AmountPayInfo" class="table table-bordered komodo-datagrid" width="100%">\r\n      <tr>\r\n        <td colspan="7">\r\n          '),o.buffer.push(N((T=a.loc||t&&t.loc,I={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},T?T.call(t,"locale.onlinetill:customer.accounts",I):D.call(t,"loc","locale.onlinetill:customer.accounts",I)))),o.buffer.push(" : "),o.buffer.push(N(a.view.call(t,"Komodo.Controls.CoreSelect",{hash:{tabindex:"1",valueBinding:"data.customer.account",contentBinding:"data.customer.accounts",optionLabelPath:"content.displayText",optionValuePath:"content"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING"},hashContexts:{tabindex:t,valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n        </td>        \r\n      </tr>\r\n      <tr>\r\n        "),S=a.if.call(t,"data.customer.isCommercialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:R.program(3,r,o),fn:R.program(1,n,o),contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('\r\n        <th width="10%" style="text-align:center">Date</th>\r\n          '),S=a.if.call(t,"data.customer.isCommercialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:R.program(7,l,o),fn:R.program(5,i,o),contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('\r\n        \r\n        <th width="20%" style="text-align:center">Period</th>\r\n        '),S=a.if.call(t,"data.customer.isCommercialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:R.noop,fn:R.program(9,c,o),contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('\r\n        <th width="10%" style="text-align:center">Total Amount<br/>in '),S=a._triageMustache.call(t,"data.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</th>\r\n        <th width="2%" style="text-align:center">Pay</th>\r\n      </tr>\r\n      '),S=a.each.call(t,"item","in","data.customer.account.quotes",{hash:{},hashTypes:{},hashContexts:{},inverse:R.noop,fn:R.program(11,u,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('\r\n      <tr>\r\n        <td colspan="5">\r\n          <b>Sub-total in '),S=a._triageMustache.call(t,"data.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n          <b>'),S=a._triageMustache.call(t,"data.customer.subTotal",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td colspan="5">\r\n          <b>Balance in '),S=a._triageMustache.call(t,"data.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n          <b>'),S=a._triageMustache.call(t,"data.customer.balance",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n        </td>\r\n      </tr>\r\n      <tr>\r\n        <td colspan="5">\r\n          <b>Total amount to pay in '),S=a._triageMustache.call(t,"data.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n          <b>'),S=a._triageMustache.call(t,"data.customer.payAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),
o.buffer.push('</b>\r\n        </td>\r\n        <td style="text-align:right">\r\n        </td>\r\n      </tr>\r\n    </table>\r\n  </div>\r\n  <br/>\r\n  <div class="float-right">\r\n    '),S=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"select"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:R.noop,fn:R.program(27,C,o),contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push(" &nbsp;\r\n    "),S=a.view.call(t,"Komodo.Controls.Button",{hash:{action:"cancel"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:R.noop,fn:R.program(29,x,o),contexts:[t],types:["ID"],data:o}),(S||0===S)&&o.buffer.push(S),o.buffer.push("\r\n  </div>\r\n</div>"),""}),Ember.TEMPLATES.RealtimeOptionView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Cancel",o):u.call(e,"loc","Cancel",o)))),t.buffer.push("\r\n        "),""}function r(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(h((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"Submit",o):u.call(e,"loc","Submit",o)))),t.buffer.push("\r\n        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var i,l,c,u=a.helperMissing,h=this.escapeExpression,d=this;return o.buffer.push('<table border="0" cellSpacing="2" cellPadding="2" width="100%">\r\n  <tr>\r\n    <td width="170px" valign="top">\r\n      <table width="100%">\r\n        '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"1",valueBinding:"view.context.data.payByDate",label:"Pay By Date"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </table>\r\n    </td>\r\n    <td width="170px" valign="top" colspan="2">\r\n      '),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"Next Invoice : ",c):u.call(t,"loc","Next Invoice : ",c)))),o.buffer.push("<b>"),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"2013/03/12 00:00:00 AM",c):u.call(t,"loc","2013/03/12 00:00:00 AM",c)))),o.buffer.push('</b>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td width="170px" valign="top">\r\n      <table width="100%">\r\n        '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.Select",{hash:{tabindex:"45",valueBinding:"view.context.data.invoicePeriod",contentBinding:"view.context.listInvoicePeriod",optionLabelPath:"content",optionValuePath:"content",label:"Invoice Period"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </table>\r\n    </td>\r\n    <td width="170px" valign="top">\r\n      <table width="100%">\r\n        '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.Checkbox",{hash:{tabindex:"6",valueBinding:"view.context.data.nextInvoiceDate",label:"Move Next Invoice Date"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </table>\r\n    </td>\r\n    <td width="170px" valign="top">\r\n      <table width="100%">\r\n        '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.Checkbox",{hash:{tabindex:"6",valueBinding:"view.context.data.autoReconnect",label:"Auto Reconnect"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </table>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td colspan="3">\r\n      <table width="100%">\r\n        '),o.buffer.push(h(a.view.call(t,"Komodo.Controls.Select",{hash:{tabindex:"45",valueBinding:"view.context.data.smartcardNumber",contentBinding:"view.context.listSmartcards",optionLabelPath:"content",optionValuePath:"content",label:"SmartCard Number"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </table>\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td colspan="3">\r\n      '),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"Select product to Auto-Add ",c):u.call(t,"loc","Select product to Auto-Add ",c)))),o.buffer.push('<span style="color:red;">'),o.buffer.push(h((l=a.loc||t&&t.loc,c={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},l?l.call(t,"SC (At Customer) :Active",c):u.call(t,"loc","SC (At Customer) :Active",c)))),o.buffer.push("</span>\r\n      "),o.buffer.push(h(a.view.call(t,"Komodo.Controls.DataGrid",{hash:{tabindex:"20",canEdit:!0,editMode:"cell",pageSize:10,performsValidation:!0,canSelect:!0,selectedItemBinding:"view.context.data.selectedGridItem",commandItemBinding:"view.context.data.commandGridItem",commandItemTypeBinding:"view.context.data.commandGridItemType",contentBinding:"view.context.data.gridData",columnsBinding:"view.context.gridColumns"},hashTypes:{tabindex:"STRING",canEdit:"BOOLEAN",editMode:"STRING",pageSize:"INTEGER",performsValidation:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING"},hashContexts:{tabindex:t,canEdit:t,editMode:t,pageSize:t,performsValidation:t,canSelect:t,selectedItemBinding:t,commandItemBinding:t,commandItemTypeBinding:t,contentBinding:t,columnsBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n    </td>\r\n  </tr>\r\n  <tr>\r\n    <td colspan="3" align="right">\r\n        '),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"16",action:"\r\n        "},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:d.noop,fn:d.program(1,n,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n        "),i=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"17",action:"submitRealTimeOption"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:d.noop,fn:d.program(3,r,o),contexts:[t],types:["ID"],data:o}),(i||0===i)&&o.buffer.push(i),o.buffer.push("\r\n    </td>\r\n  </tr>\r\n</table>\r\n"),""}),Ember.TEMPLATES.ReprintReceiptView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"col-md-4"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:v.noop,fn:v.program(6,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function r(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.shiftNumber",n):y.call(e,"loc","locale.onlinetill:shift.shiftNumber",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.shiftNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong> <br/>\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:customer.payAmount",n):y.call(e,"loc","locale.onlinetill:customer.payAmount",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.amount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function i(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.paymentNumber",n):y.call(e,"loc","locale.onlinetill:shift.paymentNumber",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.paymentId",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong> <br/>\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.date",n):y.call(e,"loc","locale.onlinetill:shift.date",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function l(e,t){var s,o,n;return t.buffer.push("\r\n    "),t.buffer.push(b((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:payment.paymentType",n):y.call(e,"loc","locale.onlinetill:payment.paymentType",n)))),t.buffer.push(": <strong>"),s=a._triageMustache.call(e,"data.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong>\r\n    "),""}function c(e,t){var s;return t.buffer.push("\r\n      "),s=a.with.call(e,"item",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(9,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n      "),""}function u(e,t){return t.buffer.push("\r\n      <tr>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"quoteId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n        <td>\r\n          "),t.buffer.push(b(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n      "),""}function h(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(b((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.ok",o):y.call(e,"loc","locale.onlinetill:shift.ok",o)))),t.buffer.push("\r\n        "),""}function d(e,t){var s,o;return t.buffer.push("\r\n        "),t.buffer.push(b((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.cancel",o):y.call(e,"loc","locale.onlinetill:shift.cancel",o)))),t.buffer.push("\r\n        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var p,m,f,y=a.helperMissing,b=this.escapeExpression,v=this;return o.buffer.push('<div class="modal-max-size">\r\n  <fieldset>\r\n    <legend>'),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.receiptDetails",f):y.call(t,"loc","locale.onlinetill:shift.receiptDetails",f)))),o.buffer.push("</legend>\r\n    "),p=a.view.call(t,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(1,n,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n    <br/>\r\n    <b>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.details",f):y.call(t,"loc","locale.onlinetill:shift.details",f)))),o.buffer.push(":</b>\r\n    <table "),o.buffer.push(b(a["bind-attr"].call(t,{hash:{class:":table :table-bordered :komodo-datagrid"},hashTypes:{class:"STRING"},hashContexts:{class:t},contexts:[],types:[],data:o}))),o.buffer.push(">\r\n      <tr>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.transactionNumber",f):y.call(t,"loc","locale.onlinetill:shift.transactionNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.receiptNumber",f):y.call(t,"loc","locale.onlinetill:shift.receiptNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:customer.customerNumber",f):y.call(t,"loc","locale.onlinetill:customer.customerNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:shift.accountNumber",f):y.call(t,"loc","locale.onlinetill:shift.accountNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:quote.quoteNumber",f):y.call(t,"loc","locale.onlinetill:quote.quoteNumber",f)))),o.buffer.push("</th>\r\n        <th>"),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:customer.payAmount",f):y.call(t,"loc","locale.onlinetill:customer.payAmount",f)))),o.buffer.push("</th>\r\n      </tr>\r\n      "),p=a.each.call(t,"item","in","data.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:v.noop,fn:v.program(8,c,o),contexts:[t,t,t],types:["ID","ID","ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push('\r\n    </table>\r\n  </fieldset>\r\n  <table border="0" width="100%">\r\n    <tr>\r\n      <td>\r\n        <fieldset>\r\n          <legend>'),o.buffer.push(b((m=a.loc||t&&t.loc,f={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},m?m.call(t,"locale.onlinetill:payment.supervisorApproval",f):y.call(t,"loc","locale.onlinetill:payment.supervisorApproval",f)))),o.buffer.push('</legend>\r\n          <table border="0" width="100%">\r\n            <tr>\r\n              <td>\r\n                '),o.buffer.push(b(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"201",valueBinding:"data.supervisorUsername",label:"~locale.onlinetill:payment.supervisorName~"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n              </td>\r\n              <td>\r\n                "),o.buffer.push(b(a.view.call(t,"Komodo.Controls.TextField",{hash:{type:"password",tabindex:"202",valueBinding:"data.passCode",label:"~locale.onlinetill:payment.passCode~"},hashTypes:{type:"STRING",tabindex:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{type:t,tabindex:t,valueBinding:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n              </td>\r\n            </tr>\r\n          </table>\r\n        </fieldset>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td align="right">\r\n        '),p=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"ok",disabledBinding:"view.context.data.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:v.noop,fn:v.program(11,h,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n        "),p=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:v.noop,fn:v.program(13,d,o),contexts:[t],types:["ID"],data:o}),(p||0===p)&&o.buffer.push(p),o.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n</div>"),""}),Ember.TEMPLATES.SearchView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s;return t.buffer.push('\r\n    <div class="modal-max-size">\r\n        '),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{id:"SearchField",tabindex:"1",placeholder:"Type your search here",valueBinding:"view.context.data.searchText",validatorBinding:"view.context.data.searchText.Error",label:"Search Text"},hashTypes:{id:"STRING",tabindex:"STRING",placeholder:"STRING",valueBinding:"STRING",validatorBinding:"STRING",label:"STRING"},hashContexts:{id:e,tabindex:e,placeholder:e,valueBinding:e,validatorBinding:e,label:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"2",action:"searchCustomer",class:"nextto-conntrol"},hashTypes:{tabindex:"STRING",action:"STRING",class:"STRING"},hashContexts:{tabindex:e,action:e,class:e},inverse:S.noop,fn:S.program(2,r,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        <br/>\r\n        "),s=a.each.call(e,"row","in","view.context.data.searchResultSet",{hash:{},hashTypes:{},hashContexts:{},inverse:S.noop,fn:S.program(4,i,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n        \r\n        <div style="float:right;width:60%" id="divbottombtncontainer">\r\n            '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"previousPage",id:"btnPreviousbottom",visibleBinding:"view.context.data.isButtonVisible",disabledBinding:"view.context.data.isPreviousDisable"},hashTypes:{action:"STRING",id:"STRING",visibleBinding:"STRING",disabledBinding:"STRING"},hashContexts:{action:e,id:e,visibleBinding:e,disabledBinding:e},inverse:S.noop,fn:S.program(7,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a._triageMustache.call(e,"searchRequest.Displaycurrentpagerange",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"nextPage",id:"btnNextbottom",visibleBinding:"view.context.data.isButtonVisible",disabledBinding:"view.context.data.isNextDisable"},hashTypes:{action:"STRING",id:"STRING",visibleBinding:"STRING",disabledBinding:"STRING"},hashContexts:{action:e,id:e,visibleBinding:e,disabledBinding:e},inverse:S.noop,fn:S.program(9,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </div>\r\n        <br/>\r\n          "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"addCustomers",id:"btnAddCustomers",class:"btn-success",visibleBinding:"view.context.data.isMultiSelectVisible"},hashTypes:{action:"STRING",id:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,id:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(11,h,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"clearAll",id:"btnClearAll",class:"btn-inverse",visibleBinding:"view.context.data.isMultiSelectVisible"},hashTypes:{action:"STRING",id:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,id:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(13,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n\r\n    </div>\r\n"),""}function r(e,t){var s,o;return t.buffer.push("\r\n             "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.search",o):C.call(e,"loc","locale.onlinetill:customer.search",o)))),t.buffer.push("\r\n        "),""}function i(e,t){var s;return t.buffer.push('\r\n        <div class="mobile-searchresults">\r\n            <div class="row">\r\n        <div class="col-sm-12 ">\r\n            '),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.searchResult.searchField1",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.searchResult.searchField4",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.searchResult.searchField9",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(' \r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-sm-4 sub-heading">\r\n            '),s=a._triageMustache.call(e,"row.searchResult.searchField2",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" "),s=a._triageMustache.call(e,"row.searchResult.searchField3",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('    \r\n        </div>\r\n          <div class="col-sm-3">\r\n            '),s=a._triageMustache.call(e,"row.searchResult.searchField5",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n        </div>\r\n        <div class="col-sm-3">\r\n            '),s=a._triageMustache.call(e,"row.searchResult.searchField6",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n        </div>\r\n         <div class="col-sm-2">\r\n            '),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"row.isSelected",visibleBinding:"row.multiSelect"},hashTypes:{checkedBinding:"STRING",visibleBinding:"STRING"},hashContexts:{checkedBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.add~",visibleBinding:"row.multiSelect"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"addSingleCustomer",class:"btn-success btn-xs nextto-control",visibleBinding:"row.addVisible"},hashTypes:{action:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(5,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-sm-6">\r\n            '),s=a._triageMustache.call(e,"row.searchResult.searchField7",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(' \r\n        </div>\r\n        <div class="col-sm-6">\r\n            '),s=a._triageMustache.call(e,"row.searchResult.searchField8",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </div>\r\n    </div>\r\n        </div>\r\n        "),""}function l(e,t){t.buffer.push("\r\n            Add\r\n            ")}function c(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.previous",o):C.call(e,"loc","locale.onlinetill:shift.previous",o)))),t.buffer.push("\r\n            "),""}function u(e,t){var s,o;return t.buffer.push("\r\n            "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.next",o):C.call(e,"loc","locale.onlinetill:shift.next",o)))),t.buffer.push("\r\n            "),""}function h(e,t){t.buffer.push("\r\n            Add Customers\r\n            ")}function d(e,t){t.buffer.push("\r\n            Clear All\r\n            ")}function p(e,t){var s;return t.buffer.push('\r\n<table border="0" cellSpacing="2" cellPadding="2" width="100%">\r\n    <tr>\r\n        <td>\r\n            <table border="0" cellSpacing="5" cellPadding="5">\r\n                <tr>\r\n                    <td width="250px" valign="bottom">\r\n                        <table>\r\n                            '),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{id:"SearchField",tabindex:"1",placeholderBinding:"view.context.data.searchTextPlaceholder",valueBinding:"view.context.data.searchText",validatorBinding:"view.context.data.searchText.Error",label:"Search Text"},hashTypes:{id:"STRING",tabindex:"STRING",placeholderBinding:"STRING",valueBinding:"STRING",validatorBinding:"STRING",label:"STRING"},hashContexts:{id:e,tabindex:e,placeholderBinding:e,valueBinding:e,validatorBinding:e,label:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                        </table>\r\n                    </td>\r\n                    <td width="80px" valign="top">\r\n                        <table>\r\n                            '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{tabindex:"2",action:"searchCustomer"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:e,action:e},inverse:S.noop,fn:S.program(16,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                        </table>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td>\r\n            <div class="modal-max-size" style="height:425px">\r\n                <table width="100%">\r\n                    '),s=a.each.call(e,"row","in","view.context.data.searchResultSet",{hash:{},hashTypes:{},hashContexts:{},inverse:S.noop,fn:S.program(18,f,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                </table>\r\n            </div>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td>\r\n            <div style="float:right;width:60%" id="divbottombtncontainer">\r\n                '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"previousPage",id:"btnPreviousbottom",visibleBinding:"view.context.data.isButtonVisible",disabledBinding:"view.context.data.isPreviousDisable"},hashTypes:{action:"STRING",id:"STRING",visibleBinding:"STRING",disabledBinding:"STRING"},hashContexts:{action:e,id:e,visibleBinding:e,disabledBinding:e},inverse:S.noop,fn:S.program(21,b,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                "),s=a._triageMustache.call(e,"searchRequest.Displaycurrentpagerange",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"nextPage",id:"btnNextbottom",visibleBinding:"view.context.data.isButtonVisible",disabledBinding:"view.context.data.isNextDisable"},hashTypes:{action:"STRING",id:"STRING",visibleBinding:"STRING",disabledBinding:"STRING"},hashContexts:{action:e,id:e,visibleBinding:e,disabledBinding:e},inverse:S.noop,fn:S.program(23,v,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n            </div>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td align="right">\r\n            '),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"addCustomers",id:"btnAddCustomers",class:"btn-success",visibleBinding:"view.context.data.isMultiSelectVisible"},hashTypes:{action:"STRING",id:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,id:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(11,h,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"clearAll",id:"btnClearAll",class:"btn-inverse",visibleBinding:"view.context.data.isMultiSelectVisible"},hashTypes:{action:"STRING",id:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,id:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(13,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n        </td>\r\n    </tr>\r\n</table>\r\n\r\n"),""}function m(e,t){var s,o;return t.buffer.push("\r\n                            "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:customer.search",o):C.call(e,"loc","locale.onlinetill:customer.search",o)))),t.buffer.push("\r\n                            "),""}function f(e,t){var s;return t.buffer.push('\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>\r\n                                <table width="100%" class="komodo-searchresults">\r\n                                    <tr >\r\n                                        <td class="sub-heading" width="30%">\r\n                                            '),s=a._triageMustache.call(e,"row.searchResult.searchField2",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" "),s=a._triageMustache.call(e,"row.searchResult.searchField3",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                                        </td>\r\n                                        <td width="30%">\r\n                                            '),s=a._triageMustache.call(e,"row.searchResult.searchField4",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),
t.buffer.push('\r\n                                        </td>\r\n                                        <td width="30%">\r\n                                            '),s=a._triageMustache.call(e,"row.searchResult.searchField9",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                                        </td>\r\n                                        <td width="10%" class="searchresults-type">\r\n                                            '),s=a._triageMustache.call(e,"row.searchResult.searchField1",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                                        </td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td>\r\n                                            "),s=a._triageMustache.call(e,"row.searchResult.searchField7",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                                        </td>\r\n                                        <td>\r\n                                            "),s=a._triageMustache.call(e,"row.searchResult.searchField8",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                                        </td>\r\n                                        <td >\r\n                                            "),s=a._triageMustache.call(e,"row.searchResult.searchField6",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                                        </td>\r\n                                        <td>\r\n                                            "),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"row.isSelected",visibleBinding:"row.multiSelect"},hashTypes:{checkedBinding:"STRING",visibleBinding:"STRING"},hashContexts:{checkedBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(x(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.add~",visibleBinding:"row.multiSelect"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                                            "),s=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"addSingleCustomer",class:"btn-success",visibleBinding:"row.addVisible"},hashTypes:{action:"STRING",class:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,class:e,visibleBinding:e},inverse:S.noop,fn:S.program(19,y,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                                        </td>\r\n                                    </tr>\r\n                                </table>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                    "),""}function y(e,t){t.buffer.push("\r\n                                            Add\r\n                                            ")}function b(e,t){var s,o;return t.buffer.push("\r\n                "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.previous",o):C.call(e,"loc","locale.onlinetill:shift.previous",o)))),t.buffer.push("\r\n                "),""}function v(e,t){var s,o;return t.buffer.push("\r\n                "),t.buffer.push(x((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.next",o):C.call(e,"loc","locale.onlinetill:shift.next",o)))),t.buffer.push("\r\n                "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var g,C=a.helperMissing,x=this.escapeExpression,S=this;return g=a.if.call(t,"isMobileDevice",{hash:{},hashTypes:{},hashContexts:{},inverse:S.program(15,p,o),fn:S.program(1,n,o),contexts:[t],types:["ID"],data:o}),(g||0===g)&&o.buffer.push(g),o.buffer.push("\r\n"),""}),Ember.TEMPLATES.ShiftDetailsContainerView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){var s,o;return t.buffer.push("\r\n                    "),t.buffer.push(L((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.shiftDetails",o):F.call(e,"loc","locale.onlinetill:shift.shiftDetails",o)))),t.buffer.push("\r\n                    "),""}function r(e,t){var s,o;return t.buffer.push("\r\n                    "),t.buffer.push(L((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.interimShiftReport",o):F.call(e,"loc","locale.onlinetill:shift.interimShiftReport",o)))),t.buffer.push("\r\n                    "),""}function i(e,t){var s,o;return t.buffer.push("\r\n                    "),t.buffer.push(L((s=a.loc||e&&e.loc,o={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},s?s.call(e,"locale.onlinetill:shift.closeShift",o):F.call(e,"loc","locale.onlinetill:shift.closeShift",o)))),t.buffer.push("\r\n                    "),""}function l(e,t){t.buffer.push('\r\n                    <span class="customer-type-label">\r\n                        <div class="img-responsive dstv-blue-logo"></div>\r\n                    </span>\r\n                    ')}function c(e,t){var s;return t.buffer.push("\r\n                    "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isGotv",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(12,h,t),fn:_.program(10,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                    "),""}function u(e,t){t.buffer.push('\r\n                    <span class="customer-type-label">\r\n                        <img src="Content/Images/gotv.svg" class="img-responsive" />\r\n                    </span>\r\n                    ')}function h(e,t){t.buffer.push("\r\n                    <span>-</span>\r\n                    ")}function d(e,t){var s;return t.buffer.push('\r\n                    <img class="align-icon" src="Content/Images/customer-icon.svg" />\r\n                    '),s=a.if.call(e,"isResidentialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(17,m,t),fn:_.program(15,p,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n\r\n                    "),""}function p(e,t){return t.buffer.push("\r\n                    "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.customer.customerName",id:"customerName"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" - "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.customer.customerNumber",id:"customernumber"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                    "),""}function m(e,t){return t.buffer.push("\r\n                    "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerName",id:"customertitle"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n\r\n                    "),""}function f(e,t){return t.buffer.push("\r\n\r\n                    "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerName",id:"customertitle"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n\r\n                    "),""}function y(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-active status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function b(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isPotentialCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(26,g,t),fn:_.program(24,v,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function v(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-potential status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function g(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isBadDebtCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(29,x,t),fn:_.program(27,C,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function C(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-bad-debt status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function x(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isClosedCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(32,T,t),fn:_.program(30,S,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function S(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-closed status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function T(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isFraudCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(35,R,t),fn:_.program(33,I,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function I(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-fraud-investigation status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function R(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isSuspendedCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(38,D,t),fn:_.program(36,N,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function N(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-suspended status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function D(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isDeceased",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(41,P,t),fn:_.program(39,B,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function B(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-deceased status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function P(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isEmigrated",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(44,E,t),fn:_.program(42,w,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function w(e,t){var s;return t.buffer.push('\r\n                        <span class="customer-status-emigrated status-padding">'),s=a._triageMustache.call(e,"Komodo.Services.customerProfileService.personalDetails.customerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</span>\r\n                        "),""}function E(e,t){var s;return t.buffer.push("\r\n                        "),s=a.if.call(e,"Komodo.Services.customerProfileService.personalDetails.isFraudInvestigation",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(45,K,t),fn:_.program(33,I,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function K(e,t){t.buffer.push("\r\n                        <span>-</span>\r\n                        ")}function A(e,t){return t.buffer.push("\r\n                    "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.Link",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerTypeText",action:"EmpCustLinkPopupClicked",class:"banner-link"},hashTypes:{textBinding:"STRING",action:"STRING",class:"STRING"},hashContexts:{textBinding:e,action:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br />\r\n                    "),""}function O(e,t){return t.buffer.push("\r\n                    "),t.buffer.push(L(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerTypeText",id:"customertype"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                    "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var G,M,k,F=a.helperMissing,L=this.escapeExpression,_=this;return o.buffer.push('<div class="shift-customer-container">\r\n    <div id="shift-banner">\r\n        <div class="shift-details inline">\r\n            <div class="shift-3-col">'),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.cashierName",k):F.call(t,"loc","locale.onlinetill:shift.cashierName",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.cashierName",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('</div>\r\n            <div class="shift-3-col">'),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.shiftNumber",k):F.call(t,"loc","locale.onlinetill:shift.shiftNumber",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.shiftNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('</div>\r\n            <div class="shift-3-col">'),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.generalLedger",k):F.call(t,"loc","locale.onlinetill:shift.generalLedger",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.generalLedger",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('</div>\r\n            <div class="shift-3-col">\r\n                '),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.stockHandler",k):F.call(t,"loc","locale.onlinetill:shift.stockHandler",k)))),o.buffer.push(" : "),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreSelect",{hash:{valueBinding:"data.stockHandlerId",contentBinding:"data.stockHandlers",optionLabelPath:"content.Name",optionValuePath:"content.Id",disableBinding:"data.isOffLine"},hashTypes:{valueBinding:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",disableBinding:"STRING"},hashContexts:{valueBinding:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,disableBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n            </div>\r\n            <div class="shift-3-col">'),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.baseCurrency",k):F.call(t,"loc","locale.onlinetill:shift.baseCurrency",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.baseCurrency",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('</div>\r\n            <ul class="shift-3-col">\r\n                <li>\r\n                    '),G=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"17",action:"shiftDetails",type:"banner",disableBinding:"data.isOffLine"},hashTypes:{tabindex:"STRING",action:"STRING",type:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:t,action:t,type:t,disableBinding:t},inverse:_.noop,fn:_.program(1,n,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("\r\n                </li>\r\n                <li>\r\n                    "),G=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"17",action:"interimShiftReport",type:"banner"},hashTypes:{tabindex:"STRING",action:"STRING",type:"STRING"},hashContexts:{tabindex:t,action:t,type:t},inverse:_.noop,fn:_.program(3,r,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("\r\n                </li>\r\n                <li>\r\n                    "),G=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"17",action:"closeShift",type:"banner",disableBinding:"data.isOffLine"},hashTypes:{tabindex:"STRING",action:"STRING",type:"STRING",disableBinding:"STRING"},hashContexts:{tabindex:t,action:t,type:t,disableBinding:t},inverse:_.noop,fn:_.program(5,i,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="shift-payment-details inline">\r\n            <ul class="amounts-list">\r\n                <li>'),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.cash",k):F.call(t,"loc","locale.onlinetill:shift.cash",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.cash",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("</li>\r\n                <li>"),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.other",k):F.call(t,"loc","locale.onlinetill:shift.other",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.other",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("</li>\r\n                <li>"),o.buffer.push(L((M=a.loc||t&&t.loc,k={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o},M?M.call(t,"locale.onlinetill:shift.totalEntered",k):F.call(t,"loc","locale.onlinetill:shift.totalEntered",k)))),o.buffer.push(" : "),G=a._triageMustache.call(t,"data.total",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("</li>\r\n            </ul>\r\n        </div>\r\n      \r\n        <a "),o.buffer.push(L(a.action.call(t,"showCustomerDetails",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push('><div class="toggle-customer-banner-btn" id="toggle-banners"><span id="customer-details-txt">Customer Details</span></div></a>\r\n    </div>\r\n\r\n    <div id="customer-details-banner">\r\n        <div class="customer-profile-banner customer-profile-banner-no-margintop">\r\n            <div class="left">\r\n                <div class="banner-2-col">\r\n                    '),G=a.if.call(t,"Komodo.Services.customerProfileService.personalDetails.isDstv",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(9,c,o),fn:_.program(7,l,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    '),G=a.if.call(t,"isShowIcon",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(19,f,o),fn:_.program(14,d,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push("\r\n\r\n                    "),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerNo",id:"customernumber"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:t,id:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('&nbsp;&nbsp;&nbsp;&nbsp;\r\n\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    <a '),o.buffer.push(L(a.action.call(t,"changeCustomerStatus",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:o}))),o.buffer.push(">\r\n                        "),G=a.if.call(t,"Komodo.Services.customerProfileService.personalDetails.isActiveCustomer",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(23,b,o),fn:_.program(21,y,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('\r\n                    </a>\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    '),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{id:"locationIndicator",visibleBinding:"false"},hashTypes:{id:"STRING",visibleBinding:"STRING"},hashContexts:{id:t,visibleBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n                    "),G=a.if.call(t,"Komodo.Services.customerProfileService.personalDetails.isEmployeeType",{hash:{},hashTypes:{},hashContexts:{},inverse:_.program(49,O,o),fn:_.program(47,A,o),contexts:[t],types:["ID"],data:o}),(G||0===G)&&o.buffer.push(G),o.buffer.push('\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    '),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.customerClassText",id:"customerclass"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:t,id:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    '),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.mobileNo",id:"customerphone"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:t,id:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n                </div>\r\n                <div class="banner-2-col">\r\n                    '),o.buffer.push(L(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"Komodo.Services.customerProfileService.personalDetails.email",id:"customeremail"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:t,id:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n                </div>\r\n\r\n                <div class="banner-2-col btn btn-sm btn-primary" id="stay-right">\r\n                    '),o.buffer.push(L(a.view.call(t,"Komodo.Controls.Link",{hash:{text:"~locale.customerprofile.customerprofile:amountPayable.amountToPay~",action:"viewAmountPayable",class:"banner-link"},hashTypes:{text:"STRING",action:"STRING",class:"STRING"},hashContexts:{text:t,action:t,class:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <a "),o.buffer.push(L(a.action.call(t,"showShiftDetails",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:o}))),o.buffer.push('><div class="toggle-shift-banner-btn" id="toggle-banners"><span id="shift-details-txt">Shift Details</span></div></a>\r\n\r\n\r\n    </div>\r\n</div>\r\n'),""}),Ember.TEMPLATES.ShiftDetailsReportView=Ember.Handlebars.template(function(e,t,a,s,o){function n(e,t){return t.buffer.push('\r\n    <div class="text-center">\r\n        <img src="Content/Images/busy-indicator.svg" />\r\n        <br />\r\n        '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.messageSpooling~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"view.context.data.spoolingPercentage",id:"percentage"},hashTypes:{textBinding:"STRING",id:"STRING"},hashContexts:{textBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    </div>\r\n    "),""}function r(e,t){var s,o,n;return t.buffer.push("\r\n    "),s=a.if.call(e,"view.context.data.isMultipleBusinessUnit",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(4,i,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n\r\n    <div class="print-button">\r\n        <a '),t.buffer.push(ae(a.action.call(e,"printReport",{hash:{target:"view.context"},hashTypes:{target:"STRING"},hashContexts:{target:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('>\r\n            <img name="print_01" alt="print" src="./Content/Images/report_print.gif" />'),t.buffer.push(ae((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:report.print",n):oe.call(e,"loc","locale.onlinetill:report.print",n)))),t.buffer.push('\r\n        </a>\r\n    </div>\r\n    <div class="panel panel-default printing">\r\n        <div class="panel-body" id="reportView">\r\n            <h5 class="text-center">\r\n                '),s=a.if.call(e,"view.context.data.isMultipleBusinessUnit",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(10,h,t),fn:se.program(8,u,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n            </h5>\r\n            <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.country",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</h5>\r\n            <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.header",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" "),t.buffer.push(ae((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.summaryReport",n):oe.call(e,"loc","locale.onlinetill:shift.summaryReport",n)))),t.buffer.push("</h5>\r\n            <br />\r\n            "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(12,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            <br />\r\n            "),s=a.if.call(e,"view.context.data.isMultipleCurrency",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(29,I,t),fn:se.program(19,b,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n            <hr />\r\n            <h5 class="text-center">\r\n             '),s=a.if.call(e,"view.context.data.isMultipleBusinessUnit",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(34,D,t),fn:se.program(32,N,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n            </h5>\r\n            <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.country",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</h5>\r\n            <h5 class="text-center">'),s=a._triageMustache.call(e,"view.context.data.header",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" "),t.buffer.push(ae((o=a.loc||e&&e.loc,n={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.onlinetill:shift.detailsReport",n):oe.call(e,"loc","locale.onlinetill:shift.detailsReport",n)))),t.buffer.push("</h5>\r\n            <br />\r\n            "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(12,d,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.if.call(e,"view.context.data.hasPaymentData",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(36,B,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.each.call(e,"paymentsByPaymentType","in","view.context.data.paymentCountByPaymentTypes",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(38,P,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n\r\n            "),s=a.if.call(e,"view.context.data.isCancelledGridDataVisible",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(63,H,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n           \r\n</div>\r\n    </div>\r\n    "),""}function i(e,t){var s;return t.buffer.push("\r\n    "),s=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.businessUnits~"},hashTypes:{title:"STRING"},hashContexts:{title:e},inverse:se.noop,fn:se.program(5,l,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    <hr />  \r\n    "),""}function l(e,t){var s;return t.buffer.push("\r\n        "),s=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(6,c,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n    "),""}function c(e,t){return t.buffer.push("\r\n            "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.RadioButtonGroup",{hash:{contentBinding:"view.context.data.viewingPlatformData",displayPath:"title",valuePath:"value",valueBinding:"view.context.data.selectedViewingPlatformData"},hashTypes:{contentBinding:"STRING",displayPath:"STRING",valuePath:"STRING",valueBinding:"STRING"},hashContexts:{contentBinding:e,displayPath:e,valuePath:e,valueBinding:e},contexts:[e],types:["ID"],data:t}))),
t.buffer.push("\r\n        "),""}function u(e,t){return t.buffer.push("\r\n                <img "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{src:"view.context.data.logoPath"},hashTypes:{src:"STRING"},hashContexts:{src:e},contexts:[],types:[],data:t}))),t.buffer.push("/>\r\n                "),""}function h(e,t){t.buffer.push('\r\n                <img src="Content/Images/main_logo.svg" />\r\n                ')}function d(e,t){var s;return t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(13,p,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),s=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(16,f,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function p(e,t){var s;return t.buffer.push("\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.company~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.country",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br />\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.shift~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : <strong>"),s=a._triageMustache.call(e,"view.context.data.status",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</strong> "),s=a._triageMustache.call(e,"view.context.data.shiftNumber",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.on~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> "),s=a._triageMustache.call(e,"view.context.data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.online~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> <br />\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:report.userName~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.userName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br />\r\n            "),s=a.if.call(e,"view.context.data.isBankDepositNumberVisible",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(14,m,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function m(e,t){return t.buffer.push("\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.stockHandler~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"view.context.data.stockHandlerDescription"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" <br />\r\n            "),""}function f(e,t){var s;return t.buffer.push("\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.date~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.date",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br />\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.time~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),s=a._triageMustache.call(e,"view.context.data.time",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push(" <br />\r\n            "),s=a.if.call(e,"view.context.data.isBankDepositNumberVisible",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(14,m,t),fn:se.program(17,y,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function y(e,t){return t.buffer.push("\r\n            <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.bankDepositNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong> : "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"view.context.data.bankDepositNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" <br />\r\n            "),""}function b(e,t){var s;return t.buffer.push('\r\n            <table id="splitPaymentTypesTable" '),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :table-responsive :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n                <thead>\r\n                    <tr>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.paymentType~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.currency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionCount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalBaseAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalInBaseCurrency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    "),s=a.each.call(e,"itemSummaryReport","in","view.context.data.summaryGridData",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(20,v,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                    "),s=a.each.call(e,"itemSummaryTotal","in","view.context.data.summaryTotalByCurrency",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(26,S,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                </tbody>\r\n            </table>\r\n            "),""}function v(e,t){var s;return t.buffer.push("\r\n                    "),s=a.each.call(e,"itemCurrency","in","itemSummaryReport.splitByCurrencies",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(21,g,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                    "),""}function g(e,t){var s;return t.buffer.push("\r\n                    <tr>\r\n                        "),s=a.if.call(e,"itemCurrency.isShowPaymentType",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(22,C,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        <td>"),s=a._triageMustache.call(e,"itemCurrency.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        <td>"),s=a._triageMustache.call(e,"itemCurrency.Count",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n                        <td class="text-right">'),s=a._triageMustache.call(e,"itemCurrency.Amount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n                        <td class="text-right">'),s=a._triageMustache.call(e,"itemCurrency.BaseAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        "),s=a.if.call(e,"itemCurrency.isShowPaymentType",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(24,x,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                    </tr>\r\n                    "),""}function C(e,t){var s;return t.buffer.push("\r\n                        <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{rowspan:"itemCurrency.CurrencyCount"},hashTypes:{rowspan:"STRING"},hashContexts:{rowspan:e},contexts:[],types:[],data:t}))),t.buffer.push(">"),s=a._triageMustache.call(e,"itemSummaryReport.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        "),""}function x(e,t){var s;return t.buffer.push("\r\n                        <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{rowspan:"itemCurrency.CurrencyCount"},hashTypes:{rowspan:"STRING"},hashContexts:{rowspan:e},contexts:[],types:[],data:t}))),t.buffer.push(' class="text-right">'),s=a._triageMustache.call(e,"itemSummaryReport.amount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        "),""}function S(e,t){var s;return t.buffer.push('\r\n                    <tr>\r\n                        <td colspan="3" class="text-right">'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalByCurrency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("&nbsp;"),s=a._triageMustache.call(e,"itemSummaryTotal.currency",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n                        <td class="text-right">'),s=a._triageMustache.call(e,"itemSummaryTotal.totalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('</td>\r\n                        <td class="text-right">'),s=a._triageMustache.call(e,"itemSummaryTotal.totalBaseAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        "),s=a.if.call(e,"itemSummaryTotal.isSplitRows",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(27,T,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                    </tr>\r\n                    "),""}function T(e,t){var s;return t.buffer.push("\r\n                        <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{rowspan:"view.context.data.summaryTotalByCurrency.length"},hashTypes:{rowspan:"STRING"},hashContexts:{rowspan:e},contexts:[],types:[],data:t}))),t.buffer.push(' class="text-right">'),s=a._triageMustache.call(e,"itemSummaryTotal.total",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</td>\r\n                        "),""}function I(e,t){var s;return t.buffer.push("\r\n            <table "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :table-responsive :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n                <thead>\r\n                    <tr>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.paymentType~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionCount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    "),s=a.each.call(e,"row","in","view.context.data.summaryGridData",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(30,R,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                </tbody>\r\n            </table>\r\n            "),""}function R(e,t){return t.buffer.push("\r\n                    <tr>\r\n                        <td>\r\n                            "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        </td>\r\n                        <td>\r\n                            "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.count"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                        </td>\r\n                        <td class="text-right">\r\n                            '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                        </td>\r\n                    </tr>\r\n                    "),""}function N(e,t){return t.buffer.push("\r\n                <img "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{src:"view.context.data.logoPath"},hashTypes:{src:"STRING"},hashContexts:{src:e},contexts:[],types:[],data:t}))),t.buffer.push(" />\r\n             "),""}function D(e,t){t.buffer.push('\r\n                <img src="Content/Images/main_logo.svg" />\r\n             ')}function B(e,t){return t.buffer.push("\r\n                <br />\r\n                <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.payments~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong><br/>\r\n            "),""}function P(e,t){var s,o,n;return t.buffer.push("\r\n            <b>"),s=a._triageMustache.call(e,"paymentsByPaymentType.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</b> "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.payment~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n                <table "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.paymentNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.receiptNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.customerNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.accountNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:quote.quoteNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            "),s=a.if.call(e,"view.context.data.showOfflinePaymentView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(39,w,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(41,E,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"paymentsByPaymentType.paymentType","Cheque",n):oe.call(e,"ifeq","paymentsByPaymentType.paymentType","Cheque",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(43,K,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"paymentsByPaymentType.paymentType","Card",n):oe.call(e,"ifeq","paymentsByPaymentType.paymentType","Card",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.currency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.payAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:quote.baseAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        "),s=a.each.call(e,"row","in","paymentsByPaymentType.items",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(45,A,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n\r\n                        "),s=a.if.call(e,"view.context.data.isMultipleCurrency",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(60,q,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        <tr>\r\n                            <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{colspan:"paymentsByPaymentType.colSpanForTotal"},hashTypes:{colspan:"STRING"},hashContexts:{colspan:e},contexts:[],types:[],data:t}))),t.buffer.push(' class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"paymentsByPaymentType.totalInBaseCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b>\r\n                            </td>\r\n                        </tr>\r\n\r\n                    </tbody>\r\n                </table>\r\n                "),""}function w(e,t){return t.buffer.push("\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.offline~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            "),""}function E(e,t){return t.buffer.push("\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.chequeBank~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.drawerName~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.chequeNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            "),""}function K(e,t){return t.buffer.push("\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.cardNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            "),""}function A(e,t){var s;return t.buffer.push("\r\n                        "),s=a.each.call(e,"item","in","row.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(46,O,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function O(e,t){var s;return t.buffer.push("\r\n                        <tr>\r\n                            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(49,M,t),fn:se.program(47,G,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.quoteId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(58,V,t),fn:se.program(51,k,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </tr>\r\n                        "),""}function G(e,t){return t.buffer.push('\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function M(e,t){t.buffer.push('\r\n                            <td class="bottom"></td>\r\n                            ')}function k(e,t){var s,o,n;return t.buffer.push("\r\n                            "),s=a.if.call(e,"view.context.data.showOfflinePaymentView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(52,F,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(54,L,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"paymentsByPaymentType.paymentType","Cheque",n):oe.call(e,"ifeq","paymentsByPaymentType.paymentType","Cheque",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(56,_,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"paymentsByPaymentType.paymentType","Card",n):oe.call(e,"ifeq","paymentsByPaymentType.paymentType","Card",n),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.currency.value"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                            </td>\r\n                            <td class="top text-right">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                            </td>\r\n                            <td class="top text-right">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.baseCurrencyAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function F(e,t){return t.buffer.push('\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.isOffline"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function L(e,t){return t.buffer.push("\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.bankName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("/"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.branchCode"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.accountHolderName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("                              \r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.chequeNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function _(e,t){return t.buffer.push("\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.cardNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function V(e,t){var s;return t.buffer.push("\r\n                            "),s=a.if.call(e,"view.context.data.showOfflinePaymentView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(49,M,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                            <td class="bottom"></td>\r\n                            <td class="bottom"></td>\r\n                            <td class="bottom"></td>\r\n                            '),""}function q(e,t){var s;return t.buffer.push("\r\n                        "),s=a.each.call(e,"item","in","paymentsByPaymentType.totalByCurrencies",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(61,U,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function U(e,t){return t.buffer.push("\r\n                        <tr>\r\n                            <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{colspan:"paymentsByPaymentType.colSpanForCurrency"},hashTypes:{colspan:"STRING"},hashContexts:{colspan:e},contexts:[],
types:[],data:t}))),t.buffer.push(' class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalByCurrency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("&nbsp;"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.currency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.totalByCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.totalByBaseCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b>\r\n                            </td>\r\n                        </tr>\r\n                        "),""}function H(e,t){var s;return t.buffer.push("\r\n                "),s=a.if.call(e,"view.context.data.hasCancelledPaymentData",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(64,$,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                "),s=a.each.call(e,"cancelPaymentsByPaymentType","in","view.context.data.cancelPaymentCountByPaymentTypes",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(66,Q,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n            "),""}function $(e,t){return t.buffer.push("\r\n                    <br />\r\n                    <strong>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.cancelledPayments~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</strong><br/>\r\n                "),""}function Q(e,t){var s,o,n;return t.buffer.push("\r\n                <b>"),s=a._triageMustache.call(e,"cancelPaymentsByPaymentType.paymentType",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("</b> "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.payment~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br />\r\n                <table "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{class:":table :table-bordered :komodo-datagrid :table-condensed :print-table"},hashTypes:{class:"STRING"},hashContexts:{class:e},contexts:[],types:[],data:t}))),t.buffer.push(">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:payment.paymentType~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.paymentNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.transactionNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.receiptNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.customerNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.accountNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:quote.quoteNumber~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            "),s=a.if.call(e,"view.context.data.showOfflinePaymentView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(39,w,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(41,E,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"cancelPaymentsByPaymentType.paymentType","Cheque",n):oe.call(e,"ifeq","cancelPaymentsByPaymentType.paymentType","Cheque",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(43,K,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"cancelPaymentsByPaymentType.paymentType","Card",n):oe.call(e,"ifeq","cancelPaymentsByPaymentType.paymentType","Card",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.currency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:customer.payAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                            <th>"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:quote.baseAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        "),s=a.each.call(e,"row","in","cancelPaymentsByPaymentType.items",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(67,j,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),s=a.if.call(e,"view.context.data.isMultipleCurrency",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(76,X,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        <tr>\r\n                            <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{colspan:"cancelPaymentsByPaymentType.colSpanForTotal"},hashTypes:{colspan:"STRING"},hashContexts:{colspan:e},contexts:[],types:[],data:t}))),t.buffer.push(' class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalAmount~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"cancelPaymentsByPaymentType.totalInBaseCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n                "),""}function j(e,t){var s;return t.buffer.push("\r\n                        "),s=a.each.call(e,"item","in","row.SplitPayments",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(68,J,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function J(e,t){var s;return t.buffer.push("\r\n                        <tr>\r\n                            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(71,Y,t),fn:se.program(69,z,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.financialTransactionId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.receiptNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.customerNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.accountNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.quoteId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),s=a.if.call(e,"item.isFirst",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(58,V,t),fn:se.program(73,W,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        </tr>\r\n                        "),""}function z(e,t){return t.buffer.push('\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentType"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                            </td>\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.paymentId"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function Y(e,t){t.buffer.push('\r\n                            <td class="bottom"></td>\r\n                            <td class="bottom"></td>\r\n                            ')}function W(e,t){var s,o,n;return t.buffer.push("\r\n                            "),s=a.if.call(e,"view.context.data.showOfflinePaymentView",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(52,F,t),contexts:[e],types:["ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(74,Z,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"cancelPaymentsByPaymentType.paymentType","Cheque",n):oe.call(e,"ifeq","cancelPaymentsByPaymentType.paymentType","Cheque",n),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                            "),o=a.ifeq||e&&e.ifeq,n={hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(56,_,t),contexts:[e,e],types:["ID","STRING"],data:t},s=o?o.call(e,"cancelPaymentsByPaymentType.paymentType","Card",n):oe.call(e,"ifeq","cancelPaymentsByPaymentType.paymentType","Card",n),(s||0===s)&&t.buffer.push(s),t.buffer.push('\r\n                            <td class="top">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.currency.value"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                            </td>\r\n                            <td class="top text-right">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.amount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                            </td>\r\n                            <td class="top text-right">\r\n                                '),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.baseCurrencyAmount"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function Z(e,t){return t.buffer.push("\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.bankName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("/"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.branchCode"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.accountHolderName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            <td>\r\n                                "),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"row.chequeNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n                            </td>\r\n                            "),""}function X(e,t){var s;return t.buffer.push("\r\n                        "),s=a.each.call(e,"item","in","cancelPaymentsByPaymentType.totalByCurrencies",{hash:{},hashTypes:{},hashContexts:{},inverse:se.noop,fn:se.program(77,ee,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(s||0===s)&&t.buffer.push(s),t.buffer.push("\r\n                        "),""}function ee(e,t){return t.buffer.push("\r\n                        <tr>\r\n                            <td "),t.buffer.push(ae(a["bind-attr"].call(e,{hash:{colspan:"cancelPaymentsByPaymentType.colSpanForCurrency"},hashTypes:{colspan:"STRING"},hashContexts:{colspan:e},contexts:[],types:[],data:t}))),t.buffer.push(' class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.onlinetill:shift.totalByCurrency~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("&nbsp;"),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.currency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.totalByCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</b>\r\n                            </td>\r\n                            <td class="text-right">\r\n                                <b>'),t.buffer.push(ae(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.totalByBaseCurrency"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</b>\r\n                            </td>\r\n                        </tr>\r\n                        "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),o=o||{};var te,ae=this.escapeExpression,se=this,oe=a.helperMissing;return o.buffer.push('<div class="modal-max-size">\r\n    '),te=a.if.call(t,"view.context.data.spooling",{hash:{},hashTypes:{},hashContexts:{},inverse:se.program(3,r,o),fn:se.program(1,n,o),contexts:[t],types:["ID"],data:o}),(te||0===te)&&o.buffer.push(te),o.buffer.push("\r\n</div>"),""}),Komodo.Models.OnlineTill=Ember.Namespace.createWithMixins(LoggingMixin,{name:"Komodo.Models.OnlineTill"}),Komodo.Models.OnlineTill.SRQLineItemModel=Ember.Object.extend({init:function(){this.isFirst="",this.quoteLineItemId="",this.adjustmentAmount="",this.amount="",this.baseAmount="",this.startDate="",this.endDate="",this.period="",this.invoiceText="",this.taxAmount="",this._super()}}),Komodo.Models.OnlineTill.CRMQuoteLineItemModel=Ember.Object.extend({init:function(){this.productName="",this.productType="",this.quantity="",this.quotedUnitPrice="",this.totalPrice="",this.deviceSerialNumber="",this.model="",this._super()}}),Komodo.Models.OnlineTill.SRQModel=Ember.Object.extend({init:function(){this.quoteId="",this.createdByUser="",this.financialAccountId="",this.fulfillmentDate="",this.quoteDateTime="",this.replacedByQuoteId="",this.totalAmount="",this.isSelected=!0,this.previousIsSelectedState=!0,this.subTotal=0,this.balance=0,this.quoteLineItems=[],this.srqStatus="No",this._super()}}),Komodo.Models.OnlineTill.SupervisorApprovalModel=Ember.Object.extend({init:function(){this.supervisorUsername="",this.passCode="",this.disableAction=!1,this._super()}}),Komodo.Models.UpdateExchangeRatesInformationModel=Ember.Object.extend({init:function(){this.currencyId=void 0,this.currencyCode=void 0,this.currencyDescription=void 0,this.roundingFormula=void 0,this.taxFormula=void 0,this.exchangeRate=void 0,this.isSelected=void 0,this.isDefault=void 0,this.activeDate=void 0,this.baseCurrency=void 0,this.baseCurrencyDescription=void 0,this._super()}}),Komodo.Models.UpdateExchangeRatesModel=Ember.Object.extend({init:function(){this.observeProperty=void 0,this.updateExchangeRatesInformation=[],this.exchangeRatesHistory=[],this._super()}}),Komodo.Application.ShiftManagementView=Komodo.UI.View.extend({viewKey:"ShiftManagementView"}),Komodo.Application.SupervisorApprovalView=Komodo.UI.View.extend({viewKey:"SupervisorApprovalView",templateName:"SupervisorApprovalView"}),Komodo.Application.UseCreditView=Komodo.UI.View.extend({viewKey:"UseCreditView",templateName:"UseCreditView"}),Komodo.Application.UpdateExchangeRatesView=Komodo.UI.View.extend({viewKey:"UpdateExchangeRatesView"}),Komodo.Models.OnlineTill.RetrieveCustomers=Ember.Object.extend({init:function(){this.Country=void 0,this.UserName=void 0,this.Key=void 0,this.Value=void 0,this._super()}}),Komodo.Application.BatchPaymentReportView=Komodo.UI.View.extend({viewKey:"BatchPaymentReportView"}),Komodo.Models.OnlineTill.AccountModel=Ember.Object.extend({init:function(){this.accountNumber="",this.type="",this.methodOfPayment="",this.status="",this.displayText="",this.chargeuntildate="",this.overdue="",this.currencyCode="",this.isDefault=!1,this.balance=0,this.selected=!1,this.quotes=[],this.products=[],this._super()}}),Komodo.Application.BatchPaymentView=Komodo.UI.View.extend({viewKey:"BatchPaymentView",templateName:"BatchPaymentView"}),Komodo.Models.OnlineTill.BatchPaymentReportModel=Ember.Object.extend({init:function(){this.header="",this.country="",this.batchNumber="",this.date="",this.time="",this.userName="",this.currency="",this.agent="",this.smsAccount="",this.bankDepositNumber="",this.currency="",this.spooling=!0,this.spoolingPercentage="0%",this.showOfflinePaymentView=!1,this.stockHandlerDescription="",this.summaryGridData=[],this.detailGridData=[],this._super()},isBankDepositNumberVisible:function(){return null!==this.bankDepositNumber&&void 0!==this.bankDepositNumber&&""!==this.bankDepositNumber&&"object"!=typeof this.bankDepositNumber}.property("this.bankDepositNumber")}),Komodo.Models.OnlineTill.CancelPaymentModel=Ember.Object.extend({init:function(){this.shiftNumber="",this.paymentId="",this.amount="",this.currency="",this.currencyRate="",this.date="",this.paymentType="",this.isCancelled="",this.isSplit="",this.isCashSale="",this.disableAction="",this.reason="",this.supervisorUsername="",this.passCode="",this.enableFiscalization=!1,this.enableInvoice=!1,this.SplitPayments=[],this._super()}}),Komodo.Models.OnlineTill.CloseShiftsModel=Ember.Object.extend({init:function(){this.shiftId="",this.bdNumber="",this.cashierName="",this.shiftType="",this.startDate="",this.endDate="",this.selectedCashierName="",this.selectedshift="",this.isGridVisible=!1,this.isMessageVisible=!1,this.shiftData=[],this._super()},selectedGridItem:void 0,commandGridItem:void 0,commandGridItemType:void 0,shiftStatuses:[],shiftTypes:[],currencies:[]}),Komodo.Application.CashSalePaymentView=Komodo.UI.View.extend({viewKey:"CashSalePaymentView",templateName:"CashSalePaymentView"}),Komodo.Models.OnlineTill.CustomerDetailModel=Ember.Object.extend({init:function(){this.SMSAccount="",this.typeOfPrinter="",this.typeOfPayment="",this.currency="",this.currencyRate="",this.cash="",this.other="",this.total="",this.splitPayments="",this.totalPaymentAmount="",this.amountCaptured="",this.balance="",this.customerNumber="",this.accountNumber="",this.invoiceNumber="",this.paymentAmount="",this._super()}}),Komodo.Application.CreditCardView=Komodo.UI.View.extend({viewKey:"CreditCardView",didInsertElement:function(){var e=this.get("context.data");e&&e.selectedPrinter&&e.set("printer",e.selectedPrinter)}}),Komodo.Models.OnlineTill.CustomerModel=Ember.Object.extend({init:function(){this.customerNumber="",this.title="",this.customerFirstname="",this.customerSurname="",this.customerName="",this.customerClass="",this.customerType="",this.address="",this.accountCount="",this.payAmount="",this.email="",this.telNo="",this.mobileNo="",this.customerStatus="",this.balanceDue="",this.dueDate="",this.locationIndicator="",this.isActiveCustomer=!0,this.isDstv=!1,this.isGotv=!1,this.businessUnit=!1,this.isCommercialCustomer=!1,this.rdChequeStatus=void 0,this.accounts=[],this.accountToSelect=void 0,this.quotes=[],this.quote=void 0,this._super()},multiAccount:function(){return void 0!==this.accounts&&this.accounts.length>2}.property("accounts"),account:void 0}),Komodo.Models.OnlineTill.SearchCustomerModel=Ember.Object.extend({init:function(){this.searchText="",this.resultMsg="",this.searchResultSet=[],this.isButtonVisible=!1,this.isMultiSelectVisible=!1,this.isPreviousDisable=!1,this.isNextDisable=!1,this._super()}}),Komodo.Application.CustomerDetailsView=Komodo.UI.View.extend({viewKey:"CustomerDetailsView"}),Komodo.Models.OnlineTill.OfflinePaymentModel=Ember.Object.extend({init:function(){this.customerNumber="",this.accountType="",this.paymentType="",this.payAmount="",this.syncStatus="",this.WasOffline="",this.Synced="",this.paymentDate="",this.isCancelled="No",this.offlineMessageId="",this.cancelPublished=!1,this.failedMessage="",this._super()}}),Komodo.Application.CustomerPaymentView=Komodo.UI.View.extend({viewKey:"CustomerPaymentView",templateName:"CustomerPaymentView"}),Komodo.Application.SplitPaymentView=Komodo.UI.View.extend({viewKey:"SplitPaymentView",templateName:"SplitPaymentView"}),Komodo.Application.EmailReceiptConfirmView=Komodo.UI.View.extend({viewKey:"EmailReceiptConfirmView"}),Komodo.Models.OnlineTill.PaymentOverrideModel=Ember.Object.extend({init:function(){this.message="",this.supervisorUsername="",this.passCode="",this.disableAction="",this._super()}}),Komodo.Application.OfflinePaymentSyncingView=Komodo.UI.View.extend({viewKey:"OfflinePaymentSyncingView"}),Komodo.Models.OnlineTill.PaymentReportModel=Ember.Object.extend({init:function(){this.report="",this.cashierName="",this.shiftId="",this.bdNumber="",this.shiftStatus="",this.startDate="",this.endDate="",this.selectedReport="",this.selectedCashierName="",this.isGridVisible=!1,this.isMessageVisible=!1,this.shiftData=[],this._super()},selectedGridItem:void 0,commandGridItem:void 0,commandGridItemType:void 0,shiftStatuses:[],shiftTypes:[],currencies:[],reports:[]}),Komodo.Application.PaymentOverrideView=Komodo.UI.View.extend({viewKey:"PaymentOverrideView"}),Komodo.Models.OnlineTill.PrintingModel=Ember.Object.extend({init:function(){this._super(),this.UID="",this.printerName="",this.printerType="",this.assetTag="",this.ipAddress="",this.isActive="",this.printerLayout="",this.searchAssetTag="",this.userName=""},selectedGridItem:void 0,commandGridItem:void 0,commandGridItemType:void 0,isUpdateButtonVisible:!1,printers:[]}),Komodo.Application.PaymentReportView=Komodo.UI.View.extend({viewKey:"PaymentReportView"}),Komodo.Application.CancelPaymentView=Komodo.UI.View.extend({viewKey:"CancelPaymentView"}),Komodo.Application.PaymentView=Komodo.UI.View.extend({viewKey:"PaymentView",templateName:"PaymentView"}),Komodo.Models.OnlineTill.ProductModel=Ember.Object.extend({init:function(){this.accountNumber="",this.productId="",this.hardware="",this.productName="",this.productType="",this.smartcardNumber="",this._super()}}),Komodo.Application.PrintReceiptView=Komodo.UI.View.extend({viewKey:"PrintReceiptView",didInsertElement:function(){var e=this.get("context.data");e&&e.selectedPrinter&&e.set("printer",e.selectedPrinter)}}),Komodo.Models.OnlineTill.RealtimeOptionModel=Ember.Object.extend({init:function(){var e=function(e,t){var a=Komodo.Models.SampleProductData.create();return a.set("isSelected",!1),a.set("productName",e),a.set("productCode",t),a};this.payByDate="",this.autoReconnect="",this.invoicePeriod="",this.nextInvoiceDate="",this.smartcardNumber="",this.set("gridData",[]),this.get("gridData").push(e("Dual View Access Charge Ku-Band","DUALPK")),this.get("gridData").push(e("DStv Family Bouquet KU","COFAMKU")),this.get("gridData").push(e("High Definition KU Bouquet","HD1KU")),this.get("gridData").push(e("M-Net Domestic Stand Alone Ku-Band","MND")),this.get("gridData").push(e("North Indian Addon to MINIB Bouq KU-Band","ASIAMB")),this.get("gridData").push(e("Combined Indian Addon Bouq KU-Band","ASIA3PK")),this.get("gridData").push(e("PVR Access Service","PVRPK")),this.get("gridData").push(e("PORTPK- Portuguese Add-On Bouquet","PORTPK")),this.get("gridData").push(e("PORTMB- Port Add-On Bouquet for MINIB","PORTMB")),this.get("gridData").push(e("South Indian Standalone Bouq KU-Band","ASIA2KU")),this.get("gridData").push(e("Standard Digital Terrestrial Bouq","MSDTT")),this.get("gridData").push(e("Add2 Secondary Product","ADD2SEC")),this.get("gridData").push(e("HD Access Service","HDPVRPK")),this.get("gridData").push(e("Premium Bouquet (KU-Band)","PRM")),this.get("gridData").push(e("Premium minus M-Net (KU-Band)","PMM")),this.selectedGridItem=void 0,this.commandGridItem=void 0,this.commandGridItemType=void 0,this._super()}}),Komodo.Models.SampleProductData=Ember.Object.extend({init:function(){this.isSelected="",this.productName="",this.productCode="",this._super()}}),Komodo.Application.QuoteDetailsView=Komodo.UI.View.extend({viewKey:"QuoteDetailsView"}),Komodo.Models.OnlineTill.ReceiptModel=Ember.Object.extend({init:function(){this.ReceiptDate=void 0,this.CashierName=void 0,this.ReceiptNumber=void 0,this.CustomerID=void 0,this.AccountID=void 0,this.CustomerName=void 0,this.Address=void 0,this.CellNumber=void 0,this.SmartcardNumber=void 0,this.Package=void 0,this.Discount=void 0,this.Hardware=void 0,this.Insurance=void 0,this.ViewingPeriod=void 0,this.NextPaymentDate=void 0,this.MethodOfPayment=void 0,this.Currency=void 0,this.TotalAmountExclTax=void 0,this.Tax=void 0,this.TaxPercentage=void 0,this.TotalAmountInclTax=void 0,this.Amount=void 0,this.BaseCurrencyAmount=void 0,this.BaseTenderedAmount=void 0,this.ChangeOwed=void 0,this.Change=void 0,this.BusinessUnit=void 0,this.QuotationID=void 0,this.InvoiceDetail=void 0,this.FiscalDocument=void 0,this.IsTaxInvoice=!1,this.IsReprint=void 0,this.IsCancelled=void 0,this.IsRefund=void 0,this.IsOffline=void 0,this.IsCashSale=void 0,this.IsSplit=void 0,this._super()}}),Komodo.Application.RealtimeOptionView=Komodo.UI.View.extend({viewKey:"RealtimeOptionView"}),Komodo.Models.OnlineTill.ReprintReceiptModel=Ember.Object.extend({init:function(){this.shiftNumber="",this.paymentId="",this.receiptNumber="",this.customerNumber="",this.accountNumber="",this.quoteId="",this.financialTransactionId="",this.enableFiscalization=!1,this.amount="",this.currency="",this.currencyRate="",this.date="",this.paymentType="",this.isCancelled="",this.isSplit="",this.disableAction="",this.supervisorUsername="",this.passCode="",this._super()}}),Komodo.Application.ReprintReceiptView=Komodo.UI.View.extend({viewKey:"ReprintReceiptView"}),Komodo.Models.OnlineTill.SearchResultModel=Ember.Object.extend({init:function(){this.searchResult=void 0,this.isSelected=!1,this.multiSelect=!0,this.addVisible=!1,this._super()}}),Komodo.Application.SearchView=Komodo.UI.View.extend({viewKey:"SearchView"}),Komodo.Models.OnlineTill.ShiftDetailModel=Ember.Object.extend({init:function(){this.paymentId="",this.amount="",this.baseCurrencyAmount="",this.currency="",this.currencyRate="",this.date="",this.paymentType="",this.isCashSale="",this.isCancelled="",this.isRefund="",this.isSplit="",this.isOffline="No",this.enableFiscalization=!1,this.enableInvoice=!1,this.sortId="",this.accountHolderName="",this.bankName="",this.chequeAccountNumber="",this.branchName="",this.branchCode="",this.chequeDate="",this.chequeNumber="",this.cardNumber="",this.cardAuthNumber="",this.cardCVVNumber="",this.cardExpiryDate="",this.SplitPayments=[],this._super()},disableCancel:function(){return"Yes"===this.isCancelled||"Yes"===this.isRefund||!0===this.isRefund}.property("this.isCancelled","this.isRefund")}),Komodo.Models.OnlineTill.SplitPaymentModel=Ember.Object.extend({init:function(){this.isFirst="",this.receiptNumber="",this.customerNumber="",this.accountNumber="",this.quoteId="",this.financialTransactionId="",this.amount="",this.baseCurrencyAmount="",this.currency="",this.customerName="",this.businessUnit="",this._super()}}),Komodo.Models.OnlineTill.ShiftSummaryModel=Ember.Object.extend({init:function(){this.currency="",this.paymentType="",this.count="",this.cancelledCount="",this.amount="",this._super()}}),Komodo.Application.ShiftDetailsContainerView=Komodo.UI.View.extend({viewKey:"ShiftDetailsContainerView"}),Komodo.Models.OnlineTill.ShiftDetailsReportModel=Ember.Object.extend({init:function(){this.header="",this.country="",this.shiftNumber="",this.date="",this.time="",this.userName="",this.status="",this.bankDepositNumber="",this.currency="",this.spooling=!0,this.spoolingPercentage="0%",
this.showOfflinePaymentView=!1,this.stockHandlerDescription="",this.summaryGridData=[],this.detailGridData=[],this.cancelledGridData=[],this._super()},isBankDepositNumberVisible:function(){return null!==this.bankDepositNumber&&void 0!==this.bankDepositNumber&&""!==this.bankDepositNumber&&"object"!=typeof this.bankDepositNumber}.property("this.bankDepositNumber"),isCancelledGridDataVisible:function(){return null!==this.cancelledGridData&&void 0!==this.cancelledGridData&&this.cancelledGridData.length>0}.property("this.cancelledGridData"),detailGridDataTotal:function(){var e=0;return null!==this.detailGridData&&void 0!==this.detailGridData&&this.detailGridData.length>0&&$(this.detailGridData).each(function(t,a){e+=parseFloat(a.baseCurrencyAmount)}),parseFloat(e).toFixed(2)}.property("this.detailGridData"),cancelledGridDataTotal:function(){var e=0;return null!==this.cancelledGridData&&void 0!==this.cancelledGridData&&this.cancelledGridData.length>0&&$(this.cancelledGridData).each(function(t,a){e+=parseFloat(a.baseCurrencyAmount)}),parseFloat(e).toFixed(2)}.property("this.cancelledGridData")}),Komodo.Application.ShiftDetailsReportView=Komodo.UI.View.extend({viewKey:"ShiftDetailsReportView"}),Komodo.Models.OnlineTill.ShiftModel=Ember.Object.extend({init:function(){this.shiftId="",this.glNumber="",this.bdNumber="",this.status="",this.date="",this.dateString="",this.type="",this.supervisorId="",this.stockHandlerId="",this.stockHandlerName="",this.stockHandlerDescription="",this.cash=0,this.other=0,this.total=0,this.totalString="0.00",this.userName="",this.baseCurrency="",this.shiftDetails=[],this.shiftSummary=[],this.cancelledPayments=[],this.printers=[],this.stockHandlers=[],this.allowedCurrencies=[],this._super()}}),Komodo.Application.ShiftDetailsView=Komodo.UI.View.extend({viewKey:"ShiftDetailsView"}),Komodo.Application.UpdateExchangeRatesController=Komodo.UI.Controller.extend({_localeBase:"locale.onlinetill:",showExchangeRateInfo:!1,observeProperty:!1,noexchangeratemsg:!1,init:function(){Komodo.log("Constructing Manage Exchange Rates controller"),this.set("processVersion","v1.1"),this.set("processName","Case History service"),this.set("showExchangeRateInfo",!1),this.registerModel("updateExchangeRatesModel",Komodo.Models.UpdateExchangeRatesModel),this._super()},start:function(){this.getExchangeRateForCurrentCoutry(),this.set("observeProperty",!1),this.set("noexchangeratemsg",!1),this.set("showExchangeRateInfo",!1),this.set("updateExchangeRatesModel",Komodo.Models.UpdateExchangeRatesModel.create()),this.get("updateExchangeRatesModel").updateExchangeRatesInformation.clear(),this.set("updateExchangeRatesInformation",Komodo.Models.UpdateExchangeRatesInformationModel.create()),this.set("loggedInCountryName",void 0),this.registerValidation(),this.set("showExchangeRateInfo",!1),this.set("showExchangeRateHistoryInfo",!1),this._super()},mapExchangeRateInfoModel:function(e,t,a){var s=Komodo.Models.UpdateExchangeRatesInformationModel.create();return s.currencyId=e.CurrencyId,s.currencyCode=e.Mnemonic,s.currencyDescription=e.CurrencyDescription,s.exchangeRate=e.ConversionFactor,s.activeDate=this.getFormattedDate(e.StartDate),s.isDefault=t,s.isSelected=!1,s.baseCurrency=a.Mnemonic,s.baseCurrencyDescription=a.CurrencyDescription,s},mapexchangeRatesHistoryInfoModel:function(e,t){var a=Komodo.Models.UpdateExchangeRatesInformationModel.create();return a.exchangeRate=e.ConversionFactor,a.startDate=this.getFormattedDate(e.StartDate),a},getCDMData:function(){var e=this;Komodo.Repositories.cacheRepository.fetch(Komodo.CacheKeys.selectedCountry).done(function(t){e.set("loggedInCountryName",t.data.countryDescription),Komodo.Services.cachedDataService.fetch("Location").done(function(e){JSON.parse(e);Komodo.Services.cachedDataService.fetch("CountryISO").done(function(e){}).fail(function(){Komodo.log("[ERROR] : could not retrieve CountryISO domain = "+quoteCountry+"/ qualifier = "+language)})}).fail(function(){Komodo.log("[ERROR] : could not retrieve Location domain = "+quoteCountry+"/ qualifier = "+language)})})},registerValidation:function(){var e=this;e.registerValidator(e.get("updateExchangeRatesInformation"),"exchangeRate",{isRequired:!0,type:"string",maxLength:30,regExPattern:"^[^-+!@#$%&_a-zA-Z ][0-9]*(.[0-9]{1,100})?$"}),e.registerValidator(e.get("updateExchangeRatesInformation"),"dateActive",{type:"date",isRequired:!0,functions:this.registerCustomValidation,minDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())})},getExchangeRateForCurrentCoutry:function(){this.getCDMData();var e=this.get("loggedInCountryName"),t=this;Komodo.Services.queryService.getJSON("/AccountProfile/GetExchangeRates?countryName="+e).done(function(e){t.bindExchangeGrid(e)}).error(function(e){var a=JSON.stringify(e);null!=e.responseJSON||void 0!=e.responseJSON?Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.techerror"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,this,"id5446673","error"):Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.techerror"),kl.value(t._localeBase+"updateExchangeRate.techerrormsg"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","error"),Komodo.log("Get Exchange Rate ajax call failed. Error: "+a)})},bindExchangeGrid:function(e){if(this.get("updateExchangeRatesModel").updateExchangeRatesInformation.clear(),e){if(e.OtherCurrencies&&e.OtherCurrencies.length>0){this.set("observeProperty",!0),this.set("noexchangeratemsg",!1);for(var t=0;t<e.OtherCurrencies.length;t++)this.get("updateExchangeRatesModel").updateExchangeRatesInformation.addObject(this.mapExchangeRateInfoModel(e.OtherCurrencies[t],!1,e.DefaultCurrency))}}else this.set("noexchangeratemsg",!0),this.set("observeProperty",!1)},bindexchangeRatesHistoryGrid:function(e){if(this.set("showExchangeRateInfo",!1),this.set("showExchangeRateHistoryInfo",!0),this.get("updateExchangeRatesModel").exchangeRatesHistory.clear(),e&&e.OtherCurrencies&&e.OtherCurrencies.length>0){this.set("observeProperty",!0),this.set("noexchangeratemsg",!1),e.OtherCurrencies=e.OtherCurrencies.sortBy("StartDate").reverse();for(var t=0;t<e.OtherCurrencies.length;t++)this.get("updateExchangeRatesModel").exchangeRatesHistory.addObject(this.mapexchangeRatesHistoryInfoModel(e.OtherCurrencies[t],!1))}},setGridColumn:function(){var e=this;e.set("dataGridUpdateExchangeColumns",[Komodo.Controls.DataGridColumn.create({name:"currencyId",title:kl.value(e._localeBase+"updateExchangeRate.currencyId"),canEdit:!1,width:"150px",type:"string"}),Komodo.Controls.DataGridColumn.create({name:"currencyCode",title:kl.value(e._localeBase+"updateExchangeRate.curencyCode"),canEdit:!1,width:"150px"}),Komodo.Controls.DataGridColumn.create({name:"currencyDescription",title:kl.value(e._localeBase+"updateExchangeRate.currencyDescription"),canEdit:!1,width:"150px"}),Komodo.Controls.DataGridColumn.create({name:"exchangeRate",title:kl.value(e._localeBase+"updateExchangeRate.exchangeRate"),canEdit:!1,width:"100px"}),Komodo.Controls.DataGridRadioButtonColumn.create({name:"isSelected",title:kl.value(e._localeBase+"updateExchangeRate.update"),displayType:"radiobutton",canEdit:!0,isAlwaysEditing:!0,width:"50px"})])},actions:{updateExchange:function(){var e=this.get("updateExchangeRatesInformation"),t=this;if(this.validators.exchangeRateValidator.errors.length>0)return void Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.errormssg"),kl.value(t._localeBase+"updateExchangeRate.retemsg"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","warning");if(this.validators.dateActiveValidator.errors.length>0)return void Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.updateExchangeRateTitle"),kl.value(t._localeBase+"updateExchangeRate.dateErrorMessage"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","warning");var a=t.getDateFromJavascriptDate(e.get("dateActive"));Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.confirmupdation"),kl.value(t._localeBase+"updateExchangeRate.confirmmsg"),Komodo.Controls.MessageBoxYesNoButtons,this,"id5446673","alert").response=function(s){"yes"==s&&(t.updateExchangeRate=new Object,t.updateExchangeRate.CurrencyId=e.get("currencyId"),t.updateExchangeRate.StartDate=a,t.updateExchangeRate.ConversionFactor=e.get("exchangeRate"),t.updateExchangeRate.CurrencyDescription=e.get("currencyDescription"),t.updateExchangeRate.IsDefaultCurrency=e.get("isDefault"),t.updateExchangeRate.Mnemonic=e.get("currencyCode"),t.updateExchangeRatePublish(t.updateExchangeRate))}},selectExchangeRate:function(e){this.editSelectedCurrency(e.get("content")),this.set("showExchangeRateInfo",!0),this.set("showExchangeRateHistoryInfo",!1)},ViewCurrencyExchangeRateHistory:function(e){this.editSelectedCurrency(e.get("content")),this.viewCurrencyHistoryByCurrencyID(e.get("content"))}},editSelectedCurrency:function(e){try{var t=e,a=this.get("updateExchangeRatesInformation");a.set("currencyId",t.currencyId),a.set("currencyCode",t.currencyCode),a.set("currencyDescription",t.currencyDescription),a.set("isDefault",t.isDefault),a.set("isSelected",t.isSelected)}catch(e){this.handleException("updateExchangeRatesModel",e,!0,!0)}},viewCurrencyHistoryByCurrencyID:function(e){var t=this;Komodo.Services.queryService.getJSON("/AccountProfile/GetExchangeRateByCurrencyID?currencyId="+e.currencyId).done(function(e){t.bindexchangeRatesHistoryGrid(e)})},updateExchangeRatePublish:function(e){var t=this;Komodo.Services.queryService.postJSON("/AccountProfile/CreateExchangeRate",{data:e}).done(function(e){if(e>0){t.getExchangeRateForCurrentCoutry(),Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.successmssg"),kl.value(t._localeBase+"updateExchangeRate.exchangeupdatesuccess"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","success");var a=t.get("updateExchangeRatesInformation");a.set("exchangeRate",""),a.set("currencyDescription",""),a.set("currencyCode",""),a.set("dateActive",""),t.set("showExchangeRateInfo",!1)}}).error(function(e){var a=JSON.stringify(e);null!=e.responseJSON||void 0!=e.responseJSON?Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.techerror"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,this,"id5446673","error"):Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"updateExchangeRate.techerror"),kl.value(t._localeBase+"updateExchangeRate.techerrormsg"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","error"),Komodo.log("Update Exchange Rate ajax call failed. Error: "+a)})},getDateFromJavascriptDate:function(e){function t(e){var t=e.toString();return t.length<2?"0"+t:t}var a=e.getFullYear();return t(e.getMonth()+1)+"-"+t(e.getDate())+"-"+a},registerCustomValidation:function(e,t,a){var s=Ember.A();e[Object.keys(e)[0]];a=a||{};var o=a.displayName;if(e.hasOwnProperty("runCycle")&&"1"===t.campaignType&&"4"===t.runCycle)return s.addObject(kl.value("locale.campaign:createCampaign.runCycleCannotBeManual",{displayName:o})),s;if(e.hasOwnProperty("reviewDate")&&"2"!==t.campaignType){if(!t.get("reviewDate"))return s.addObject(kl.value("locale.campaign:createCampaign.reviewDateRequired",{displayName:o})),s;if(new Date(t.get("executionDate"))>=new Date(t.get("reviewDate")))return s.addObject(kl.value("locale.campaign:createCampaign.reviewDateAndExecutionDate",{displayName:o})),s}else if(e.hasOwnProperty("expiryDate")&&"1"!==t.campaignType){if(!t.get("expiryDate"))return s.addObject(kl.value("locale.campaign:createCampaign.expiryDateRequired",{displayName:o})),s}else if(e.hasOwnProperty("campaignName")){if(void 0!==t.campaignName&&t.campaignName.length>100)return s.addObject(kl.value("locale.campaign:createCampaign.campaignNameLength",{displayName:o})),s}else if(e.hasOwnProperty("executionDate")){if("-1"!==t.runCycle&&"4"!==t.runCycle&&!t.get("executionDate"))return s.addObject(kl.value("locale.campaign:createCampaign.executionDateRequired",{displayName:o})),s}else if(e.hasOwnProperty("numberOfCustomersTargeted")){if(void 0!==t.numberOfCustomersTargeted){if(isNaN(t.numberOfCustomersTargeted))return s.addObject(kl.value("locale.campaign:createCampaign.numberOfCustomersTargetedNumbers",{displayName:o})),s;if(t.numberOfCustomersTargeted>1e9||t.numberOfCustomersTargeted<1)return s.addObject(kl.value("locale.campaign:createCampaign.numberOfCustomersTargetedLimit",{displayName:o})),s}}else if(e.hasOwnProperty("platforms")){var n=!1;if(void 0!==t.platforms&&$.each(t.platforms,function(e,t){t.isChecked&&(n=!0)}),!n)return s.addObject(kl.value("locale.campaign:createCampaign.distributionPlatformRequired",{displayName:o})),s}else if(e.hasOwnProperty("languages")&&"1"===t.isTranslationRequired){var r=!1;if(void 0!==t.languages&&$.each(t.languages,function(e,t){t.isChecked&&(r=!0)}),!r)return s.addObject(kl.value("locale.campaign:createCampaign.languageRequired",{displayName:o})),s}return s},selectedRow:function(){var e=this;try{$.each(e.get("updateExchangeRatesModel.updateExchangeRatesInformation"),function(t,a){if(null!=a.isSelected&&1==a.isSelected)return e.editSelectedCurrency(a),!1})}catch(e){this.handleException("selectedRow",e,!0,!0)}}.observes("updateExchangeRatesModel.updateExchangeRatesInformation.@each.isSelected"),getFormattedDate:function(e){var t="";if("0001-01-01T00:00:00"===e)return"";if(e){var a=e.split("T"),s=new Date(a[0]),o=s.getDate();o=o<10?"0"+o.toString():o.toString();var n=s.getMonth()+1;n=n<10?"0"+n.toString():n.toString();t=o+"-"+n+"-"+s.getFullYear()}return t},stop:function(){this.set("showExchangeRateInfo",!1),this.set("observeProperty",!1),this.set("noexchangeratemsg",!1),this._super()}}),Komodo.Models.OnlineTill.PrintReceiptModel=Ember.Object.extend({init:function(){this._super()},showBusyIndicator:!1,disablePayment:!1,printer:void 0,selectedPrinter:void 0,receiptData:void 0,printers:void 0,selectedEmail:void 0,displayEmailSelectList:!1,email:[],displayEmailReceiptOption:!1,printerChanged:function(){var e,t=this,a=t.receiptData;if(a){void 0==a.length?(e=new Array,e[0]=a):e=a;var s="";void 0!==t.printer&&(s=t.printer.layout);var o="";try{var n=JSON.parse('{"root": {"Payload": {"ListOfPayments":'+JSON.stringify(e)+"} } }"),o=TrimPath.parseDOMTemplate("printPreview",s).process(n)}catch(e){console.log("Error while parsing printer template: "+e)}$("#printPreview").html(o)}}.observes("printer")}),Komodo.Models.OnlineTill.PaymentModel=Ember.Object.extend({init:function(){this.cashierName="",this.currencyRate="",this.cash="",this.other="",this.total="",this.balance="",this.amountLeft="",this.amountCaptured="",this.baseAmount="",this.customerNumber="",this.shiftNumber="",this.baseCurrency="",this.shiftType="",this.generalLedger="",this.bankDepositNumber="",this.autoReconnectProducts="",this.disableReconnectProducts=!0,this.stockHandlerId="",this.stockHandlers=[],this.allowedCurrencies=[],this.amountTendered="",this.changeOwed="0",this.isChequePaymentVisible=!1,this.drawerName="",this.chequeNumber="",this.chequeBank="",this.chequeBranch="",this.chequeBranchCode="",this.chequeAccountNumber="",this.chequeDate="",this.isCardPaymentVisible=!1,this.cardType="",this.cardHolder="",this.cardNumber="",this.expiryDate="",this.authorisationNumber="",this.cvcNumber="",this.searchText="",this.enableMakePayment="",this.isCustomerPayment=!1,this.isSplitPayment=!1,this.isBatchPayment=!1,this.isBankDepositNumberVisible=void 0,this.isAutoReconnectVisible=void 0,this.set("isBankDepositNumberVisible",!1),this.set("isAutoReconnectVisible",!1),this.gridData=[],this.productGridData=[],this.quoteGridData=[],this.customer=void 0,this.customers=void 0,this.srqCustomer=void 0,this.quote=void 0,this.isCashSalePayment="",this.showQuoteInformation="",this.showQuoteGrid="",this.quoteId="",this.quoteAmount="",this.quoteStatus="",this.quoteSAPStatus="",this.isQuoteQuantityShort=!1,this.isRepairQuotePassed=!0,this.isCommercialCustomer=!1,this.refundPayment=!1,this.disableAmountTendered=!1,this.useIntegratedCardPayment=!1,this.useHardwareAndSoftwareSplitQuote=!0,this.isRefundAvailable=!1,this.enableFiscalization=!1,this.enableInvoice=!1,this.businessUnit="",this.reprintSupervisorApprovalRequired=!0,this.enableAmountLowestDenomination=!0,this.updateRDFlag=!0,this.defaultCardPaymentMethod=!1,this.isOffLine=!1,this.isStockHandlerChanged=!1,this.filesToUpload=[],this.accountTypes=[],this.enableEmailReceipt=!1,this.validateRepairQuotePayment=!1,this._super(),this.set("paymentType",this._getDefaultPaymentType()),this.set("methodOfPayment",this._getDefaultMethodOfPayment()),this.set("printerType",this._getDefaultPrinterType()),this.set("paymentAmount",this._getDefaultPaymentAmount()),this.set("cardType",this._getDefaultMethodOfPaymentSub()),this.originalQuoteAmount=0},selectedGridItem:void 0,commandGridItem:void 0,commandGridItemType:void 0,methodOfPayment:void 0,methodOfPayments:["Cash","Card","Cheque"],_getDefaultMethodOfPayment:function(){return this.defaultCardPaymentMethod?"Card":"Cash"},methodOfPaymentChanged:function(){if(this.set("isChequePaymentVisible",!1),this.set("isCardPaymentVisible",!1),this.set("disableCurrency",!1),this.allowedCurrencies&&this.allowedCurrencies.length>1){var e=this.get("baseCurrency"),t=$.grep(this.allowedCurrencies,function(t){return t.value==e});void 0!==t&&null!=t&&t.length>0&&!0}"Cheque"===this.methodOfPayment?(this.set("isChequePaymentVisible",!0),this.set("chequeDate",new Date)):"Card"===this.methodOfPayment&&this.set("isCardPaymentVisible",!0),this.set("amountTendered",this.paymentAmount)}.observes("methodOfPayment"),methodOfPaymentSubs:[{key:"Visa Credit",value:"1"},{key:"Visa Debit",value:"2"},{key:"Mastercard Credit",value:"3"},{key:"Mastercard Debit",value:"4"},{key:"Maestro Debit",value:"5"}],_getDefaultMethodOfPaymentSub:function(){return this.methodOfPaymentSubs[0]},paymentType:void 0,paymentTypes:[kl.value("locale.onlinetill:home.subTitleCustomerPayment"),kl.value("locale.onlinetill:home.subTitleCashSales"),kl.value("locale.onlinetill:home.subTitleSplitPayment"),kl.value("locale.onlinetill:home.subTitleBatchPayment")],_getDefaultPaymentType:function(){return this.paymentTypes.find(function(e){return e===kl.value("locale.onlinetill:home.subTitleCashSales")})},typeOfPaymentChanged:function(){if(this.set("disableCurrency",!1),this.set("autoReconnectProducts",!1),this.set("disableReconnectProducts",!0),this.set("isCashSalePayment",!1),this.set("isCustomerPayment",!0),this.set("isSplitPayment",!1),this.set("showQuoteInformation",!1),this.set("showQuoteGrid",!1),this.set("isAutoReconnectVisible",!1),this.set("isBatchPayment",!1),this.set("showQuoteGrid",!1),void 0!==this.chequeDate&&this.set("chequeDate",new Date),this.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")){if(this.set("isAutoReconnectVisible",!0),void 0!==this.gridData&&this.gridData.length>1){var e=this.gridData[0];this.gridData.clear(),this.gridData.pushObject(e)}}else this.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")?(this.set("isAutoReconnectVisible",!0),this.set("isSplitPayment",!0)):this.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")?(this.set("isCashSalePayment",!0),this.set("isCustomerPayment",!1),this.set("showQuoteGrid",!0)):this.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")&&(this.set("isBatchPayment",!0),this.set("isSplitPayment",!0),this.allowedCurrencies&&this.allowedCurrencies.length>1&&this.set("disableCurrency",!0));!0===this.enbaleMakePayment&&this.set("paymentAmount",0)}.observes("paymentType"),printerType:"",printerTypes:["Pre-Printed","Blank"],_getDefaultPrinterType:function(){return this.paymentTypes.find(function(e){return"Pre-Printed"===e})},printerTypeChanged:function(){}.observes("printerType"),currency:"",currencies:[],disableCurrency:!1,paymentAmount:"",_getDefaultPaymentAmount:function(){return 0},paymentAmountChanged:function(){this.set("amountTendered",this.paymentAmount)}.observes("paymentAmount"),amountTenderedChanged:function(){var e=0;if(this.paymentAmount&&!1===isNaN(this.paymentAmount)){var t=this.amountTendered&&!1===isNaN(this.amountTendered)?this.amountTendered:0,a=this.amountCaptured&&!1===isNaN(this.amountCaptured)?this.amountCaptured:0;if(e=(t-this.paymentAmount).toFixed(2),(t-a-e).toFixed(2),void 0!==this.currency&&null!==this.currency&&""!==this.baseCurrency&&this.baseCurrency!==this.currency.value){var s=isNaN(e)?0:e,o=isNaN(this.currency.rate)?0:parseFloat(this.currency.rate);o>0&&(e=s*o,e=e.toFixed(2))}}this.set("changeOwed",e)}.observes("amountTendered"),gridDataCommandItemChanged:function(){0===this.gridData.length?this.set("enableMakePayment",!0):this.set("enableMakePayment",!1)}.observes("commandGridItem")}),Komodo.Application.SearchController=Komodo.UI.Controller.extend({isInitiated:!1,searchPopUp:void 0,controller:void 0,callBack:void 0,_pageFrom:null,_pageSize:null,_currentPage:null,_totalCount:0,_documentType:"",_filterEntity:"",popupVisible:!1,customertype:[],country:void 0,countryDescription:void 0,needs:["searchControl","payment"],init:function(){Komodo.log("Constructing OnlineTill Search Customer controller"),this.set("processVersion","v1.1"),this.set("processName","OnlineTill Search Customer process"),this.registerModel("data",Komodo.Models.OnlineTill.SearchCustomerModel),this.set("_pageFrom",0),this.set("_currentPage",0),this.set("_pageSize",parseInt(KomodoConfiguration.elasticSearchConfig.numberOfRecords)),this.set("_documentType","customerprofile"),this.set("_filterEntity","customer"),this.requiresDependency("_systemService",{singleton:Komodo.Services.systemService}),this._super()},start:function(){this.setButtonVisibility(),this.set("popupVisible",!1),this.set("controller",this.get("controllers.searchControl"));var e=this;this.callBack=function(t){var a=e.translateSearchResultSet(t);if(1===a.length){var s=a[0].searchResult,o=[],n=e.bindCustomerModel(s);o.push(n),Komodo.Services.eventAggregator.publish("PublishCustomerSelected",o)}else void 0===e.searchPopUp&&e.set("searchPopUp",Komodo.Application.ModalPaneController.create()),e.get("data").set("searchResultSet",a),e.setButtonVisibility(),e.get("data").set("searchTextPlaceholder",kl.value("locale.onlinetill:customer.searchPlaceholder")),!1===this.get("popupVisible")&&(this.set("popupVisible",!0),e.searchPopUp.popup(kl.value("locale.onlinetill:customer.addCustomer"),null,{view:Komodo.Application.SearchView,context:e,canUserClose:!0}))},this.getCacheData(),this._super()},stop:function(){this._super()},getSystemService:function(){return this.get("_systemService")},isMobileDevice:function(){return this.getSystemService().get("isMobile")}.property(),userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},setCountryUserName:function(e){e.set("Country",this.country),e.set("UserName",this.userName())},showAddCustomer:function(){this.start();var e=this;this.searchPopUp.popup(kl.value("locale.onlinetill:customer.addCustomer"),null,{view:Komodo.Application.SearchView,context:e,canUserClose:!0})},setPageCount:function(e){var t=this.controller;this.set("_pageFrom",t._pageFrom),this.set("_pageSize",parseInt(KomodoConfiguration.elasticSearchConfig.numberOfRecords)),this.set("_currentPage",t._currentPage),void 0===e?this.set("_totalCount",t.searchResultSet.length):this.set("_totalCount",e)},setButtonVisibility:function(){this.data.set("isButtonVisible",!1),this.data.set("isPreviousDisable",!0),this.data.set("isNextDisable",!0),this._totalCount>0?this.data.set("resultMsg",""):this.data.set("resultMsg","No result found"),this._totalCount>this._pageSize&&(this.data.set("isButtonVisible",!0),this._currentPage>1&&this.data.set("isPreviousDisable",!1),0!==this._currentPage&&this._currentPage*this._pageSize<this._totalCount&&this.data.set("isNextDisable",!1))},showBlockingBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,15e3,"blocking",this)},hideBusyIndicator:function(){Komodo.Services.busyService.stop(this.get("processId"),"blocking")},searchCustomer:function(e,t){var a=this.data.searchText;if("string"==typeof e&&(a=e,this.searchPopUp=void 0,this.start()),void 0!==t){this.data.get("").set("isMultiSelectVisible",t)}if(a&&a.length>0)if(!1===Komodo.Services.offlineService.workingOffline())this.set("searchingValue",a),this.set("searchText",a),this.set("_pageFrom",0),this.set("_currentPage",1),this.retrieveElasticSearchData(this.createSearchRequest(a));else{var s=this;Komodo.Repositories.cacheRepository.fetch("Customers").done(function(e){if(a=a.toUpperCase(),e=$.grep(e,function(e){return e.id.toUpperCase()===a||e.number.toUpperCase()===a||e.name.toUpperCase().search(a)>=0||e.mobileNumber.toUpperCase()===a}),1===e.length){var t=[],o=Komodo.Models.OnlineTill.CustomerModel.create();o.set("customerNumber",e[0].number),o.set("customerFirstname",e[0].name),o.set("customerSurname",e[0].name),o.set("customerName",e[0].name),o.set("accounts",e[0].accounts),t.push(o),Komodo.Services.eventAggregator.publish("PublishCustomerSelected",t)}else void 0===s.searchPopUp&&s.set("searchPopUp",Komodo.Application.ModalPaneController.create()),s.get("data").set("searchResultSet",s.translateSearchResultSet(e)),s.setButtonVisibility(),s.searchPopUp.popup(kl.value("locale.onlinetill:customer.addCustomer"),null,{view:Komodo.Application.SearchView,context:{data:s.data},canUserClose:!0})})}},addCustomers:function(){var e=[],t=this,a=this.data.searchResultSet;void 0!==a&&$(a).each(function(a,s){var o=s.searchResult;if(!0===s.isSelected){var n=t.bindCustomerModel(o);e.push(n)}}),e.length>0&&(void 0!==this.searchPopUp&&this.searchPopUp.close(),this.clearAll(),Komodo.Services.eventAggregator.publish("PublishCustomerSelected",e))},addSingleCustomer:function(e){e._parentView.get("content").set("isSelected",!0),this.addCustomers()},clearAll:function(){var e=this.data.searchResultSet;void 0!==e&&$(e).each(function(e,t){t.set("isSelected",!1)})},nextPage:function(){this.searchText&&this._pageFrom+this._pageSize<this._totalCount?(this._pageFrom=this._pageFrom+parseInt(this._pageSize),this._currentPage=this._currentPage+1,this.retrieveElasticSearchData(this.createSearchRequest(this.searchText))):this.data.set("isNextDisable",!0)},previousPage:function(){this.searchText&&this._currentPage>1?(this._pageFrom=this._pageFrom-parseInt(this._pageSize),this._currentPage=this._currentPage-1,this.retrieveElasticSearchData(this.createSearchRequest(this.searchText))):this.data.set("isPreviousDisable",!0)},createSearchRequest:function(e){var t=Komodo.Models.SearchRequest.create();return t.set("SearchText",e),t.set("Searchcountry",this.countryDescription),t.set("Pagefrom",this.get("_pageFrom")),t.set("PageSize",this.get("_pageSize")),t.set("DocumentType",this.get("_documentType")),t.set("DefaultField",KomodoConfiguration.elasticSearchConfig.default_field),t.set("DefaultOperator",KomodoConfiguration.elasticSearchConfig.default_operator),t.set("filterMessage","Filtered by "+this.get("_filterEntity")),t},bindCustomerModel:function(e){var t=this,a=Komodo.Models.OnlineTill.CustomerModel.create(),s=null===e.searchField2||void 0===e.searchField2?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField2.toString())),o=null===e.searchField3||void 0===e.searchField3?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField3.toString())),n=null===e.searchField4||void 0===e.searchField4?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField4.toString())),r=null===e.searchField6||void 0===e.searchField6?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField6.toString())),i=null===e.searchField7||void 0===e.searchField7?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField7.toString())),l=null===e.searchField8||void 0===e.searchField8?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField8.toString())),c=null===e.searchField9||void 0===e.searchField9?"":t.getSearchFieldValueAfterColon(t.removeHtmlFromSearchFields(e.searchField9.toString()));return a.set("customerNumber",isNaN(n)?0:n),a.set("customerFirstname",s),a.set("customerSurname",o),a.set("customerName",t.concatStrings(s,o)),a.set("address",r),i=i.split("</br>").join(","),i=0===i.indexOf(",")?i.substring(1):i,a.set("telNo",i.replace(/(<.*?>)/gi,"")),a.set("mobileNo","+"+i.replace(/(<.*?>)/gi,"")),a.set("email",l.replace(new RegExp("</br>","g"),";").replace(/(<.*?>)/gi,"")),a.set("customerType",c),a.set("customerStatus","Active"),a.set("isDstv",e.isDstv),a.set("isGotv",e.isGotv),a.set("businessUnit",e.businessUnit),a.set("customerClass",e.customerClass),a.set("deviceNumber",e.deviceNumber),a},bindCustomerSearchResult:function(e){var t=Komodo.Models.SearchResultModel.create();t.set("searchField1","Customer");var a="",s=this.getRegExToCreateSearchValue(),o=this.getTokenToHighlightSearchResult();void 0!==e.FirstName?(a=e.FirstName?e.FirstName.replace(s,o):"",t.set("searchField2",a.htmlSafe())):t.set("searchField2",""),void 0!==e.Surname?(a=e.Surname?e.Surname.replace(s,o):"",t.set("searchField3",a.htmlSafe())):t.set("searchField3",""),void 0!==e.BusinessUnit&&(a=e.BusinessUnit?e.BusinessUnit.replace(s,o):"","DSTV"===e.BusinessUnit.toUpperCase()&&t.set("isDstv",!0),"GOTV"===e.BusinessUnit.toUpperCase()&&t.set("isGotv",!0),t.set("businessUnit",e.BusinessUnit.toUpperCase())),void 0!==e.CustomerNumber?(a=e.CustomerNumber?e.CustomerNumber.replace(s,o):"",t.set("searchField4",a.htmlSafe())):t.set("searchField4",""),void 0!==e.IdentityValue?(a=e.IdentityValue?e.IdentityValue.replace(s,o):"",t.set("searchField5",a.htmlSafe())):t.set("searchField5",""),void 0!==e.ListOfAddress&&e.ListOfAddress.length&&e.ListOfAddress.length>0?(a=e.ListOfAddress[0].City?e.ListOfAddress[0].City.replace(s,o):"",t.set("searchField6",a.htmlSafe())):t.set("searchField6","");var n="";if(void 0!==e.ListOfPhoneNumber&&e.ListOfPhoneNumber.length&&e.ListOfPhoneNumber.length>0)for(var r=0;r<e.ListOfPhoneNumber.length;r++){var i=e.ListOfPhoneNumber[r].Code?e.ListOfPhoneNumber[r].Code.replace(s,o):"",l=e.ListOfPhoneNumber[r].Number?e.ListOfPhoneNumber[r].Number.replace(s,o):"";a=i&&l?i+"-"+l:i+l,a=a||"-",n+=r===e.ListOfPhoneNumber.length-1?a:a+"</br>"}else n+="";t.set("searchField7",n.htmlSafe());var c="";if(void 0!==e.ListOfEmail&&e.ListOfEmail.length&&e.ListOfEmail.length>0)for(var u=0;u<e.ListOfEmail.length;u++)a=e.ListOfEmail[u]?e.ListOfEmail[u].replace(s,o):" - ",c+=u===e.ListOfEmail.length-1?a:a+"</br>";else c="";t.set("searchField8",c.htmlSafe());var h=this.getCustomerTypeText(e.CustomerType);return void 0!==h?(h=""!==h?h:"-",t.set("searchField9",h.htmlSafe())):t.set("searchField9",""),void 0!==e.Class?(a=e.Class?e.Class.replace(s,o):"",t.set("customerClass",a.htmlSafe())):t.set("customerClass",""),t},getPreTagForHighLightSearchResult:function(){return"<"+ElasticSearchConfiguration.highlightSearchResult.htmlTag+" class='"+ElasticSearchConfiguration.highlightSearchResult.cssClass+"' >"},getPostTagForHighLightSearchResult:function(){return"</"+ElasticSearchConfiguration.highlightSearchResult.htmlTag+">"},getTokenToHighlightSearchResult:function(){return this.getPreTagForHighLightSearchResult()+"$1"+this.getPostTagForHighLightSearchResult()},getRegExToCreateSearchValue:function(){return new RegExp("("+this.get("searchingValue")+")","gi")},getCustomerTypeText:function(e){if(jQuery.isNumeric(e)){for(var t=this.get("customertype"),a=0;a<t.length;a++)if(t[a].key===e)return t[a].value;return""}return e},getSearchFieldValueAfterColon:function(e){var t=e.indexOf(":");return t<0?e:e.substring(t+1).trim()},removeHtmlFromSearchFields:function(e){var t=new RegExp(this.getPreTagForHighLightSearchResult(),"g"),a=new RegExp(this.getPostTagForHighLightSearchResult(),"g");return e.replace(t,"").replace(a,"")},getCacheData:function(){
var e=this,t=$.Deferred(),a=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),s=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),o=Komodo.Services.localizationService.getCurrentLanguage();return e.set("country",a),e.set("countryDescription",s),Komodo.Services.cachedDataService.fetch("CustomerType",{domain:a,qualifier:o}).done(function(t){e.get("customertype").clear(),$.each(t,function(t,a){e.get("customertype").addObject(a)})}).fail(function(){Komodo.log("could not retrieve customertype")}),t},concatStrings:function(e,t,a){var s=void 0===e||null===e?"":e,o=void 0===t||null===t?"":t,n=void 0===a||null===a?"":a;return $.trim(s.concat(" ",o," ",n))},retrieveCustomersEvent:function(e,t){var a=Komodo.Models.OnlineTill.RetrieveCustomers.create(),s=Komodo.canonicalFacadeFactory(a,["Country","UserName","Key","Value"]);this.setCountryUserName(s),s.set("Key",e),s.set("Value",t),Komodo.Services.OLTService.publishOLTEvent(this,a,"RetrieveCustomersEvent","v1")},messageCustomersRetrievedEventReceived:function(e){var t=[];if(e&&e.ResponseMessage&&e.ResponseMessage.Payload&&e.ResponseMessage.Payload.ListOfCustomers){var a=e.ResponseMessage.Payload.ListOfCustomers;if(a&&void 0===a.length)t.pushObject(this.populateSearchResultModel(a));else for(var s=0;s<a.length;s++)t.pushObject(this.populateSearchResultModel(a[s]))}this.callBack(t)},retrieveElasticSearchData:function(e){var t=this;Komodo.Services.queryService.getJSON("/ElasticSearch/GetElasticSearchData?from="+e.get("Pagefrom")+"&size="+e.get("PageSize")+"&documentType="+e.get("DocumentType")+"&default_field="+e.get("DefaultField")+"&searchText="+e.get("SearchText")+"&default_operator="+e.get("DefaultOperator")).done(function(e){var a=[];if(null!==e&&e.hits&&e.hits.hits&&e.hits.hits.length>0){t.set("_totalCount",e.hits.total);for(var s=e.hits.hits,o=0;o<s.length;o++)if(s[o]._type.toLowerCase()===ElasticSearchConfiguration.documentType.customer.toLowerCase()){var n=t.bindCustomerSearchResult(s[o]._source);n&&a.addObject(n)}}t.callBack(a)}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrieveElasticSearchData ajax call failed. Error: "+t)})},retrieveElasticSearchDataWithPromise:function(e){var t=$.Deferred(),a=this;return Komodo.Services.queryService.getJSON("/ElasticSearch/GetElasticSearchData?from="+e.get("Pagefrom")+"&size="+e.get("PageSize")+"&documentType="+e.get("DocumentType")+"&default_field="+e.get("DefaultField")+"&searchText="+e.get("SearchText")+"&default_operator="+e.get("DefaultOperator")).done(function(s){var o=void 0,n=[];if(null!==s&&s.hits&&s.hits.hits&&s.hits.hits.length>0){a.set("_totalCount",s.hits.total);for(var r=s.hits.hits,i=0;i<r.length;i++)if(r[i]._type.toLowerCase()===ElasticSearchConfiguration.documentType.customer.toLowerCase()){var l=a.bindCustomerSearchResult(r[i]._source);l&&($.each($.makeArray(r[i]._source.ListOfDevice),function(t,a){a.DeviceNumber===e.get("SearchText")&&l.set("deviceNumber",a.DeviceNumber)}),n.addObject(l))}var c=a.translateSearchResultSet(n);1===c.length&&(o=a.bindCustomerModel(c[0].searchResult))}t.resolve(o)}).error(function(e){var a=JSON.stringify(e);Komodo.log("retrieveElasticSearchData ajax call failed. Error: "+a),t.fail(e)}),t},messageFailureMessageEventReceived:function(e){this.hideBusyIndicator();var t=kl.value(controller._localeBase+"shift.technicalError");void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfErrorDetails&&(t="",$(e.ResponseMessage.Payload.ListOfErrorDetails).each(function(e,a){t+=a.ErrorDescription})),Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t,Komodo.Controls.MessageBoxOkButton,this,"id544246673","danger")},populateSearchResultModel:function(e){var t=new Komodo.Models.OnlineTill.SearchResultModel;return t.set("searchField1","Customer"),t.set("searchField2","Name: "+(null===e.FirstName?"":e.FirstName)),t.set("searchField3",null===e.SurName?"":e.SurName),t.set("searchField4","Customer No: "+e.UID),t.set("searchField5","ID/Passport: "),t.set("searchField6","Phone number: "),t.set("searchField8","City: "+this.concatStrings(e.Street,e.SmallCity)),t},translateSearchResultSet:function(e){var t=this.data.get(""),a=[];return $(e).each(function(e,s){if("Customer"===s.searchField1){var o=new Komodo.Models.OnlineTill.SearchResultModel;o.set("deviceNumber",s.deviceNumber),!1===Komodo.Services.offlineService.workingOffline()?(o.set("searchResult",s),o.set("isSelected",!1),o.set("multiSelect",!0),o.set("addVisible",!1),!1===t.isMultiSelectVisible&&(o.set("multiSelect",!1),o.set("addVisible",!0))):(o.set("searchField1","Customer"),o.set("searchField2",s.name),o.set("searchField4",s.number),o.set("searchField5",s.id),o.set("searchField6",s.mobileNumber),o.set("searchField10",s.accounts),o.set("isSelected",!1),o.set("multiSelect",!0),o.set("addVisible",!1),!1===t.isMultiSelectVisible&&(o.set("multiSelect",!1),o.set("addVisible",!0))),a.pushObject(o)}}),a},actions:{newProcess:function(){this.startNewProcess()},searchCustomer:function(){this.searchCustomer()},addCustomers:function(){this.addCustomers()},addSingleCustomer:function(e){this.addSingleCustomer(e)},clearAll:function(){this.clearAll()},nextPage:function(){this.nextPage()},previousPage:function(){this.previousPage()}}}),Komodo.Application.ShiftManagement=Ember.Object.extend({init:function(){},start:function(){var e=this,t=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),a=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription");e.set("country",t),e.set("countryDescription",a),e.set("genericController",Komodo.Services.uiService.getController("genericPayment")),e.set("paymentController",Komodo.Services.uiService.getController("payment")),e.set("_cacheRepository",e.get("paymentController").getCacheRepository());var s=Komodo.Application.PrintingManagement.create();s.start(),s.getCachePrinter(),e.set("printingManagement",s)},canCancelPayment:function(e,t,a,s){var o=this,n=void 0;if(void 0!==o.popup){var r=e._parentView._parentView._parentView._parentView.get("content");n=Komodo.Models.OnlineTill.CancelPaymentModel.create(),n.set("shiftNumber",t),n.set("paymentId",r.paymentId),n.set("SplitPayments",r.SplitPayments),n.set("amount",r.amount),n.set("currency",r.currency),n.set("currencyRate",r.currencyRate),n.set("date",r.date),n.set("paymentType",r.paymentType),n.set("isCancelled",r.isCancelled),n.set("isSplit",r.isSplit),n.set("enableFiscalization",a?1:0),n.set("enableInvoice",s?1:0),n.set("isCashSale",r.isCashSale),n.set("disableAction",!1)}if(void 0!==n)if("No"===n.isCancelled)if("Yes"===n.isCashSale&&n.SplitPayments&&n.SplitPayments.length>0){var i=n.SplitPayments[0].quoteId;i&&isNaN(i)?Komodo.Services.queryService.getJSON("SwapMaterialAvailability/GetCrmQuote?quoteNumber="+i).done(function(e){"2"===e.Category||"3"===e.Category?alert(kl.value(o._localeBase+"shift.cancelCashSalePaymentError")):o.cancelPayment(n)}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetCrmQuote ajax call failed. Error: "+t)}):o.cancelPayment(n)}else o.cancelPayment(n);else alert(kl.value(o._localeBase+"shift.cancelPaymentError"))},cancelPayment:function(e,t){var a=this;if(void 0!==e){a.get("paymentController").registerValidator(e,"reason",{isRequired:!0,type:"string"}),a.get("paymentController").registerValidator(e,"supervisorUsername",{isRequired:!0,type:"string"}),a.get("paymentController").registerValidator(e,"passCode",{isRequired:!0,type:"string"}),a.popup.close();var s=Komodo.Application.ModalPaneController.create();s.popup(kl.value(a._localeBase+"home.cancelReceiptTitle"),"cancelPayment",{context:{data:e,cancelReason:[{key:a.cancelReason,value:a.cancelReason}],ok:function(){var e=this,o=e.data.paymentId,n=e.data.reason.key;e.data.set("disableAction",!0),a.get("genericController").validateUserClaim(a.get("country"),e.data.supervisorUsername,e.data.passCode,a.get("_supervisorClaim")).done(function(r){void 0!==r?t===e.data.supervisorUsername?(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.unauthoriseCancelError"))):(s.close(),a.get("paymentController").cancelPaymentEvent(o,n,e.data.supervisorUsername,r)):(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.messageAccessValidate")))})},cancel:function(){s.close(),a.shiftDetails()}}})}},clearShiftDetails:function(e){var t=this;e.set("shiftNumber",void 0),e.set("generalLedger",void 0),e.set("baseCurrency",void 0),e.set("stockHandlerId",void 0),e.set("stockHandlers",[]),e.set("allowedCurrencies",void 0),e.set("currencyRate",void 0),e.set("shiftType",void 0),e.set("bankDepositNumber",void 0),e.set("isBankDepositNumberVisible",!1),e.set("cash",parseFloat(0).toFixed(2)),e.set("other",parseFloat(0).toFixed(2)),e.set("total",parseFloat(0).toFixed(2)),t.set("shiftData",void 0)},closeShift:function(e){var t=this,a=e;void 0!==a&&t.closeShiftEvent(a)},closeShiftEvent:function(e){var t=this,a=(t.get("shiftData"),Komodo.Models.CloseShift.create()),s=Komodo.canonicalFacadeFactory(a,["Country","UserName","ShiftUID"]);t.setCountryUserName(s),s.set("ShiftUID",e.shiftId),Komodo.Services.OLTService.publishOLTEvent(t.get("paymentController"),a,"CloseShiftEvent","v1",!0),t.get("paymentController").showBlockingBusyIndicator()},closeShiftReport:function(e){var t=this,a=e;if(a){var s=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();s.userName=t.userName(),s.country=t.get("countryDescription"),s.header="Shift",s.shiftNumber=a.shiftId,s.status="Closed",s.date=(new moment).format(KomodoConfiguration.dateFormat),s.time=(new moment).format(KomodoConfiguration.timeFormat),s.bankDepositNumber=a.bdNumber,s.stockHandlerDescription=a.stockHandlerDescription,s.currency=a.baseCurrency.value,s.detailGridData=a.shiftDetails,s.cancelledGridData=a.cancelledPayments,t.set("shiftData",void 0),Komodo.Services.OLTReportService.retrievedReportData(s),t.get("genericController").showReportPopup(kl.value(t._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"),Komodo.Services.eventAggregator.publish("PublishShiftClosed")}},countryCode:function(){return this.country},getHardwareInvoice:function(e){var t=this;if(t.get("paymentController").showBlockingBusyIndicator(),void 0!==t.popup){var a=e._parentView._parentView._parentView._parentView._parentView.get("content");Komodo.Services.queryService.getJSON("/PointOfSale/GetPaymentWithSapInvoice?paymentId="+a.paymentId).done(function(e){t.get("paymentController").hideBusyIndicator(),t.get("paymentController").searchCustomers(e,!1,!1).done(function(){t.get("paymentController").searchQuotes(e).done(function(){e&&t.get("paymentController").showReceiptPopup(e)})}).fail(function(e){e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t.get("paymentController"),"modelPayment","danger"),Komodo.log("searchCustomers ajax call failed. Error: "+JSON.stringify(e))})}).error(function(e){t.get("paymentController").hideBusyIndicator(),e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t.get("paymentController"),"modelPayment","danger"),Komodo.log("Get Sap Invoice Details ajax call failed. Error: "+JSON.stringify(e))}),t.popup.close()}},getOfflineUserShiftDetails:function(){var e=this,t=void 0;return e.get("_cacheRepository").fetch(e.countryCode()+".ShiftDetails."+e.userName()).done(function(e){t=e.data}),void 0===t&&(t={ShiftDetail:Komodo.Models.ShiftDetails.create()},e.get("_cacheRepository").save(e.countryCode()+".ShiftDetails."+e.userName(),t)),t},getShiftDetailsReportObject:function(e,t,a){var s=Ember.Object.create();return s.set("paymentTypes",Ember.A()),$.each(e,function(e,o){var n=Ember.Object.create();n.set("Type",o.paymentType),n.set("Currencies",Ember.A()),n.set("recordCount",0);var r=!0;$.each(a,function(e,a){var s=0,i=0,l=Ember.Object.create();l.set("Name",a.value),l.set("Items",Ember.A()),l.set("recordCount",0);var c=Ember.Object.create();$.each(t,function(e,t){t.paymentType===o.paymentType&&t.currency.value===a.value&&(i+=1,s=(parseFloat(s)+parseFloat(t.amount)).toFixed(2))}),0!==i&&(c.set("isShowPaymentType",r),c.set("isShowCurrency",!0),c.set("Count",i),c.set("Amount",s),l.get("Items").addObject(c)),r=!1,l.set("recordCount",l.get("Items").length),n.set("recordCount",n.get("recordCount")+l.get("recordCount")),n.get("Currencies").addObject(l)}),s.get("paymentTypes").addObject(n)}),s},getStockHandlerAccounts:function(e){e&&!1===$.isEmptyObject(e)&&e.length&&e.length>0&&$.each(e,function(e,t){Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+t.Id).done(function(e){if(e&&e.Account){for(var a=[],s=0;s<e.Account.length;s++)a.pushObject({Type:e.Account[s].Type,UID:e.Account[s].UID,IsDefault:e.Account[s].IsDefault});t.accounts={Account:a}}else t.accounts=void 0})})},hideShiftDetails:function(){var e=this;$("#komodo-shift-details").addClass("komodo-hidden"),$("#komodo-shift-details").slideUp(),$("#komodo-shift-page").removeClass("shift-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.get("paymentController").set("shiftBannerVisible",!1)},interimShiftReport:function(e){var t=this,a=Komodo.Services.OLTReportService.currentReportData.get("shiftDetailReportDataGrid");t.set("data",Ember.Object.create()),t.get("paymentController").set("data.shiftDetailReportDataGrid",a),t.set("data.shiftDetailReportDataGrid",a);var s=e;if(s){var o=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();o.userName=t.userName(),o.country=t.get("countryDescription"),o.header="Interim Shift",o.shiftNumber=s.shiftId,o.status=s.status,o.date=(new moment).format(KomodoConfiguration.dateFormat),o.time=(new moment).format(KomodoConfiguration.timeFormat),o.bankDepositNumber=s.bdNumber,o.stockHandlerDescription=s.stockHandlerDescription,o.currency=s.baseCurrency.value,o.detailGridData=s.shiftDetails,o.cancelledGridData=s.cancelledPayments,Komodo.Services.OLTReportService.retrievedReportData(o),t.get("genericController").showReportPopup(kl.value(t._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")}},messageShiftDetailsRetrievedEventReceived:function(e,t){if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var a=this,s=a.get("genericController").populateShiftModel(e.ResponseMessage.Payload.Shifts);t.set("shiftNumber",s.shiftId),t.set("allowedCurrencies",s.allowedCurrencies),t.set("currency",s.baseCurrency),t.set("baseCurrency",t.currency.value),t.set("currencyRate",s.currencyRate),t.set("shiftType",s.type),t.set("generalLedger",s.glNumber),t.set("bankDepositNumber",s.bdNumber),t.set("isBankDepositNumberVisible",null!==s.bdNumber&&""!==s.bdNumber),t.set("stockHandlerId",s.stockHandlerId),t.set("stockHandlers",s.stockHandlers),t.set("cash",parseFloat(s.cash).toFixed(2)),t.set("other",parseFloat(s.other).toFixed(2)),t.set("total",parseFloat(s.total).toFixed(2)),a.set("shiftData",s)}a.get("paymentController").hideBusyIndicator()},rePublish:function(e,t){var a=this;if(void 0!==a.popup){var s=e._parentView._parentView._parentView._parentView.get("content"),o=Komodo.Models.Payment.create(),n=Komodo.canonicalFacadeFactory(o,["UID","MethodOfPayment","MethodOfPaymentSub","ShiftID","StockHandlerID","IsCancelled","IsSplit","IsCashSale","Amount","AmountTendered","PaymentDate","IsAutoReconnectRequired","ShiftType","PaymentStatus","AccountHolderName","BankName","BranchName","BranchCode","ChequeDate","ChequeNumber","SplitPayments","WasOffline","IsRefund","CardAuthNumber","SupervisorUsername","ElevatedPrivilegeSessionToken"]);a.setCountryUserName(n),n.set("UID",s.paymentId),n.set("MethodOfPayment",s.paymentType),n.set("ShiftID",t.shiftNumber),n.set("StockHandlerID",t.stockHandlerId),n.set("ShiftType","Cashier");var r=void 0!==s.currency&&null!==s.currency?s.currency.key:"",i=Komodo.Models.Price.create();i.set("CurrencyCode",r),i.set("Value",s.amount),n.set("AmountTendered",i);var l=Komodo.Models.Price.create();l.set("CurrencyCode",r),l.set("Value",s.amount),n.set("Amount",l),n.set("IsCancelled","Yes"===s.isCancelled?1:0),n.set("IsSplit","Yes"===s.isSplit?1:0),n.set("IsCashSale",1),n.set("IsAutoReconnectRequired",1),n.set("IsRefund","Yes"===s.isRefund?1:0);var c=[],u=Komodo.Models.SplitPayment.create();$(s.SplitPayments).each(function(e,t){u=Komodo.Models.SplitPayment.create();var a=Komodo.Models.Price.create();a.set("CurrencyCode",r),a.set("Value",void 0!==t.amount&&""!==t.amount?t.amount:0),u.set("Amount",a),u.set("CustomerID",t.customerNumber),u.set("AccountID",t.accountNumber),u.set("QuotationID",t.quoteId),c.push(u)}),void 0!==c&&c.length>1&&n.set("IsSplit",1),n.set("SplitPayments",c),n.set("WasOffline",0);var h=Komodo.Models.CreatePayment.create(),d=Komodo.canonicalFacadeFactory(h,["Country","UserName","SupervisorUsername","Payment"]);a.setCountryUserName(d),d.set("Payment",o),Komodo.Services.OLTService.publishOLTEvent(a.get("paymentController"),h,"CreatePaymentEvent","v2",!1),a.popup.close()}},retrieveShiftSummaryEvent:function(e,t,a){var s=this;t&&s.get("paymentController").showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftSummary?shiftId="+e.shiftId).done(function(t){if(void 0!==t&&null!==t){var o=s.get("genericController").populateShiftSummaryBalance({Summary:t});e.set("shiftSummary",o.shiftSummary),e.set("cash",o.cash),e.set("other",o.other),e.set("total",o.total),e.set("totalString",parseFloat(o.total).toFixed(2)),a.set("cash",parseFloat(e.cash).toFixed(2)),a.set("other",parseFloat(e.other).toFixed(2)),a.set("total",parseFloat(e.total).toFixed(2))}}).error(function(e){s.get("genericController").showErrorPopup("retrieveShiftSummary",e),s.get("paymentController").hideBusyIndicator()})},retrieveShiftPaymentsEvent:function(e,t,a,s,o){var n=this;s&&n.get("paymentController").showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&page="+t+"&pageSize="+n.pageSize).done(function(s){if(void 0!==s&&null!==s){var r=[],i=[];if("InterimShiftReport"===a||"CloseShiftReport"===a?(r=Komodo.Services.OLTReportService.currentReportData.get("detailGridData"),i=Komodo.Services.OLTReportService.currentReportData.get("cancelledGridData")):r=e.shiftDetails,void 0!==s.Payments&&$(s.Payments).each(function(e,t){var s=n.get("genericController").populateShiftDetailModel(t);if(Ember.isEmpty(s.isCashSale)||"YES"!==s.isCashSale.toUpperCase()||(s.set("enableInvoice",o.get("enableInvoice")),s.set("enableFiscalization",o.get("enableFiscalization")),s.set("isRefund",s.get("isRefund"))),"InterimShiftReport"===a||"CloseShiftReport"===a)if("No"===s.isCancelled)r.pushObject(s);else{var l=JSON.parse(JSON.stringify(s));l.amount=parseFloat(-1*l.amount).toFixed(2),l.baseCurrencyAmount=parseFloat(-1*l.baseCurrencyAmount).toFixed(2),$(l.SplitPayments).each(function(e,t){t.amount=parseFloat(t.amount).toFixed(2)}),r.pushObject(l),i.pushObject(s)}"ShiftDetails"!==a&&"Nothing"!==a||r.pushObject(s)}),e.set("shiftDetails",r),e.set("cancelledPayments",i),!0===s.More||"true"===s.More){var l=Math.ceil(t*n.pageSize/s.TotalCount*100)+"%";Komodo.Services.OLTReportService.currentReportData.set("spoolingPercentage",l),n.retrieveShiftPaymentsEvent(e,t+1,a,!1,o)}else Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",n.get("genericController").populateShiftSummary(r)),Komodo.Services.OLTReportService.currentReportData.set("detailGridData",Komodo.Services.OLTReportService.currentReportData.detailGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("cancelledGridData",Komodo.Services.OLTReportService.currentReportData.cancelledGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),"ShiftDetails"===a&&n.shiftPaymentAction(a,o,e),"InterimShiftReport"!==a&&"CloseShiftReport"!==a||(n.get("paymentController").setPaymentDetailsListByCurrencies(),n.get("genericController").showReportPopup(kl.value(n._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"))}else Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),"ShiftDetails"===a&&n.shiftPaymentAction(a,o,e),"InterimShiftReport"!==a&&"CloseShiftReport"!==a||(n.get("paymentController").setPaymentDetailsListByCurrencies(),n.get("genericController").showReportPopup(kl.value(n._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"))}).error(function(e){n.get("paymentController").genericController.showErrorPopup("retrieveShiftPayments",e),n.get("paymentController").hideBusyIndicator()})},retrieveShiftDetailsEvent:function(e,t,a){var s=this,o=0,n=s.get("shiftStatuses").find(function(e){return"Open"===e.value});a&&void 0!==a.stockHandlerId&&(o=a.stockHandlerId),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftDetails?userName="+s.userName()+"&shiftStatus="+n.key+"&shiftType=Cashier&stockHandlerId="+o).done(function(e){if(void 0!==e&&null!==e){var o=s.get("genericController").populateShiftModel(e);s.getStockHandlerAccounts(o.stockHandlers),a.set("shiftNumber",o.shiftId),a.set("allowedCurrencies",o.allowedCurrencies),a.set("currency",o.baseCurrency),a.set("baseCurrency",a.currency.value),a.set("currencyRate",o.currencyRate),a.set("shiftType",o.type),a.set("generalLedger",o.glNumber),a.set("bankDepositNumber",o.bdNumber),a.set("isBankDepositNumberVisible",null!==o.bdNumber&&""!==o.bdNumber),a.set("stockHandlerId",o.stockHandlerId),a.set("stockHandlers",o.stockHandlers),a.set("cash",parseFloat(o.cash).toFixed(2)),a.set("other",parseFloat(o.other).toFixed(2)),a.set("total",parseFloat(o.total).toFixed(2));o.set("shiftDetails",[]),o.set("cancelledPayments",[]),s.set("shiftData",o),s.retrieveShiftPaymentsEvent(o,1,"Nothing",!1,a),!0===t&&(s.get("paymentController").updateUser(!1,void 0,void 0,a),s.syncOfflinePayments(a)),!0===s.get("paymentController").get("invokeRetrieveQuotationsEvent")&&(s.get("paymentController").set("invokeRetrieveQuotationsEvent",!1),s.get("paymentController").retrieveQuotationsEvent()),"Batch Payment"===a.paymentType&&a.allowedCurrencies&&a.allowedCurrencies.length>1&&a.set("disableCurrency",!0)}else Komodo.Controls.MessageBoxController.show(kl.value(s._localeBase+"shift.technicalErrorTitle"),kl.value(s._localeBase+"shift.openShiftError"),Komodo.Controls.MessageBoxOkButton,s.get("paymentController"),"modelPayment","danger");s.get("paymentController").hideBusyIndicator()}).error(function(e){s.get("genericController").showErrorPopup("retrieveShiftDetails",e),s.get("paymentController").hideBusyIndicator()})},searchShiftPaymentsEvent:function(e,t,a){var s=this;a&&s.get("paymentController").showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&paymentId="+t+"&page=0&pageSize=0").done(function(t){if(void 0!==t&&null!==t){var a=e.shiftDetails;void 0!==t.Payments&&$(t.Payments).each(function(e,t){a.pushObject(s.get("genericController").populateShiftDetailModel(t))}),e.set("shiftDetails",a)}}).error(function(e){s.get("genericController").showErrorPopup("retrieveShiftPayments",e),s.get("paymentController").hideBusyIndicator()})},setCountryUserName:function(e){var t=this;e.set("Country",t.get("country")),e.set("UserName",t.userName())},shiftDetails:function(e,t,a,s){var o=this,n=e;if(n){o.popup=Komodo.Application.ModalPaneController.create();var r=Ember.Object.create({type:"boolean"}),i=Ember.Object.create({type:"boolean"});r.value=!0,i.value=!(n.shiftDetails.length>10),n.shiftDetails&&(t||a)&&$.each(n.shiftDetails,function(e,s){"YES"===s.isCashSale.toUpperCase()&&(s.enableInvoice=!0===t?t:a),"Yes"===s.isRefund||!0===s.isRefund?s.isRefund=!0:s.isRefund=!1,!0===s.isRefund&&(s.enableInvoice=!0===t?t:a)}),o.popup.popup("Shift Details","shiftDetails",{context:{data:n.shiftDetails.slice(0,10),isPreviousDisable:r,isNextDisable:i,page:0,searchText:"",cancel:function(){o.popup.close()},searchReceipt:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);t.length>0?(e.data.clear(),e.data.pushObjects(t.slice(0,10)),e.page=0):(e.data.clear(),e.page=0,alert("No results found.")),e.setButtons(a)},previousPage:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);if(e.page>0){e.page=e.page-1;var s=0===e.page?1:e.page+1;e.data.clear(),e.data.pushObjects(t.slice(10*e.page,10*s))}e.setButtons(a)},nextPage:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);if(t.length>10){e.page=e.page+1;var s=e.page+1;e.data.clear(),e.data.pushObjects(t.slice(10*e.page,10*s))}e.setButtons(a)},searchResult:function(){var e=this,t=e.searchText,a=[];return""===t||void 0===t?n.shiftDetails:($(n.shiftDetails).each(function(e,s){s.SplitPayments.find(function(e){return e.financialTransactionId.toString()===t||e.accountNumber.toString()===t||e.quoteId.toString()===t||e.receiptNumber.toString()===t})&&a.pushObject(s)}),a)},setButtons:function(e){var t=this;0===e||t.page===e-1?t.isNextDisable.set("value",!0):t.isNextDisable.set("value",!1),0===t.page?t.isPreviousDisable.set("value",!0):t.isPreviousDisable.set("value",!1)},cancelPayment:function(e){o.canCancelPayment(e)},rePublish:function(e){o.rePublish(e)},getHardwareInvoice:function(e){o.getHardwareInvoice(e)},reprintReceipt:function(e){o.get("printingManagement").reprintReceipt(e,s,o.popup)}}}),o.get("paymentController").hideBusyIndicator()}},shiftPaymentAction:function(e,t,a){var s=this;switch(e){case"ShiftDetails":s.shiftDetails(a,t.enableFiscalization,t.enableInvoice,t);break;case"InterimShiftReport":s.interimShiftReport(a,t);break;case"CloseShiftReport":s.closeShiftReport(a)}s.get("paymentController").hideBusyIndicator()},showHideShiftDetails:function(){var e=this;e.shiftBannerVisible?($("#komodo-shift-details").addClass("komodo-hidden"),$("#komodo-shift-details").slideUp(),$("#komodo-shift-page").removeClass("shift-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.set("shiftBannerVisible",!1)):(e.customerBannerVisible&&e.hideCustomerDetails(),$("#komodo-shift-details").removeClass("komodo-hidden"),$("#komodo-shift-details").slideDown(),$("#komodo-shift-page").removeClass("no-banner-padding"),$("#komodo-shift-page").addClass("shift-page-padding"),e.set("shiftBannerVisible",!0))},stockHandlerChanged:function(e,t){var a=this,s=t;e&&s&&e.stockHandlerId&&s.stockHandlerId!==e.stockHandlerId&&(Komodo.Controls.MessageBoxController.show(kl.value(a._localeBase+"home.title"),kl.value(a._localeBase+"shift.messageStokhandlerValidate"),Komodo.Controls.MessageBoxYesNoButtons,a.get("paymentController"),"stockHandlerChanged").response=function(t){"no"===t&&(Ember.removeObserver(a.get("paymentController"),"data.stockHandlerId"),e.set("stockHandlerId",s.stockHandlerId),Ember.addObserver(a.get("paymentController"),"data.stockHandlerId",a.stockHandlerChanged))})}.observes("data.stockHandlerId"),syncOfflinePayments:function(e){var t=this,a=t.getOfflineUserShiftDetails();if(a&&a.ShiftDetail){var s=t.get("paymentController").getOfflinePayments(a.ShiftDetail.Payments);if(s&&s.length&&s.length>0){t.offlinePayments=Komodo.Models.OnlineTill.OfflinePaymentModel.create(),t.offlinePayments.set("disableSync",!1),t.offlinePayments.set("disableClose",!1);var o=[];$.each(s,function(e,t){var a=Komodo.Models.OnlineTill.OfflinePaymentModel.create();t.SplitPayments&&t.SplitPayments.length&&t.SplitPayments.length>0&&(a.set("customerNumber",t.SplitPayments[0].CustomerID),a.set("accountType",t.SplitPayments[0].AccountType.description),a.set("payAmount",t.SplitPayments[0].Amount.Value)),a.set("paymentDate",t.PaymentDate),a.set("isCancelled",1===t.IsCancelled?"Yes":"No"),a.set("paymentType",t.MethodOfPayment),a.set("syncStatus","Pending"),a.set("WasOffline",t.WasOffline),a.set("Synced",t.Synced),o.pushObject(a)}),t.offlinePayments.set("payments",o);var n=Komodo.Application.ModalPaneController.create();n.popup(kl.value(t._localeBase+"home.syncOfflinePaymentsTitle"),"offlinePaymentSyncing",{canUserClose:!1,context:{data:t.offlinePayments,startSyncing:function(){t.offlinePayments.set("disableSync",!0),t.offlinePayments.set("disableClose",!0),t.get("paymentController").publishOfflinePayments(s,this.data.payments)},paymentSyncStatus:function(e){var t=e._parentView.get("content");t&&("Pending"===t.syncStatus?alert("Payment need to be synced."):"Syncing"===t.syncStatus?alert("Syncing has been started for the payment."):"Synced"===t.syncStatus?alert("Payment is synced successfully."):"Failed"===t.syncStatus&&alert(t.failedMessage))},close:function(){n.close(),a=t.getOfflineUserShiftDetails();var s=t.get("paymentController").getOfflinePayments(a.ShiftDetail.Payments);s&&s.length&&s.length>0?Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.offlinePayments"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger").response=function(){Komodo.Services.uiService.getController("application").redirectReturn("home")}:t.retrieveShiftDetailsEvent(!1,!1,e)}}})}}},userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},_cacheRepository:void 0,_localeBase:"locale.onlinetill:",_supervisorClaim:["clarity://system/supervisor","clarity://olt/cancelReprintPayment"],cancelReason:"Incorrect Capture",country:void 0,countryDescription:void 0,genericController:void 0,offlinePayments:void 0,pageSize:20,paymentController:void 0,printingManagement:void 0,shiftBannerVisible:!1,shiftData:void 0,shiftStatuses:[],shiftTypes:[]}),Komodo.Application.PrintingManagement=Ember.Object.extend({_cacheRepository:void 0,_localeBase:"locale.onlinetill:",_supervisorClaim:["clarity://system/supervisor","clarity://olt/cancelReprintPayment"],_systemService:void 0,cachePrinter:void 0,cacheSpeedPoint:void 0,commonUtility:void 0,country:void 0,countryDescription:void 0,genericController:void 0,paymentController:void 0,printerKey:"Printer",speedpointKey:"Speedpoint",userName:void 0,init:function(){},start:function(){this.set("country",Komodo.Services.uiService.getController("application").get("_selectedCountryId")),this.set("countryDescription",Komodo.Services.uiService.getController("application").get("_selectedCountryDescription")),this.set("userName",Komodo.Services.securityService.get("domainUserName").substring(3)),this.set("genericController",Komodo.Services.uiService.getController("genericPayment")),this.set("paymentController",Komodo.Services.uiService.getController("payment")),this.set("_cacheRepository",this.get("paymentController").getCacheRepository()),this.set("_systemService",this.get("paymentController").getSystemService())},emailReceipt:function(e,t){var a=this;if(e&&e.receiptData&&e.receiptData.length>=1){var s=[];$(e.receiptData).each(function(e,t){var o=Komodo.Models.PaymentCaptured.create();o.set("Country",a.get("country")),o.set("BusinessUnit",t.BusinessUnit),o.set("ReceiptNumber",t.ReceiptNumber),o.set("ReceiptDate",t.ReceiptDate),o.set("MethodOfPayment",t.MethodOfPayment),o.set("CustomerID",t.CustomerID),o.set("CustomerName",t.CustomerName),o.set("SmartcardNumber",t.SmartcardNumber),o.set("CellphoneNumber",t.CellNumber),o.set("Currency",t.Currency);var n=Komodo.Models.Price.create();n.set("CurrencyCode",t.Currency),n.set("Value",t.TotalAmountInclTax),n.set("ValueWithoutTax",t.TotalAmountExclTax);var r=Komodo.Models.Tax.create();r.set("Amount",t.Tax),n.ListOfTax[0]=r,o.set("Amount",n);var i=Komodo.Models.Price.create();i.set("CurrencyCode",t.Currency),i.set("Value",t.Amount),i.ListOfTax[0]=r,o.set("AmountTendered",i)
;var l=Komodo.Models.Price.create();l.set("CurrencyCode",t.Currency),l.set("Value",t.Change),o.set("ChangeOwed",l),o.set("CashierName",t.CashierName),o.set("QuotationID",t.QuotationID),o.set("IsCashSale",t.IsCashSale),o.set("IsCancelled",t.IsCancelled),o.set("IsReprint",t.IsReprint),o.set("IsRefund",t.IsRefund),o.set("EmailReceiptDate",new moment(new Date).format("YYYYMMDD_hhmmss")),s.push(o)});var o=Ember.Object.create({ListOfPayment:s}),n=void 0;t.EnableFiscalization?e.receiptData.length>1?n=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_SINGLE",!1):e.email&&e.email.length>0?(n=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_ALTERNATE",!1),e.email.forEach(function(t){t.Value===e.selectedEmail&&t.IsPrimary&&(n=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_PRIMARY",!1))})):n=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_CAPTURED",!1):e.receiptData.length>1?n=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_SINGLE"):e.email&&e.email.length>0?(n=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_ALTERNATE"),e.email.forEach(function(t){t.Value===e.selectedEmail&&t.IsPrimary&&(n=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_PRIMARY"))})):n=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_CAPTURED"),a.publishOutbondNotificationEvent({Payload:o},e.selectedEmail,n,t)}},getCachePrinter:function(){var e=this;e.get("_cacheRepository").fetch(e.get("country")+".PrinterDetails."+e.get("userName")).done(function(t){t&&t.data&&(e.set("cachePrinter",t.data.Printer),e.set("cacheSpeedPoint",t.data.Speedpoint))})},getPrinterTypeFormShiftDetails:function(e,t){var a="";return $.each(e,function(e,s){s.printerName.toUpperCase()===t.toUpperCase()&&(a=s.printerType)}),a},isNonWindowsSystem:function(){var e=void 0;return navigator&&navigator.appVersion&&(-1!==navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!==navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!==navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!==navigator.appVersion.indexOf("Linux")&&(e="Linux")),void 0!==e&&"Windows"!==e},printReceipt:function(e){var t=this,a=(t.get("_systemService").get("isMobile"),t.isNonWindowsSystem(),KomodoConfiguration.localStorageApiUrl+"/printReceipt"),s={async:!1,type:"POST",cache:!1,url:a,dataType:"json",contentType:"application/json",data:JSON.stringify(e)};jQuery.ajax(s).done(function(){}).fail(function(e){var a=kl.value(t._localeBase+"shift.technicalError");e&&(void 0!==e.responseJSON?a=e.responseJSON.message:void 0!==e.statusText&&""!==e.statusText&&(a=e.statusText)),alert(a)})},publishOutbondNotificationEvent:function(e,t,a,s){var o=this,n=Komodo.Models.SendOutboundNotification.create(),r=Komodo.canonicalFacadeFactory(n,["Country","ListOfOutboundNotification"]);r.set("Country",o.get("country"));var i=Komodo.Models.ListOfOutboundNotification.create(),l=Komodo.canonicalFacadeFactory(i,["OutboundNotification"]),c=Komodo.Models.OutboundNotification.create(),u=Komodo.canonicalFacadeFactory(c,["BusinessEntity","BusinessUnit","Country","TemplateName","ListOfRecipient","ListOfAttachment","MessageData"]),h=Komodo.Models.ListOfRecipients.create(),d=Komodo.canonicalFacadeFactory(h,["Recipient"]),p=Komodo.Models.Recipient.create(),m=Komodo.canonicalFacadeFactory(p,["CommunicationType","Language","MessageUID","From","To","ScheduledDate","ExpiryDate","ListOfContext"]);!0===s.EnableFiscalization?(u.set("BusinessEntity",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("BusinessUnit",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("Country",o.get("countryDescription")),u.set("TemplateName",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("MessageData",e),m.set("Language",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE",e.Payload.ListOfPayment[0].IsTaxInvoice)),m.set("CommunicationType",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE",e.Payload.ListOfPayment[0].IsTaxInvoice))):(u.set("BusinessEntity",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION")),u.set("BusinessUnit",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT")),u.set("Country",o.get("countryDescription")),u.set("TemplateName",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME")),u.set("MessageData",e),m.set("Language",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE")),m.set("CommunicationType",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE")));var f=Komodo.Models.ListOfContext.create(),y=Komodo.canonicalFacadeFactory(f,["Context"]),b=Komodo.Models.Context.create(),v=Komodo.canonicalFacadeFactory(b,["Value","ContextValueUri"]);return v.set("Value","Outcome"),v.set("ContextValueUri",a),y.set("Context",b),m.set("ListOfContext",f),m.set("To",t),d.set("Recipient",p),u.set("ListOfRecipient",h),l.set("OutboundNotification",c),r.set("ListOfOutboundNotification",i),Komodo.Services.OLTService.publishOLTEvent(o,n,"SendReceiptNotificationEvent","v1",!0).done(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has been published."),Komodo.Controls.MessageBoxController.show(kl.value(o._localeBase+"home.emailReceiptTitle"),kl.value(o._localeBase+"report.emailSentSuccessMsg"),Komodo.Controls.MessageBoxOkButton,o,"id5446673","success").response=function(e){o.get("paymentController").showReceiptPopup(s)}}).fail(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has failed."),Komodo.Controls.MessageBoxController.show(kl.value(o._localeBase+"home.emailReceiptTitle"),kl.value(o._localeBase+"report.emailSentFailureMsg"),Komodo.Controls.MessageBoxOkButton,o,"id5446673","danger").response=function(e){o.get("paymentController").showReceiptPopup(s)}}),!0},reprintReceipt:function(e,t,a){var s,o=this,n=void 0;o.set("smartcardNumber",""),!1===t.reprintSupervisorApprovalRequired?(s=e._parentView._parentView._parentView._parentView.get("content"),Ember.isEmpty(a)||a.close(),o.retrieveReceiptDetailsEvent(s.paymentId)):(Ember.isEmpty(a)||(s=e._parentView._parentView._parentView._parentView.get("content"),n=Komodo.Models.OnlineTill.ReprintReceiptModel.create(),n.set("shiftNumber",t.shiftNumber),n.set("paymentId",s.paymentId),n.set("SplitPayments",s.SplitPayments),n.set("amount",s.amount),n.set("currency",s.currency),n.set("currencyRate",s.currencyRate),n.set("date",s.date),n.set("paymentType",s.paymentType),n.set("isCancelled",s.isCancelled),n.set("isSplit",s.isSplit),n.set("disableAction",!1),o.get("paymentController").registerValidator(n,"supervisorUsername",{isRequired:!0,type:"string"}),o.get("paymentController").registerValidator(n,"passCode",{isRequired:!0,type:"string"}),a.close()),void 0!==n&&(a=Komodo.Application.ModalPaneController.create(),a.popup(kl.value(this._localeBase+"home.reprintReceiptTitle"),"reprintReceipt",{context:{data:n,ok:function(){var e=this,s=e.data.paymentId;e.data.set("disableAction",!0),o.get("genericController").validateUserClaim(o.get("country"),e.data.supervisorUsername,e.data.passCode,o._supervisorClaim).done(function(n){void 0!==n?t.cashierName===e.data.supervisorUsername?(e.data.set("disableAction",!1),alert(kl.value(o._localeBase+"shift.unauthoriseReprintError"))):(a.close(),o.retrieveReceiptDetailsEvent(s)):(e.data.set("disableAction",!1),alert(kl.value(o._localeBase+"shift.messageAccessValidate")))})},cancel:function(){a.close(),o.get("paymentController").shiftDetails()}}})))},retrieveReceiptDetailsEvent:function(e){var t=this;t.get("paymentController").showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/GetPayment?paymentId="+e).done(function(e){t.get("paymentController").hideBusyIndicator(),t.get("paymentController").searchCustomers(e,!1,!1).done(function(){t.get("paymentController").searchQuotes(e).done(function(){e&&(e.IsReprint=!0,t.get("paymentController").showReceiptPopup(e))})}).fail(function(e){e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t.get("paymentController"),"modelPayment","danger"),Komodo.log("searchCustomers ajax call failed. Error: "+JSON.stringify(e))})}).error(function(e){t.get("paymentController").hideBusyIndicator(),e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t.get("paymentController"),"modelPayment","danger"),Komodo.log("Create payment ajax call failed. Error: "+JSON.stringify(e))})},updateCachePrinter:function(e,t){var a=this,s=!1;if(t&&(delete t.layout,e===a.printerKey&&(void 0===a.cachePrinter||t.key!==a.cachePrinter.key&&t.ipAddress!==a.cachePrinter.ipAddress)&&(s=!0,a.set("cachePrinter",t)),e===a.speedpointKey&&(void 0===a.cacheSpeedPoint||t.key!==a.cacheSpeedPoint.key&&t.ipAddress!==a.cacheSpeedPoint.ipAddress)&&(s=!0,a.set("cacheSpeedPoint",t)),s)){var o={Printer:a.cachePrinter,Speedpoint:a.cacheSpeedPoint};this.get("_cacheRepository").save(a.get("country")+".PrinterDetails."+a.get("userName"),o)}}}),Komodo.Application.ShiftManagementController=Komodo.UI.Controller.extend({_localeBase:"locale.onlinetill:",needs:["payment","genericPayment"],genericController:void 0,country:void 0,countryDescription:void 0,pageSize:20,methodOfPayments:["Cash","Cheque","Card"],paymentCountByPaymentTypes:[],cancelPaymentCountByPaymentTypes:[],init:function(){Komodo.log("Constructing Close Shifts controller"),this.set("processVersion","v1.1"),this.set("processName","Close Shifts process"),this._super(),this.requiresDependency("_featureToggleService",{singleton:Komodo.Services.featureToggleService}),this.set("gridColumns",[Komodo.Controls.DataGridColumn.create({name:"shiftId",title:kl.value(this._localeBase+"shift.shiftNumber"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"userName",title:kl.value(this._localeBase+"shift.cashierName"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"glNumber",title:kl.value(this._localeBase+"shift.generalLedger"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"stockHandlerName",title:kl.value(this._localeBase+"shift.stockHandler"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"dateString",title:kl.value(this._localeBase+"shift.date"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"status",title:kl.value(this._localeBase+"shift.status"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"totalString",title:kl.value(this._localeBase+"shift.balance"),canEdit:!1,customClass:"komodo-decimal"}),Komodo.Controls.DataGridCommandColumn.create({title:kl.value(this._localeBase+"shift.actions"),width:"50px",action:"closeShift",displayText:kl.value(this._localeBase+"shift.closeShift"),displayType:"button",target:"Komodo.Application.router.closeShiftsController"})])},start:function(){this._super(),this.registerModel("data",Komodo.Models.OnlineTill.CloseShiftsModel),this.genericController=this.get("controllers.genericPayment"),this.getCacheData(),this.registerValidation();var e=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();Komodo.Services.OLTReportService.retrievedReportData(e)},stop:function(){this._super()},userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},setCountryUserName:function(e){e.set("Country",this.country),e.set("UserName",this.userName())},registerValidation:function(){var e=this;e.registerValidator(e.get("data"),"shiftType",{type:"string",isRequired:!0}),e.registerValidator(e.get("data"),"shiftId",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"cashierName",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z.]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"bdNumber",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"startDate",{type:"string",functions:Komodo.UI.Validators.DatePickerValidator}),e.registerValidator(e.get("data"),"endDate",{type:"string",functions:Komodo.UI.Validators.DatePickerValidator})},searchShifts:function(){var e=this,t=e.get("data");if(!1!==e.canSubmitData(t,kl.value(e._localeBase+"home.useCaseCloseShiftsTitle"),{showInModal:!0}))if(void 0!==t.cashierName&&""!==t.cashierName||void 0!==t.shiftId&&""!==t.shiftId||void 0!==t.bdNumber&&""!==t.bdNumber||void 0!==t.startDate&&""!==t.startDate||void 0!==t.endDate&&""!==t.endDate){if(void 0!==t.cashierName&&""!==t.cashierName){var a=t.cashierName.indexOf("\\");a>0?t.set("selectedCashierName",t.cashierName.substring(a+1).trim()):t.set("selectedCashierName",t.cashierName.trim())}t.set("shiftData",[]),e.retrieveShiftsEvent(1,!0)}else Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.useCaseCloseShiftsTitle"),kl.value(e._localeBase+"report.messageReportInputsValidate"),Komodo.Controls.MessageBoxOkButtons,this,"modelCloseShift","danger")},clearShifts:function(){var e=this,t=e.get("data");t&&(t.set("shiftType",t.shiftTypes&&t.shiftTypes.length>1?t.shiftTypes[1]:t.shiftTypes[0]),t.set("shiftId",""),t.set("bdNumber",""),t.set("cashierName",""),t.set("startDate",""),t.set("endDate",""),t.set("selectedCashierName",""),t.set("selectedshift",""),t.set("isGridVisible",!1),t.set("isMessageVisible",!1),t.set("shiftData",[]),t.set("selectedGridItem",void 0),t.set("commandGridItem",void 0),t.set("commandGridItemType",void 0))},closeShift:function(){var e=this,t=e.get("data");void 0!==t.commandGridItem&&(t.set("selectedCashierName",t.commandGridItem.userName),t.set("selectedshift",t.commandGridItem),e.closeShiftEvent(t.commandGridItem,!0))},showReport:function(){var e=this,t=e.get("data"),a=e.get("shiftdata");if(a){var s=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();s.userName=t.selectedCashierName,s.country=e.countryDescription,s.header="Shift",s.shiftNumber=a.shiftId,s.status="Closed",s.date=moment().format(KomodoConfiguration.dateFormat),s.time=moment().format(KomodoConfiguration.timeFormat),s.bankDepositNumber=a.bdNumber,s.stockHandlerDescription=a.stockHandlerDescription,s.currency=a.baseCurrency.value,s.detailGridData=a.shiftDetails,s.cancelledGridData=a.cancelledPayments,e.get("controllers.payment").set("shiftdata",void 0),Komodo.Services.OLTReportService.retrievedReportData(s),e.genericController.showReportPopup(kl.value(e._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")}},showResultView:function(){return!(!this.data||!0!==this.data.isMessageVisible&&!0!==this.data.isGridVisible)}.property("data.isMessageVisible","data.isGridVisible"),getCacheData:function(){var e=this,t=e.get("data"),a=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),s=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),o=Komodo.Services.localizationService.getCurrentLanguage();e.set("country",a),e.set("countryDescription",s),Komodo.Services.cachedDataService.fetch("ShiftStatus",{domain:a,qualifier:o}).done(function(e){t.set("shiftStatuses",[]),t.set("shiftStatuses",e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve ShiftStatus domain = "+a+"/ qualifier = "+o)}),Komodo.Services.cachedDataService.fetch("ShiftType",{domain:a,qualifier:o}).done(function(a){e.getFeatureToggleService().isEnabled("OnlineTill","EnableAgencyBatchPayment").done(function(e){Ember.run(function(){t.set("shiftTypes",[]),$.each(a,function(a,s){"Batch"===s.value?e&&t.shiftTypes.addObject(s):t.shiftTypes.addObject(s)}),t.set("shiftType",a&&a.length>1?a[1]:a[0])})})}).fail(function(){Komodo.log("[ERROR] : could not retrieve ShiftType domain = "+a+"/ qualifier = "+o)}),Komodo.Services.cachedDataService.fetch("Currency",{domain:a,qualifier:o}).done(function(e){t.set("currencies",[]),t.set("currencies",e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Currency domain = "+a+"/ qualifier = "+o)})},getFeatureToggleService:function(){return this.get("_featureToggleService")},showBlockingBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,15e3,"blocking",this)},hideBusyIndicator:function(){Komodo.Services.busyService.stop(this.get("processId"),"blocking")},retrieveShiftsEvent:function(e,t){var a,s=this,o=s.get("data");a=void 0!==o.shiftId&&""!==o.shiftId?"shiftId="+o.shiftId:"shiftId=0";var n=o.shiftStatuses.find(function(e){return"1"===e.key});a=a+"&userName="+o.selectedCashierName+"&shiftStatus="+n.key+"&shiftType="+o.shiftType.key+"&bankDepositNumber="+o.bdNumber,void 0!==o.startDate&&""!==o.startDate?a=a+"&startDate="+moment(o.startDate).format("YYYY-MM-DDThh:mm:ss"):a+="&startDate",void 0!==o.endDate&&""!==o.endDate?a=a+"&endDate="+moment(o.endDate).format("YYYY-MM-DDThh:mm:ss"):a+="&endDate",a=a+"&page="+e+"&pageSize="+s.pageSize,t&&s.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShifts?"+a).done(function(t){if(void 0!==t&&null!==t&&void 0!==t.Shifts){var a=o.get("shiftData");$($.makeArray(t.Shifts)).each(function(e,t){a.pushObject(s.genericController.populateShiftModel({Shift:t.Shift,StockHandlers:t.StockHandlers}))}),a.length>0&&"Batch"===a[0].type?s.gridColumns[0].set("title",kl.value(s._localeBase+"shift.batchNumber")):s.gridColumns[0].set("title",kl.value(s._localeBase+"shift.shiftNumber")),o.set("shiftData",a),o.set("isGridVisible",!0),o.set("isMessageVisible",!1),!0!==t.More&&"true"!==t.More||s.retrieveShiftsEvent(e+1,!1)}else o.set("shiftData",[]),o.set("isGridVisible",!1),o.set("isMessageVisible",!0);s.hideBusyIndicator()}).error(function(e){s.genericController.showErrorPopup("retrieveShifts",e),s.hideBusyIndicator()})},messageShiftsRetrievedEventReceived:function(e){var t=this,a=t.get("data");if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var s=e.ResponseMessage.Payload,o=[];$(s.Shifts).each(function(e,a){o.pushObject(t.genericController.populateShiftModel({Shift:a.Shift}))}),o.length>0&&"Batch"===o[0].type?t.gridColumns[0].set("title",kl.value(this._localeBase+"shift.batchNumber")):t.gridColumns[0].set("title",kl.value(this._localeBase+"shift.shiftNumber")),a.set("shiftData",o),a.set("isGridVisible",!0),a.set("isMessageVisible",!1)}else a.set("shiftData",[]),a.set("isGridVisible",!1),a.set("isMessageVisible",!0);t.hideBusyIndicator()},retrieveShiftDetailsEvent:function(e,t){var a=this,s=a.get("data"),o=s.shiftStatuses.find(function(t){return t.value===e.status});t&&a.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftDetails?shiftId="+e.shiftId+"&shiftStatus="+o.key+"&shiftType="+e.type).done(function(e){if(void 0!==e&&null!==e){var t=a.genericController.populateShiftModel(e);t.set("shiftDetails",[]),t.set("cancelledPayments",[]),a.set("shiftdata",t),a.retrieveShiftPaymentsEvent(t,1,!1),a.showReport()}a.hideBusyIndicator()}).error(function(e){a.genericController.showErrorPopup("retrieveShiftDetails",e),a.hideBusyIndicator()})},messageShiftDetailsRetrievedEventReceived:function(e){var t=this;if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var a=t.genericController.populateShiftModel(e.ResponseMessage.Payload.Shifts);t.set("shiftdata",a),t.closeShiftEvent(a)}},retrieveShiftPaymentsEvent:function(e,t,a){var s=this,o=e.get("allowedCurrencies");a&&s.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&page="+t+"&pageSize="+s.pageSize).done(function(a){if(void 0!==a&&null!==a){var n=Komodo.Services.OLTReportService.currentReportData.get("detailGridData"),r=Komodo.Services.OLTReportService.currentReportData.get("cancelledGridData");if(void 0!==a.Payments&&$(a.Payments).each(function(e,t){var a=s.genericController.populateShiftDetailModel(t);if("No"===a.isCancelled)n.pushObject(a);else{var o=JSON.parse(JSON.stringify(a));o.amount=parseFloat(-1*o.amount).toFixed(2),o.baseCurrencyAmount=parseFloat(-1*o.baseCurrencyAmount).toFixed(2),$(o.SplitPayments).each(function(e,t){t.amount=parseFloat(t.amount).toFixed(2)}),n.pushObject(o),r.pushObject(a)}}),e.set("shiftDetails",n),e.set("cancelledPayments",r),!0===a.More||"true"===a.More){var i=Math.ceil(t*s.pageSize/a.TotalCount*100)+"%";Komodo.Services.OLTReportService.currentReportData.set("spoolingPercentage",i),s.retrieveShiftPaymentsEvent(e,t+1,!1)}else Komodo.Services.OLTReportService.currentReportData.set("detailGridData",Komodo.Services.OLTReportService.currentReportData.detailGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("cancelledGridData",Komodo.Services.OLTReportService.currentReportData.cancelledGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("allPayments",n),Komodo.Services.OLTReportService.currentReportData.set("allCurrencies",o),Komodo.Services.OLTReportService.currentReportData.set("allMethodOfPayments",s.methodOfPayments),Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",s.genericController.populateShiftSummary(n,s.methodOfPayments,o,!0)),!Ember.isEmpty(o)&&o.length>1&&Komodo.Services.OLTReportService.currentReportData.set("summaryTotalByCurrency",s.genericController.populateShiftSummaryTotalByCurrency(n,o)),Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),s.genericController.setPaymentDetailsListByCurrencies(o),s.genericController.showReportPopup(kl.value(s._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")}else Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),s.genericController.setMultipleBusinessUnitDefaultSettings(),s.genericController.setPaymentDetailsListByCurrencies(o),s.genericController.showReportPopup(kl.value(s._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")}).error(function(e){s.genericController.showErrorPopup("retrieveShiftPayments",e),s.hideBusyIndicator()})},closeShiftEvent:function(e){var t=this,a=Komodo.Models.CloseShift.create(),s=Komodo.canonicalFacadeFactory(a,["Country","UserName","ShiftUID"]);this.setCountryUserName(s),s.set("ShiftUID",e.shiftId),Komodo.Services.OLTService.publishOLTEvent(this,a,"CloseShiftEvent","v1",!0),t.showBlockingBusyIndicator()},messageShiftClosedEventReceived:function(){var e=this,t=e.get("data");Komodo.log("closeShiftEvent() callback is received."),e.retrieveShiftDetailsEvent(t.selectedshift);t.set("shiftData",[]),e.retrieveShiftsEvent(1,!1)},messageFailureMessageEventReceived:function(e){this.hideBusyIndicator();var t=kl.value(controller._localeBase+"shift.technicalError");void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfErrorDetails&&(t="",$(e.ResponseMessage.Payload.ListOfErrorDetails).each(function(e,a){t+=a.ErrorDescription})),Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t,Komodo.Controls.MessageBoxOkButton,this,"id544246673","danger")},messageReceived:function(e){this.hideBusyIndicator(),Komodo.UI.log("[ShiftManagementController.messageReceived] : event name = "+e.ResponseMessage.EventName)},messageDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[ShiftManagementController.messageDeliveryFailure] : messageId = "+e.messageId)},messageFault:function(e){this.hideBusyIndicator(),Komodo.UI.error("[ShiftManagementController.messageFault] : messageId = "+e.messageId)},shiftdata:void 0,actions:{newProcess:function(){this.startNewProcess()},searchShifts:function(){this.searchShifts()},clearShifts:function(){this.clearShifts()},closeShift:function(){this.closeShift()},showBlockingBusyIndicator:function(){this.showBlockingBusyIndicator()},hideBusyIndicator:function(){this.hideBusyIndicator()}}}),Komodo.Application.PaymentReportController=Komodo.UI.Controller.extend({_localeBase:"locale.onlinetill:",needs:["genericPayment"],country:void 0,countryDescription:void 0,genericController:void 0,pageSize:20,methodOfPayments:["Cash","Cheque","Card"],paymentCountByPaymentTypes:[],cancelPaymentCountByPaymentTypes:[],init:function(){Komodo.log("Constructing Payment Report controller"),this.set("processVersion","v1.1"),this.set("processName","Payment Report process"),this._super(),this.requiresDependency("_featureToggleService",{singleton:Komodo.Services.featureToggleService}),this.set("gridColumns",[Komodo.Controls.DataGridColumn.create({name:"shiftId",title:kl.value(this._localeBase+"shift.shiftNumber"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"userName",title:kl.value(this._localeBase+"shift.cashierName"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"glNumber",title:kl.value(this._localeBase+"shift.generalLedger"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"stockHandlerName",title:kl.value(this._localeBase+"shift.stockHandler"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"dateString",title:kl.value(this._localeBase+"shift.date"),canEdit:!1,width:"15%"}),Komodo.Controls.DataGridColumn.create({name:"status",title:kl.value(this._localeBase+"shift.status"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"totalString",title:kl.value(this._localeBase+"shift.balance"),canEdit:!1,customClass:"komodo-decimal"}),Komodo.Controls.DataGridCommandColumn.create({title:kl.value(this._localeBase+"shift.actions"),width:"50px",action:"viewReport",displayText:kl.value(this._localeBase+"shift.view"),displayType:"button",target:"Komodo.Application.router.paymentReportController"})])},start:function(){this._super(),this.registerModel("data",Komodo.Models.OnlineTill.PaymentReportModel),this.genericController=this.get("controllers.genericPayment"),this.getCacheData(),this.registerValidation();var e=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();Komodo.Services.OLTReportService.retrievedReportData(e)},stop:function(){this._super()},userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},setCountryUserName:function(e){e.set("Country",this.country),e.set("UserName",this.userName())},registerValidation:function(){var e=this;e.registerValidator(e.get("data"),"report",{type:"string",isRequired:!0}),e.registerValidator(e.get("data"),"shiftStatus",{type:"string",isRequired:!0}),e.registerValidator(e.get("data"),"shiftId",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"cashierName",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z.]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"bdNumber",{type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z]*$",functions:Komodo.UI.Validators.shouldNotStartWithSpace}),e.registerValidator(e.get("data"),"startDate",{type:"string",functions:Komodo.UI.Validators.DatePickerValidator}),e.registerValidator(e.get("data"),"endDate",{type:"string",functions:Komodo.UI.Validators.DatePickerValidator})},searchReport:function(){var e=this,t=e.get("data");if(!1!==e.canSubmitData(t,kl.value(e._localeBase+"home.useCaseReportTitle"),{showInModal:!0}))if(void 0!==t.cashierName&&""!==t.cashierName||void 0!==t.shiftId&&""!==t.shiftId||void 0!==t.bdNumber&&""!==t.bdNumber||void 0!==t.startDate&&""!==t.startDate||void 0!==t.endDate&&""!==t.endDate){if(void 0!==t.cashierName&&""!==t.cashierName){var a=t.cashierName.indexOf("\\");a>0?t.set("selectedCashierName",t.cashierName.substring(a+1).trim()):t.set("selectedCashierName",t.cashierName.trim())}else t.set("selectedCashierName","");t.set("selectedReport",t.report);t.set("shiftData",[]),e.retrieveShiftsEvent(1,!0)}else Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.useCaseReportTitle"),kl.value(e._localeBase+"report.messageReportInputsValidate"),Komodo.Controls.MessageBoxOkButtons,this,"modelPaymentReport","danger")},clearReport:function(){var e=this,t=e.get("data");t&&(t.set("report",t.reports&&t.reports.length>0?t.reports[0]:""),t.set("shiftStatus",t.shiftStatuses&&t.shiftStatuses.length>0?t.shiftStatuses[0]:""),t.set("cashierName",""),t.set("shiftId",""),t.set("bdNumber",""),t.set("startDate",""),t.set("endDate",""),t.set("selectedReport",""),t.set("selectedCashierName",""),t.set("isGridVisible",!1),t.set("isMessageVisible",!1),t.set("shiftData",[]),t.set("selectedGridItem",void 0),t.set("commandGridItem",void 0),t.set("commandGridItemType",void 0))},viewReport:function(){var e=this,t=e.get("data");void 0!==t.commandGridItem&&(t.set("selectedCashierName",t.commandGridItem.userName),e.retrieveShiftDetailsEvent(t.commandGridItem,!0))},showReport:function(){var e,t=this,a=t.get("data"),s=t.get("shiftdata");"Shift Details Report"===a.selectedReport&&(e=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create(),e.country=t.countryDescription,e.userName=a.selectedCashierName,e.header="Shift",e.shiftNumber=s.shiftId,e.status=s.status,e.date=t.getDate(s.date),e.time=t.getTime(s.date),e.bankDepositNumber=s.bdNumber,e.stockHandlerDescription=s.stockHandlerDescription,e.currency=s.baseCurrency.value,e.detailGridData=s.shiftDetails,e.cancelledGridData=s.cancelledPayments,Komodo.Services.OLTReportService.retrievedReportData(e),t.genericController.showReportPopup(kl.value(t._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")),"Agency Batch Payment Report"===a.selectedReport&&(e=Komodo.Models.OnlineTill.BatchPaymentReportModel.create(),e.country=t.countryDescription,e.userName=a.selectedCashierName,e.header="Agency",e.batchNumber=s.shiftId,e.currency="",e.agent="",e.smsAccount="",e.status=s.status,e.date=t.getDate(s.date),e.time=t.getTime(s.date),e.bankDepositNumber=s.bdNumber,e.stockHandlerDescription=s.stockHandlerDescription,e.currency=s.baseCurrency.value,e.detailGridData=s.shiftDetails,e.cancelledGridData=s.cancelledPayments,Komodo.Services.OLTReportService.retrievedReportData(e),t.genericController.showReportPopup(kl.value(t._localeBase+"report.batchPaymentReport"),"batchPaymentReport"))},showBatchPaymentReport:function(e,t){var a=this;this.getCacheData().done(function(){a.retrieveShiftDetailsEvent(e,t)})},getCacheData:function(){var e=this,t=e.get("data"),a=$.Deferred(),s=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),o=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),n=Komodo.Services.localizationService.getCurrentLanguage();return e.set("country",s),e.set("countryDescription",o),Komodo.Services.cachedDataService.fetch("ShiftStatus",{domain:s,qualifier:n}).done(function(e){t.set("shiftStatuses",[]),t.set("shiftStatuses",e);var s=e.find(function(){return e[0]});t.set("shiftStatus",s),a.resolve(e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve ShiftStatus domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("ShiftType",{domain:s,qualifier:n}).done(function(e){t.set("shiftTypes",[]),t.set("shiftTypes",e)}).fail(function(){
Komodo.log("[ERROR] : could not retrieve ShiftType domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("Currency",{domain:s,qualifier:n}).done(function(e){t.set("currencies",[]),t.set("currencies",e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Currency domain = "+s+"/ qualifier = "+n)}),e.getFeatureToggleService().isEnabled("OnlineTill","EnableAgencyBatchPayment").done(function(e){Ember.run(function(){t.reports.clear(),t.reports.push("Shift Details Report"),e&&t.reports.push("Agency Batch Payment Report"),t.set("report",t.reports[0])})}),a},getDate:function(e){return moment(e).format(KomodoConfiguration.dateFormat)},getTime:function(e){return moment(e).format(KomodoConfiguration.timeFormat)},showResultView:function(){return!(!this.data||!0!==this.data.isMessageVisible&&!0!==this.data.isGridVisible)}.property("data.isMessageVisible","data.isGridVisible"),getFeatureToggleService:function(){return this.get("_featureToggleService")},showBlockingBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,15e3,"blocking",this)},hideBusyIndicator:function(){Komodo.Services.busyService.stop(this.get("processId"),"blocking")},retrieveShiftsEvent:function(e,t){var a,s=this,o=s.get("data");a=void 0!==o.shiftId&&""!==o.shiftId?"shiftId="+o.shiftId:"shiftId=0";var n=o.shiftTypes.find(function(e){return e.value===("Shift Details Report"===o.selectedReport?"Cashier":"Batch")});a=a+"&userName="+o.selectedCashierName+"&shiftStatus="+o.shiftStatus.key+"&shiftType="+n.key+"&bankDepositNumber="+o.bdNumber,void 0!==o.startDate&&""!==o.startDate?a=a+"&startDate="+moment(o.startDate).format("YYYY-MM-DDThh:mm:ss"):a+="&startDate",void 0!==o.endDate&&""!==o.endDate?a=a+"&endDate="+moment(o.endDate).format("YYYY-MM-DDThh:mm:ss"):a+="&endDate",a=a+"&page="+e+"&pageSize="+s.pageSize,t&&s.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShifts?"+a).done(function(t){if(void 0!==t&&null!==t&&void 0!==t.Shifts){var a=o.get("shiftData");$($.makeArray(t.Shifts)).each(function(e,t){a.pushObject(s.genericController.populateShiftModel({Shift:t.Shift,StockHandlers:t.StockHandlers}))}),a.length>0&&"Batch"===a[0].type?s.gridColumns[0].set("title",kl.value(s._localeBase+"shift.batchNumber")):s.gridColumns[0].set("title",kl.value(s._localeBase+"shift.shiftNumber")),o.set("shiftData",a),o.set("isGridVisible",!0),o.set("isMessageVisible",!1),!0!==t.More&&"true"!==t.More||s.retrieveShiftsEvent(e+1,!1)}else o.set("shiftData",[]),o.set("isGridVisible",!1),o.set("isMessageVisible",!0);s.hideBusyIndicator()}).error(function(e){s.genericController.showErrorPopup("retrieveShifts",e),s.hideBusyIndicator()})},messageShiftsRetrievedEventReceived:function(e){var t=this,a=t.get("data");if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var s=e.ResponseMessage.Payload,o=[];$(s.Shifts).each(function(e,a){o.pushObject(t.genericController.populateShiftModel({Shift:a.Shift}))}),o.length>0&&"Batch"===o[0].type?t.gridColumns[0].set("title",kl.value(this._localeBase+"shift.batchNumber")):t.gridColumns[0].set("title",kl.value(this._localeBase+"shift.shiftNumber")),a.set("shiftData",o),a.set("isGridVisible",!0),a.set("isMessageVisible",!1)}else a.set("shiftData",[]),a.set("isGridVisible",!1),a.set("isMessageVisible",!0);t.hideBusyIndicator()},retrieveShiftDetailsEvent:function(e,t){var a=this,s=a.get("data"),o=s.shiftStatuses.find(function(t){return t.value===e.status});t&&a.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftDetails?shiftId="+e.shiftId+"&shiftStatus="+o.key+"&shiftType="+e.type).done(function(e){if(void 0!==e&&null!==e){var t=a.genericController.populateShiftModel(e);t.set("shiftDetails",[]),t.set("cancelledPayments",[]),a.set("shiftdata",t),a.retrieveShiftPaymentsEvent(t,1,!1),a.showReport()}a.hideBusyIndicator()}).error(function(e){a.genericController.showErrorPopup("retrieveShiftDetails",e),a.hideBusyIndicator()})},messageShiftDetailsRetrievedEventReceived:function(e){if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var t,a=this,s=a.genericController.populateShiftModel(e.ResponseMessage.Payload.Shifts);a.set("shiftdata",s);var o=a.get("data");"Shift Details Report"===o.selectedReport&&(t=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create(),t.country=a.countryDescription,t.userName=o.selectedCashierName,t.header="Shift",t.shiftNumber=s.shiftId,t.status=s.status,t.date=a.getDate(s.date),t.time=a.getTime(s.date),t.bankDepositNumber=s.bdNumber,t.stockHandlerDescription=s.stockHandlerDescription,t.currency=s.baseCurrency.value,t.summaryGridData=a.genericController.populateShiftSummary(s.shiftDetails),t.detailGridData=s.shiftDetails,this.showShiftDetailsReportPopup(t)),"Agency Batch Payment Report"===o.selectedReport&&(t=Komodo.Models.OnlineTill.BatchPaymentReportModel.create(),t.country=a.countryDescription,t.userName=o.selectedCashierName,t.header="Agency",t.batchNumber=s.shiftId,t.currency="",t.agent="",t.smsAccount="",t.status=s.status,t.date=a.getDate(s.date),t.time=a.getTime(s.date),t.bankDepositNumber=s.bdNumber,t.stockHandlerDescription=s.stockHandlerDescription,t.currency=s.baseCurrency.value,t.detailGridData=s.shiftDetails,t.summaryGridData=a.genericController.populateBatchSummaryModel(s),a.showBatchPaymentReportPopup(t))}this.hideBusyIndicator()},retrieveShiftPaymentsEvent:function(e,t,a){var s=this,o=s.get("data"),n="false",r=e.get("allowedCurrencies");a&&s.showBlockingBusyIndicator(),o.selectedReport&&"Agency Batch Payment Report"===o.selectedReport&&(n="true"),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&deepLoad="+n+"&page="+t+"&pageSize="+s.pageSize).done(function(a){if(void 0!==a&&null!==a){var n=Komodo.Services.OLTReportService.currentReportData.get("detailGridData"),i=Komodo.Services.OLTReportService.currentReportData.get("cancelledGridData");if(void 0!==a.Payments&&$(a.Payments).each(function(e,t){var a=s.genericController.populateShiftDetailModel(t);if("No"===a.isCancelled)n.pushObject(a);else{var o=JSON.parse(JSON.stringify(a));o.amount=parseFloat(-1*o.amount).toFixed(2),o.baseCurrencyAmount=parseFloat(-1*o.baseCurrencyAmount).toFixed(2),$(o.SplitPayments).each(function(e,t){t.amount=parseFloat(t.amount).toFixed(2)}),n.pushObject(o),i.pushObject(a)}}),e.set("shiftDetails",n),e.set("cancelledPayments",i),!0===a.More||"true"===a.More){var l=Math.ceil(t*s.pageSize/a.TotalCount*100)+"%";Komodo.Services.OLTReportService.currentReportData.set("spoolingPercentage",l),s.retrieveShiftPaymentsEvent(e,t+1,!1)}else Komodo.Services.OLTReportService.currentReportData.set("detailGridData",Komodo.Services.OLTReportService.currentReportData.detailGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("cancelledGridData",Komodo.Services.OLTReportService.currentReportData.cancelledGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),"Shift Details Report"===o.selectedReport&&(Komodo.Services.OLTReportService.currentReportData.set("allPayments",n),Komodo.Services.OLTReportService.currentReportData.set("allCurrencies",r),Komodo.Services.OLTReportService.currentReportData.set("allMethodOfPayments",s.methodOfPayments),Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",s.genericController.populateShiftSummary(n,s.methodOfPayments,r,!0)),!Ember.isEmpty(r)&&r.length>1&&Komodo.Services.OLTReportService.currentReportData.set("summaryTotalByCurrency",s.genericController.populateShiftSummaryTotalByCurrency(n,r))),"Agency Batch Payment Report"===o.selectedReport&&Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",s.genericController.populateShiftSummaryForAgency(n)),Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),"Shift Details Report"===o.selectedReport&&(s.genericController.setPaymentDetailsListByCurrencies(r),s.genericController.showReportPopup(kl.value(s._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")),"Agency Batch Payment Report"===o.selectedReport&&s.genericController.showReportPopup(kl.value(s._localeBase+"report.batchPaymentReport"),"batchPaymentReport")}else Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),"Shift Details Report"===o.selectedReport&&(s.genericController.setMultipleBusinessUnitDefaultSettings(),s.genericController.setPaymentDetailsListByCurrencies(r),s.genericController.showReportPopup(kl.value(s._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")),"Agency Batch Payment Report"===o.selectedReport&&s.genericController.showReportPopup(kl.value(s._localeBase+"report.batchPaymentReport"),"batchPaymentReport")}).error(function(e){s.genericController.showErrorPopup("retrieveShiftPayments",e),s.hideBusyIndicator()})},messageFailureMessageEventReceived:function(e){this.hideBusyIndicator();var t=kl.value(controller._localeBase+"shift.technicalError");void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfErrorDetails&&(t="",$(e.ResponseMessage.Payload.ListOfErrorDetails).each(function(e,a){t+=a.ErrorDescription})),Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t,Komodo.Controls.MessageBoxOkButton,this,"id544246673","danger")},messageReceived:function(e){this.hideBusyIndicator(),Komodo.UI.log("[PaymentReportController.messageReceived] : event name = "+e.ResponseMessage.EventName)},messageDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[PaymentReportController.messageDeliveryFailure] : messageId = "+e.messageId)},messageFault:function(e){this.hideBusyIndicator(),Komodo.UI.error("[PaymentReportController.messageFault] : messageId = "+e.messageId)},shiftdata:void 0,actions:{newProcess:function(){this.startNewProcess()},searchReport:function(){this.searchReport()},clearReport:function(){this.clearReport()},viewReport:function(){this.viewReport()},showBlockingBusyIndicator:function(){this.showBlockingBusyIndicator()},hideBusyIndicator:function(){this.hideBusyIndicator()}}}),Komodo.Application.GenericPaymentController=Komodo.UI.Controller.extend({localeBase:"locale.quotation:createQuotation.",init:function(){this._super(),Komodo.log("Constructing Generic Payment controller"),this.set("processVersion","v1.1"),this.set("processName","Payment process"),this.requiresDependency("_securityService",{singleton:Komodo.Services.securityService}),this.getCacheData()},start:function(){this.getCacheData(),this._super()},stop:function(){this._super()},getCacheData:function(){var e=this,t=$.Deferred(),a=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),s=Komodo.Services.localizationService.getCurrentLanguage();return Komodo.Services.cachedDataService.fetch("Currency",{domain:a,qualifier:s}).done(function(t){e.set("currencies",[]),e.set("currencies",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Currency domain = "+a+"/ qualifier = "+s)}),Komodo.Services.cachedDataService.fetch("AccountStatus",{domain:a,qualifier:s}).done(function(t){e.set("accountStatuses",[]),e.set("accountStatuses",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Account Status domain = "+a+"/ qualifier = "+s)}),Komodo.Services.cachedDataService.fetch("AccountType",{domain:a,qualifier:s}).done(function(t){e.set("accountTypes",[]),e.set("accountTypes",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Account Type domain = "+a+"/ qualifier = "+s)}),Komodo.Services.cachedDataService.fetch("MethodOfPayment",{domain:a,qualifier:s}).done(function(t){e.set("paymentMethods",[]),e.set("paymentMethods",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve MethodOfPayment domain = "+a+"/ qualifier = "+s)}),e.retrievePrinterTypesEvent(),t},showReportPopup:function(e,t){var a=this,s=Komodo.Services.OLTReportService.currentReportData;if(s){a.get("reportPoup")&&a.get("reportPoup").close(),s.set("showOfflinePaymentView",Komodo.Services.OLTReportService.showOfflinePaymentView);var o=Komodo.Services.uiService.showModalPopup(e,t,{context:{data:s,printReport:function(){var t=window.open();t.document.write("<html><head><title>"+e+"</title>"),t.document.write('<link rel="stylesheet" href="'+a.getPath()+'Content/bootstrap.css" type="text/css" />'),t.document.write('<link rel="stylesheet" href="'+a.getPath()+'Content/komodo-default.css" type="text/css" />'),t.document.write('<link rel="stylesheet" href="'+a.getPath()+'Content/modules.css" type="text/css" />'),t.document.write('<link rel="stylesheet" href="'+a.getPath()+'Content/komodo-defaults.min.css" type="text/css" />'),t.document.write("</head><body>"),t.document.write($("#reportView").html()),t.document.write("<script>window.print(); setTimeout(function () { window.close() }, 100);<\/script></body></html>")},cancel:function(){Komodo.Services.OLTReportService.retrievedReportData(void 0),o.close()}},closeCallback:function(){a.set("reportPoup",void 0)}});a.set("reportPoup",o)}},showErrorPopup:function(e,t){var a=this,s=JSON.stringify(t);Komodo.log(e+" ajax call failed. Error: "+s),t&&"string"===$.type(t.responseJSON)?Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t.responseJSON,Komodo.Controls.MessageBoxOkButtons,a,"id5446673","danger"):t.responseJSON&&t.responseJSON.ExceptionMessage?Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t.responseJSON.ExceptionMessage,Komodo.Controls.MessageBoxOkButtons,a,"id5446673","danger"):t.responseText?Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t.responseText,Komodo.Controls.MessageBoxOkButtons,a,"id5446673","danger"):t.statusText?Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),t.statusText,Komodo.Controls.MessageBoxOkButtons,a,"id5446673","danger"):Komodo.Controls.MessageBoxController.show(kl.value("locale:error"),JSON.stringify(t),Komodo.Controls.MessageBoxOkButtons,a,"id5446673","danger")},getPath:function(){var e=window.location.href;return e=e.substring(0,e.lastIndexOf("/"))+"/",e.replace("#/","")},getSecurityService:function(){return this.get("_securityService")},populateShiftModel:function(e){var t=this,a=Komodo.Models.OnlineTill.ShiftModel.create();a.set("shiftId",e.Shift.Id),a.set("stockHandlerId",e.Shift.StockHandlerAccountId),a.set("glNumber",e.Shift.GLNumber),a.set("status",e.Shift.Status),a.set("date",new Date(e.Shift.Date.replace(/[TZ]/," "))),a.set("dateString",moment(e.Shift.Date).format(KomodoConfiguration.dateTimeFormat)),a.set("type",e.Shift.Type),a.set("supervisorId",e.Shift.SupervisorUsername),a.set("bdNumber",e.Shift.BankDepositNumber),a.set("currencyRate",e.Shift.CurrencyRate),a.set("userName",e.Shift.Username),e.AllowedCurrencies&&(a.set("allowedCurrencies",[]),$(e.AllowedCurrencies).each(function(s,o){var n=e.ExchangeRates.find(function(e){return e.CurrencyId.toString()===o.Id.toString()}),r=t.currencies.find(function(e){return e.key.toString()===o.Id.toString()});if(n&&r){var i={key:r.key,value:r.value,rate:n.ConversionFactor,systemId:o.SystemId};a.allowedCurrencies.push(i),o.IsBaseCurrency&&!0===o.IsBaseCurrency&&a.set("baseCurrency",i)}}));var s=[];e.Payments&&e.Payments.Payments&&$(e.Payments.Payments).each(function(e,a){s.pushObject(t.populateShiftDetailModel(a))}),a.set("shiftDetails",s);var o=t.populateShiftSummaryBalance(e);return a.set("shiftSummary",o.shiftSummary),a.set("cash",o.cash),a.set("other",o.other),a.set("total",o.total),a.set("totalString",parseFloat(o.total).toFixed(2)),s=[],e.Printers&&e.Printers.Printers&&$(e.Printers.Printers).each(function(e,a){s.pushObject(t.populatePrinterModel(a))}),a.set("printers",s),s=[],e.StockHandlers&&e.StockHandlers.StockHandlers&&$(e.StockHandlers.StockHandlers).each(function(t,o){o.Id.toString()===e.Shift.StockHandlerAccountId.toString()&&(a.set("stockHandlerName",o.Name),a.set("stockHandlerDescription",o.Id+" - "+o.Name)),s.pushObject(o)}),s=s.sort(function(e,t){return e.IsDefault<t.IsDefault}),a.set("stockHandlers",s),a},populateShiftSummaryBalance:function(e){var t=this,a=[],s=0,o=0,n=0;return e&&(e.Summary&&e.Summary.Summary?($(e.Summary.Summary).each(function(e,o){n+=parseFloat(o.Amount.Value),a.pushObject(t.populateShiftSummaryModel(o)),"Cash"!==o.MethodOfPayment&&"cash"!==o.MethodOfPayment||(s+=parseFloat(o.Amount.Value))}),o=n-s):n=e.Shift.Balance.Value),Ember.Object.create({cash:s,other:o,total:n,shiftSummary:a})},populateShiftDetailModel:function(e){var t=Komodo.Models.OnlineTill.ShiftDetailModel.create();t.set("paymentId",e.Id),t.set("date",moment(e.PaymentDate).format("DD/MM/YYYY h:mm:ss")),t.set("paymentType",e.MethodOfPayment),t.set("isSplit","true"===e.IsSplit||!0===e.IsSplit?"Yes":"No"),t.set("isCancelled","true"===e.IsCancelled||!0===e.IsCancelled?"Yes":"No"),t.set("isRefund","true"===e.IsRefund||!0===e.IsRefund?"Yes":"No"),t.set("isCashSale","true"===e.IsCashSale||!0===e.IsCashSale?"Yes":"No"),t.set("sortId","Cash"===e.MethodOfPayment?1:"Cheque"===e.MethodOfPayment?2:"Card"===e.MethodOfPayment?3:0),"false"===e.IsCancelled||!1===e.IsCancelled?(t.set("amount",parseFloat(e.Amount.Value).toFixed(2)),t.set("baseCurrencyAmount",parseFloat(e.BaseCurrencyAmount.Value).toFixed(2))):(t.set("amount",parseFloat(-1*e.Amount.Value).toFixed(2)),t.set("baseCurrencyAmount",parseFloat(-1*e.BaseCurrencyAmount.Value).toFixed(2))),t.set("currency",this.currencies.find(function(t){return t.key===e.Amount.CurrencyCode}));var a=[];return $(e.SplitPayments).each(function(t,s){var o=Komodo.Models.OnlineTill.SplitPaymentModel.create();o.set("isFirst",0===t),o.set("receiptNumber",s.ReceiptNumber),o.set("customerNumber",s.CustomerId),o.set("accountNumber",s.AccountId),o.set("quoteId",s.QuotationId),o.set("financialTransactionId",s.FinancialTransactionId),o.set("customerName",s.CustomerName?s.CustomerName:""),o.set("currency",s.Amount.CurrencyCode),o.set("businessUnit",s.BusinessUnit),o.set("isOffline","No"),"false"===e.IsCancelled||!1===e.IsCancelled?(o.set("amount",parseFloat(s.Amount.Value).toFixed(2)),o.set("baseCurrencyAmount",parseFloat(s.BaseCurrencyAmount.Value).toFixed(2))):(o.set("amount",parseFloat(-1*s.Amount.Value).toFixed(2)),o.set("baseCurrencyAmount",parseFloat(-1*s.BaseCurrencyAmount.Value).toFixed(2))),a.pushObject(o)}),t.set("SplitPayments",a),t.set("accountHolderName",e.AccountHolderName),t.set("bankName",e.BankName),t.set("chequeAccountNumber",e.ChequeAccountNumber),t.set("branchName",e.BranchName),t.set("branchCode",e.BranchCode),t.set("chequeDate",e.ChequeDate),t.set("chequeNumber",e.ChequeNumber),t.set("cardNumber",e.CardNumber),t.set("cardAuthNumber",e.CardAuthNumber),t.set("cardCVVNumber",e.CardCVVNumber),t.set("cardExpiryDate",e.CardExpiryDate),t},populateShiftSummaryModel:function(e){var t=Komodo.Models.OnlineTill.ShiftSummaryModel.create();return t.set("currency",e.Amount.CurrencyCode),t.set("paymentType",e.MethodOfPayment),t.set("count",e.TotalPayments),t.set("cancelledCount",e.TotalCancelledPayments),t.set("amount",parseFloat(e.Amount.Value).toFixed(2)),t},populateShiftSummaryForAgency:function(e){var t=0,a=0,s=0,o=0,n=0,r=0,i="";$(e).each(function(e,l){"No"===l.isCancelled&&(i=this.currency.value,"Cash"===l.paymentType&&(t+=parseFloat(l.baseCurrencyAmount),a+=1),"Cheque"===l.paymentType&&(s+=parseFloat(l.baseCurrencyAmount),o+=1),"Card"===l.paymentType&&(n+=parseFloat(l.baseCurrencyAmount),r+=1))});var l,c=[];return a>0&&(l=Komodo.Models.OnlineTill.ShiftSummaryModel.create(),l.set("paymentType","Cash"),l.set("count",a),l.set("amount",parseFloat(t).toFixed(2)),l.set("currency",i),c.pushObject(l)),o>0&&(l=Komodo.Models.OnlineTill.ShiftSummaryModel.create(),l.set("paymentType","Cheque"),l.set("count",o),l.set("amount",parseFloat(s).toFixed(2)),l.set("currency",i),c.pushObject(l)),r>0&&(l=Komodo.Models.OnlineTill.ShiftSummaryModel.create(),l.set("paymentType","Card"),l.set("count",r),l.set("amount",parseFloat(n).toFixed(2)),l.set("currency",i),c.pushObject(l)),c},populateShiftSummary:function(e,t,a,s){var o=this,n=Ember.A(),r=e;return Komodo.Services.OLTReportService.currentReportData.set("isMultipleCurrency",void 0!=a&&a.length>1),s&&o.setMultipleBusinessUnitDefaultSettings(),r=o.setPaymentDetailsListByBusinessUnit(r),$(t).each(function(e,t){var s=0,i=$.grep(r,function(e,a){return e.paymentType===t&&"No"===e.isCancelled});if(!Ember.isEmpty(i)){var l=Ember.Object.create();if(l.set("paymentType",t),l.set("count",i.length),a.length>1){var c=o.getShiftSummaryByCurrency(i,a);l.set("splitByCurrencies",c),Ember.isEmpty(c)||$(c).each(function(e,t){s+=parseFloat(t.BaseAmount)})}else $(i).each(function(e,t){s+=parseFloat(t.baseCurrencyAmount)});l.set("amount",s.toFixed(2)),n.addObject(l)}}),n},populateShiftSummaryTotalByCurrency:function(e,t){var a=this,s=Ember.A(),o=!0,n=e;if(n=a.setPaymentDetailsListByBusinessUnit(n),$(t).each(function(e,t){var a=0,r=0,i=$.grep(n,function(e,a){return e.currency.value===t.value&&"No"===e.isCancelled});if(!Ember.isEmpty(i)){$(i).each(function(e,t){a=(parseFloat(a)+parseFloat(t.amount)).toFixed(2),r=(parseFloat(r)+parseFloat(t.baseCurrencyAmount)).toFixed(2)});var l=Ember.Object.create();l.set("currency",t.value),l.set("totalAmount",a),l.set("totalBaseAmount",r),l.set("isSplitRows",o),l.set("total",0),o=!1,s.addObject(l)}}),!Ember.isEmpty(s)&&s.length>0){var r=0;$(s).each(function(e,t){r=parseFloat(parseFloat(r)+parseFloat(t.totalBaseAmount)).toFixed(2)}),s[0].total=r}return s},getShiftSummaryByCurrency:function(e,t){var a=0,s=0,o=0,n=0,r=0,i=Ember.A(),l=!0;return $(t).each(function(c,u){var h=$.grep(e,function(e,t){return e.currency.value===u.value});if(!Ember.isEmpty(h)&&(a=0,s=0,o=0,r+=1,$(h).each(function(e,t){n=h.length,a=(parseFloat(a)+parseFloat(t.amount)).toFixed(2),s=(parseFloat(s)+parseFloat(t.baseCurrencyAmount)).toFixed(2),o=(parseFloat(o)+parseFloat(t.baseCurrencyAmount)).toFixed(2)}),0!==n)){var d=Ember.Object.create();d.set("isShowPaymentType",l),d.set("Name",u.value),d.set("Count",n),d.set("Amount",a),d.set("BaseAmount",s),d.set("CurrencyCount",t.length),i.addObject(d),l=!1}$.each(i,function(e,t){t.set("CurrencyCount",r)})}),i},setPaymentDetailsListByCurrencies:function(e){var t=this,a=JSON.parse(JSON.stringify(Komodo.Services.OLTReportService.currentReportData.get("detailGridData")));a=t.setPaymentDetailsListByBusinessUnit(a),t.paymentCountByPaymentTypes=t.getPaymentCountByPaymentType(a,!1),void 0!==t.paymentCountByPaymentTypes&&$(t.paymentCountByPaymentTypes).each(function(a,s){s.totalByCurrencies=t.getPaymentDetailsListByCurrencies(s.items,e)}),Komodo.Services.OLTReportService.currentReportData.set("hasPaymentData",!Ember.isEmpty(a)),Komodo.Services.OLTReportService.currentReportData.set("paymentCountByPaymentTypes",t.paymentCountByPaymentTypes);var s=JSON.parse(JSON.stringify(Komodo.Services.OLTReportService.currentReportData.get("cancelledGridData")));s=t.setPaymentDetailsListByBusinessUnit(s),t.cancelPaymentCountByPaymentTypes=t.getPaymentCountByPaymentType(s,!0),void 0!==t.cancelPaymentCountByPaymentTypes&&$(t.cancelPaymentCountByPaymentTypes).each(function(a,s){s.totalByCurrencies=t.getPaymentDetailsListByCurrencies(s.items,e)}),Komodo.Services.OLTReportService.currentReportData.set("hasCancelledPaymentData",!Ember.isEmpty(s)),Komodo.Services.OLTReportService.currentReportData.set("cancelPaymentCountByPaymentTypes",t.cancelPaymentCountByPaymentTypes)},setPaymentDetailsListByBusinessUnit:function(e){var t=JSON.parse(JSON.stringify(e));if(Komodo.Services.OLTReportService.currentReportData.get("isMultipleBusinessUnit")){var a=Komodo.Services.OLTReportService.currentReportData.get("selectedViewingPlatformData").toUpperCase();t=$.grep(t,function(e,t){if(e.SplitPayments.length>0&&1===e.SplitPayments.length&&e.SplitPayments[0].businessUnit===a)return e;if(e.SplitPayments.length>1){var s=parseFloat(e.amount),o=parseFloat(e.baseCurrencyAmount),n=$.grep(e.SplitPayments,function(e,t){return e.businessUnit===a});if(!Ember.isEmpty(n)&&n.length>0){var r=0,i=0;$(n).each(function(e,t){t.isFirst=0===e,r+=parseFloat(t.amount),i+=parseFloat(t.baseCurrencyAmount)});var l=s-r,c=o-i,u=(s-l).toFixed(2),h=(o-c).toFixed(2);return e.amount=u,e.baseCurrencyAmount=h,e.SplitPayments=n,e}}})}return t},getPaymentDetailsListByCurrencies:function(e,t){var a=[],s=0,o=0,n={};return void 0!=t&&t.length>1&&void 0!==e&&$.each(t,function(t,r){var i=$.grep(e,function(e){return e.currency.value===r.value});void 0!==i&&i.length>0&&($(i).each(function(e,t){s+=parseFloat(t.amount),o+=parseFloat(t.baseCurrencyAmount)}),n={currency:r.value,totalByCurrency:s.toFixed(2),totalByBaseCurrency:o.toFixed(2)},a.push(n),s=0,o=0)}),a},getPaymentCountByPaymentType:function(e,t){for(var a=this,s=[],o={},n=0;n<e.length;n++){var r=e[n].paymentType;o[r]||(o[r]=[]),o[r].push(e[n])}for(var i in o)if(o.hasOwnProperty(i)){var l=0,c=0,u=0;$(o[i]).each(function(e,t){l+=parseFloat(t.baseCurrencyAmount)}),l=parseFloat(l).toFixed(2),c=a.getColspanForDetailShiftReport(i,t),u=parseInt(c)+parseInt(1),s.push({paymentType:i,count:o[i].length,items:o[i],totalByCurrencies:[],totalInBaseCurrency:l,colSpanForCurrency:c,colSpanForTotal:u})}return s},getColspanForDetailShiftReport:function(e,t){var a=t?8:7;return"Cash"===e&&(a=parseInt(a)+parseInt(0)),"Cheque"===e&&(a=parseInt(a)+parseInt(3)),"Card"===e&&(a=parseInt(a)+parseInt(1)),Komodo.Services.OLTReportService.currentReportData.get("showOfflinePaymentView")&&(a=parseInt(a)+parseInt(1)),a},setMultipleBusinessUnitDefaultSettings:function(){Komodo.Services.OLTReportService.currentReportData.set("isMultipleBusinessUnit",Komodo.Services.OLTReportService.isMultipleBusinessUnit),Komodo.Services.OLTReportService.currentReportData.get("isMultipleBusinessUnit")&&(Komodo.Services.OLTReportService.currentReportData.set("isFirstOpen",!0),Komodo.Services.OLTReportService.currentReportData.set("viewingPlatformData",[{title:kl.value(this.localeBase+"dstv"),value:kl.value(this.localeBase+"dstv")},{title:kl.value(this.localeBase+"gotv"),value:kl.value(this.localeBase+"gotv")}]),Komodo.Services.OLTReportService.currentReportData.set("selectedViewingPlatformData",kl.value(this.localeBase+"dstv")),Komodo.Services.OLTReportService.currentReportData.set("logoPath","Content/Images/main_logo.svg")),Komodo.Services.OLTReportService.currentReportData.set("hasPaymentData",!1),Komodo.Services.OLTReportService.currentReportData.set("hasCancelledPaymentData",!1)},populateBatchSummaryModel:function(e){var t=[],a=Komodo.Models.OnlineTill.ShiftSummaryModel.create();return a.set("paymentType","Total Batch Amount"),a.set("amount",parseFloat(e.total).toFixed(2)),t.pushObject(a),a=Komodo.Models.OnlineTill.ShiftSummaryModel.create(),a.set("paymentType","Total Payments Amount"),a.set("amount",parseFloat(e.total).toFixed(2)),t.pushObject(a),a=Komodo.Models.OnlineTill.ShiftSummaryModel.create(),a.set("paymentType","Total Transactions"),a.set("amount",e.shiftDetails.length),t.pushObject(a),t},populateAccountModel:function(e){var t,a,s=[],o=this;if(void 0===e.ListOfAccount.Account||void 0===e.ListOfAccount.Account.length||e.ListOfAccount.Account.length<=0)t=Komodo.Models.OnlineTill.AccountModel.create(),t.set("accountNumber",""),t.set("status",""),t.set("type",""),t.set("chargeuntildate",""),t.set("overdue",""),t.set("currencyCode",""),t.set("methodOfPayment",""),t.set("displayText","-None-"),t.set("products",void 0),t.set("quotes",void 0),s.push(t);else{var n=Komodo.Models.OnlineTill.AccountModel.create();n.set("accountNumber",""),n.set("status",""),n.set("type",""),n.set("chargeuntildate",""),n.set("overdue",""),n.set("currencyCode",""),n.set("methodOfPayment",""),n.set("displayText","-All-"),n.set("products",void 0),s.push(n);var r=[],i=0;$(e.ListOfAccount.Account).each(function(e,n){t=Komodo.Models.OnlineTill.AccountModel.create(),t.set("accountNumber",n.UID);var l=o.accountStatuses.find(function(e){return e.key===n.Status});t.set("status",l?l.value:"");var c=o.accountTypes.find(function(e){return e.key===n.Type});t.set("type",c?c.value:""),n.PaymentDetail&&(a=o.paymentMethods.find(function(e){return e.key===n.PaymentDetail.MethodOfPayment}),t.set("chargeuntildate",o.getDueDateOfAnAccount(n.PaymentDetail.DebitOrderDay))),n.Balance&&n.Balance.Value&&(t.set("overdue",parseFloat(n.Balance.Value).toFixed(2)),t.set("currencyCode",n.Balance.CurrencyCode),i=parseFloat(i)+parseFloat(n.Balance.Value)),t.set("methodOfPayment",a?a.value:""),t.set("displayText",n.UID+": "+t.type+" ("+t.status+"-"+t.methodOfPayment+")");var u=o.populateProductModel(n);$(u).each(function(e,t){r.pushObject(t)}),t.set("products",u),t.set("quotes",void 0),t.set("isDefault",n.IsDefault),s.push(t)}),n.set("overdue",parseFloat(i).toFixed(2)),s[0].set("products",r)}return s},populateProductModel:function(e){var t=[];return void 0!==e.ListOfAgreement&&null!==e.ListOfAgreement&&$(e.ListOfAgreement.Agreement).each(function(a,s){void 0!==s.ListOfHardware&&$(s.ListOfHardware.Hardware).each(function(a,s){void 0!==s.ListOfService&&null!==s.ListOfService&&$(s.ListOfService.Service).each(function(a,o){var n=Komodo.Models.OnlineTill.ProductModel.create();n.set("accountNumber",e.UID),n.set("productId",o.UID),n.set("productStatus",o.Status),n.set("hardware",s.ProductDetail.Name),n.set("productName",o.ProductDetail.Name),n.set("productType",o.ProductDetail.Type),n.set("smartcardNumber",s.LinkedSmartcard),t.push(n)})})}),t},populatePrinterModel:function(e){var t=this,a=Komodo.Models.OnlineTill.PrintingModel.create();if(a.set("UID",e.UID),a.set("printerName",e.PrinterName),a.set("ipAddress",e.IPAddress),a.set("printerLayout",e.DefaultLayout),a.set("isActive","true"===e.IsActive||!0===e.IsActive),void 0!==t.printerTypes){var s=$.grep($.makeArray(t.printerTypes),function(t){return t.UID.toString()===e.PrinterType.toString()});s&&s.length>0&&a.set("printerType",s[0].name)}return a},getCustomerInformation:function(e){var t="",a=[],s=[];return $(e.accounts).each(function(e,o){$(o.products).each(function(e,o){void 0!==o.smartcardNumber&&""!==o.smartcardNumber&&(t=o.smartcardNumber),"Insurance"===o.productType&&-1===$.inArray(o.productType,s)&&s.push(o.productName),""!==o.hardware&&-1===$.inArray(o.hardware,a)&&a.push(o.hardware)})}),{SmartCardNumber:t,Hardware:a.join("</br>"),Insurance:s.join("</br>")}},getDueDateOfAnAccount:function(e){var t,a=parseInt(e,10),s=new Date,o=new Date(s.getFullYear(),s.getMonth(),a);return t=1===XDates.compare(s,o)?XDates.getNextMonthDateForDay(e):o,XDates.getDateFromJavascriptDate(t)},validateUserClaim:function(e,t,a,s){var o=this,n=$.Deferred();return o.getSecurityService().authenticate(e,t,a).done(function(e){var t=void 0;$(e.permissions).each(function(a,o){$(s).each(function(a,s){if(s===o)return void(t=e.sessionToken)})}),n.resolve(t)}).fail(function(){n.resolve(void 0)}),n},retrievePrinterTypesEvent:function(){var e=this;Komodo.Services.queryService.getJSON("/PointOfSale/RetrievePrinterTypes").done(function(t){if(void 0!==t&&null!==t&&void 0!==t.PrinterTypes){var a=[];$($.makeArray(t.PrinterTypes)).each(function(e,t){var s=Komodo.Models.Printing.PrinterTypesModel.create();s.set("UID",t.Id),s.set("name",t.Name),s.set("isActive",t.IsActive),a.pushObject(s)}),e.set("printerTypes",a)}else e.set("printerTypes",void 0)}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrievePrinterTypes ajax call failed. Error: "+t)})},selectedBusinessUnitChanged:function(){var e=this,t=Komodo.Services.OLTReportService.currentReportData.get("isFirstOpen");if(!Ember.isEmpty(t))if(t)Komodo.Services.OLTReportService.currentReportData.set("isFirstOpen",!1);else{$(".printing").scrollTop(0);var a=[],s=[],o=[]
;Ember.isEmpty(Komodo.Services.OLTReportService.currentReportData.get("allPayments"))||(a=JSON.parse(JSON.stringify(Komodo.Services.OLTReportService.currentReportData.get("allPayments")))),Ember.isEmpty(Komodo.Services.OLTReportService.currentReportData.get("allCurrencies"))||(s=JSON.parse(JSON.stringify(Komodo.Services.OLTReportService.currentReportData.get("allCurrencies")))),Ember.isEmpty(Komodo.Services.OLTReportService.currentReportData.get("allMethodOfPayments"))||(o=JSON.parse(JSON.stringify(Komodo.Services.OLTReportService.currentReportData.get("allMethodOfPayments")))),Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",e.populateShiftSummary(a,o,s,!1)),!Ember.isEmpty(s)&&s.length>1&&Komodo.Services.OLTReportService.currentReportData.set("summaryTotalByCurrency",e.populateShiftSummaryTotalByCurrency(a,s)),e.setPaymentDetailsListByCurrencies(s),Komodo.Services.OLTReportService.currentReportData.set("logoPath","Content/Images/"+("GOTV"===Komodo.Services.OLTReportService.currentReportData.selectedViewingPlatformData.toUpperCase()?"gotv-alt.svg":"main_logo.svg"))}}.observes("Komodo.Services.OLTReportService.currentReportData.selectedViewingPlatformData"),currencies:[],accountTypes:[],accountStatuses:[],paymentMethods:[],printerTypes:[],reportPopup:void 0}),Komodo.Application.PaymentController=Komodo.UI.Controller.extend({_localeBase:"locale.onlinetill:",_supervisorClaim:["clarity://system/supervisor","clarity://olt/cancelReprintPayment"],_isRestrictedForAgencyPayment:"clarity://olt/restrictedForAgencyPayment",needs:["customerProfile","search","customerProfileContainer","paymentReport","genericPayment"],methodOfPayments:["Cash","Cheque","Card"],controller:void 0,genericController:void 0,country:void 0,countryDescription:void 0,pageSize:20,offlinePayments:void 0,offlinePaymentsCount:0,invokeRetrieveQuotationsEvent:!1,init:function(){this._super(),Komodo.log("Constructing Payment controller"),this.set("processVersion","v1.1"),this.set("processName","Payment process");var e=this;e.requiresDependency("_cacheRepository",{singleton:Komodo.Repositories.cacheRepository}),e.requiresDependency("_securityService",{singleton:Komodo.Services.securityService}),e.requiresDependency("_uiService",{singleton:Komodo.Services.uiService}),e.requiresDependency("_systemService",{singleton:Komodo.Services.systemService}),e.set("srqGridColumns",[Komodo.Controls.DataGridColumn.create({name:"invoiceText",title:kl.value(e._localeBase+"quote.invoiceText"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"startDate",title:kl.value(e._localeBase+"shift.startDate"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"endDate",title:kl.value(e._localeBase+"shift.endDate"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"baseAmount",title:kl.value(e._localeBase+"quote.baseAmount"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"adjustmentAmount",title:kl.value(e._localeBase+"quote.adjustmentAmount"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"taxAmount",title:kl.value(e._localeBase+"quote.taxAmount"),canEdit:!1}),Komodo.Controls.DataGridColumn.create({name:"amount",title:kl.value(e._localeBase+"quote.amount"),canEdit:!1})]),e.set("quoteGridColumns",[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(e._localeBase+"customer.productName")}),Komodo.Controls.DataGridColumn.create({name:"quantity",title:kl.value(e._localeBase+"customer.quantity"),width:"120px"}),Komodo.Controls.DataGridColumn.create({name:"quotedUnitPrice",title:kl.value(e._localeBase+"customer.quotedUnitPrice")})]),e.registerModel("data",Komodo.Models.OnlineTill.PaymentModel),e.set("QuotationPayment",!1),Komodo.Services.eventAggregator.subscribe("PublishCustomerSelected",function(t){void 0!==t&&(e.data.set("customers",t),e.setCustomerDetailsData())}),Komodo.Services.eventAggregator.subscribe("PublishQuotationPayment",function(t){if(void 0!==t&&void 0!==t.QuoteNumber&&""!==t.QuoteNumber){e.data.set("paymentType",kl.value("locale.onlinetill:home.subTitleCashSales")),e.data.set("quoteId",t.QuoteNumber),e.data.set("customerNumber",t.CustomerNumber),e.data.get("stockHandlerId")?e.retrieveQuotationsEvent():e.set("invokeRetrieveQuotationsEvent",!0);var a=t.CustomerNumber;a&&(e.set("linkedCustomerNumber",a),e.findCustomers([{CustomerID:a}]))}})},start:function(){var e=this,t=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();Komodo.Services.OLTReportService.retrievedReportData(t);var a=void 0!==Komodo.Services.uiService.getController("home").route?Komodo.Services.uiService.getController("home").route.get("router.location.lastSetURL"):void 0;e.set("lastSetURL",a);var s=e.get("data");e.registerValidator(s,"methodOfPayment",{isRequired:!0,type:"string"}),e.registerValidator(s,"currency",{isRequired:!0,type:"string"}),e.registerValidator(s,"paymentAmount",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}),e.registerValidator(s,"amountTendered",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}),e.clearModelData(),s.set("isCommercialCustomer",!1),s.set("cashierName",Komodo.Services.securityService.get("domainUserName")),e.getCacheData().done(function(){s.set("methodOfPayment",s._getDefaultMethodOfPayment());var t=e.get("shiftdata");void 0===t||null===t?s.isOffLine||(e.clearShiftDetails(),e.retrieveShiftDetailsEvent(!0,!0)):(s.set("shiftNumber",t.shiftId),s.set("stockHandlerId",t.stockHandlerId),s.set("stockHandlers",t.stockHandlers),s.set("currency",t.baseCurrency),s.set("baseCurrency",t.baseCurrency.value),s.set("shiftType",t.type),s.set("generalLedger",t.glNumber),s.set("bankDepositNumber",t.bdNumber),s.set("isBankDepositNumberVisible",null!==t.bdNumber&&""!==t.bdNumber),s.set("allowedCurrencies",t.allowedCurrencies),s.set("cash",parseFloat(t.cash).toFixed(2)),s.set("other",parseFloat(t.other).toFixed(2)),s.set("total",parseFloat(t.total).toFixed(2)),e.syncOfflinePayments()),e.paymentMethodChanged(),!0!==e.autoPopulateData()||s.isOffLine||void 0!==Komodo.Services.customerProfileService.personalDetails&&(void 0!==e.data.quoteId&&""!==e.data.quoteId&&null!==e.data.quoteId||s.get("paymentType")===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.get("paymentType")===kl.value("locale.onlinetill:home.subTitleCashSales")||!1!==e.QuotationPayment||e.setCustomerDetailsFromController()),e.set("QuotationPayment",!1),e.set("autoPopulateFlag",!0),e.set("enableFiscalization",e.data.enableFiscalization),e.set("enableInvoice",e.data.enableInvoice),e.setEmailReceiptDetailIfEmailReceiptAllowed(e.data.enableEmailReceipt)}),e.genericController=e.get("controllers.genericPayment"),e.genericController&&e.genericController.start(),e.hideShiftDetails(),e.hideCustomerDetails(),e.getCachePrinter(),e.set("data.searchTextPlaceholder",kl.value("locale.onlinetill:customer.searchPlaceholder")),this._super()},stop:function(){this._super()},getCacheRepository:function(){return this.get("_cacheRepository")},getSecurityService:function(){return this.get("_securityService")},getUIService:function(){return this.get("_uiService")},getSystemService:function(){return this.get("_systemService")},isMobileDevice:function(){return this.getSystemService().get("isMobile")}.property(),isNonWindowsSystem:function(){var e=void 0;return navigator&&navigator.appVersion&&(-1!==navigator.appVersion.indexOf("Win")&&(e="Windows"),-1!==navigator.appVersion.indexOf("Mac")&&(e="MacOS"),-1!==navigator.appVersion.indexOf("X11")&&(e="UNIX"),-1!==navigator.appVersion.indexOf("Linux")&&(e="Linux")),void 0!==e&&"Windows"!==e},enableOffline:function(){var e=this,t=e.get("data");!t.isOffLine&&Komodo.Services.offlineService.workingOffline()?(e.set("selectedPaymentType",t.paymentType),e.set("selectedMethodOfPayment",t.methodOfPayment),t.set("paymentType",kl.value("locale.onlinetill:home.subTitleCustomerPayment")),t.set("methodOfPayment","Cash"),t.set("isOffLine",!0)):t.isOffLine&&Komodo.Services.offlineService.workingOffline()||(void 0!==e.paymentType&&t.set("paymentType",e.paymentType),void 0!==e.methodOfPayment&&t.set("methodOfPayment",e.methodOfPayment),t.set("isOffLine",!1))},autoPopulateData:function(){var e=!1,t=this,a=t.get("data");return a.get("paymentType")!==kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&a.get("paymentType")!==kl.value("locale.onlinetill:home.subTitleSplitPayment")||(e=!0),a.get("paymentType")===kl.value("locale.onlinetill:home.subTitleCashSales")&&"/customerPayment"!==t.get("lastSetURL")&&"/splitPayment"!==t.get("lastSetURL")&&"/batchPayment"!==t.get("lastSetURL")&&(e=!0),!1===t.get("autoPopulateFlag")&&(e=!1),e},setPaymentType:function(e){var t=this,a=t.get("data");a&&(a.set("paymentType",e.value),a.set("isOffLine",!1)),t.enableOffline()},clearQuoteData:function(){this.get("data").set("quoteId",void 0)},clearModelData:function(){var e=this,t=e.get("data");t.set("gridData",[]),t.set("productGridData",[]),t.set("quoteGridData",[]),t.set("srqCustomer",void 0),t.set("customer",void 0),t.set("drawerName",void 0),t.set("chequeNumber",void 0),t.set("chequeBank",void 0),t.set("chequeBranch",void 0),t.set("chequeBranchCode",void 0),t.set("cardNumber",void 0),t.set("cardHolder",void 0),t.set("cardType",t._getDefaultMethodOfPaymentSub()),t.set("paymentAmount",void 0),t.set("originalQuoteAmount",void 0),t.set("enableMakePayment",!1),t.set("showQuoteInformation",!1),t.set("searchText",""),t.set("autoReconnectProducts",!0),t.set("disableReconnectProducts",!0),t.set("enableAmountLowestDenomination",void 0),e.set("smartcardNumber",""),e.set("paymentNotes",Ember.Object.create()),e.set("chargeUntilDate",""),!0!==e.QuotationPayment&&t.set("quoteId",void 0),e.set("popup",void 0)},clearShiftDetails:function(){var e=this,t=e.get("data");t.set("shiftNumber",void 0),t.set("generalLedger",void 0),t.set("baseCurrency",void 0),t.set("stockHandlerId",void 0),t.set("stockHandlers",[]),t.set("allowedCurrencies",void 0),t.set("currencyRate",void 0),t.set("shiftType",void 0),t.set("bankDepositNumber",void 0),t.set("isBankDepositNumberVisible",!1),t.set("cash",parseFloat(0).toFixed(2)),t.set("other",parseFloat(0).toFixed(2)),t.set("total",parseFloat(0).toFixed(2)),e.set("shiftdata",void 0)},userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},countryCode:function(){return this.country},setCountryUserName:function(e){e.set("Country",this.country),e.set("UserName",this.userName())},setCustomerDetailsForCustomerPayment:function(){var e=this,t=e.get("data"),a=Komodo.Models.OnlineTill.AccountModel.create();a.set("accountNumber",""),a.set("status",""),a.set("type",""),a.set("chargeuntildate",""),a.set("overdue",""),a.set("currencyCode",""),a.set("methodOfPayment",""),a.set("displayText","-All-"),a.set("products",void 0),a.set("quotes",void 0),a.set("selected",!1),$(t.customers).each(function(s,o){t.set("gridData",[]),t.set("srqCustomer",void 0),a.set("quotes",[]),a.set("products",[]);var n=0,r=0;o.accounts&&($(o.accounts).each(function(e,t){if(t.set("displayText",t.accountNumber+": "+t.type+" ("+t.status+"-"+t.methodOfPayment+")"),t.accountNumber.toString()===o.account.accountNumber.toString()){var s=0;parseFloat(t.overdue)>0&&(s=parseFloat(t.overdue)),n+=s}else t.set("selected",!1);$(t.quotes).each(function(e,t){a.get("quotes").push(t),t.isSelected&&(r+=isNaN(t.totalAmount)?0:parseFloat(t.totalAmount))}),$(t.products).each(function(e,t){a.get("products").push(t)})}),o.accounts.splice(0,0,a)),o.set("quote",o.quote.length>0?o.quote[0]:o.quote),o.set("quotes",a.get("quotes")),o.set("subTotal",parseFloat(r).toFixed(2)),o.set("balance",parseFloat(n).toFixed(2)),o.set("payAmount",parseFloat(o.payAmount).toFixed(2)),t.set("customerNumber",o.customerNumber),t.get("gridData").pushObject(o),t.set("customer",o),t.set("originalQuoteAmount",parseFloat(o.payAmount).toFixed(2)),t.set("paymentAmount",e.getConvertedAmountByCurrency(parseFloat(o.payAmount).toFixed(2)))}),void 0!==a.get("quotes")&&a.get("quotes").length>0?a.get("quotes").forEach(function(e){Ember.isEmpty(e)||(e.isSelected&&"-"!==e.quoteId&&t.set("autoReconnectProducts",!0),e.isSelected&&"-"===e.quoteId&&t.set("autoReconnectProducts",!1))}):t.set("autoReconnectProducts",!1),e.hideCustomerDetails()},getConvertedAmountByCurrency:function(e){var t=isNaN(e)?0:e,a=this.get("data");if(void 0!==a.currency&&null!==a.currency&&""!==a.baseCurrency&&a.baseCurrency!==a.currency.value){var s=isNaN(e)?0:e,o=isNaN(a.currency.rate)?0:parseFloat(a.currency.rate);o>0&&(t=s/o),0!==t&&(t+=this.getFractionToAdd((t*o).toFixed(2),parseFloat(e).toFixed(2)))}return 0!==t?parseFloat(t).toFixed(2):t},getFractionToAdd:function(e,t){var a=0,s=e-t;return s=Math.abs(s),s>0&&s>.5&&(a=.01),a},setCustomerDetailsForSplitPayment:function(){var e=this.get("data"),t=!1;$.each(e.customers,function(e,a){var s=Komodo.Models.OnlineTill.AccountModel.create();s.set("accountNumber",""),s.set("status",""),s.set("type",""),s.set("chargeuntildate",""),s.set("overdue",""),s.set("currencyCode",""),s.set("methodOfPayment",""),s.set("displayText","-All-"),s.set("products",void 0);var o=[];o.push(s),$.merge(o,a.get("accounts")),$.each(o,function(e,t){a.account&&a.account.accountNumber===t.accountNumber&&t.set("selected",!0)}),a.set("accounts",o),a.set("accountCount","("+(o.length-1)+")"),(void 0===a.quotes||void 0===a.quotes.length||a.quotes.length<1)&&(t=!1);var n=0;$(a.quotes).each(function(e,t){t.isSelected&&(n+=isNaN(t.totalAmount)?0:parseFloat(t.totalAmount))});var r=0;$(a.accounts).each(function(e,t){if(t.accountNumber.toString()===a.account.accountNumber.toString()){var s=0;parseFloat(t.overdue)>0&&(s=parseFloat(t.overdue)),r+=s}}),a.set("subTotal",parseFloat(n).toFixed(2)),a.set("balance",parseFloat(r).toFixed(2))}),e.set("gridData",e.customers),e.set("autoReconnectProducts",t),e.set("disableReconnectProducts",!t)},setCustomerDetailsData:function(){var e=this,t=e.get("data");t.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&(void 0!==t.customerNumbers&&t.customerNumbers.length>1?t.set("paymentType",kl.value("locale.onlinetill:home.subTitleSplitPayment")):t.set("paymentType",kl.value("locale.onlinetill:home.subTitleCustomerPayment"))),t.set("autoReconnectProducts",!0),$(t.customers).each(function(a,s){if(t.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&(t.set("gridData",[]),t.set("srqCustomer",void 0)),t.set("customerNumber",s.customerNumber),t.get("gridData").pushObject(s),t.set("customer",s),t.isOffLine){var o=[];$(s.accounts).each(function(e,t){var a=Komodo.Models.OnlineTill.AccountModel.create();a.set("accountNumber",t.number),a.set("status",t.status),a.set("methodOfPayment",t.mop),a.set("displayText",t.number+":"+t.status+"-"+t.mop),a.set("products",[]),o.push(a)}),s.set("accounts",o),s.set("account",o.length>0?o[0]:void 0)}else s.set("accounts",[]),e.retrieveFinancialDetails(s.customerNumber),e.retrieveCustomerRDChequeStatus(s)}),e.showBlockingBusyIndicator(),e.hideCustomerDetails()},setCustomerDetailsFromController:function(){var e=this,t=e.get("data"),a=void 0;if(a=Komodo.Services.customerProfileService.personalDetails,void 0!==a&&void 0!==a.customerNo||void 0===e.get("controllers.customerProfile").customerProfileModel||(a=e.get("controllers.customerProfile").customerProfileModel.personalDetails),void 0!==a&&void 0!==a.customerNo||void 0===e.get("controllers.customerProfileContainer").personalDetails||(a=e.get("controllers.customerProfileContainer").personalDetails),void 0!==a&&void 0!==a.customerNo){t.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&t.set("paymentType",kl.value("locale.onlinetill:home.subTitleCustomerPayment"));var s=Komodo.Models.OnlineTill.CustomerModel.create();s.set("customerNumber",a.customerNo),s.set("title",a.title),s.set("customerFirstname",a.firstName),s.set("customerSurname",a.lastName),s.set("customerName",e.concatStrings(a.title,a.firstName,a.lastName)),s.set("customerClass",a.customerClassText),s.set("customerType",a.customerTypeText),s.set("telNo",a.telNo),s.set("mobileNo",a.mobileNo),s.set("locationIndicator",a.locationIndicator),s.set("email",a.email),s.set("isActiveCustomer",a.isActiveCustomer),s.set("isPotentialCustomer",a.isPotentialCustomer),s.set("isBadDebtCustomer",a.isBadDebtCustomer),s.set("isClosedCustomer",a.isClosedCustomer),s.set("isFraudCustomer",a.isFraudCustomer),s.set("isSuspendedCustomer",a.isSuspendedCustomer),s.set("isDeceased",a.isDeceased),s.set("isEmigrated",a.isEmigrated),s.set("isFraudInvestigation",a.isFraudInvestigation),s.set("isDstv",a.isDstv),s.set("isGotv",a.isGotv),s.set("businessUnit",void 0!==a.viewPlatform?a.viewPlatform.toUpperCase():""),s.set("customerStatus",a.customerStatus),s.set("accounts",[]),t.set("gridData",[]),t.get("gridData").pushObject(s),t.set("customerNumber",a.customerNo),t.set("customer",s),e.retrieveFinancialDetails(a.customerNo),e.retrieveCustomerRDChequeStatus(s),e.hideCustomerDetails()}},addCustomer:function(){var e=this,t=e.get("data");e.set("smartcardNumber","");var a=t.gridData.length>0?t.gridData[0].customerNumber:"";t.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")?t.searchText!==a&&e.get("controllers.search").searchCustomer(t.searchText,!1):e.get("controllers.search").searchCustomer(t.searchText,!0)},canCancelPayment:function(e){var t=this,a=void 0;if(void 0!==t.popup){var s=e._parentView._parentView._parentView._parentView.get("content");a=Komodo.Models.OnlineTill.CancelPaymentModel.create(),a.set("shiftNumber",t.data.shiftNumber),a.set("paymentId",s.paymentId),a.set("SplitPayments",s.SplitPayments),a.set("amount",s.amount),a.set("currency",s.currency),a.set("currencyRate",s.currencyRate),a.set("date",s.date),a.set("paymentType",s.paymentType),a.set("isCancelled",s.isCancelled),a.set("isSplit",s.isSplit),a.set("enableFiscalization",t.data.enableFiscalization?1:0),a.set("enableInvoice",t.data.enableInvoice?1:0),a.set("isCashSale",s.isCashSale),a.set("disableAction",!1)}if(void 0!==a)if("No"===a.isCancelled)if("Yes"===a.isCashSale&&a.SplitPayments&&a.SplitPayments.length>0){var o=a.SplitPayments[0].quoteId;o&&isNaN(o)?Komodo.Services.queryService.getJSON("SwapMaterialAvailability/GetCrmQuote?quoteNumber="+o).done(function(e){"2"===e.Category||"3"===e.Category?alert(kl.value(t._localeBase+"shift.cancelCashSalePaymentError")):t.cancelPayment(a)}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetCrmQuote ajax call failed. Error: "+t)}):t.cancelPayment(a)}else t.cancelPayment(a);else alert(kl.value(t._localeBase+"shift.cancelPaymentError"))},cancelPayment:function(e){var t=this;if(void 0!==e){t.registerValidator(e,"reason",{isRequired:!0,type:"string"}),t.registerValidator(e,"supervisorUsername",{isRequired:!0,type:"string"}),t.registerValidator(e,"passCode",{isRequired:!0,type:"string"}),t.popup.close();var a=Komodo.Application.ModalPaneController.create();a.popup(kl.value(t._localeBase+"home.cancelReceiptTitle"),"cancelPayment",{context:{data:e,cancelReason:[{key:t.cancelReason,value:t.cancelReason}],ok:function(){var e=this,s=e.data.paymentId,o=e.data.reason.key;e.data.set("disableAction",!0),t.genericController.validateUserClaim(t.country,e.data.supervisorUsername,e.data.passCode,t._supervisorClaim).done(function(n){void 0!==n?t.data.cashierName===e.data.supervisorUsername?(e.data.set("disableAction",!1),alert(kl.value(t._localeBase+"shift.unauthoriseCancelError"))):(a.close(),t.cancelPaymentEvent(s,o,e.data.supervisorUsername,n)):(e.data.set("disableAction",!1),alert(kl.value(t._localeBase+"shift.messageAccessValidate")))})},cancel:function(){a.close(),t.shiftDetails()}}})}},rePublish:function(e){var t=this;if(void 0!==t.popup){var a=e._parentView._parentView._parentView._parentView.get("content"),s=Komodo.Models.Payment.create(),o=Komodo.canonicalFacadeFactory(s,["UID","MethodOfPayment","MethodOfPaymentSub","ShiftID","StockHandlerID","IsCancelled","IsSplit","IsCashSale","Amount","AmountTendered","PaymentDate","IsAutoReconnectRequired","ShiftType","PaymentStatus","AccountHolderName","BankName","BranchName","BranchCode","ChequeDate","ChequeNumber","SplitPayments","WasOffline","IsRefund","CardAuthNumber","SupervisorUsername","ElevatedPrivilegeSessionToken"]);t.setCountryUserName(o),o.set("UID",a.paymentId),o.set("MethodOfPayment",a.paymentType),o.set("ShiftID",t.data.shiftNumber),o.set("StockHandlerID",t.data.stockHandlerId),o.set("ShiftType","Cashier");var n=void 0!==a.currency&&null!==a.currency?a.currency.key:"",r=Komodo.Models.Price.create();r.set("CurrencyCode",n),r.set("Value",a.amount),o.set("AmountTendered",r);var i=Komodo.Models.Price.create();i.set("CurrencyCode",n),i.set("Value",a.amount),o.set("Amount",i),o.set("IsCancelled","Yes"===a.isCancelled?1:0),o.set("IsSplit","Yes"===a.isSplit?1:0),o.set("IsCashSale",1),o.set("IsAutoReconnectRequired",1),o.set("IsRefund","Yes"===a.isRefund?1:0);var l=[],c=Komodo.Models.SplitPayment.create();$(a.SplitPayments).each(function(e,t){c=Komodo.Models.SplitPayment.create();var a=Komodo.Models.Price.create();a.set("CurrencyCode",n),a.set("Value",void 0!==t.amount&&""!==t.amount?t.amount:0),c.set("Amount",a),c.set("CustomerID",t.customerNumber),c.set("AccountID",t.accountNumber),c.set("QuotationID",t.quoteId),l.push(c)}),void 0!==l&&l.length>1&&o.set("IsSplit",1),o.set("SplitPayments",l),o.set("WasOffline",0);var u=Komodo.Models.CreatePayment.create(),h=Komodo.canonicalFacadeFactory(u,["Country","UserName","SupervisorUsername","Payment"]);t.setCountryUserName(h),h.set("Payment",s),Komodo.Services.OLTService.publishOLTEvent(t,u,"CreatePaymentEvent","v2",!1),t.popup.close()}},getHardwareInvoice:function(e){var t=this;if(t.showBlockingBusyIndicator(),void 0!==t.popup){var a=e._parentView._parentView._parentView._parentView._parentView.get("content");Komodo.Services.queryService.getJSON("/PointOfSale/GetPaymentWithSapInvoice?paymentId="+a.paymentId).done(function(e){t.hideBusyIndicator(),t.searchCustomers(e,!1,!1).done(function(){t.searchQuotes(e).done(function(){e&&t.showReceiptPopup(e)})}).fail(function(e){e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),Komodo.log("searchCustomers ajax call failed. Error: "+JSON.stringify(e))})}).error(function(e){t.hideBusyIndicator(),e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),Komodo.log("Get Sap Invoice Details ajax call failed. Error: "+JSON.stringify(e))}),t.popup.close()}},reprintReceipt:function(e){var t,a=this,s=void 0;if(a.set("smartcardNumber",""),!1===a.get("data").reprintSupervisorApprovalRequired)t=e._parentView._parentView._parentView._parentView.get("content"),void 0!==a.popup&&a.popup.close(),a.retrieveReceiptDetailsEvent(t.paymentId);else if(void 0!==a.popup&&(t=e._parentView._parentView._parentView._parentView.get("content"),s=Komodo.Models.OnlineTill.ReprintReceiptModel.create(),s.set("shiftNumber",a.data.shiftNumber),s.set("paymentId",t.paymentId),s.set("SplitPayments",t.SplitPayments),s.set("amount",t.amount),s.set("currency",t.currency),s.set("currencyRate",t.currencyRate),s.set("date",t.date),s.set("paymentType",t.paymentType),s.set("isCancelled",t.isCancelled),s.set("isSplit",t.isSplit),s.set("disableAction",!1),a.registerValidator(s,"supervisorUsername",{isRequired:!0,type:"string"}),a.registerValidator(s,"passCode",{isRequired:!0,type:"string"}),a.popup.close()),void 0!==s){var o=Komodo.Application.ModalPaneController.create();o.popup(kl.value(this._localeBase+"home.reprintReceiptTitle"),"reprintReceipt",{context:{data:s,ok:function(){var e=this,t=e.data.paymentId;e.data.set("disableAction",!0),a.genericController.validateUserClaim(a.country,e.data.supervisorUsername,e.data.passCode,a._supervisorClaim).done(function(s){void 0!==s?a.data.cashierName===e.data.supervisorUsername?(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.unauthoriseReprintError"))):(o.close(),a.retrieveReceiptDetailsEvent(t)):(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.messageAccessValidate")))})},cancel:function(){o.close(),a.shiftDetails()}}})}},submitRealTimeOption:function(){var e=this,t=Komodo.Application.ModalPaneController.create();t.popup(kl.value(e._localeBase+"home.printReceiptTitle"),"printReceipt",{context:{data:Komodo.Models.OnlineTill.PrintReceiptModel.create(),cancel:function(){t.close()}}})},closeShift:function(){var e=this;void 0!==e.get("shiftdata")&&e.closeShiftEvent()},shiftDetails:function(){var e=this,t=e.get("shiftdata");if(t){e.popup=Komodo.Application.ModalPaneController.create();var a=Ember.Object.create({type:"boolean"}),s=Ember.Object.create({type:"boolean"});a.value=!0,s.value=!(t.shiftDetails.length>10),t.shiftDetails&&(e.data.enableFiscalization||e.data.enableInvoice)&&$.each(t.shiftDetails,function(t,a){"YES"===a.isCashSale.toUpperCase()&&(a.enableInvoice=!0===e.data.enableFiscalization?e.data.enableFiscalization:e.data.enableInvoice),"Yes"===a.isRefund||!0===a.isRefund?a.isRefund=!0:a.isRefund=!1,!0===a.isRefund&&(a.enableInvoice=!0===e.data.enableFiscalization?e.data.enableFiscalization:e.data.enableInvoice)}),e.popup.popup(kl.value("locale.onlinetill:shift.shiftDetails"),"shiftDetails",{context:{data:t.shiftDetails.slice(0,10),isPreviousDisable:a,isNextDisable:s,page:0,searchTextPlaceholder:kl.value("locale.onlinetill:customer.searchPlaceholder"),searchText:"",cancel:function(){e.popup.close()},searchReceipt:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);t.length>0?(e.data.clear(),e.data.pushObjects(t.slice(0,10)),e.page=0):(e.data.clear(),e.page=0,alert("No results found.")),e.setButtons(a)},previousPage:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);if(e.page>0){e.page=e.page-1;var s=0===e.page?1:e.page+1;e.data.clear(),e.data.pushObjects(t.slice(10*e.page,10*s))}e.setButtons(a)},nextPage:function(){var e=this,t=e.searchResult(),a=Math.ceil(t.length/10);if(t.length>10){e.page=e.page+1;var s=e.page+1;e.data.clear(),e.data.pushObjects(t.slice(10*e.page,10*s))}e.setButtons(a)},searchResult:function(){var e=this,a=e.searchText,s=[];return""===a||void 0===a?t.shiftDetails:($(t.shiftDetails).each(function(e,t){t.SplitPayments.find(function(e){return e.financialTransactionId.toString()===a||e.accountNumber.toString()===a||e.quoteId.toString()===a||e.receiptNumber.toString()===a})&&s.pushObject(t)}),s)},setButtons:function(e){var t=this;0===e||t.page===e-1?t.isNextDisable.set("value",!0):t.isNextDisable.set("value",!1),0===t.page?t.isPreviousDisable.set("value",!0):t.isPreviousDisable.set("value",!1)},cancelPayment:function(t){e.canCancelPayment(t)},rePublish:function(t){e.rePublish(t)},getHardwareInvoice:function(t){e.getHardwareInvoice(t)},reprintReceipt:function(t){e.reprintReceipt(t)}}}),e.hideBusyIndicator()}},interimShiftReport:function(){var e=this,t=e.get("shiftdata");if(t){var a=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();a.userName=this.userName(),a.country=this.countryDescription,a.header="Interim Shift",a.shiftNumber=t.shiftId,a.status=t.status,a.date=(new moment).format(KomodoConfiguration.dateFormat),a.time=(new moment).format(KomodoConfiguration.timeFormat),a.bankDepositNumber=t.bdNumber,a.stockHandlerDescription=t.stockHandlerDescription,a.currency=t.baseCurrency.value,a.detailGridData=t.shiftDetails,a.cancelledGridData=t.cancelledPayments,Komodo.Services.OLTReportService.retrievedReportData(a),e.genericController.showReportPopup(kl.value(e._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport")}},closeShiftReport:function(){var e=this,t=e.get("shiftdata");if(t){var a=Komodo.Models.OnlineTill.ShiftDetailsReportModel.create();a.userName=e.userName(),a.country=e.countryDescription,a.header="Shift",a.shiftNumber=t.shiftId,a.status="Closed",a.date=(new moment).format(KomodoConfiguration.dateFormat),a.time=(new moment).format(KomodoConfiguration.timeFormat),a.bankDepositNumber=t.bdNumber,a.stockHandlerDescription=t.stockHandlerDescription,a.currency=t.baseCurrency.value,a.detailGridData=t.shiftDetails,a.cancelledGridData=t.cancelledPayments,e.set("shiftdata",void 0),Komodo.Services.OLTReportService.retrievedReportData(a),e.genericController.showReportPopup(kl.value(e._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"),Komodo.Services.eventAggregator.publish("PublishShiftClosed")}},makePayment:function(){var e=this,t=!0,a=!0,s=!1,o=void 0,n=void 0,r=void 0,i=kl.value(e._localeBase+"shift.messageInputValidate"),l=e.get("data"),c=e.get("shiftdata");if(!1!==e.canSubmitData(l,kl.value(e._localeBase+"home.title"),{showInModal:!0})){if(l.isOffLine)(void 0===l.customerNumber||""===l.customerNumber||isNaN(l.customerNumber))&&(t=!1,i=kl.value(e._localeBase+"shift.messageCustomerNumberValidate")),(void 0===l.paymentAmount||""===l.paymentAmount||isNaN(l.paymentAmount)||parseFloat(l.paymentAmount)<=0)&&(t=!1,i=kl.value(e._localeBase+"shift.messagePaymentAmountValidate"));else{var u=!1;if(void 0!==l.currency&&null!==l.currency&&""!==l.baseCurrency&&l.baseCurrency!==l.currency.value&&(u=!0),void 0===l.paymentAmount||""===l.paymentAmount||isNaN(l.paymentAmount)||parseFloat(l.paymentAmount)<=0)t=!1,i=kl.value(e._localeBase+"shift.messagePaymentAmountValidate");else if(parseFloat(l.amountTendered)<parseFloat(l.paymentAmount))t=!1,i=kl.value(e._localeBase+"shift.messageAmountTenderedValidate");else if(!1===u&&l.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")&&parseFloat(l.amountTendered)!==parseFloat(l.paymentAmount))t=!1,i=kl.value(e._localeBase+"shift.messageSplitAmountTenderedValidate");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")&&parseFloat(l.amountTendered)!==parseFloat(l.paymentAmount))t=!1,i=kl.value(e._localeBase+"shift.messageSplitAmountTenderedValidate");else if(l.paymentType!==kl.value("locale.onlinetill:home.subTitleCashSales")||void 0!==l.quoteId&&""!==l.quoteId||!isNaN(l.quoteId))if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&(void 0===l.quoteStatus||!1===e.isRefund&&!Ember.isEmpty(l.quote)&&"1"!==l.quote.Status&&"2"!==l.quote.Status)&&isNaN(l.quoteId))t=!1,i=kl.value(e._localeBase+"shift.messageQuoteStatusVaildate");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&!0===l.isQuoteQuantityShort&&isNaN(l.quoteId))t=!1,i=kl.value(e._localeBase+"shift.messageStockValidate");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&!1===l.isRepairQuotePassed&&isNaN(l.quoteId))t=!1,i=kl.value(e._localeBase+"shift.messageRepairQuoteValidate",{quotenumber:l.quoteId,status:l.quoteSAPStatus});else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&!1===isNaN(l.quoteId)&&void 0!==l.quoteStatus&&null!==l.quoteStatus&&"OPEN"!==l.quoteStatus)t=!1,i=kl.value(e._localeBase+"shift.messageInvoiceStatusVaildate");else if(l.paymentType!==kl.value("locale.onlinetill:home.subTitleCashSales")&&(void 0===l||l.gridData.length<1))t=!1,i=kl.value(e._localeBase+"shift.messageCustomerValidate");else if(l.paymentType!==kl.value("locale.onlinetill:home.subTitleCashSales")&&l.gridData.length<=1&&void 0===l.gridData[0].quote&&void 0===l.gridData[0].account)t=!1,i=kl.value(e._localeBase+"shift.messageAccountValidate");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&parseFloat(l.paymentAmount)!==parseFloat(e.getConvertedAmountByCurrency(parseFloat(l.quoteAmount))))t=!1,i=kl.value(e._localeBase+"shift.messageQuoteAmountValidate");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&!0===e.isRefund&&(isNaN(l.cash)||parseFloat(l.cash)<parseFloat(l.paymentAmount)))t=!1,
i=kl.value(e._localeBase+"payment.refundPaymentAmount");else if(l.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&!1===e.isRefund&&isNaN(l.quoteId)&&!0===l.useHardwareAndSoftwareSplitQuote){var h=!1;$.each(l.quoteGridData,function(e,t){return void 0===t.productType||""===t.productType||"HARDWARE"===t.productType.toUpperCase()||(h=!0,!1)}),!h||void 0!==l.customers&&0!==l.customers.length&&!1!==e.checkDetfaultAccountExists(l.customers)||(s=!0,a=t=!1,i=kl.value(e._localeBase+"shift.messageQuoteLinkValidate"))}else l.paymentType!==kl.value("locale.onlinetill:home.subTitleSplitPayment")&&l.paymentType!==kl.value("locale.onlinetill:home.subTitleBatchPayment")||0===parseFloat(l.amountLeft)?l.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")&&l.gridData.length<=1?(t=!1,i=kl.value(e._localeBase+"shift.messageSplitPaymentValidate")):"Card"===l.methodOfPayment&&void 0!==l.expiryDate&&""!==l.expiryDate&&new moment(l.expiryDate,"MMYY").endOf("month")<new moment?(t=!1,i=kl.value(e._localeBase+"shift.messageCardDateValidate")):$(l.gridData).each(function(s,u){if(void 0===u.quote&&void 0===u.account&&l.paymentType!==kl.value("locale.onlinetill:home.subTitleBatchPayment"))return t=!1,void(i=kl.value(e._localeBase+"shift.messageNoQuoteAccountValidate"));if(isNaN(u.payAmount))return t=!1,void(i=kl.value(e._localeBase+"shift.messageAmountValidate"));if((void 0===u.quotes||void 0===u.quotes.length||u.quotes.length<=0)&&void 0!==u.account&&"-All-"===u.account.displayText&&l.paymentType!==kl.value("locale.onlinetill:home.subTitleBatchPayment"))return t=!1,void(i=kl.value(e._localeBase+"shift.messageNoAccountValidate"));if(Komodo.Services.securityService.hasPermission(e._isRestrictedForAgencyPayment)&&e.isCommissionableStockHandler(e.data.get("stockHandlerId"))&&void 0!==u.accounts&&void 0!=u.accounts.length&&u.accounts.length>0&&e.hasAccountType(u.accounts,"Commission"))return t=!1,i=kl.value(e._localeBase+"shift.messageCommissionPaymentNotAllowed",{customerid:u.customerNumber}),!1;if("Cheque"===l.methodOfPayment&&(l.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")||l.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment"))){var h=e.rdChequeStatuses.find(function(e){return"Yes"===e.value});if(u.rdChequeStatus&&u.rdChequeStatus.Status&&""!==u.rdChequeStatus.Status.trim()&&u.rdChequeStatus.Status!==h.key)return o=u,a=t=!1,void(i=u.customerNumber+kl.value(e._localeBase+"customer.rdChequePayment"))}if(void 0!==c&&(n=c.shiftDetails.find(function(e){var t=!1;return void 0!==u.quote?$.each($.makeArray(u.quote),function(a,s){return!(t=e.SplitPayments.find(function(e){return e.quoteId.toString()===s.quoteId.toString()&&(parseFloat(e.amount).toFixed(2)===parseFloat(u.payAmount).toFixed(2)||parseFloat(e.amount).toFixed(2)===parseFloat(l.paymentAmount).toFixed(2))}))}):t=e.SplitPayments.find(function(e){return e.accountNumber.toString()===u.account.accountNumber.toString()&&(parseFloat(e.amount).toFixed(2)===parseFloat(u.payAmount).toFixed(2)||parseFloat(e.amount).toFixed(2)===parseFloat(l.paymentAmount).toFixed(2))}),t})),l.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||l.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")){if(void 0===u.payAmount||parseFloat(u.payAmount).toFixed(2)<=0)return t=!1,void(i=kl.value(e._localeBase+"shift.messageAmountValidate"));r=l.gridData.find(function(e,t){return e.account&&u.account&&e.customerNumber===u.customerNumber&&e.account.accountNumber===u.account.accountNumber&&s!==t})}l.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")&&l.set("autoReconnectProducts",!1)}):(t=!1,i=kl.value(e._localeBase+"shift.messageAmountSumValidate"));else t=!1,i=kl.value(e._localeBase+"shift.messageQuoteValidate");void 0!==r&&(t=!1,i=kl.value(e._localeBase+"shift.messageDuplicateCustomerValidate"))}t?(Ember.isEmpty(l)||!l.isCashSalePayment||Ember.isEmpty(l.quote)||Ember.isEmpty(l.quote.BusinessUnit)||e.setNotes(e.get("paymentNotes"),"BusinessUnit",l.quote.BusinessUnit.toUpperCase()),void 0!==n&&l.stockHandlerId===c.stockHandlerId?Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title")+" : "+kl.value(e._localeBase+"shift.duplicatePaymentTitle"),kl.value(e._localeBase+"shift.messageDuplicatePaymentValidate"),Komodo.Controls.MessageBoxYesNoButtons,e,"duplicatePayment").response=function(t){"yes"===t&&e.createPaymentEvent()}:e.createPaymentEvent()):a?Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),i,Komodo.Controls.MessageBoxOkButtons,e,"modelPayment","danger"):s?Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),i,Komodo.Controls.MessageBoxYesNoButtons,e,"modelPayment").response=function(t){if("yes"===t){var a={QuoteNumber:l.quoteId,CustomerNumber:l.customerNumber,Country:e.get("country")};Komodo.Services.eventAggregator.publish("PublishCreateCustomer",a)}}:!1===l.get("updateRDFlag")&&void 0!==o?Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),o.customerNumber+kl.value(e._localeBase+"customer.chequePaymentRestricted"),Komodo.Controls.MessageBoxOkButtons,e,"modelPayment","danger"):Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),i,Komodo.Controls.MessageBoxYesNoButtons,e,"modelPayment").response=function(t){if("yes"===t){var a=Komodo.Models.OnlineTill.SupervisorApprovalModel.create(),s=Komodo.Application.ModalPaneController.create();s.popup(kl.value(e._localeBase+"home.title"),"supervisorApproval",{context:{data:a,ok:function(){var t=this;t.data.set("disableAction",!0),e.genericController.validateUserClaim(e.country,t.data.supervisorUsername,t.data.passCode,e._supervisorClaim).done(function(a){void 0!==a?e.data.cashierName===t.data.supervisorUsername?(t.data.set("disableAction",!1),alert(kl.value(e._localeBase+"customer.unauthoriseError"))):(s.close(),e.updateRDCheque(o,a)):(t.data.set("disableAction",!1),alert(kl.value(e._localeBase+"customer.accessDenied")))})},cancel:function(){s.close()}}})}}}},hasAccountType:function(e,t){for(var a=0;a<e.length;a++)if(e[a].type.toLowerCase()===t.toLowerCase())return!0},isCommissionableStockHandler:function(e){var t=this.get("shiftdata");if(void 0!=t&&void 0!=t.stockHandlers&&void 0!=t.stockHandlers.length)for(var a=0;a<t.stockHandlers.length;a++)if(1==t.stockHandlers[a].IsCommissionable&&t.stockHandlers[a].Id===e)return!0;return!1},useCredit:function(){var e=this,t=Komodo.Application.ModalPaneController.create(),a={paymentInvoices:e.get("data.customer.account.paymentInvocies"),invoices:e.get("data.customer.account.invoices")};t.popup(kl.value(e._localeBase+"home.useAvailableCreditTitle"),"useCredit",{context:{data:a,useAvailableCredit:function(){var a=this.data,s=[],o=[];if($.each(a.paymentInvoices,function(e,t){!0===t.isSelected&&s.push(parseInt(t.invoiceNumber))}),$.each(a.invoices,function(e,t){!0===t.isSelected&&o.push(parseInt(t.invoiceNumber))}),s.length<=0)alert("Please select payment for applying the credit.");else if(o.length<=0)alert("Please select invoice for applying the credit.");else if(s.length>0&&o.length>0){t.close();var n=Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.useAvailableCreditTitle"),kl.value(e._localeBase+"payment.confirmUseCredit"),Komodo.Controls.MessageBoxYesNoButtons,e,"authmbx3","modelUseCredit");n.response=function(t){if("yes"===t){var a={customerId:e.get("data.customer.customerNumber"),payments:s,invoices:o};Komodo.Services.queryService.postJSON("/Invoice/UseCredit",{data:a}).done(function(){e.retrieveCustomerInvoices(e.get("data.customer.customerNumber")),Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.useAvailableCreditTitle"),"Credit Applied Successfully",Komodo.Controls.MessageBoxOkButtons,e,"authmbx3","modelUseCredit")}).error(function(t){e.hideBusyIndicator(!1);var a=JSON.stringify(t);Komodo.log("UseCredit ajax call failed. Error: "+a)})}}}},cancel:function(){t.close()}}})},viewQuoteDetails:function(e){var t=this,a=this.get("data");if(a.set("customer",e.content),void 0!==a.customer&&void 0!==a.customer.quotes&&void 0!==a.customer.quotes.length){if(a.customer.quotes.length>0){var s,o=Komodo.Application.ModalPaneController.create();"Commercial"===a.customer.get("customerClass").toString()?(s=kl.value(t._localeBase+"home.invoiceDetailsTitle"),a.customer.set("isCommercialCustomer",!0)):(s=kl.value(t._localeBase+"home.quoteDetailsTitle"),a.customer.set("isCommercialCustomer",!1)),o.popup(s,"quoteDetails",{context:{data:a,calculate:function(){if(a.paymentType!==kl.value("locale.onlinetill:home.subTitleBatchPayment")){var e=0,s=[],o=a.get("autoReconnectProducts");$(a.customer.quotes).each(function(t,a){a.isSelected?(o=!0,e+=isNaN(a.totalAmount)?0:parseFloat(a.totalAmount),jQuery.inArray(a.financialAccountId,s)<0&&s.push(a.financialAccountId)):o=!1}),!0===a.get("autoReconnectProducts")&&(a.set("autoReconnectProducts",o),a.set("disableReconnectProducts",!o));var n=0,r=!1;$(a.customer.accounts).each(function(e,t){$(s).each(function(e,s){if(t.accountNumber.toString()===s.toString()){parseFloat(t.overdue)>0&&parseFloat(t.overdue),a.customer.get("isCommercialCustomer")&&(r=!(parseFloat(t.overdue)<0),a.set("autoReconnectProducts",!1)),r||void 0===t.overdue||""===t.overdue||isNaN(t.overdue)||(n=parseFloat(n)+parseFloat(t.overdue))}})});var i=parseFloat(e)+parseFloat(n);a.customer.set("subTotal",parseFloat(e).toFixed(2)),a.customer.set("balance",parseFloat(n).toFixed(2)),a.customer.set("payAmount",parseFloat(i).toFixed(2)),a.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&(a.set("originalQuoteAmount",parseFloat(i).toFixed(2)),a.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(i).toFixed(2))))}},selectedQuote:function(){this.calculate()},select:function(){void 0!==a.customer&&void 0!==a.customer.quotes&&$(a.customer.quotes).each(function(e,t){t.set("previousIsSelectedState",t.isSelected)}),o.close()},cancel:function(){this.calculate(),o.close()}}})}}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noSRQError"),Komodo.Controls.MessageBoxOkButtons,this,"modelPayment","danger")},viewProductDetails:function(e){var t=this,a=e._parentView._childViews[0].text,s=t.get("data"),o=void 0,n=!1;if($(s.gridData).each(function(e,t){t.customerNumber===a&&(o=t)}),o&&void 0!==o.accounts&&$(o.accounts).each(function(e,t){void 0!==t.products&&t.products.length>=0&&(n=!0)}),void 0!==o&&!0===n){var r=Komodo.Application.ModalPaneController.create();r.popup(kl.value(t._localeBase+"home.productDetailsTitle"),"customerDetails",{context:{data:o,selectedGridItem:void 0,commandGridItem:void 0,commandGridItemType:void 0,gridColumns:[Komodo.Controls.DataGridColumn.create({name:"accountNumber",title:kl.value(t._localeBase+"customer.account"),width:"50px"}),Komodo.Controls.DataGridColumn.create({name:"hardware",title:kl.value(t._localeBase+"customer.hardware"),width:"50px"}),Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(t._localeBase+"customer.productName"),width:"150px"}),Komodo.Controls.DataGridColumn.create({name:"productType",title:kl.value(t._localeBase+"customer.productType"),width:"150px"})],cancel:function(){r.close()}}})}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),"No Product information found for the customer!",Komodo.Controls.MessageBoxOkButtons,t,"modelPayment")},removeCustomer:function(e){var t=this,a=e._parentView.content,s=t.get("data"),o=-1;$(s.gridData).each(function(e,t){t.customerNumber===a.customerNumber&&t.payAmount===a.payAmount&&(o=(t.account&&a.account&&(t.account.accountNumber,a.account.accountNumber),e))}),o>-1&&(void 0!==s.srqCustomer&&s.srqCustomer.customerNumber===number&&s.set("srqCustomer",void 0),s.gridData.removeAt(o),s.set("customer",void 0),t.hideCustomerDetails())},retrieveQuote:function(){var e=this;e.set("linkedCustomerNumber",void 0),void 0!==e.data.get("quoteId")&&""!==e.data.get("quoteId")&&(e.set("quoteGridColumns",[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(e._localeBase+"customer.productName")}),Komodo.Controls.DataGridColumn.create({name:"quantity",title:kl.value(e._localeBase+"customer.quantity"),width:"120px"}),Komodo.Controls.DataGridColumn.create({name:"quotedUnitPrice",title:kl.value(e._localeBase+"customer.quotedUnitPrice")})]),e.get("data").set("paymentAmount",""),e.get("data").set("originalQuoteAmount",""),e.get("data").set("quoteAmount",""),e.get("data").set("quoteStatus",""),e.get("data").set("quoteGridData",[]),e.get("data").set("enableMakePayment",!1),e.retrieveQuotationsEvent())},retrieveQuoteHardware:function(){var e=this;e.set("linkedCustomerNumber",void 0),void 0!==e.data.get("quoteId")&&""!==e.data.get("quoteId")&&(e.set("quoteGridColumns",[Komodo.Controls.DataGridColumn.create({name:"deviceSerialNumber",title:kl.value(e._localeBase+"customer.deviceSerialNumber")}),Komodo.Controls.DataGridColumn.create({name:"model",title:kl.value(e._localeBase+"customer.model")})]),e.get("data").set("paymentAmount",""),e.get("data").set("originalQuoteAmount",""),e.get("data").set("quoteAmount",""),e.get("data").set("quoteStatus",""),e.get("data").set("quoteGridData",[]),e.retrieveHardwareIssuedAgainstQuotation())},showReceiptPopup:function(e){var t=this,a=t.get("data"),s=t.get("shiftdata"),o=[],n=void 0,r=void 0;if(void 0!==e)if(e.EnableFiscalization=a.enableFiscalization,e.EnableInvoice=a.enableInvoice,a.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")){var i=t.get("controllers.paymentReport");i.start(),s=Komodo.Models.OnlineTill.ShiftModel.create(),s.set("shiftId",e.ShiftId),s.set("status","Closed"),s.set("type","Batch"),i.get("data").set("selectedCashierName",t.userName()),i.get("data").set("selectedReport","Agency Batch Payment Report"),i.showBatchPaymentReport(s,!1),t.clearModelData(),void 0!==a.chequeDate&&a.set("chequeDate",new Date),t.clearShiftDetails(),t.retrieveShiftDetailsEvent(!1,!1)}else{o=[];var l=void 0;void 0!==s&&($(s.printers).each(function(e,a){if(!0===a.isActive&&a.printerName&&0!==a.printerName.indexOf("POS")){var s={key:a.printerName,value:a.printerName,printerType:a.printerType,ipAddress:a.ipAddress,layout:unescape(a.printerLayout)};o.pushObject(s),t.cachePrinter&&a.printerName===t.cachePrinter.key&&a.ipAddress===t.cachePrinter.ipAddress&&(l=s)}}),o=o.sort(function(e,t){return e.key===t.key?0:+(e.key>t.key)||-1})),n=Komodo.Models.OnlineTill.PrintReceiptModel.create(),n.printers=o,n.selectedPrinter=l,n.receiptData=t.populateReceiptModel(e),a.get("enableEmailReceipt")&&(!a.customer||e.IsCashSale||e.IsSplit||(a.customers=[],a.customers[0]=a.customer),a.isOffLine||e.IsCashSale||e.IsSplit?a.isOffLine||(n.displayEmailReceiptOption=!0,n.displayEmailSelectList=!1):(n.displayEmailReceiptOption=!0,a.customers&&a.customers[0]&&a.customers[0].email&&""!==a.customers[0].email.trim()&&(n.displayEmailSelectList=!0))),r=Komodo.Application.ModalPaneController.create(),r.popup(kl.value(t._localeBase+"home.printReceiptTitle"),"printReceipt",{context:{data:n,previewReceipt:function(){var e=window.open();e.document.write($("#printPreview").html()),e.print(),e.close()},printReceipt:function(){var e=this,a=$("#printPreview").children("table"),s="",o=e.data.printer.printerType;$(a).each(function(e,t){s+=$(t).html()}),Ember.isEmpty(o)&&(o=t.getPrinterTypeFromShiftDetails(t.shiftdata.printers,e.data.printer.key)),t.printReceipt({receiptText:s,printer:e.data.printer.key,printerType:o,ipAddress:e.data.printer.ipAddress}),t.updateCachePrinter(t.printerKey,e.data.printer)},emailReceiptconfirm:function(){r.close(),n.email.length>0&&(n.selectedEmail=n.email[0]),t.displayEmailConfirmation(n,e)},cancel:function(){r.close()}},closeCallback:function(){if(t.get("linkedCustomerNumber")){var e=Komodo.Models.CustomerDetailsModel.create();e.set("customerNo",t.get("linkedCustomerNumber")),e.set("searchRequired",!0),e.set("customerClass","-"),Komodo.Services.customerProfileService.setCustomerPersonalDetail(e),Komodo.Services.customerProfileService.setIsCustomerAuthorised(!0);var a=Komodo.Models.SearchRequestForBaseSystem.create();a.set("uid",t.get("linkedCustomerNumber")),Komodo.Services.eventAggregator.publish("PublishCustomerSearchRequest",a)}t.set("linkedCustomerNumber",void 0)}})}else a.isOffLine&&(o=[],void 0!==s&&($(s.printers).each(function(e,t){!0===t.isActive&&t.printerName&&0!==t.printerName.indexOf("POS")&&o.pushObject({key:t.UID,value:t.printerName+" : "+t.ipAddress,ipAddress:t.ipAddress,printerType:t.printerType,layout:unescape(t.printerLayout)})}),o=o.sort(function(e,t){return e.key===t.key?0:+(e.key>t.key)||-1})),n=Komodo.Models.OnlineTill.PrintReceiptModel.create(),n.printers=o,n.receiptData=t.populateOfflineReceiptModel(),a.set("customerNumber",""),a.set("amountTendered",parseFloat("0").toFixed(2)),a.set("paymentAmount",parseFloat("0").toFixed(2)),r=Komodo.Application.ModalPaneController.create(),r.popup(kl.value(t._localeBase+"home.printReceiptTitle"),"printReceipt",{context:{data:n,previewReceipt:function(){var e=window.open();e.document.write($("#printPreview").html()),e.print(),e.close()},printReceipt:function(){var e=this,a=$("#printPreview").children("table"),s="";$(a).each(function(e,t){s+=$(t).html()}),t.printReceipt({receiptText:s,printer:e.data.printer.ipAddress,printerType:e.data.printer.printerType})},cancel:function(){r.close()}}}))},displayEmailConfirmation:function(e,t){var a=this,s=Komodo.Application.ModalPaneController.create();if(e.displayEmailSelectList){a.retrieveCustomerEmails(e.receiptData[0].CustomerID);var o=a.get("data");void 0!==o.customers[0].email&&(e.email=o.customers[0].emailList)}a.registerValidator(e,"selectedEmail",{isRequired:!0,type:"string",regExPattern:Komodo.UI.Validators.RegExPatterns.Email,displayName:kl.value(a._localeBase+"report.email")}),s.popup(kl.value(a._localeBase+"home.emailReceiptTitle"),"emailReceiptConfirm",{context:{data:e,validators:a.validators,emailReceipt:function(){if(!1!==a.canSubmitData(e,kl.value(a._localeBase+"home.emailReceiptTitle"),{showInModal:!1})){var o=$("#printPreview").children("table"),n="";$(o).each(function(e,t){n+=$(t).html()}),s.close(),a.emailReceipt(e,t)}},cancel:function(){s.close(),a.showReceiptPopup(t)}}})},shiftPaymentAction:function(e){var t=this;switch(e){case"ShiftDetails":t.shiftDetails();break;case"InterimShiftReport":t.interimShiftReport();break;case"CloseShiftReport":t.closeShiftReport()}t.hideBusyIndicator()},updateRunningTotal:function(){var e=this,t=this.get("data"),a=!0,s=parseFloat(t.paymentAmount);void 0!==t.currency&&null!==t.currency&&""!==t.baseCurrency&&t.baseCurrency!==t.currency.value&&(a=!1);var o=0;$(t.gridData).each(function(t,a){o=parseFloat(parseFloat(o)+parseFloat(e.getConvertedAmountByCurrency(parseFloat(isNaN(a.payAmount)||""===a.payAmount?0:a.payAmount)))).toFixed(2)});var n=isNaN(o)?(0).toFixed(2):parseFloat(o).toFixed(2);n=parseFloat(n);var r=isNaN(s-n)?(0).toFixed(2):(parseFloat(s).toFixed(2)-parseFloat(o).toFixed(2)).toFixed(2);if(t.set("amountCaptured",n),t.set("amountLeft",r),a)t.set("baseAmount",isNaN(s)?(0).toFixed(2):s.toFixed(2));else{var i=isNaN(s)?0:s;i*=isNaN(t.currency.rate)?0:parseFloat(t.currency.rate),t.set("baseAmount",i.toFixed(2))}}.observes("data.paymentAmount","data.currency","data.gridData.@each.payAmount"),selectedAccountChanged:function(){var e=this.get("data");$(e.gridData).each(function(e,t){void 0===t.account&&$.each(t.accounts,function(e,a){!0===a.selected&&t.set("account",a)})})}.observes("data.gridData.@each.account"),currencyChanged:function(){var e=this,t=this.get("data"),a=parseFloat(t.originalQuoteAmount);if(t.set("paymentAmount",e.getConvertedAmountByCurrency(a)),void 0!==t.currency&&null!==t.currency&&""!==t.baseCurrency&&t.baseCurrency!==t.currency.value){var s=isNaN(t.paymentAmount)?0:t.paymentAmount;s*=isNaN(t.currency.rate)?0:parseFloat(t.currency.rate),t.set("baseAmount",s.toFixed(2))}else t.set("baseAmount",isNaN(a)?(0).toFixed(2):a.toFixed(2))}.observes("data.currency"),showCustomerGrid:function(){return!0!==this.get("data").get("isCustomerPayment")}.property("data.isCustomerPayment"),showAmountSpan:function(){return!0!==this.get("data").get("isSplitPayment")}.property("data.isSplitPayment"),showBatchSpan:function(){return!0!==this.get("data").get("isBatchPayment")}.property("data.isBatchPayment"),showCustomerBanner:function(){return!(this.get("data").paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&!this.get("data").isOffLine)}.property("data.paymentType"),labelPaymentAmount:function(){return this.getLabelTextForCurrency("payment.paymentAmount",!1)}.property("data.currency"),labelBaseAmount:function(){return this.getLabelTextForCurrency("quote.baseAmount",!0)}.property("data.currency"),labelAmountTendered:function(){return this.getLabelTextForCurrency("payment.amountTendered",!1)}.property("data.currency"),labelChangeOwed:function(){return this.getLabelTextForCurrency("payment.changeOwed",!0)}.property("data.currency"),labelAmountCaptured:function(){return this.getLabelTextForCurrency("shift.amountCaptured",!1)}.property("data.currency"),labelAmountLeft:function(){return this.getLabelTextForCurrency("shift.amountLeft",!1)}.property("data.currency"),getLabelTextForCurrency:function(e,t){var a=this.get("data"),s=kl.value(this._localeBase+e);return void 0!==a.currency&&null!==a.currency&&""!==a.baseCurrency&&a.baseCurrency!==a.currency.value&&(s=t?s+" ("+a.baseCurrency+")":s+" ("+a.currency.value+")"),s},typeOfPaymentChanged:function(){var e=this;e.clearModelData();var t=e.get("data");t.set("refundPayment",!1),t.set("disableAmountTendered",!1),e.set("linkedCustomerNumber",void 0),t.set("isCustomerPayment",!1),t.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")?(t.set("isCustomerPayment",!0),Komodo.Services.uiService.transitionTo("customerPayment")):t.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")?Komodo.Services.uiService.transitionTo("cashSalePayment"):t.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")?Komodo.Services.uiService.transitionTo("splitPayment"):t.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")&&Komodo.Services.uiService.transitionTo("batchPayment"),e.hideCustomerDetails()}.observes("data.paymentType"),stockHandlerChanged:function(){var e=this,t=e.get("data"),a=e.get("shiftdata");t&&a&&t.stockHandlerId&&a.stockHandlerId!==t.stockHandlerId&&(Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),kl.value(e._localeBase+"shift.messageStokhandlerValidate"),Komodo.Controls.MessageBoxYesNoButtons,e,"stockHandlerChanged").response=function(s){"no"===s&&(Ember.removeObserver(e,"data.stockHandlerId"),t.set("stockHandlerId",a.stockHandlerId),Ember.addObserver(e,"data.stockHandlerId",e.stockHandlerChanged))})}.observes("data.stockHandlerId"),paymentMethodChanged:function(){var e=this,t=e.get("data");e.removeValidator("cardTypeValidator"),e.removeValidator("cardHolderValidator"),e.removeValidator("cardNumberValidator"),e.removeValidator("drawerNameValidator"),e.removeValidator("chequeBankValidator"),e.removeValidator("chequeBranchValidator"),e.removeValidator("chequeNumberValidator"),e.removeValidator("chequeDateValidator"),e.registerValidator(t,"amountTendered",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}),t.set("disableAmountTendered",t.get("refundPayment")),"Cheque"===t.methodOfPayment?(e.registerValidator(t,"drawerName",{isRequired:!0,type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z ]*$"}),e.registerValidator(t,"chequeBank",{isRequired:!0,type:"string"}),e.registerValidator(t,"chequeBranch",{isRequired:!0,type:"string"}),e.registerValidator(t,"chequeNumber",{isRequired:!0,type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z]*$"}),e.registerValidator(t,"chequeDate",{isRequired:!0,functions:Komodo.UI.Validators.DatePickerValidator})):"Card"===t.methodOfPayment&&!1===t.useIntegratedCardPayment&&(e.registerValidator(t,"cardType",{isRequired:!0,type:"string"}),e.registerValidator(t,"cardHolder",{isRequired:!0,type:"string",minLength:2,maxLength:50,regExPattern:"^[0-9a-zA-Z ]*$"}),e.registerValidator(t,"cardNumber",{isRequired:!0,type:"string",minLength:4,maxLength:4,regExPattern:"^[0-9]*$"})),"Cheque"!==t.methodOfPayment&&"Card"!==t.methodOfPayment||(e.removeValidator("amountTenderedValidator"),t.set("disableAmountTendered",!0))}.observes("data.methodOfPayment"),bankChanged:function(){var e=this,t=e.get("data");e.set("bankBranches",[]),e.get("data.chequeBank")&&$.each(e.get("banks"),function(a,s){s.CanonicalKey===e.get("data.chequeBank").CanonicalKey&&s.Branches&&s.Branches.Branch&&($.isArray(s.Branches.Branch)?$.each(s.Branches.Branch,function(t,a){e.get("bankBranches").addObject(a)}):e.get("bankBranches").addObject(s.Branches.Branch),t.set("chequeBranchCode",""))})}.observes("data.chequeBank"),branchChanged:function(){var e=this,t=e.get("data");e.get("data.chequeBranch")&&t.set("chequeBranchCode",t.get("chequeBranch").BranchCode)}.observes("data.chequeBranch"),enableAmountLowestDenominationChanged:function(){var e=this,t=e.get("data");e.removeValidator("paymentAmountValidator"),e.removeValidator("amountTenderedValidator"),t.get("enableAmountLowestDenomination")?(e.set("amountRegExPattern","^[0-9]{1,15}(.([0-9])([0,5]){0,1}?)?$"),e.registerValidator(t,"paymentAmount",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}),e.registerValidator(t,"amountTendered",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern})):(e.set("amountRegExPattern","^[0-9]{1,15}(.([0-9])([0-9]){0,1}?)?$"),e.registerValidator(t,"paymentAmount",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}),e.registerValidator(t,"amountTendered",{isRequired:!0,type:"string",minLength:1,maxLength:50,regExPattern:e.amountRegExPattern}))}.observes("data.enableAmountLowestDenomination"),quoteChanged:function(){var e=this,t=e.get("data");t.set("paymentAmount",""),t.set("originalQuoteAmount",""),t.set("quoteAmount",""),t.set("quoteStatus",""),t.set("quoteGridData",[]),t.set("enableMakePayment",!1)}.observes("data.quoteId"),getCacheData:function(){var e=this,t=e.get("data"),a=$.Deferred(),s=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),o=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),n=Komodo.Services.localizationService.getCurrentLanguage();return e.set("country",s),e.set("countryDescription",o),Komodo.Services.cachedDataService.fetch("ShiftStatus",{domain:s,qualifier:n}).done(function(t){e.set("shiftStatuses",[]),e.set("shiftStatuses",t),a.resolve(t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve ShiftStatus domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("ShiftType",{domain:s,qualifier:n}).done(function(t){e.set("shiftTypes",[]),e.set("shiftTypes",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve ShiftType domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("QuotationStatus",{domain:s,qualifier:n}).done(function(t){e.set("quoteStatuses",[]),e.set("quoteStatuses",t)}).fail(function(){Komodo.log("[ERROR] : could not retrieve QuotationStatus domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("Currency",{domain:s,qualifier:n}).done(function(e){t.set("currencies",[]),t.set("currencies",e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Currency domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("BankDetail",{domain:s,qualifier:n}).done(function(t){var a=JSON.parse(t);e.set("banks",[]),$.each($.makeArray(a.Banks.Bank),function(t,a){e.banks.addObject(a)})}).fail(function(){Komodo.log("[ERROR] : could not retrieve BankDetail domain = "+s+"/ qualifier = "+n)}),Komodo.Services.cachedDataService.fetch("RDChequeStatus").done(function(t){e.set("rdChequeStatuses",[]),e.set("rdChequeStatuses",t)}).fail(function(){Komodo.log("could not retrieve RD Cheque Status")}),Komodo.Services.cachedDataService.fetch("RDChequeStatusReason").done(function(t){e.set("rdChequeStatusReasons",[]),e.set("rdChequeStatusReasons",t)}).fail(function(){Komodo.log("could not retrieve RD Cheque Status reasons")}),Komodo.Services.cachedDataService.fetch("AccountType",{domain:s,qualifier:n}).done(function(e){t.set("accountTypes",[]),t.set("accountTypes",e)}).fail(function(){Komodo.log("[ERROR] : could not retrieve Account Type domain = "+s+"/ qualifier = "+n)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","IntegratedCardPayment").done(function(e){t.set("useIntegratedCardPayment",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OnlineTill","UseHardwareAndSoftwareSplitQuote").done(function(e){t.set("useHardwareAndSoftwareSplitQuote",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","EnableRefundFeature").done(function(e){t.set("isRefundAvailable",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","ReprintSupervisorApprovalRequired").done(function(e){t.set("reprintSupervisorApprovalRequired",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","EnableAmountLowestDenomination").done(function(e){t.set("enableAmountLowestDenomination",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","UpdateRDFlag").done(function(e){t.set("updateRDFlag",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","DefaultCardPaymentMethod").done(function(e){t.set("defaultCardPaymentMethod",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OnlineTill","EnableEmailReceipt").done(function(e){t.set("enableEmailReceipt",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","EnableFiscalization").done(function(e){t.set("enableFiscalization",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","EnableInvoice").done(function(e){t.set("enableInvoice",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("OLTPayment","ValidateRepairQuotePayment").done(function(e){t.set("validateRepairQuotePayment",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("User","IsUserActivityToBeTracked").done(function(e){t.set("isUserActivityToBeTracked",e)}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)}),a},concatStrings:function(e,t,a){var s;return s=void 0===e||null===e?"":e,s+=void 0===t||null===t?"":" "+t,s+=void 0===a||null===a?"":" "+a},showHideShiftDetails:function(){var e=this;e.shiftBannerVisible?($("#komodo-shift-details").addClass("komodo-hidden"),$("#komodo-shift-details").slideUp(),$("#komodo-shift-page").removeClass("shift-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.set("shiftBannerVisible",!1)):(e.customerBannerVisible&&e.hideCustomerDetails(),$("#komodo-shift-details").removeClass("komodo-hidden"),$("#komodo-shift-details").slideDown(),
$("#komodo-shift-page").removeClass("no-banner-padding"),$("#komodo-shift-page").addClass("shift-page-padding"),e.set("shiftBannerVisible",!0))},hideShiftDetails:function(){var e=this;$("#komodo-shift-details").addClass("komodo-hidden"),$("#komodo-shift-details").slideUp(),$("#komodo-shift-page").removeClass("shift-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.set("shiftBannerVisible",!1)},showHideCustomerDetails:function(){var e=this;e.customerBannerVisible?($("#komodo-customer-details").addClass("komodo-hidden"),$("#mobile-customer-details").addClass("komodo-hidden"),$("#komodo-customer-details").slideUp(),$("#mobile-customer-details").slideUp(),$("#komodo-shift-page").removeClass("customer-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.set("customerBannerVisible",!1)):(e.shiftBannerVisible&&e.hideShiftDetails(),$("#komodo-customer-details").removeClass("komodo-hidden"),$("#mobile-customer-details").removeClass("komodo-hidden"),$("#komodo-customer-details").slideDown(),$("#mobile-customer-details").slideDown(),$("#komodo-shift-page").removeClass("no-banner-padding"),$("#komodo-shift-page").addClass("customer-page-padding"),e.set("customerBannerVisible",!0))},hideCustomerDetails:function(){var e=this,t=e.get("data");t.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")||t.isOffLine||$("#otp-slide-item-customer").addClass("komodo-hidden"),$("#komodo-customer-details").addClass("komodo-hidden"),$("#mobile-customer-details").addClass("komodo-hidden"),$("#komodo-customer-details").slideUp(500),$("#komodo-shift-page").removeClass("customer-page-padding"),$("#komodo-shift-page").addClass("no-banner-padding"),e.set("customerBannerVisible",!1)},fixHTML:function(e){return e.replace(/ /g,"&nbsp;").replace(/\u2019/g,"'").replace(/-/g,"&#8209;")},prepareHTMLPrint:function(e){var t=this;return $("#print").html(e),$("#print").find("textarea, input").each(function(e,t){var a=t.value;$(t).replaceWith(a)}),$("#print").find("img").each(function(e,a){if(!/^(?:\/|[a-z]+:\/\/)/.test($(a).attr("src"))){var s=t.getPath()+$(a).attr("src");s=s.replace("./",""),$(a).attr("src",s)}}),$("#print").find("h1, h2, h3, h4, h5, h6").replaceWith(function(){return $("<font />",{html:$(t).html()}).attr("size","3")}),$("#print").find("hr").replaceWith("---------------------------------------------------------------"),$("#print").find("td").each(function(e,t){if(""!==t.innerText){var a=t.innerHTML;$(t).html('<font size="1">'+a+"</font>")}}),$("#print").find("td table td").each(function(e,t){if(""!==t.innerText){var a=t.innerHTML;$(t).html('<font size="1">'+a+"</font>")}}),$("#print").find("script").replaceWith(""),$("#print").html()},getPath:function(){var e=window.location.href;return e=e.substring(0,e.lastIndexOf("/"))+"/",e.replace("#/","")},removeValidator:function(e){var t=this;void 0!==t.get("validators."+e)&&(t.get("validators."+e).functions.clear(),t.get("validators."+e).validate())},readCSVContent:function(e){var t=this;t.get("data").set("gridData",[]);var a=!1;if(e){var s=e.split("\n");t.fileRecordCount=0,t.showBlockingBusyIndicator();var o=[];$(s).each(function(e,s){var n=s.split(",");if(3!==n.length)return""!==s&&(a=!0),!1;if(""!==n[0]||""!==n[1]){if(void 0!==n[0]&&""!==n[0]&&!1===jQuery.isNumeric(n[0]))return Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),n[0]+kl.value(t._localeBase+"payment.invalidCustomerNumber"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),!1;if(void 0!==n[1]&&""!==n[1]&&!1===jQuery.isNumeric(n[1]))return Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),n[1]+kl.value(t._localeBase+"payment.invalidAccountNumber"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),!1;if(void 0!==n[2]&&""!==n[2]&&!1===jQuery.isNumeric(n[2]))return Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),n[2]+kl.value(t._localeBase+"payment.invalidAmount"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),!1;var r={CustomerID:n[0],AccountID:n[1],PaymentAmount:n[2]};o=[],o.pushObject(r),t.insertBatchCustomerInGrid(r),t.searchCustomers(o,!0)}return!0})}else $(".file-upload-item:last").remove(),Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"payment.fileBlank"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger");a&&($(".file-upload-item:last").remove(),Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"payment.fileInvalid"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"))},insertBatchCustomerInGrid:function(e){var t=Komodo.Models.OnlineTill.CustomerModel.create();t.set("customerNumber",e.CustomerID),t.set("customerFirstname",""),t.set("customerSurname",""),t.set("customerName",""),t.set("address",""),t.set("telNo",""),t.set("mobileNo",""),t.set("email",""),t.set("customerType",""),t.set("customerStatus",""),t.set("isDstv",""),t.set("isGotv",""),t.set("businessUnit",""),t.set("customerClass",""),t.set("payAmount",e.PaymentAmount),t.set("accountToSelect",e.AccountID);var a=this.get("data");void 0!==a.get("gridData")&&null!==a.get("gridData")||a.set("gridData",[]),a.get("gridData").pushObject(t)},updateCustomerInGrid:function(e){var t=this.get("data.gridData");if(void 0!==t){var a=$.grep(t,function(t){return t.customerNumber===e.customerNumber||t.accountToSelect===e.AccountID});$(a).each(function(t,a){a.set("customerNumber",e.customerNumber),a.set("customerFirstname",e.customerFirstName),a.set("customerSurname",e.customerSurname),a.set("customerName",e.customerName),a.set("address",e.address),a.set("telNo",e.telNo),a.set("mobileNo",e.mobileNo),a.set("email",e.email),a.set("customerType",e.customerType),a.set("customerStatus","Active"),a.set("isDstv",e.isDstv),a.set("isGotv",e.isGotv),a.set("businessUnit",e.businessUnit),a.set("customerClass",e.customerClass)})}},retrieveBatchPaymentCustomerUsingAccountNumber:function(e){var t=this,a=$.Deferred();return Komodo.Services.queryService.getJSON("/AccountProfile/GetCustomerIdByFinancialAccount?id="+e.AccountID+"&dummy="+e.AccountID).done(function(a){if(a)if(-1===a)e.CustomerID="";else{e.CustomerID=a.toString();var s=[];s.pushObject(e),e.customerNumber=a.toString(),t.updateCustomerInGrid(e),t.searchCustomers(s,!0)}}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetCustomerIdByFinancialAccount ajax call failed. Error: "+t)}),a.promise()},getDefaultAccountNumber:function(e){var t="",a=$.grep($.makeArray(e),function(e){return!0===e.isDefault});return a&&a.length>0&&(t=a[0].accountNumber),t},checkDetfaultAccountExists:function(e){var t=!1,a=this;return $.each($.makeArray(e),function(e,s){t=!(!s||""===a.getDefaultAccountNumber(s.accounts))}),t},getOfflineUserShiftDetails:function(){var e=this,t=void 0;return this.getCacheRepository().fetch(e.countryCode()+".ShiftDetails."+e.userName()).done(function(e){t=e.data}),void 0===t&&(t={ShiftDetail:Komodo.Models.ShiftDetails.create()},e.getCacheRepository().save(e.countryCode()+".ShiftDetails."+e.userName(),t)),t},updateUser:function(e,t,a){var s=this,o=s.get("shiftdata"),n=s.getOfflineUserShiftDetails();if(n&&void 0===n.ShiftDetail&&(n.ShiftDetail=Komodo.Models.ShiftDetails.create()),e)n.ShiftDetail.Shift=Komodo.Models.Shift.create(),n.ShiftDetail.StockHandlers=[],n.ShiftDetail.AllowedCurrencies=[],n.ShiftDetail.Payments=[],n.ShiftDetail.Summary=[],n.ShiftDetail.ExchangeRates=[];else{var r=Komodo.Models.Shift.create();r.set("UID",o.shiftId),r.set("GLNumber",o.glNumber),r.set("Type",o.type),r.set("Cash",parseFloat(o.cash).toFixed(2)),r.set("Other",parseFloat(o.other).toFixed(2)),r.set("Balance",parseFloat(o.total).toFixed(2)),r.set("StockHandlerAccountID",o.stockHandlerId),r.set("BankDepositNumber",o.bdNumber),r.set("Currency",s.data.currency),r.set("UID",o.shiftId),r.set("GLNumber",o.glNumber),r.set("UID",o.shiftId),r.set("GLNumber",o.glNumber);n.ShiftDetail.Shift&&n.ShiftDetail.Shift.UID&&n.ShiftDetail.Shift.UID,n.ShiftDetail.Shift=r,n.ShiftDetail.StockHandlers=o.stockHandlers,n.ShiftDetail.AllowedCurrencies=o.allowedCurrencies,n.ShiftDetail.Printers=o.printers;var i=0;if(t)if(void 0===n.ShiftDetail.Payments&&(n.ShiftDetail.Payments=[]),1===t.IsCancelled?t.isCancelled="Yes":t.isCancelled="No",t.offlineMessageId){for(i=0;i<n.ShiftDetail.Payments.length;i++)if(n.ShiftDetail.Payments[i].PaymentDate===t.PaymentDate){n.ShiftDetail.Payments[i].Synced=t.Synced,n.ShiftDetail.Payments[i].offlineMessageId=t.offlineMessageId;break}}else"Yes"!==t.isCancelled&&n.ShiftDetail.Payments.pushObject(t);else if(a&&n.ShiftDetail.Payments){for(i=0;i<n.ShiftDetail.Payments.length;i++)if(n.ShiftDetail.Payments[i].offlineMessageId===a){1===n.ShiftDetail.Payments[i].IsCancelled?n.ShiftDetail.Payments[i].Synced="Yes":n.ShiftDetail.Payments[i].Synced="No";break}}else{var l=new moment(new moment,KomodoConfiguration.dateTimeFormat);n.ShiftDetail.Payments=$.grep(n.ShiftDetail.Payments,function(e){var t=new moment(e.PaymentDate,KomodoConfiguration.dateTimeFormat);return"No"===e.Synced||t&&l.date()===t.date()})}}s.getCacheRepository().save(s.countryCode()+".ShiftDetails."+s.userName(),n)},getCachePrinter:function(){var e=this;this.getCacheRepository().fetch(e.countryCode()+".PrinterDetails."+e.userName()).done(function(t){t&&t.data&&(e.set("cachePrinter",t.data.Printer),e.set("cacheSpeedPoint",t.data.Speedpoint))})},updateCachePrinter:function(e,t){var a=this,s=!1;if(t&&(delete t.layout,e===a.printerKey&&(void 0===a.cachePrinter||t.key!==a.cachePrinter.key&&t.ipAddress!==a.cachePrinter.ipAddress)&&(s=!0,a.set("cachePrinter",t)),e===a.speedpointKey&&(void 0===a.cacheSpeedPoint||t.key!==a.cacheSpeedPoint.key&&t.ipAddress!==a.cacheSpeedPoint.ipAddress)&&(s=!0,a.set("cacheSpeedPoint",t)),s)){var o={Printer:a.cachePrinter,Speedpoint:a.cacheSpeedPoint};a.getCacheRepository().save(a.countryCode()+".PrinterDetails."+a.userName(),o)}},getOfflinePayments:function(e){return e?$.grep(e,function(e){if(1===e.WasOffline&&(void 0===e.Synced||"No"===e.Synced)&&"No"===e.isCancelled)return e.Synced=0===e.WasOffline?"Yes":"No",e}):e},showBlockingBusyIndicator:function(e){e||(e=15e3),Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,e,"blocking",this)},hideBusyIndicator:function(e){var t=this;if(e){var a=t.get("data.gridData");t.fileRecordCount=t.fileRecordCount+1,a&&a.length===t.fileRecordCount&&(t.fileRecordCount=0,Komodo.Services.busyService.stop(this.get("processId"),"blocking"))}else Komodo.Services.busyService.stop(this.get("processId"),"blocking")},retrieveShiftDetailsEvent:function(e,t){var a=this,s=0,o=a.get("data"),n=a.shiftStatuses.find(function(e){return"1"===e.key});o&&void 0!==o.stockHandlerId&&(s=o.stockHandlerId),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftDetails?userName="+a.userName()+"&shiftStatus="+n.key+"&shiftType=Cashier&stockHandlerId="+s).done(function(e){if(void 0!==e&&null!==e){var s=a.genericController.populateShiftModel(e);a.getStockHandlerAccounts(s.stockHandlers);var o=a.get("data");o.set("shiftNumber",s.shiftId),o.set("allowedCurrencies",s.allowedCurrencies),o.set("currency",s.baseCurrency),o.set("baseCurrency",o.currency.value),o.set("currencyRate",s.currencyRate),o.set("shiftType",s.type),o.set("generalLedger",s.glNumber),o.set("bankDepositNumber",s.bdNumber),o.set("isBankDepositNumberVisible",null!==s.bdNumber&&""!==s.bdNumber),o.set("stockHandlerId",s.stockHandlerId),o.set("stockHandlers",s.stockHandlers),o.set("cash",parseFloat(s.cash).toFixed(2)),o.set("other",parseFloat(s.other).toFixed(2)),o.set("total",parseFloat(s.total).toFixed(2));s.set("shiftDetails",[]),s.set("cancelledPayments",[]),a.set("shiftdata",s),a.retrieveShiftPaymentsEvent(s,1,"Nothing",!1),!0===t&&(a.updateUser(!1,void 0,void 0),a.syncOfflinePayments()),!0===a.get("invokeRetrieveQuotationsEvent")&&(a.set("invokeRetrieveQuotationsEvent",!1),a.retrieveQuotationsEvent()),o.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")&&o.allowedCurrencies&&o.allowedCurrencies.length>1&&o.set("disableCurrency",!0)}else Komodo.Controls.MessageBoxController.show(kl.value(a._localeBase+"shift.technicalErrorTitle"),kl.value(a._localeBase+"shift.openShiftError"),Komodo.Controls.MessageBoxOkButton,a,"modelPayment","danger");a.hideBusyIndicator()}).error(function(e){a.genericController.showErrorPopup("retrieveShiftDetails",e),a.hideBusyIndicator()})},getStockHandlerAccounts:function(e){e&&!1===$.isEmptyObject(e)&&e.length&&e.length>0&&$.each(e,function(e,t){Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+t.Id).done(function(e){if(e&&e.Account){for(var a=[],s=0;s<e.Account.length;s++)a.pushObject({Type:e.Account[s].Type,UID:e.Account[s].UID,IsDefault:e.Account[s].IsDefault});t.accounts={Account:a}}else t.accounts=void 0})})},messageShiftDetailsRetrievedEventReceived:function(e){if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.Shifts){var t=this,a=t.genericController.populateShiftModel(e.ResponseMessage.Payload.Shifts),s=t.get("data");s.set("shiftNumber",a.shiftId),s.set("allowedCurrencies",a.allowedCurrencies),s.set("currency",a.baseCurrency),s.set("baseCurrency",s.currency.value),s.set("currencyRate",a.currencyRate),s.set("shiftType",a.type),s.set("generalLedger",a.glNumber),s.set("bankDepositNumber",a.bdNumber),s.set("isBankDepositNumberVisible",null!==a.bdNumber&&""!==a.bdNumber),s.set("stockHandlerId",a.stockHandlerId),s.set("stockHandlers",a.stockHandlers),s.set("cash",parseFloat(a.cash).toFixed(2)),s.set("other",parseFloat(a.other).toFixed(2)),s.set("total",parseFloat(a.total).toFixed(2)),this.set("shiftdata",a)}this.hideBusyIndicator()},retrieveShiftPaymentsEvent:function(e,t,a,s){var o=this,n=o.get("data"),r=n.get("allowedCurrencies");s&&o.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&page="+t+"&pageSize="+o.pageSize).done(function(s){if(void 0!==s&&null!==s){var n=[],i=[];if("InterimShiftReport"===a||"CloseShiftReport"===a?(n=Komodo.Services.OLTReportService.currentReportData.get("detailGridData"),i=Komodo.Services.OLTReportService.currentReportData.get("cancelledGridData")):n=o.get("shiftdata.shiftDetails"),void 0!==s.Payments&&$(s.Payments).each(function(e,t){var s=o.genericController.populateShiftDetailModel(t);if("InterimShiftReport"===a||"CloseShiftReport"===a)if("No"===s.isCancelled)n.pushObject(s);else{var r=JSON.parse(JSON.stringify(s));r.amount=parseFloat(-1*r.amount).toFixed(2),r.baseCurrencyAmount=parseFloat(-1*r.baseCurrencyAmount).toFixed(2),$(r.SplitPayments).each(function(e,t){t.amount=parseFloat(t.amount).toFixed(2)}),n.pushObject(r),i.pushObject(s)}"ShiftDetails"!==a&&"Nothing"!==a||n.pushObject(s)}),e.set("shiftDetails",n),e.set("cancelledPayments",i),!0===s.More||"true"===s.More){var l=Math.ceil(t*o.pageSize/s.TotalCount*100)+"%";Komodo.Services.OLTReportService.currentReportData.set("spoolingPercentage",l),o.retrieveShiftPaymentsEvent(e,t+1,a,!1)}else"ShiftDetails"===a&&o.shiftPaymentAction(a),"InterimShiftReport"!==a&&"CloseShiftReport"!==a||(Komodo.Services.OLTReportService.currentReportData.set("detailGridData",Komodo.Services.OLTReportService.currentReportData.detailGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("cancelledGridData",Komodo.Services.OLTReportService.currentReportData.cancelledGridData.sort(function(e,t){return e.sortId<t.sortId?-1:e.sortId>t.sortId?1:parseInt(e.paymentId,10)>parseInt(t.paymentId,10)?-1:parseInt(e.paymentId,10)<parseInt(t.paymentId,10)?1:0})),Komodo.Services.OLTReportService.currentReportData.set("allPayments",n),Komodo.Services.OLTReportService.currentReportData.set("allCurrencies",r),Komodo.Services.OLTReportService.currentReportData.set("allMethodOfPayments",o.methodOfPayments),Komodo.Services.OLTReportService.currentReportData.set("summaryGridData",o.genericController.populateShiftSummary(n,o.methodOfPayments,r,!0)),!Ember.isEmpty(r)&&r.length>1&&Komodo.Services.OLTReportService.currentReportData.set("summaryTotalByCurrency",o.genericController.populateShiftSummaryTotalByCurrency(n,r)),Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),o.genericController.setPaymentDetailsListByCurrencies(r),o.genericController.showReportPopup(kl.value(o._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"))}else Komodo.Services.OLTReportService.currentReportData.set("spooling",!1),"ShiftDetails"===a&&o.shiftPaymentAction(a),"InterimShiftReport"!==a&&"CloseShiftReport"!==a||(o.genericController.setMultipleBusinessUnitDefaultSettings(),o.genericController.setPaymentDetailsListByCurrencies(r),o.genericController.showReportPopup(kl.value(o._localeBase+"report.shiftDetailsReport"),"shiftDetailsReport"))}).error(function(e){o.genericController.showErrorPopup("retrieveShiftPayments",e),o.hideBusyIndicator()})},searchShiftPaymentsEvent:function(e,t,a){var s=this;a&&s.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftPayments?shiftId="+e.shiftId+"&paymentId="+t+"&page=0&pageSize=0").done(function(t){if(void 0!==t&&null!==t){var a=s.get("shiftdata.shiftDetails");void 0!==t.Payments&&$(t.Payments).each(function(e,t){a.pushObject(s.genericController.populateShiftDetailModel(t))}),e.set("shiftDetails",a)}}).error(function(e){s.genericController.showErrorPopup("retrieveShiftPayments",e),s.hideBusyIndicator()})},retrieveShiftSummaryEvent:function(e,t){var a=this,s=a.get("data");t&&a.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveShiftSummary?shiftId="+e.shiftId).done(function(t){if(void 0!==t&&null!==t){var o=a.genericController.populateShiftSummaryBalance({Summary:t});e.set("shiftSummary",o.shiftSummary),e.set("cash",o.cash),e.set("other",o.other),e.set("total",o.total),e.set("totalString",parseFloat(o.total).toFixed(2)),s.set("cash",parseFloat(e.cash).toFixed(2)),s.set("other",parseFloat(e.other).toFixed(2)),s.set("total",parseFloat(e.total).toFixed(2))}}).error(function(e){a.genericController.showErrorPopup("retrieveShiftSummary",e),a.hideBusyIndicator()})},closeShiftEvent:function(){var e=this,t=e.get("data"),a=Komodo.Models.CloseShift.create(),s=Komodo.canonicalFacadeFactory(a,["Country","UserName","ShiftUID"]);e.setCountryUserName(s),s.set("ShiftUID",t.shiftNumber),Komodo.Services.OLTService.publishOLTEvent(e,a,"CloseShiftEvent","v1",!0),e.showBlockingBusyIndicator()},messageShiftClosedEventReceived:function(){var e=this,t=e.get("shiftdata");e.hideBusyIndicator(),Komodo.log("closeShiftEvent() callback is received."),t.set("shiftDetails",[]),t.set("cancelledPayments",[]),e.updateUser(!0,void 0,void 0),e.shiftPaymentAction("CloseShiftReport"),e.retrieveShiftPaymentsEvent(t,1,"CloseShiftReport",!1)},retrieveCustomerSRQEvent:function(e){var t=this,a=Komodo.Models.RetrieveCustomerSRQ.create(),s=Komodo.canonicalFacadeFactory(a,["Country","UserName","CustomerID"]);t.setCountryUserName(s),s.set("CustomerID",e),Komodo.Services.OLTService.publishOLTEvent(t,a,"RetrieveCustomerSRQEvent","v1",!0)},messageCustomerSRQRetrievedEventReceived:function(e){var t=this,a=t.get("data"),s=void 0,o=!1;if(void 0!==e.ResponseMessage.Payload.CustomerSRQ&&e.ResponseMessage.Payload.CustomerSRQ.length>0){var n=void 0===e.ResponseMessage.Payload.CustomerSRQ||void 0!==e.ResponseMessage.Payload.CustomerSRQ.length&&null!==e.ResponseMessage.Payload.CustomerSRQ.length?e.ResponseMessage.Payload.CustomerSRQ[0].CustomerID:e.ResponseMessage.Payload.CustomerSRQ.CustomerID;if($(a.gridData).each(function(e,t){if(t.customerNumber===n)return void(s=t)}),void 0!==s){if(void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.CustomerSRQ){var r=[],i=[],l=parseFloat(0);void 0!==e.ResponseMessage.Payload.CustomerSRQ&&$(e.ResponseMessage.Payload.CustomerSRQ).each(function(e,t){if(void 0!==t.SRQID){var a=Komodo.Models.OnlineTill.SRQModel.create(),s=void 0!==t.TotalAmount?t.TotalAmount.Value:0;if(a.set("quoteId",t.SRQID),a.set("createdByUser",t.CreatedByUser),a.set("financialAccountId",t.FinancialAccountID),a.set("balance",t.FinancialAccountBalance),a.set("fulfillmentDate",new moment(t.FulfillmentDate).format(KomodoConfiguration.dateFormat)),a.set("quoteDateTime",new moment(t.SRQDate).format(KomodoConfiguration.dateFormat)),a.set("replacedByQuoteId",t.ReplacedBySRQID),a.set("totalAmount",s),0===parseFloat(s)?a.set("isSelected",!1):a.set("isSelected",!0),a.set("previousIsSelectedState",!0),"NotInDispute"===t.SRQStatus?a.set("srqStatus","No"):a.set("srqStatus","Yes"),void 0!==t.SRQLineItems&&0!==t.SRQLineItems.length)$(t.SRQLineItems).each(function(e,t){var s=Komodo.Models.OnlineTill.SRQLineItemModel.create();0===e?s.set("isFirst",!0):s.set("isFirst",!1),s.set("quoteLineItemId",t.SRQLineItemID),s.set("adjustmentAmount",t.AdjustmentAmount),s.set("amount",t.Amount),s.set("baseAmount",t.BaseAmount),s.set("startDate",new moment(t.StartDate).format(KomodoConfiguration.dateFormat)),s.set("endDate",new moment(t.EndDate).format(KomodoConfiguration.dateFormat)),s.set("period",new moment(t.StartDate).format(KomodoConfiguration.dateFormat)+" to "+new moment(t.EndDate).format(KomodoConfiguration.dateFormat)),s.set("taxAmount",t.TaxAmount),s.set("numberOfUnits",t.NumberOfUnits);var o="",n=t.InvoiceText.split("-");if(n.length>1)for(var r=1;r<n.length;r++)o+=n[r].trim();else o=t.InvoiceText;s.set("invoiceText",o),a.quoteLineItems.pushObject(s)});else{var o=Komodo.Models.OnlineTill.SRQLineItemModel.create();o.set("isFirst",!0),a.quoteLineItems.pushObject(o)}r.pushObject(a),l+=parseFloat(s),jQuery.inArray(t.FinancialAccountID,i)<0&&i.push(t.FinancialAccountID)}});var c=0,u=!1,h=Ember.isEmpty(s.get("customerClass"))?"":s.get("customerClass").toString().toUpperCase();"COMMERCIAL"===h&&a.set("autoReconnectProducts",!1),$(s.accounts).each(function(e,t){$(i).each(function(e,a){if(t.accountNumber===a){parseFloat(t.overdue)>0?parseFloat(t.overdue):parseFloat(t.overdue)<0&&(u=!0),"COMMERCIAL"===h&&(o=!(parseFloat(t.overdue)<0)),o||void 0===t.overdue||""===t.overdue||isNaN(t.overdue)||(c=parseFloat(c)+parseFloat(t.overdue))}})});var d=parseFloat(l)+parseFloat(c);s.set("subTotal",parseFloat(l).toFixed(2)),s.set("balance",parseFloat(c).toFixed(2)),"Batch Payment"!==a.paymentType&&s.set("payAmount",parseFloat(d).toFixed(2)),s.set("quotes",r),a.set("isCommercialCustomer",!1),a.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&(s.get("customerClass")&&"COMMERCIAL"===s.get("customerClass").toString().toUpperCase()&&u&&r.length>0&&a.set("isCommercialCustomer",!0),a.set("originalQuoteAmount",parseFloat(d)>0?parseFloat(d).toFixed(2):parseFloat(0).toFixed(2)),a.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(d)>0?parseFloat(d).toFixed(2):parseFloat(0).toFixed(2))))}void 0!==s.accounts&&void 0!==s.quotes&&$(s.accounts).each(function(e,t){t.set("quotes",[]);var a=[];a="-All-"===t.displayText?s.quotes:$.grep(s.quotes,function(e){if(t.accountNumber===e.financialAccountId)return e}),t.set("quotes",a)}),s.set("disableQuoteDetails",!1)}}s&&s.get("quotes")&&s.get("quotes").length&&s.get("quotes").length>0&&!o?(a.set("autoReconnectProducts",!0),a.set("disableReconnectProducts",!1)):o?(a.set("isCommercialCustomer",!1),a.set("autoReconnectProducts",!1)):(a.set("isCommercialCustomer",!1),a.set("autoReconnectProducts",!1),a.set("disableReconnectProducts",!0)),a.set("enableMakePayment",!1),t.hideBusyIndicator()},syncOfflinePayments:function(){var e=this,t=e.getOfflineUserShiftDetails();if(t&&t.ShiftDetail){var a=e.getOfflinePayments(t.ShiftDetail.Payments);if(a&&a.length&&a.length>0){e.offlinePayments=Komodo.Models.OnlineTill.OfflinePaymentModel.create(),e.offlinePayments.set("disableSync",!1),e.offlinePayments.set("disableClose",!1);var s=[];$.each(a,function(e,t){var a=Komodo.Models.OnlineTill.OfflinePaymentModel.create();t.SplitPayments&&t.SplitPayments.length&&t.SplitPayments.length>0&&(a.set("customerNumber",t.SplitPayments[0].CustomerID),a.set("accountType",t.SplitPayments[0].AccountType.description),a.set("payAmount",t.SplitPayments[0].Amount.Value)),a.set("paymentDate",t.PaymentDate),a.set("isCancelled",1===t.IsCancelled?"Yes":"No"),a.set("paymentType",t.MethodOfPayment),a.set("syncStatus","Pending"),a.set("WasOffline",t.WasOffline),a.set("Synced",t.Synced),s.pushObject(a)}),e.offlinePayments.set("payments",s);var o=Komodo.Application.ModalPaneController.create();o.popup(kl.value(e._localeBase+"home.syncOfflinePaymentsTitle"),"offlinePaymentSyncing",{canUserClose:!1,context:{data:e.offlinePayments,startSyncing:function(){e.offlinePayments.set("disableSync",!0),e.offlinePayments.set("disableClose",!0),e.publishOfflinePayments(a,this.data.payments)},paymentSyncStatus:function(e){var t=e._parentView.get("content");t&&("Pending"===t.syncStatus?alert("Payment need to be synced."):"Syncing"===t.syncStatus?alert("Syncing has been started for the payment."):"Synced"===t.syncStatus?alert("Payment is synced successfully."):"Failed"===t.syncStatus&&alert(t.failedMessage))},close:function(){o.close(),t=e.getOfflineUserShiftDetails();var a=e.getOfflinePayments(t.ShiftDetail.Payments);a&&a.length&&a.length>0?Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),kl.value(e._localeBase+"shift.offlinePayments"),Komodo.Controls.MessageBoxOkButtons,e,"modelPayment","danger").response=function(){e.getUIService().getController("application").redirectReturn("home")}:e.retrieveShiftDetailsEvent(!1,!1)}}})}}},publishOfflinePayments:function(e,t){var a=[],s=this,o=s.get("shiftdata");if(o&&o.stockHandlers&&o.stockHandlers.length){for(var n=void 0,r=0;r<o.stockHandlers.length;r++)if(o.stockHandlerId===o.stockHandlers[r].Id){n=o.stockHandlers[r];break}n&&e&&e.length&&(s.offlinePaymentsCount=e.length,$.each(e,function(e,r){var i=new $.Deferred,l=[],c=r.SplitPayments[0].CustomerID;l.pushObject({CustomerID:c}),s.searchCustomers(l,!1).done(function(a){!a||a.get("customerNumber")!==c&&a.get("deviceNumber")!==c?(r.IsAutoReconnectRequired=0,s.createPaymentEvent(void 0,void 0,!0,o.stockHandlerId,r,t[e],n.accounts,void 0),i.resolve(a)):(c=a.get("customerNumber"),Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+c).done(function(a){a?Komodo.Services.queryService.getJSON("/Quote/GetCustomerQuotes?customerId="+c+"&quoteCurrentStatus=4&quoteCategory=0").done(function(o){o&&o.Quote&&o.Quote.length&&0!==o.Quote.length?s.createPaymentEvent(void 0,void 0,!0,c,r,t[e],a,o):(r.IsAutoReconnectRequired=0,s.createPaymentEvent(void 0,void 0,!0,c,r,t[e],a,void 0)),i.resolve(o)}).fail(function(a){var o=JSON.stringify(a);Komodo.log("Get GetCustomerQuotes ajax call failed. Error: "+o),s.offlinePayments.set("disableSync",!1),s.offlinePayments.set("disableClose",!1),t[e].set("syncStatus","Failed"),t[e].set("failedMessage",a)}):(r.IsAutoReconnectRequired=0,s.createPaymentEvent(void 0,void 0,!0,o.stockHandlerId,r,t[e],n.accounts,void 0),i.resolve(a))}).fail(function(a){var o=JSON.stringify(a);Komodo.log("Get AccountProfile ajax call failed. Error: "+o),s.offlinePayments.set("disableSync",!1),s.offlinePayments.set("disableClose",!1),t[e].set("syncStatus","Failed"),t[e].set("failedMessage",a)}))}),a.push(i)}))}return $.when.apply(s,a).promise()},getPaymentAccount:function(e,t){var a=this,s=void 0;return e&&!1===$.isEmptyObject(e)&&e.Account&&!1===$.isEmptyObject(e.Account)&&e.Account.length&&e.Account.length>0&&void 0===(s=e.Account.find(function(e){return e.Type===t.key}))&&(s=e.Account.find(function(e){return!0===e.IsDefault})),void 0===s&&(s=a.getUnallocatedAccountOfStockHandler()),s},getUnallocatedAccountOfStockHandler:function(){var e=this,t=e.get("data"),a=e.get("shiftdata"),s=void 0;if(a.stockHandlers&&a.stockHandlers.length&&a.stockHandlers.length>0){for(var o=void 0,n=0;n<a.stockHandlers.length;n++)if(a.stockHandlerId===a.stockHandlers[n].Id){o=a.stockHandlers[n];break}var r=t.accountTypes.find(function(e){return"Unallocated"===e.value});r&&o&&o.accounts&&o.accounts.Account&&o.accounts.Account.length&&o.accounts.Account.length>0&&(s=o.accounts.Account.find(function(e){return e.Type===r.key}))}return s},createPaymentEvent:function(e,t,a,s,o,n,r,i){var l,c=this,u=c.get("data"),h=c.get("shiftdata"),d=void 0;if(a){if(l=c.getOfflinePaymentPayload(s,o,r,i))d=c._systemService.newGuid(),o.offlineMessageId=d,n.set("offlineMessageId",d),n.set("syncStatus","Syncing"),c.updateUser(!1,o,void 0);else if(n.set("syncStatus","Failed"),n.set("failedMessage","Quote or Account is not defined for the customer. If it is an invalid customer please check if stock handler has unallocated account configured."),c.offlinePaymentsCount=parseInt(c.offlinePaymentsCount)-1,c.offlinePaymentsCount<=0){var p=c.getOfflineUserShiftDetails(),m=c.getOfflinePayments(p.ShiftDetail.Payments);m&&m.length&&m.length>0?(c.offlinePayments.set("disableSync",!1),c.offlinePayments.set("disableClose",!1)):c.offlinePayments.set("disableClose",!1)}c.publishPayment(l,a,d)}else if(l=c.getOnlinePaymentPayload(e,t),void 0!==u.stockHandlerId&&null!==u.stockHandlerId&&void 0!==h.stockHandlerId&&null!==h.stockHandlerId&&u.set("isStockHandlerChanged",u.stockHandlerId.toString()!==h.stockHandlerId.toString()),"Card"===u.methodOfPayment&&u.useIntegratedCardPayment){var f=[],y=void 0;if(void 0!==h&&($(h.printers).each(function(e,t){if(!0===t.isActive&&t.printerName.indexOf("POS")>=0){var a={key:t.printerName,value:t.printerName,printerType:t.printerType,ipAddress:t.ipAddress,layout:unescape(t.printerLayout)};f.pushObject(a),c.cacheSpeedPoint&&t.printerName===c.cacheSpeedPoint.key&&t.ipAddress===c.cacheSpeedPoint.ipAddress&&(y=a)}}),f=f.sort(function(e,t){return e.key===t.key?0:+(e.key>t.key)||-1})),f&&f.length&&f.length>0){var b=Komodo.Models.OnlineTill.PrintReceiptModel.create();b.printers=f,b.selectedPrinter=y,b.set("showBusyIndicator",!1),b.set("disablePayment",!1);var v=Komodo.Application.ModalPaneController.create();v.popup(kl.value(c._localeBase+"home.useCaseTitle"),"creditCard",{context:{data:b,makePayment:function(){this.data.set("showBusyIndicator",!0),this.data.set("disablePayment",!0);var e={terminalIP:this.data.printer.ipAddress,terminalPort:"6000",receiptMessage:"THANK YOU - MULTICHOICE",amount:u.get("paymentAmount")};l.Payment.set("CardTransaction",e),c.publishPayment(l,a,d),c.updateCachePrinter(c.speedpointKey,this.data.printer),v.close()},cancel:function(){v.close()}}})}else Komodo.Controls.MessageBoxController.show(kl.value(c._localeBase+"home.title"),"No credit card devices assigned to the user.",Komodo.Controls.MessageBoxOkButtons,c,"modelPayment","danger")}else c.publishPayment(l,a,d)},publishPayment:function(e,t,a){if(e){var s=this,o=void 0,n=s.get("shiftdata"),r=s.get("data");t||s.showBlockingBusyIndicator(18e4),e.get("Payment.ElevatedPrivilegeSessionToken")&&(Komodo.Services.queryService.set("_elevatedPrivilegeSessionToken",e.get("Payment.ElevatedPrivilegeSessionToken")),o=Komodo.Services.queryService.elevatedPrivilegeBeforeSend),e.Payment.CashierName=e.UserName,Komodo.Services.queryService.deleteJSON("/RedisCache/InvalidateCustomer?CustomerNumber="+this.get("data.customerNumber")),Komodo.Services.queryService.postJSON("/PointOfSale/CreatePayment",{data:e.Payment,beforeSend:o,timeout:KomodoConfiguration.extendedAjaxTimeout}).done(function(o){if(void 0!=r&&r.isUserActivityToBeTracked&&void 0!=r.customerNumber&&s.startActivity(r.customerNumber),e.Payment.set("UID",o.Id),t||s.hideBusyIndicator(),"Card"===r.methodOfPayment&&r.useIntegratedCardPayment){var i=$.grep(r.get("methodOfPaymentSubs"),function(e){return e.key===o.CardTransactionResponse.CardType});i&&i.length>0&&r.set("cardType",i[0]),
"Two"===o.CardTransactionResponse.ResponseVersion&&o.CardTransactionResponse.CardTransactionResponseV2&&(r.set("cardHolder",o.CardTransactionResponse.CardTransactionResponseV2.CardHolderName),r.set("authorisationNumber",o.CardTransactionResponse.ReferenceRetrievalNumber))}t?s.updateSyncStatus(o,a):(s.paymentCreated(o),r.isStockHandlerChanged?(s.clearShiftDetails(),s.retrieveShiftDetailsEvent(!1,!1)):(s.retrieveShiftSummaryEvent(n,!1),s.searchShiftPaymentsEvent(n,o.Id,!1)))}).fail(function(o){if(s.hideBusyIndicator(),r.isStockHandlerChanged&&(s.clearShiftDetails(),s.retrieveShiftDetailsEvent(!1,!1)),t&&a){var n=s.getErrorMessage(o);if(s.setOfflineGridPaymentSyncStatus(a,"Failed",n),s.updateUser(!1,void 0,a),s.offlinePaymentsCount=parseInt(s.offlinePaymentsCount)-1,s.offlinePaymentsCount<=0){var i=s.getOfflineUserShiftDetails(),l=s.getOfflinePayments(i.ShiftDetail.Payments);s.offlinePayments&&(l&&l.length&&l.length>0?(s.offlinePayments.set("disableSync",!1),s.offlinePayments.set("disableClose",!1)):s.offlinePayments.set("disableClose",!1))}}else s.displayPaymentException(o,e),Komodo.log("Create payment ajax call failed. Error: "+JSON.stringify(o))})}},startActivity:function(e){var t={CustomerId:e,StartDate:(new Date).toGMTString(),Subject:"Activity-"+e};Komodo.Services.queryService.postJSON("/CrmUserManagement/SaveActivity",{data:t}).done(function(t){Komodo.log("User Activity for Customer:-"+e+" started successfully")}).error(function(t){var a=JSON.stringify(t);Komodo.log("User Activity for Customer:-"+e+" could not be started. Error: "+a)})},displayPaymentException:function(e,t){var a=this,s=a.getErrorMessage(e);if(s.indexOf("exceeds your threshold, please call your supervisor")>0){var o=Komodo.Models.OnlineTill.PaymentOverrideModel.create();o.set("message",s),o.set("disableAction",!1);var n=Komodo.Application.ModalPaneController.create();n.popup(kl.value(a._localeBase+"home.overridePaymentTitle"),"paymentOverride",{context:{data:o,ok:function(){var e=this;e.data.set("disableAction",!0),a.genericController.validateUserClaim(a.country,e.data.supervisorUsername,e.data.passCode,a._supervisorClaim).done(function(s){void 0!==s?a.data.cashierName===e.data.supervisorUsername?(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.overridePaymentError"))):(n.close(),void 0===t.Payment.IsCancelled||0===t.Payment.IsCancelled?a.createPaymentEvent(e.data.supervisorUsername,s):"CancelPayment"===message.ResponseMessage.Payload.OriginatedEventName&&a.cancelPaymentEvent(t.UID,a.cancelReason,e.data.supervisorUsername,s)):(e.data.set("disableAction",!1),alert(kl.value(a._localeBase+"shift.messageAccessValidate")))})},cancel:function(){n.close()}}})}else Komodo.Controls.MessageBoxController.show(kl.value(a._localeBase+"home.title"),s,Komodo.Controls.MessageBoxOkButtons,a,"modelPayment","danger")},getErrorMessage:function(e){var t=this,a=kl.value(t._localeBase+"shift.technicalError");return e&&(a="string"===$.type(e.responseJSON)?e.responseJSON:e.responseJSON&&e.responseJSON.ExceptionMessage?e.responseJSON.ExceptionMessage:e.statusText?e.statusText:JSON.stringify(e)),a},paymentCreated:function(e){var t=this,a=t.get("data");void 0!==e&&(t.showReceiptPopup(e),a.set("paymentAmount","0"),a.set("originalQuoteAmount","0"))},messagePaymentCreatedEventReceived:function(){},getOnlinePaymentPayload:function(e,t){var a=this,s=a.get("data"),o=!1;void 0!==s.currency&&null!==s.currency&&""!==s.baseCurrency&&s.baseCurrency!==s.currency.value&&(o=!0);var n=Komodo.Models.Payment.create(),r=Komodo.canonicalFacadeFactory(n,["UID","MethodOfPayment","MethodOfPaymentSub","ShiftID","StockHandlerID","IsCancelled","IsSplit","IsCashSale","Amount","AmountTendered","PaymentDate","IsAutoReconnectRequired","ShiftType","PaymentStatus","AccountHolderName","BankName","BranchName","BranchCode","ChequeDate","ChequeNumber","SplitPayments","WasOffline","IsRefund","CardAuthNumber","CardNumber","SupervisorUsername","ElevatedPrivilegeSessionToken","CardTransaction","EnableFiscalization","EnableInvoice","BusinessUnit","SmartcardNumber","Notes"]);a.setCountryUserName(r),r.set("MethodOfPayment",s.methodOfPayment),r.set("PaymentDate",(new moment).format()),r.set("ShiftID",s.shiftNumber),r.set("StockHandlerID",s.stockHandlerId),r.set("ShiftType",s.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")?"Batch":"Cashier");var i=void 0!==s.currency&&null!==s.currency?s.currency.key:"",l=Komodo.Models.Price.create();l.set("CurrencyCode",i),l.set("Value",s.amountTendered),r.set("AmountTendered",l);var c=Komodo.Models.Price.create();c.set("CurrencyCode",i),c.set("Value",s.paymentAmount),r.set("Amount",c),r.set("IsCancelled",0),r.set("IsSplit",s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")?1:0),r.set("IsCashSale",s.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")?1:0),r.set("IsAutoReconnectRequired",!0===s.autoReconnectProducts?1:0),"Cheque"===s.methodOfPayment&&(r.set("AccountHolderName",s.drawerName),r.set("BankName",s.chequeBank.CanonicalValue),r.set("BranchName",s.chequeBranch.CanonicalValue),r.set("BranchCode",s.chequeBranchCode),void 0!==s.chequeDate&&""!==s.chequeDate&&r.set("ChequeDate",new moment(s.chequeDate).format()),r.set("ChequeNumber",s.chequeNumber)),"Card"===s.methodOfPayment&&(r.set("AccountHolderName",s.cardHolder),r.set("MethodOfPaymentSub",s.cardType.value),r.set("CardAuthNumber",s.authorisationNumber),r.set("CardNumber",s.cardNumber)),r.set("IsRefund",a.isRefund?1:0);var u,h,d=[],p=Komodo.Models.SplitPayment.create(),m=!1;if(s.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")){var f=0,y=0,b=!1;if($.each(s.quoteGridData,function(e,t){void 0!==t.productType&&""!==t.productType&&"HARDWARE"!==t.productType.toUpperCase()?(b=!0,f=parseFloat(parseFloat(f)+parseFloat(t.totalPrice)).toFixed(2)):y=parseFloat(parseFloat(y)+parseFloat(t.totalPrice)).toFixed(2)}),b&&void 0!==s.customers&&s.customers.length>0){if(y&&parseFloat(y)>0?(p.set("QuotationID",s.quoteId),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",y),p.set("Amount",c),d.push(p)):r.set("IsCashSale",0),f&&parseFloat(f)>0){p=Komodo.Models.SplitPayment.create();var v=s.customers[0];p.set("CustomerID",v.customerNumber),p.set("AccountID",a.getDefaultAccountNumber(v.accounts)),void 0!==y&&parseFloat(y)<=0&&p.set("QuotationID",s.quoteId),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",f),p.set("Amount",c),d.push(p)}r.set("IsAutoReconnectRequired",0)}else p.set("QuotationID",s.quoteId),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",s.paymentAmount),p.set("Amount",c),d.push(p)}else s.isOffLine?(c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",s.paymentAmount),p.set("Amount",c),p.set("CustomerID",s.customerNumber),p.set("QuotationID","0"),p.set("AccountID","0"),d.push(p)):$(s.gridData).each(function(e,t){if(void 0===t.account)p=Komodo.Models.SplitPayment.create(),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")?(c.set("Value",void 0!==t.payAmount&&""!==t.payAmount?t.payAmount:0),o&&c.set("Value",a.getConvertedAmountByCurrency(parseFloat(t.payAmount)))):c.set("Value",void 0!==t.paymentAmount&&""!==t.paymentAmount?t.paymentAmount:0),p.set("Amount",c),p.set("CustomerID",t.customerNumber),p.set("AccountID",""),d.push(p);else{var n=void 0,l=0;if("-All-"===t.account.displayText?n=t.quotes:void 0!==t.account.quotes&&(n=t.account.quotes),void 0!==n&&void 0!==n.length&&n.length>0&&s.paymentType!==kl.value("locale.onlinetill:home.subTitleBatchPayment")){var f=[],y=[];if($(n).each(function(e,o){var r=0;if(!0===o.isSelected){if(jQuery.inArray(o.financialAccountId,y)<0){y.push(o.financialAccountId);var d=$.grep($.makeArray(t.accounts),function(e){return e.accountNumber===o.financialAccountId});if(d&&d.length>0){var m=0;parseFloat(d[0].overdue)>0&&(m=parseFloat(d[0].overdue)),r=m}}p=Komodo.Models.SplitPayment.create(),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",a.getConvertedAmountByCurrency(void 0!==t.payAmount?parseFloat(t.payAmount):0)),p.set("Amount",c),p.set("CustomerID",t.customerNumber),u=a.retrieveSmartcardForReceipt(t),h=a.setNoteToProductId(t),p.set("SmartcardNumber",Ember.isEmpty(u)?a.get("smartcardNumber"):u),p.set("Notes",Ember.isEmpty(h)||Ember.isEmpty(h.ProductId)?JSON.stringify(a.get("paymentNotes")):JSON.stringify(h)),"Commercial"===t.get("customerClass").toString()?p.set("QuotationID","INV"+o.quoteId):p.set("QuotationID","SRQ"+o.quoteId),l=parseFloat(l)+parseFloat(o.totalAmount)+parseFloat(r),f.push(p)}else 1===n.length&&(c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),c.set("Value",void 0!==s.paymentAmount&&""!==s.paymentAmount?s.paymentAmount:0),p.set("Amount",c),p.set("CustomerID",t.customerNumber),p.set("AccountID",t.account.accountNumber),u=a.retrieveSmartcardForReceipt(t),h=a.setNoteToProductId(t),p.set("SmartcardNumber",Ember.isEmpty(u)?a.get("smartcardNumber"):u),p.set("Notes",Ember.isEmpty(h)||Ember.isEmpty(h.ProductId)?JSON.stringify(a.get("paymentNotes")):JSON.stringify(h)),f.push(p))}),n.length>1&&(m=!0),f&&f.length<1&&(f=[],p=Komodo.Models.SplitPayment.create(),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")?c.set("Value",void 0!==t.payAmount&&""!==t.payAmount?t.payAmount:0):c.set("Value",void 0!==s.paymentAmount&&""!==s.paymentAmount?s.paymentAmount:0),p.set("Amount",c),p.set("CustomerID",t.customerNumber),u=a.retrieveSmartcardForReceipt(t),h=a.setNoteToProductId(t),p.set("SmartcardNumber",Ember.isEmpty(u)?a.get("smartcardNumber"):u),p.set("Notes",Ember.isEmpty(h)||Ember.isEmpty(h.ProductId)?JSON.stringify(a.get("paymentNotes")):JSON.stringify(h)),"-All-"===t.account.displayText?p.set("AccountID",a.getDefaultAccountNumber(t.accounts)):p.set("AccountID",t.account.accountNumber),f.push(p)),f&&f.length&&1===f.length)if(o){var b=a.getConvertedAmountByCurrency(parseFloat(f[0].get("Amount.Value")));parseFloat(s.get("paymentAmount"))<parseFloat(b)&&f[0].set("Amount.Value",parseFloat(s.get("paymentAmount")).toFixed(2))}else parseFloat(s.get("paymentAmount"))<parseFloat(f[0].get("Amount.Value"))&&f[0].set("Amount.Value",parseFloat(s.get("paymentAmount")).toFixed(2));d.pushObjects(f)}else p=Komodo.Models.SplitPayment.create(),c=Komodo.Models.Price.create(),c.set("CurrencyCode",i),s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.paymentType===kl.value("locale.onlinetill:home.subTitleBatchPayment")?c.set("Value",void 0!==t.payAmount&&""!==t.payAmount?a.getConvertedAmountByCurrency(parseFloat(t.payAmount)):0):c.set("Value",void 0!==s.paymentAmount&&""!==s.paymentAmount?s.paymentAmount:0),p.set("Amount",c),p.set("CustomerID",t.customerNumber),u=a.retrieveSmartcardForReceipt(t),h=a.setNoteToProductId(t),p.set("SmartcardNumber",Ember.isEmpty(u)?a.get("smartcardNumber"):u),p.set("Notes",Ember.isEmpty(h)||Ember.isEmpty(h.ProductId)?JSON.stringify(a.get("paymentNotes")):JSON.stringify(h)),"-All-"===t.account.displayText?p.set("AccountID",a.getDefaultAccountNumber(t.accounts)):p.set("AccountID",t.account.accountNumber),d.push(p);if(!0===m&&d.length>1&&(s.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&parseFloat(a.getConvertedAmountByCurrency(parseFloat(l).toFixed(2))).toFixed(2)===parseFloat(s.paymentAmount).toFixed(2)||s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")&&parseFloat(l).toFixed(2)===parseFloat(t.payAmount).toFixed(2))&&($(d).each(function(e,t){var a=$.grep($.makeArray(n),function(e){return"SRQ"+e.quoteId===t.QuotationID});a&&a.length>0&&t.set("Amount.Value",parseFloat(a[0].totalAmount).toFixed(2))}),r.set("IsSplit",1),s.paymentType===kl.value("locale.onlinetill:home.subTitleCustomerPayment")&&o)){var v=0;$(d).each(function(e,t){var s=$.grep($.makeArray(n),function(e){return"SRQ"+e.quoteId===t.QuotationID});if(s&&s.length>0){var o=parseFloat(a.getConvertedAmountByCurrency(parseFloat(s[0].totalAmount).toFixed(2))).toFixed(2);v=parseFloat(parseFloat(v)+parseFloat(o)).toFixed(2)}}),parseFloat(v).toFixed(2)===parseFloat(s.paymentAmount).toFixed(2)?(r.set("IsSplit",1),$(d).each(function(e,t){var s=$.grep($.makeArray(n),function(e){return"SRQ"+e.quoteId===t.QuotationID});if(s&&s.length>0){var o=parseFloat(a.getConvertedAmountByCurrency(parseFloat(s[0].totalAmount).toFixed(2))).toFixed(2);t.set("Amount.Value",parseFloat(o).toFixed(2))}})):r.set("IsSplit",0)}}});void 0!==d&&d.length>1&&(s.paymentType===kl.value("locale.onlinetill:home.subTitleSplitPayment")||s.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales"))&&!1===m&&r.set("IsSplit",1),r.set("SplitPayments",d),r.set("WasOffline",!0===s.isOffLine?1:0),r.set("EnableFiscalization",s.enableFiscalization?1:0),r.set("EnableInvoice",s.enableInvoice?1:0),u=a.retrieveSmartcardForReceipt(v),h=a.setNoteToProductId(v),r.set("SmartcardNumber",Ember.isEmpty(u)?a.get("smartcardNumber"):u),r.set("Notes",Ember.isEmpty(h)||Ember.isEmpty(h.ProductId)?JSON.stringify(a.get("paymentNotes")):JSON.stringify(h)),!1===a.isRefund&&s.set("enableMakePayment",!s.isOffLine);var g=parseFloat(s.amountTendered).toFixed(2)-parseFloat(s.paymentAmount).toFixed(2);if(o){var C=isNaN(g)?0:g,x=isNaN(s.currency.rate)?0:parseFloat(s.currency.rate);x>0&&(g=C*x,g=g.toFixed(2))}s.set("changeOwed",g<0?0:parseFloat(g).toFixed(2));var S=Komodo.Models.CreatePayment.create(),T=Komodo.canonicalFacadeFactory(S,["Country","UserName","SupervisorUsername","Payment"]);return void 0!==e&&""!==e&&(T.set("SupervisorUsername",e),r.set("SupervisorUsername",e),r.set("ElevatedPrivilegeSessionToken",t)),a.setCountryUserName(T),T.set("Payment",n),S},getOfflinePaymentPayload:function(e,t,a,s){var o,n=this,r=n.get("data"),i=Komodo.Models.Payment.create(),l=Komodo.canonicalFacadeFactory(i,["MethodOfPayment","MethodOfPaymentSub","ShiftID","StockHandlerID","IsCancelled","IsSplit","IsCashSale","Amount","AmountTendered","PaymentDate","IsAutoReconnectRequired","ShiftType","PaymentStatus","AccountHolderName","BankName","BranchName","BranchCode","ChequeDate","ChequeNumber","SplitPayments","WasOffline","CancelReason","IsRefund","EnableFiscalization","EnableInvoice"]);n.setCountryUserName(l),l.set("MethodOfPayment",t.MethodOfPayment),l.set("ShiftID",r.shiftNumber===t.ShiftID&&"<default>"!==t.ShiftID?t.ShiftID:r.shiftNumber),l.set("StockHandlerID",void 0===t.StockHandlerID||"<default>"===t.ShiftID?r.stockHandlerId:t.StockHandlerID),l.set("ShiftType","Cashier");var c=r.currency.key;void 0===t.AmountTendered.CurrencyCode&&"<default>"!==t.AmountTendered.CurrencyCode&&(c=t.AmountTendered.CurrencyCode);var u=Komodo.Models.Price.create();u.set("CurrencyCode",c),u.set("Value",t.AmountTendered.Value),l.set("AmountTendered",u),o=Komodo.Models.Price.create(),o.set("CurrencyCode",u.get("CurrencyCode")),o.set("Value",t.Amount.Value),l.set("Amount",o),l.set("IsCancelled",0),1===t.IsCancelled&&l.set("CancelReason",n.cancelReason),l.set("IsSplit",0),l.set("IsCashSale",0),l.set("IsAutoReconnectRequired",t.IsAutoReconnectRequired),l.set("IsRefund",0),"Cheque"===t.MethodOfPayment?(l.set("AccountHolderName",t.AccountHolderName),l.set("BankName",t.BankName.CanonicalValue),l.set("BranchName",t.BranchName.CanonicalValue),l.set("BranchCode",t.BranchCode),l.set("ChequeNumber",t.ChequeNumber),t.chequeDate&&""!==t.chequeDate?l.set("ChequeDate",new moment(t.chequeDate).format()):l.set("ChequeDate",(new moment).format())):"Card"===t.MethodOfPayment&&(l.set("AccountHolderName",t.AccountHolderName),l.set("MethodOfPaymentSub",t.MethodOfPaymentSub));var h=[],d=Komodo.Models.SplitPayment.create();if(o=Komodo.Models.Price.create(),d.set("Amount",u),d.set("CustomerID",e),s&&s.Quote&&s.Quote.length&&s.Quote.length>0&&1===t.IsAutoReconnectRequired&&"DSTVRES"===t.SplitPayments[0].AccountType.value.toUpperCase()&&parseFloat(t.AmountTendered.Value)>0)d.set("QuotationID","SRQ"+s.Quote[0].Id);else{var p=void 0;"DSTVRES"!==t.SplitPayments[0].AccountType.value.toUpperCase()&&l.set("IsAutoReconnectRequired",0),p=e===t.StockHandlerID?n.getUnallocatedAccountOfStockHandler():n.getPaymentAccount(a,t.SplitPayments[0].AccountType),p?d.set("AccountID",p.UID):d.set("AccountID",void 0)}h.push(d),l.set("SplitPayments",h),l.set("WasOffline",1);var m=Komodo.Models.CreatePayment.create(),f=Komodo.canonicalFacadeFactory(m,["Country","UserName","SupervisorUsername","Payment"]);return n.setCountryUserName(f),f.set("Payment",i),d.AccountID||d.QuotationID?m:void 0},updateSyncStatus:function(e,t){var a=this,s=a.getOfflinePayment(t);if(s){s.PaymentID=e.PaymentID,s.Synced="Yes";var o=a.setOfflineGridPaymentSyncStatus(t,"Synced");if(o&&"Yes"===o.get("isCancelled")&&!1===o.get("cancelPublished")){var n=a.cancelPaymentEvent(e.PaymentID,a.cancelReason,void 0,void 0,!0);s.offlineMessageId=n,o.set("offlineMessageId",n),o.set("cancelPublished",!0)}if(a.updateUser(!1,s,void 0),a.offlinePaymentsCount=parseInt(a.offlinePaymentsCount)-1,a.offlinePaymentsCount<=0){var r=a.getOfflineUserShiftDetails(),i=a.getOfflinePayments(r.ShiftDetail.Payments);i&&i.length&&i.length>0?(a.offlinePayments.set("disableSync",!1),a.offlinePayments.set("disableClose",!1)):a.offlinePayments.set("disableClose",!1)}}},setOfflineGridPaymentSyncStatus:function(e,t,a){var s=this;if(s.offlinePayments&&s.offlinePayments.payments&&s.offlinePayments.payments.length)for(var o=0;o<s.offlinePayments.payments.length;o++)if(s.offlinePayments.payments[o].get("offlineMessageId")===e)return s.offlinePayments.payments[o].set("syncStatus",t),s.offlinePayments.payments[o].set("failedMessage",a),s.offlinePayments.payments[o]},getOfflinePayment:function(e){for(var t=this,a=t.getOfflineUserShiftDetails(),s=0;s<a.ShiftDetail.Payments.length;s++)if(a.ShiftDetail.Payments[s].offlineMessageId===e)return a.ShiftDetail.Payments[s]},getPublishedOfflineMessageId:function(e){if(e&&e.ResponseMessage&&e.ResponseMessage.EventMetaData&&e.ResponseMessage.EventMetaData.Parameters&&e.ResponseMessage.EventMetaData.Parameters.Context){var t=e.ResponseMessage.EventMetaData.Parameters.Context;if(t&&t.length&&t.length>0)for(var a=0;a<t.length;a++)if("offlineMessageId"===t[a].Key)return t[a].Value}},retrieveQuotationsEvent:function(){var e=this,t=e.data.get("quoteId"),a=e.data.get("stockHandlerId");e.data.customerNumber=void 0,e.data.customers=[];var s=kl.value("locale:error");t&&(isNaN(t)?Komodo.Services.queryService.getJSON("SwapMaterialAvailability/GetCrmQuote?quoteNumber="+t+"&stockHanderId="+a+"&retrieveStock=true").done(function(t){var a=e.resultQuoteMessage;a.ResponseMessage.Payload.ListOfQuotation.Quotation=void 0,a.ResponseMessage.Payload.ListOfQuotation.Quotation=t,e.messageQuotationsRetrievedReceived(a)}).error(function(t){e.hideBusyIndicator();var a=JSON.stringify(t);Komodo.log("GetCrmQuote ajax call failed. Error: "+a),t&&"string"===$.type(t.responseJSON)?Komodo.Controls.MessageBoxController.show(s,t.responseJSON,Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger"):t.responseJSON&&t.responseJSON.ExceptionMessage?Komodo.Controls.MessageBoxController.show(s,t.responseJSON.ExceptionMessage,Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger"):t.responseJSON&&t.responseJSON.Message?Komodo.Controls.MessageBoxController.show(s,t.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger"):t.statusText?Komodo.Controls.MessageBoxController.show(s,t.statusText,Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger"):Komodo.Controls.MessageBoxController.show(s,JSON.stringify(t),Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger")}):Komodo.Services.queryService.getJSON("SwapMaterialAvailability/GetInvoice?invoiceNumber="+t).done(function(t){var a=e.resultInvoiceMessage;a.ResponseMessage.Payload.ListOfInvoices.Invoice=void 0,a.ResponseMessage.Payload.ListOfInvoices.Invoice=t,e.messageInvoiceRetrievedReceived(a)}).error(function(t){e.hideBusyIndicator();var a=JSON.stringify(t);Komodo.log("GetInvoice ajax call failed. Error: "+a),Komodo.Controls.MessageBoxController.show(s,kl.value(e._localeBase+"shift.messageInvoiceValidate"),Komodo.Controls.MessageBoxOkButtons,e,"id5556673","danger")}),e.showBlockingBusyIndicator())},messageQuotationsRetrievedReceived:function(e){var t=this;if(t.hideBusyIndicator(),void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfQuotation&&void 0!==e.ResponseMessage.Payload.ListOfQuotation.Quotation){var a=e.ResponseMessage.Payload.ListOfQuotation.Quotation;if(void 0!==a&&void 0!==a.TotalPrice){var s=t.get("data");!t.get("linkedCustomerNumber")||void 0!==t.data.customerNumber&&null!==t.data.customerNumber&&""!==t.data.customerNumber||t.findCustomers([{CustomerID:t.get("linkedCustomerNumber")}]),s.set("quoteId",a.UID);var o=a.TotalPrice.Value;parseFloat(o)>0?(s.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(o).toFixed(2))),s.set("quoteAmount",parseFloat(o).toFixed(2)),s.set("originalQuoteAmount",parseFloat(o).toFixed(2))):(s.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(0).toFixed(2))),s.set("quoteAmount",parseFloat(0).toFixed(2)),s.set("originalQuoteAmount",parseFloat(0).toFixed(2)));var n=t.quoteStatuses.find(function(e){return e.key===a.Status});s.set("quoteStatus",void 0===n?"":n.value);var r=[];if(s.set("isQuoteQuantityShort",!1),s.set("isRepairQuotePassed",!0),void 0!==a.ListOfQuotationLineItem){var i=a.ListOfQuotationLineItem.QuotationLineItem?a.ListOfQuotationLineItem.QuotationLineItem:a.ListOfQuotationLineItem;$(i).each(function(e,t){var o=Komodo.Models.OnlineTill.CRMQuoteLineItemModel.create();o.set("productName",t.Product.Details.Name),o.set("productType",t.Product.Details.Type),o.set("quantity",t.Quantity),o.set("quotedUnitPrice",parseFloat(t.QuotedUnitPrice.Value).toFixed(2)),o.set("totalPrice",parseFloat(t.TotalPrice.Value).toFixed(2)),r.pushObject(o),a.Category!==Komodo.QuotationCategory.DEVICESWAP&&a.Category!==Komodo.QuotationCategory.REPAIR&&"HARDWARE"===t.Product.Details.Type.toUpperCase()&&t.MaterialQuantityDetails&&(t.MaterialQuantityDetails instanceof Array||(t.MaterialQuantityDetails=[t.MaterialQuantityDetails]),t.MaterialQuantityDetails.forEach(function(e){if(e.QuantityNew<t.Quantity)return s.set("isQuoteQuantityShort",!0),!1}))}),s.set("quoteGridData",r)}s.get("validateRepairQuotePayment")&&a.Category===Komodo.QuotationCategory.REPAIR&&(s.set("isRepairQuotePassed",!1),s.set("quoteSAPStatus",a.StatusReason?a.StatusReason:Komodo.RepairQuotationStatus.UNAVAILABLE),a.StatusReason&&a.StatusReason.toUpperCase()===Komodo.RepairQuotationStatus.QCPASSED&&s.set("isRepairQuotePassed",!0)),s.set("paymentType",kl.value("locale.onlinetill:home.subTitleCashSales")),s.set("showQuoteInformation",!0),s.set("showQuoteGrid",!0),s.set("refundPayment",!1),s.set("disableAmountTendered",!1),s.set("quote",a)}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noQuoteError")+e.ResponseMessage.Payload.ListOfQuotation.Quotation.UID,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noQuoteError")+e.ResponseMessage.Payload.ListOfQuotation.Quotation.UID,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")},messageInvoiceRetrievedReceived:function(e){var t=this;if(t.hideBusyIndicator(),void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfInvoices&&void 0!==e.ResponseMessage.Payload.ListOfInvoices.Invoice){var a=e.ResponseMessage.Payload.ListOfInvoices.Invoice;if(void 0!==a&&void 0!==a.UID){var s=t.get("data"),o=void 0!==a.TotalAmount?a.TotalAmount.Value.toString().trim():0;parseFloat(o)>0?(s.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(o).toFixed(2))),s.set("quoteAmount",parseFloat(o).toFixed(2)),s.set("originalQuoteAmount",parseFloat(o).toFixed(2))):(s.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(0).toFixed(2))),s.set("quoteAmount",parseFloat(0).toFixed(2)),s.set("originalQuoteAmount",parseFloat(0).toFixed(2)));var n=[];void 0!==a.ListOfInvoiceLineItem&&($($.makeArray(a.ListOfInvoiceLineItem)).each(function(e,t){var a=Komodo.Models.OnlineTill.CRMQuoteLineItemModel.create();a.set("productName",t.ProductDetail.Name.trim()),t.ProductDetail.Name&&t.ProductDetail.Name.trim().indexOf("BUNDLE")>-1?a.set("productType","SOFTWARE"):a.set("productType","HARDWARE"),a.set("quantity",t.Quantity.toString().trim());var s=void 0!==t.TotalAmount?t.TotalAmount.Value.toString().trim():0;a.set("quotedUnitPrice",parseFloat(s).toFixed(2)),a.set("totalPrice",parseFloat(s).toFixed(2)),n.pushObject(a)}),s.set("quoteGridData",n)),t.get("data").set("showQuoteInformation",!0),t.get("data").set("showQuoteGrid",!0),s.set("quoteStatus",a.Status),s.set("refundPayment",!1),s.set("disableAmountTendered",!1),s.set("enableMakePayment",!1),s.set("methodOfPayment",s._getDefaultMethodOfPayment()),!0===s.isRefundAvailable&&(e.ResponseMessage.Payload.ListOfInvoices.DocumentCategory&&"O"===e.ResponseMessage.Payload.ListOfInvoices.DocumentCategory.toUpperCase()||"O"===a.DocumentCategory.toUpperCase())&&(s.set("refundPayment",!0),s.set("disableAmountTendered",!0),s.set("enableMakePayment",!0),s.set("businessUnit",e.ResponseMessage.Payload.ListOfInvoices.Invoice.BusinessUnit),s.set("methodOfPayment","Cash"),s.set("disableCurrency",!0))}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noQuoteError")+t.data.get("quoteId"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noQuoteError")+t.data.get("quoteId"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")},retrieveHardwareIssuedAgainstQuotation:function(){var e=this,t=Komodo.Models.RetrieveHardwareIssuedAgainstQuote.create(),a=Komodo.canonicalFacadeFactory(t,["QuotationId","Country"]);a.set("QuotationId",e.data.get("quoteId")),a.set("Country",e.country),e.get("data").set("showQuoteInformation",!1),e.get("data").set("showQuoteGrid",!1),Komodo.Services.OLTService.publishOLTEvent(e,t,"RetrieveHardwareIssuedAgainstQuotation","v1",!0),e.showBlockingBusyIndicator()},messageHardwareIssuedAgainstQuotationRetrievedReceived:function(e){var t=this;if(t.hideBusyIndicator(),void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfHardware){var a=t.get("data"),s=[];$(e.ResponseMessage.Payload.ListOfHardware.Hardware).each(function(e,t){var a=Komodo.Models.OnlineTill.CRMQuoteLineItemModel.create();a.set("deviceSerialNumber",t.SerialNumber),a.set("model",t.ProductDetail.Model),s.pushObject(a)}),a.set("quoteGridData",s),t.get("data").set("showQuoteGrid",!0)}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),kl.value(t._localeBase+"shift.noQuoteDataError"),Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")},cancelPaymentEvent:function(e,t,a,s,o){var n=this,r=n.get("shiftdata"),i=Komodo.Models.Payment.create(),l=Komodo.canonicalFacadeFactory(i,["UID","Id","ShiftType","IsCancelled","IsSplit","IsCashSale","CancelReason","WasOffline","SupervisorUsername","ElevatedPrivilegeSessionToken","EnableFiscalization","EnableInvoice"]);l.set("UID",e),l.set("Id",e),l.set("ShiftType","Cashier"),l.set("IsCancelled",1),l.set("IsSplit",0),l.set("IsCashSale",0),l.set("CancelReason",t),l.set("WasOffline",0),l.set("EnableFiscalization",n.data.enableFiscalization?1:0),l.set("EnableInvoice",n.data.enableInvoice?1:0);var c=Komodo.Models.CreatePayment.create(),u=Komodo.canonicalFacadeFactory(c,["Country","UserName","SupervisorUsername","Payment"]);void 0!==a&&""!==a&&(u.set("SupervisorUsername",a),l.set("SupervisorUsername",a),l.set("ElevatedPrivilegeSessionToken",s)),n.setCountryUserName(u),u.set("Payment",i);var h=n._systemService.newGuid();n.showBlockingBusyIndicator();var d=void 0;s&&(Komodo.Services.queryService.set("_elevatedPrivilegeSessionToken",s),d=Komodo.Services.queryService.elevatedPrivilegeBeforeSend),c.Payment.CashierName=c.UserName,Komodo.Services.queryService.deleteJSON("/RedisCache/InvalidateCustomer?CustomerNumber="+this.get("data.customerNumber")),Komodo.Services.queryService.postJSON("/PointOfSale/CreatePayment",{data:c.Payment,beforeSend:d,timeout:KomodoConfiguration.extendedAjaxTimeout}).done(function(e){return n.hideBusyIndicator(),n.paymentCreated(e),n.retrieveShiftSummaryEvent(r,!1),n.searchShiftPaymentsEvent(r,e.Id,!1),o?h:void n.updateUser(!1,i,void 0)}).error(function(e){return n.hideBusyIndicator(),n.displayPaymentException(e,c),Komodo.log("Create payment ajax call failed. Error: "+JSON.stringify(e)),o?h:void n.updateUser(!1,i,void 0)})},retrieveReceiptDetailsEvent:function(e){var t=this;t.showBlockingBusyIndicator(),Komodo.Services.queryService.getJSON("/PointOfSale/GetPayment?paymentId="+e).done(function(e){t.hideBusyIndicator(),t.searchCustomers(e,!1,!1).done(function(){t.searchQuotes(e).done(function(){e&&(e.IsReprint=!0,t.showReceiptPopup(e))})}).fail(function(e){e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),Komodo.log("searchCustomers ajax call failed. Error: "+JSON.stringify(e))})}).error(function(e){t.hideBusyIndicator(),e&&void 0!==e.responseJSON&&void 0!==e.responseJSON.Message&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON.Message,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),Komodo.log("Create payment ajax call failed. Error: "+JSON.stringify(e))})},searchQuotes:function(e){var t=this,a=t.get("data"),s=$.Deferred();if(a.set("quote",void 0),!0===e.IsCashSale){var o=isNaN(e.QuotationID)?e.QuotationID:void 0;!0===e.IsSplit&&$.each($.makeArray(e.SplitPayments),function(e,t){t.QuotationId&&isNaN(t.QuotationId)&&(o=t.QuotationId)}),o?Komodo.Services.queryService.getJSON("SwapMaterialAvailability/GetCrmQuote?quoteNumber="+o+"&stockHanderId=&retrieveStock=false").done(function(e){a.set("quote",e),s.resolve(e)}).error(function(e){e&&void 0!==e.responseJSON&&Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),e.responseJSON,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger"),Komodo.log("searchQuotes ajax call failed. Error: "+JSON.stringify(e)),s.fail(e)}):s.resolve()}else s.resolve();return s},searchCustomers:function(e,t,a){var s,o=[],n=this,r=n.get("data");return a=void 0===a||null===a||a,!t&&a&&(r.gridData=[]),r.set("customers",[]),$.each($.makeArray(e),function(e,a){var i=new $.Deferred;t?void 0===a.CustomerID||""===a.CustomerID?n.retrieveBatchPaymentCustomerUsingAccountNumber(a):(s=n.get("controllers.search").createSearchRequest(a.CustomerID),n.get("controllers.search").retrieveElasticSearchDataWithPromise(s).done(function(e){e&&(r.customers.push(e),n.updateCustomerInGrid(e),n.retrieveFinancialDetails(e.customerNumber),i.resolve(e))}),o.push(i)):(s=n.get("controllers.search").createSearchRequest(a.CustomerID),n.get("controllers.search").retrieveElasticSearchDataWithPromise(s).done(function(e){void 0!==e&&r.customers.push(e),i.resolve(e)}),o.push(i))}),$.when.apply(void 0,o).promise()},findCustomers:function(e){var t,a=[],s=this,o=s.get("data");return o.set("customers",[]),$.each($.makeArray(e),function(e,n){var r=new $.Deferred;t=s.get("controllers.search").createSearchRequest(n.CustomerID),s.get("controllers.search").retrieveElasticSearchDataWithPromise(t).done(function(e){e?(o.customers.push(e),s.updateCustomerInGrid(e),s.retrieveFinancialDetails(e.customerNumber),
r.resolve(e)):Komodo.Services.queryService.getJSON("CustomerProfile?customerId="+n.CustomerID,!1).done(function(e){if(e&&e.CustomerDetail){var t=e.RdCheque?e.RdCheque.Status:"",a=Komodo.Application.CustomerProfileMapper.create(),i=a.fillCustomerDetailsForHeader(e.CustomerDetail,n.CustomerID,t),l=Komodo.Models.OnlineTill.CustomerModel.create();l.set("customerNumber",i.customerNo),l.set("title",i.title),l.set("customerFirstname",i.firstName),l.set("customerSurname",i.lastName),l.set("customerName",s.concatStrings(i.title,i.firstName,i.lastName)),l.set("customerClass",i.customerClassText),l.set("customerType",i.customerTypeText),l.set("telNo",i.telNo),l.set("mobileNo",i.mobileNo),l.set("locationIndicator",i.locationIndicator),l.set("email",i.email),l.set("isDstv",i.isDstv),l.set("isGotv",i.isGotv),l.set("businessUnit",void 0!==i.viewPlatform?i.viewPlatform.toUpperCase():""),l.set("customerStatus",i.customerStatus),o.customers.push(l),s.updateCustomerInGrid(l),s.retrieveFinancialDetails(l.customerNumber),r.resolve(e)}}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrieveCustomerProfile ajax call failed. Error: "+t)})}),a.push(r)}),$.when.apply(void 0,a).promise()},printReceipt:function(e){var t=this,a=(t.getSystemService().get("isMobile"),t.isNonWindowsSystem(),KomodoConfiguration.localStorageApiUrl+"/printReceipt"),s={async:!1,type:"POST",cache:!1,url:a,dataType:"json",contentType:"application/json",data:JSON.stringify(e)};jQuery.ajax(s).done(function(){}).fail(function(e){var a=kl.value(t._localeBase+"shift.technicalError");e&&(void 0!==e.responseJSON?a=e.responseJSON.message:void 0!==e.statusText&&""!==e.statusText&&(a=e.statusText)),alert(a)})},emailReceipt:function(e,t){if(e&&e.receiptData&&e.receiptData.length>=1){var a=[];$(e.receiptData).each(function(e,t){var s=Komodo.Models.PaymentCaptured.create();s.set("Country",controller.get("country")),s.set("BusinessUnit",t.BusinessUnit),s.set("ReceiptNumber",t.ReceiptNumber),s.set("ReceiptDate",t.ReceiptDate),s.set("MethodOfPayment",t.MethodOfPayment),s.set("CustomerID",t.CustomerID),s.set("CustomerName",t.CustomerName),s.set("SmartcardNumber",t.SmartcardNumber),s.set("CellphoneNumber",t.CellNumber),s.set("Currency",t.Currency);var o=Komodo.Models.Price.create();o.set("CurrencyCode",t.Currency),o.set("Value",t.TotalAmountInclTax),o.set("ValueWithoutTax",t.TotalAmountExclTax);var n=Komodo.Models.Tax.create();n.set("Amount",t.Tax),o.ListOfTax[0]=n,s.set("Amount",o);var r=Komodo.Models.Price.create();r.set("CurrencyCode",t.Currency),r.set("Value",t.Amount),r.ListOfTax[0]=n,s.set("AmountTendered",r);var i=Komodo.Models.Price.create();i.set("CurrencyCode",t.Currency),i.set("Value",t.Change),s.set("ChangeOwed",i),s.set("CashierName",t.CashierName),s.set("QuotationID",t.QuotationID),s.set("IsCashSale",t.IsCashSale),s.set("IsCancelled",t.IsCancelled),s.set("IsReprint",t.IsReprint),s.set("IsRefund",t.IsRefund),s.set("EmailReceiptDate",new moment(new Date).format("YYYYMMDD_hhmmss")),a.push(s)});var s=Ember.Object.create({ListOfPayment:a}),o=void 0;t.EnableFiscalization?e.receiptData.length>1?o=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_SINGLE",!1):e.email&&e.email.length>0?(o=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_ALTERNATE",!1),e.email.forEach(function(t){t.Value===e.selectedEmail&&t.IsPrimary&&(o=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_PRIMARY",!1))})):o=GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_CAPTURED",!1):e.receiptData.length>1?o=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_SINGLE"):e.email&&e.email.length>0?(o=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_ALTERNATE"),e.email.forEach(function(t){t.Value===e.selectedEmail&&t.IsPrimary&&(o=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_PRIMARY"))})):o=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_CAPTURED"),controller.publishOutbondNotificationEvent({Payload:s},e.selectedEmail,o,t)}},retrieveFinancialDetails:function(e){var t=[],a=this,s=a.resultAccountMessage;s.ResponseMessage.Payload.ListOfAccount.Account.clear();var o=$.Deferred();return Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+e).done(function(n){s.ResponseMessage.Payload.ListOfAccount.Account.clear(),n&&n.Account.length&&0!==n.Account.length&&(n.Account.length>1?s.ResponseMessage.Payload.ListOfAccount.Account.addObjects(n.Account):s.ResponseMessage.Payload.ListOfAccount.Account.addObject(n.Account[0]),s.ResponseMessage.Payload.CustomerUID=e),a.messageFinancialAccountsRetrievedReceived(s,""),a.get("data.customer")&&a.get("data.customer").get("customerClass")&&"Commercial"===a.get("data.customer").get("customerClass").toString()?a.retrieveCustomerInvoices(e):(a.set("data.isCommercialCustomer",!1),a.retrieveCustomerQuotesDetails(e)),o.resolve(n),t.push(o)}),$.when.apply(void 0,t).promise()},messageFinancialAccountsRetrievedReceived:function(e){var t=this,a=e.ResponseMessage.Payload.CustomerUID,s=t.genericController.populateAccountModel(e.ResponseMessage.Payload),o=t.get("data"),n=void 0,r=0;if($(o.gridData).each(function(e,t){if(t.customerNumber===a&&(void 0===t.accounts||t.accounts.length<1))return void(n=t)}),void 0===n&&$(o.customers).each(function(e,t){if(t.customerNumber===a&&(void 0===t.accounts||t.accounts.length<1))return void(n=t)}),void 0!==n&&void 0!==s){if(n.set("accounts",s),s.length>0){var i=void 0,l=void 0,c=n.get("accountToSelect");$(s).each(function(e,t){t.accountNumber===c&&"-All-"!==t.displayText?i=t:!0===t.isDefault&&(l=t),"-All-"!==t.displayText&&(r=parseFloat(r)+parseFloat(t.overdue&&""!==t.overdue?t.overdue:0))}),void 0===i?n.set("account",l):n.set("account",i)}else n.set("account",void 0);n.set("accountCount","("+(s.length-1)+")");var u=s.filter(function(e){return"OPEN"===e.status.toUpperCase()||"SUSPENDED"===e.status.toUpperCase()}),h=[];if($(s).each(function(e,t){h.push({AccountId:t.get("accountNumber"),DueDate:t.get("chargeuntildate"),Balance:t.get("overdue")})}),u[0]&&h&&h.length>0){var d="";void 0!==o.currencies&&(d=o.currencies.find(function(e){return e.key===u[0].currencyCode}),d=void 0!==d?d:"");var p=h.map(function(e){var t=e.DueDate.split("-");return new Date(parseInt(t[2],10),parseInt(t[1],10),parseInt(t[0],10))}),m=XDates.getNearestDate(new Date,p),f=h.filter(function(e){var t=e.DueDate.split("-");return 0===XDates.compare(new Date(parseInt(t[2],10),parseInt(t[1],10),parseInt(t[0],10)),m)});if(f&&f.length>0){for(var y=0,b=0;b<f.length;b++){var v=parseFloat(f[b].Balance).toFixed(2);y+=Math.abs(v)}var g=f[0].DueDate.split("-"),C=g[0]+" "+XDates.monthNames[parseInt(g[1],10)-1]+" "+g[2];y=y?"-"+y:"0.0",n.set("dueDate",C),n.set("balanceDue",d.value+" "+y)}}o.get("paymentType")!==kl.value("locale.onlinetill:home.subTitleCashSales")&&o.set("paymentAmount",t.getConvertedAmountByCurrency(parseFloat(r).toFixed(2)))}},retrieveCustomerQuotesDetails:function(e){var t=this,a=t.resultSRQMessage;Komodo.Services.queryService.getJSON("/Quote/GetCustomerQuotes?customerId="+e+"&quoteCurrentStatus=4&quoteCategory=0").done(function(e){a.ResponseMessage.Payload.CustomerSRQ.clear(),e&&e.Quote&&e.Quote.length&&0!==e.Quote.length&&e.Quote.forEach(function(e){var t=Komodo.Models.CustomerSRQ.create();t.set("SRQID",e.Id.toString()),t.set("CreatedByUser",e.CreatedByUserId.toString()),t.set("FinancialAccountID",e.FinancialAccountId.toString()),t.set("FulfillmentDate",e.FulfillmentDate),t.set("SRQDate",e.QuoteDate),t.set("ReplacedBySRQID",e.ReplacedByQuoteId.toString()),t.set("SRQStatus",e.QuoteStatusId.toString()),t.set("CustomerID",e.CustomerId.toString());var s=Komodo.Models.Price.create();s.set("Value",e.TotalAmount),t.set("TotalAmount",s),t.set("SRQLineItems",[]),void 0!==e.LineItems&&e.LineItems.forEach(function(a){var s=Komodo.Models.SRQLineItem.create();s.set("SRQLineItemID",a.Id.toString()),s.set("AdjustmentAmount",a.AdjustmentAmount),s.set("Amount",a.Amount),s.set("BaseAmount",a.BaseAmount),s.set("StartDate",a.StartDate),s.set("EndDate",a.EndDate),s.set("SRQType",e.QuoteType.toString()),s.set("InvoiceText",a.InvoiceText.toString()),s.set("TaxAmount",a.TaxAmount),t.SRQLineItems.push(s)}),a.ResponseMessage.Payload.CustomerSRQ.push(t)}),t.hideBusyIndicator(!0),t.messageCustomerSRQRetrievedEventReceived(a)}).error(function(e){t.hideBusyIndicator(!0);var a=JSON.stringify(e);Komodo.log("retrieveCustomerQuotesDetails ajax call failed. Error: "+a)})},retrieveCustomerInvoices:function(e){var t=this,a=t.resultSRQMessage;Komodo.Services.queryService.getJSON("/Invoice/GetCustomerInvoices?customerId="+e+"&invoiceType=2").done(function(s){if(Komodo.Services.queryService.getJSON("/Invoice/GetCustomerInvoices?customerId="+e+"&invoiceType=5").done(function(e){if(e&&e.Invoices&&e.Invoices.length&&e.Invoices.length>0){var a=[];e.Invoices.forEach(function(e){a.push({invoiceNumber:e.Id.toString(),paymentDate:new moment(e.CreateDate).format(KomodoConfiguration.dateFormat),totalAmount:-1*parseFloat(e.Balance),isSelected:!1})}),t.get("data.customer.account").set("paymentInvocies",a)}}),a.ResponseMessage.Payload.CustomerSRQ.clear(),s&&s.Invoices&&s.Invoices.length&&s.Invoices.length>0){var o=[];s.Invoices.forEach(function(t){var s=Komodo.Models.CustomerSRQ.create();s.set("SRQID",t.Id.toString()),s.set("CreatedByUser",""),s.set("FinancialAccountID",t.FinancialAccountId.toString()),s.set("FulfillmentDate",t.DueDate.toString()),s.set("SRQDate",t.CreateDate.toString()),s.set("ReplacedBySRQID",""),s.set("SRQStatus",t.DisputeStatus.toString()),s.set("CustomerID",e);var n=Komodo.Models.Price.create();n.set("Value",t.Balance),s.set("TotalAmount",n),s.set("SRQLineItems",[]),void 0!==t.LineItems&&t.LineItems.forEach(function(e){var a=Komodo.Models.SRQLineItem.create();a.set("SRQLineItemID",e.UID.toString()),a.set("AdjustmentAmount",0),a.set("Amount",e.AmountIncludingTax),a.set("NumberOfUnits",e.NumberOfUnits),a.set("BaseAmount",e.AmountIncludingTax),a.set("StartDate",e.PeriodFrom.toString()),a.set("EndDate",e.PeriodTo.toString()),a.set("SRQType",t.ArDocumentType.toString()),a.set("InvoiceText",e.InvoiceLineText.toString()),a.set("TaxAmount",e.AmountIncludingTax-e.AmountExcludingTax),s.SRQLineItems.push(a)}),o.push({invoiceNumber:t.Id.toString(),dueDate:new moment(t.CreateDate).format(KomodoConfiguration.dateFormat),totalAmount:t.Balance,isSelected:!1}),a.ResponseMessage.Payload.CustomerSRQ.push(s)}),t.get("data.customer.account").set("invoices",o)}t.hideBusyIndicator(!0),t.messageCustomerSRQRetrievedEventReceived(a)}).error(function(e){t.hideBusyIndicator(!0);var a=JSON.stringify(e);Komodo.log("retrieveCustomerInvoices ajax call failed. Error: "+a)})},retrieveCustomerRDChequeStatus:function(e){var t=$.Deferred();Komodo.Services.queryService.getJSON("CustomerProfile?customerId="+e.customerNumber,!0).done(function(a){a&&(e.rdChequeStatus=a.RdCheque),t.resolve(e)}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrieveCustomerRDChequeStatus ajax call failed. Error: "+t)})},retrieveCustomerEmails:function(e){var t=this,a=e;t.get("processId")||t.startNewProcess(),Komodo.Services.queryService.getJSON("/CustomerProfile/?customerId="+e,{async:!1}).done(function(e){if(e&&e.CustomerDetail){void 0!==e.CustomerDetail.SubscriberSystemUID&&e.CustomerDetail.SubscriberSystemUID.SubscriberSystem.length>0&&(e.CustomerDetail.SubscriberSystemUID.SubscriberSystem[0].UID=a);var t=controller.get("data");t.customers.length>=1&&e.CustomerDetail.SubscriberSystemUID.SubscriberSystem[0].UID.toString()===t.customers[0].customerNumber&&e.CustomerDetail.ListOfEmail&&e.CustomerDetail.ListOfEmail.Email&&(t.customers[0].emailList=e.CustomerDetail.ListOfEmail.Email)}}).error(function(e){var t=JSON.stringify(e);Komodo.log("[ERROR] : retrieveCustomer ajax call failed. Error: "+t)})},updateRDCheque:function(e,t){var a=this,s=Komodo.Models.UpdateRDCheque.create();s.Country=a.country,s.CustomerUID=e.get("customerNumber");var o=Komodo.Models.RDCheque.create(),n=a.rdChequeStatuses.find(function(e){return"Yes"===e.value});o.Status=n.key,a.rdChequeStatusReasons.forEach(function(e){e.key===o.Status&&(o.StatusReason=e.key)}),s.RDCheque=o,a.showBlockingBusyIndicator(),a.rdCustomer=e,Komodo.Services.OLTService.publishElevatedPrivilegeEvent(a,s,"UpdateRDCheque","v1",!1,t)},messageRDChequeUpdatedReceived:function(){var e=this;e.hideBusyIndicator(),Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),kl.value(e._localeBase+"customer.rdFlagUpdated"),Komodo.Controls.MessageBoxOkButton,e,"rdChequeUpdated","success");var t=$.Deferred();Komodo.Services.queryService.getJSON("CustomerProfile?customerId="+e.rdCustomer.customerNumber,!0).done(function(a){a&&(e.rdCustomer.rdChequeStatus=a.RdCheque),t.resolve(e.rdCustomer)}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrieveCustomerRDChequeStatus ajax call failed. Error: "+t)})},messageFailureMessageEventReceived:function(e){var t=this,a="",s="";void 0!==e.ResponseMessage.Payload&&void 0!==e.ResponseMessage.Payload.ListOfErrorDetails&&$(e.ResponseMessage.Payload.ListOfErrorDetails).each(function(e,t){a+=t.ErrorDescription,s=t.ErrorCode}),t.hideBusyIndicator();var o=t.getPublishedOfflineMessageId(e);if(o){if(t.setOfflineGridPaymentSyncStatus(o,"Failed",a),t.updateUser(!1,void 0,o),t.offlinePaymentsCount=parseInt(t.offlinePaymentsCount)-1,t.offlinePaymentsCount<=0){var n=t.getOfflineUserShiftDetails(),r=t.getOfflinePayments(n.ShiftDetail.Payments);t.offlinePayments&&(r&&r.length&&r.length>0?(t.offlinePayments.set("disableSync",!1),t.offlinePayments.set("disableClose",!1)):t.offlinePayments.set("disableClose",!1))}}else if(""!==a&&"null"!==a&&null!==a&&void 0!==a||(a=kl.value(t._localeBase+"shift.technicalError")),a&&a.indexOf("exceeds your threshold, please call your supervisor")>0){var i=Komodo.Models.OnlineTill.PaymentOverrideModel.create();i.set("message",a),i.set("disableAction",!1);var l=Komodo.Application.ModalPaneController.create();l.popup(kl.value(t._localeBase+"home.overridePaymentTitle"),"paymentOverride",{context:{data:i,ok:function(){var a=this;a.data.set("disableAction",!0),t.genericController.validateUserClaim(t.country,a.data.supervisorUsername,a.data.passCode,t._supervisorClaim).done(function(s){if(void 0!==s){if(t.data.cashierName===a.data.supervisorUsername)a.data.set("disableAction",!1),alert(kl.value(t._localeBase+"shift.overridePaymentError"));else if(l.close(),"CreatePayment"===e.ResponseMessage.Payload.OriginatedEventName)t.createPaymentEvent(a.data.supervisorUsername,s);else if("CancelPayment"===e.ResponseMessage.Payload.OriginatedEventName){var o=e.ResponseMessage.Payload.ListOfErrorDetails.ErrorCode.split(","),n=o[0].split(":")[1],r=o[1].split(":")[1];t.cancelPaymentEvent(n,r,a.data.supervisorUsername,s)}}else a.data.set("disableAction",!1),alert(kl.value(t._localeBase+"shift.messageAccessValidate"))})},cancel:function(){l.close()}}})}else Komodo.Controls.MessageBoxController.show(kl.value(t._localeBase+"home.title"),a,Komodo.Controls.MessageBoxOkButtons,t,"modelPayment","danger")},messageReceived:function(e){this.hideBusyIndicator(),Komodo.UI.log("[PaymentController.messageReceived] : event name = "+e.ResponseMessage.EventName)},messageDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[PaymentController.messageDeliveryFailure] : messageId = "+e.messageId)},messageFault:function(e){this.hideBusyIndicator(),Komodo.UI.error("[PaymentController.messageFault] : messageId = "+e.messageId)},publishOutbondNotificationEvent:function(e,t,a,s){var o=this,n=Komodo.Models.SendOutboundNotification.create(),r=Komodo.canonicalFacadeFactory(n,["Country","ListOfOutboundNotification"]);r.set("Country",o.get("country"));var i=Komodo.Models.ListOfOutboundNotification.create(),l=Komodo.canonicalFacadeFactory(i,["OutboundNotification"]),c=Komodo.Models.OutboundNotification.create(),u=Komodo.canonicalFacadeFactory(c,["BusinessEntity","BusinessUnit","Country","TemplateName","ListOfRecipient","ListOfAttachment","MessageData"]),h=Komodo.Models.ListOfRecipients.create(),d=Komodo.canonicalFacadeFactory(h,["Recipient"]),p=Komodo.Models.Recipient.create(),m=Komodo.canonicalFacadeFactory(p,["CommunicationType","Language","MessageUID","From","To","ScheduledDate","ExpiryDate","ListOfContext"]);!0===s.EnableFiscalization?(u.set("BusinessEntity",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("BusinessUnit",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("Country",o.get("loggedInCountryName")),u.set("TemplateName",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME",e.Payload.ListOfPayment[0].IsTaxInvoice)),u.set("MessageData",e),m.set("Language",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE",e.Payload.ListOfPayment[0].IsTaxInvoice)),m.set("CommunicationType",GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE",e.Payload.ListOfPayment[0].IsTaxInvoice))):(u.set("BusinessEntity",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION")),u.set("BusinessUnit",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT")),u.set("Country",o.get("loggedInCountryName")),u.set("TemplateName",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME")),u.set("MessageData",e),m.set("Language",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE")),m.set("CommunicationType",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE")));var f=Komodo.Models.ListOfContext.create(),y=Komodo.canonicalFacadeFactory(f,["Context"]),b=Komodo.Models.Context.create(),v=Komodo.canonicalFacadeFactory(b,["Value","ContextValueUri"]);return v.set("Value","Outcome"),v.set("ContextValueUri",a),y.set("Context",b),m.set("ListOfContext",f),m.set("To",t),d.set("Recipient",p),u.set("ListOfRecipient",h),l.set("OutboundNotification",c),r.set("ListOfOutboundNotification",i),Komodo.Services.OLTService.publishOLTEvent(o,n,"SendReceiptNotificationEvent","v1",!0).done(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has been published."),Komodo.Controls.MessageBoxController.show(kl.value(controller._localeBase+"home.emailReceiptTitle"),kl.value(controller._localeBase+"report.emailSentSuccessMsg"),Komodo.Controls.MessageBoxOkButton,o,"id5446673","success").response=function(e){controller.showReceiptPopup(s)}}).fail(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has failed."),Komodo.Controls.MessageBoxController.show(kl.value(controller._localeBase+"home.emailReceiptTitle"),kl.value(controller._localeBase+"report.emailSentFailureMsg"),Komodo.Controls.MessageBoxOkButton,o,"id5446673","danger").response=function(e){controller.showReceiptPopup(s)}}),!0},getChargeUntilDateFromAgreementDetail:function(e){var t=this;Komodo.Services.queryService.getJSON("/AccountProfile/GetAgreementDetailViews?agreementDetailId="+e,{async:!1}).done(function(e){$.each(e.AgreementDetailViewCollection,function(e,a){t.set("chargeUntilDate",a.ChargeUntilDate)})}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetAgreementDetailViews ajax call failed. Error: "+t)})},mapChargeUntilDateToReceipt:function(e,t,a){var s=this;a||Ember.isEmpty(e)||Ember.isEmpty(e.customer)||Ember.isEmpty(e.customer.account)||"COMMERCIAL GENERAL"===e.customer.account.type.toUpperCase()||"DSTVCOMM"===e.customer.account.type.toUpperCase()||!(e.customer.account.products.length>0)?Ember.isEmpty(t)||s.getChargeUntilDateFromAgreementDetail(t):$.each(e.customer.account.products,function(e,t){!Ember.isEmpty(t.productType)&&"PRINCIPAL"===t.productType.toUpperCase()&&!Ember.isEmpty(t.productStatus)&&t.productStatus.toUpperCase().indexOf("PENDING REMOVAL")<0&&s.getChargeUntilDateFromAgreementDetail(t.productId)})},populateReceiptModel:function(e){var t=this,a=t.get("data"),s=[];if(void 0!==e&&null!==e){var o=e;o&&o.SplitPayments&&o.SplitPayments.length>1&&(o=t.populateSingleReceipts(o)),$(o).each(function(o,n){var r=Komodo.Models.OnlineTill.ReceiptModel.create();t.set("chargeUntilDate","");var i,l=Ember.isEmpty(n.Notes)?Ember.Object.create({ProductId:""}):$.parseJSON(n.Notes);if(Ember.isEmpty(a.customers)?Ember.isEmpty(a.customer)||(i=a.customer.customerClass):$.each(a.customers,function(e,t){i=Ember.isEmpty(t.customerClass.string)?t.customerClass:t.customerClass.string}),"true"===e.IsCashSale&&!0===e.IsCashSale||Ember.isEmpty(i)||"COMMERCIAL"===i.toUpperCase()||t.mapChargeUntilDateToReceipt(a,l.ProductId,n.IsReprint),r.BusinessUnit=Ember.isEmpty(l.BusinessUnit)?"":l.BusinessUnit,r.ChargeUntilDate=Ember.isEmpty(t.get("chargeUntilDate"))?"":new moment(t.get("chargeUntilDate")).format("DD/MM/YYYY"),r.Language=Komodo.Services.localizationService.getCurrentLanguage().toUpperCase(),r.IsReprint="true"===e.IsReprint||!0===e.IsReprint?"1":"0",r.IsCancelled="true"===e.IsCancelled||!0===e.IsCancelled?"1":"0",r.IsRefund="true"===e.IsRefund||!0===e.IsRefund?"1":"0",r.IsOffline=0,r.ReceiptDate=new moment(e.ReceiptDate).format("DD/MM/YYYY h:mm"),r.CashierName=e.CashierName,r.ReceiptNumber=n.ReceiptNumber,r.CustomerID=void 0===n.CustomerID?n.CustomerId:n.CustomerID,r.QuotationID=void 0===n.QuotationID?n.QuotationId:n.QuotationID,r.MethodOfPayment=e.MethodOfPayment,r.AccountHolderName=e.AccountHolderName,r.ChequeNumber=e.ChequeNumber,r.BankName=e.BankName,t.data.enableInvoice&&(r.InvoiceDetail=n.InvoiceDetail?n.InvoiceDetail:null,r.IsTaxReceipt=!1,null!=r.InvoiceDetail)){r.InvoiceDetail.CreateDate=new moment(r.InvoiceDetail.CreateDate).format("DD/MM/YYYY"),r.InvoiceDetail.DueDate=r.InvoiceDetail.DueDate?new moment(r.InvoiceDetail.DueDate).format("DD/MM/YYYY"):r.InvoiceDetail.CreateDate,r.InvoiceDetail.BalanceBroughtForward=0;var c=0,u=0;$(r.InvoiceDetail.LineItems).each(function(e,t){t.PeriodTo&&t.PeriodFrom&&(t.PeriodTo=new moment(t.PeriodTo).format("DD/MM/YYYY"),t.PeriodFrom=new moment(t.PeriodFrom).format("DD/MM/YYYY")),c+=t.AmountIncludingTax,u+=t.AmountExcludingTax}),r.InvoiceDetail.BalanceBroughtForward=parseFloat(c-u).toFixed(2),parseFloat(n.BaseCurrencyAmount.Value)===parseFloat(c)&&(r.IsTaxReceipt=!0),r.FiscalDocument=Ember.Object.create(),r.FiscalDocument.set("GeneratedInvoiceNumber",r.InvoiceDetail.GeneratedInvoiceNumber)}t.data.enableFiscalization&&(r.FiscalDocument=n.FiscalDocument?n.FiscalDocument:null),r.IsCashSale="true"===e.IsCashSale||!0===e.IsCashSale,r.IsSplit="true"===e.IsSplit||!0===e.IsSplit,r.IsCashSale&&r.QuotationID&&(r.ReceiptNumber=r.ReceiptNumber+" - "+r.QuotationID,a.quote&&a.quote.UID===r.QuotationID&&Ember.isEmpty(r.BusinessUnit)&&a.quote.BusinessUnit&&(r.BusinessUnit=a.quote.BusinessUnit.toUpperCase())),"Cash"===e.MethodOfPayment?r.Amount=Math.abs(parseFloat(n.AmountTendered.Value).toFixed(2)):r.Amount=Math.abs(parseFloat(n.Amount.Value).toFixed(2)),r.AmountTendered=n.AmountTendered,r.AmountTenderedValue=parseFloat(n.AmountTendered.Value).toFixed(2),r.BaseCurrencyAmount=n.BaseCurrencyAmount,r.BaseTenderedAmount=r.BaseCurrencyAmount.Value,r.ChangeOwed=n.ChangeOwed,null!==r.ChangeOwed&&null!==r.ChangeOwed.Value&&""!==r.ChangeOwed.Value&&(r.BaseTenderedAmount=(parseFloat(r.BaseTenderedAmount)+parseFloat(r.ChangeOwed.Value)).toFixed(2)),r.TotalAmountExclTax=void 0!==n.Amount.ValueWithoutTax&&""!==n.Amount.ValueWithoutTax&&"0"!==n.Amount.ValueWithoutTax?Math.abs(parseFloat(n.Amount.ValueWithoutTax).toFixed(2)):parseFloat(n.Amount.Value).toFixed(2),r.TotalAmountInclTax=Math.abs(parseFloat(n.Amount.Value).toFixed(2));var h=0,d=0;$($.makeArray(n.Amount.ListOfTax)).each(function(e,t){h+=parseFloat(t.Amount),d=t.Percent}),r.Tax=parseFloat(h).toFixed(2),r.TaxPercentage=d;var p=a.allowedCurrencies.find(function(e){return e.systemId.toString()===n.Amount.CurrencyCode.toString()});r.Currency=void 0!==p&&null!==p?p.value:"",r.ExchangeRate=void 0!==p&&null!==p?p.rate:"";var m=void 0;if($(a.gridData).each(function(e,t){if(t.customerNumber.toString()===r.CustomerID.toString())return void(m=t)}),void 0===m&&$(a.customers).each(function(e,t){if(t&&t.customerNumber.toString()===r.CustomerID.toString())return void(m=t)}),r.AccountID=n.AccountID,r.CustomerName=n.CustomerName,r.Address=n.Address,r.CellNumber=n.CellphoneNumber,r.Change=void 0!==n.ChangeOwed&&null!==n.ChangeOwed&&""!==n.ChangeOwed.Value?parseFloat(n.ChangeOwed.Value).toFixed(2):"0.00",void 0!==m){if(Ember.isEmpty(r.BusinessUnit)&&(r.BusinessUnit=r.IsCashSale&&r.QuotationID&&r.BusinessUnit?r.BusinessUnit:m.businessUnit),void 0!==r.AccountID&&""!==r.AccountID||void 0===m.account||(r.AccountID=m.account.accountNumber),void 0!==r.Address&&""!==r.Address||(r.Address=m.address),void 0!==r.CellNumber&&""!==r.CellNumber||(r.CellNumber=void 0!==m.telNo&&null!==m.telNo?m.telNo.split(",").join("</br>"):""),void 0!==m.quote&&void 0===m){h=0;var f=0,y=[],b="";$(m.quote.quoteLineItems).each(function(e,t){h+=parseFloat(t.taxAmount),f+=parseFloat(t.baseAmount),y.push(t.invoiceText),void 0!==t.startDate&&void 0!==t.endDate&&(b=t.startDate.substring(0,10)+" - "+t.endDate.substring(0,10))}),r.Package=y.join("</br>"),r.TotalAmountExclTax=Math.abs(parseFloat(f).toFixed(2)),r.Tax=parseFloat(h).toFixed(2),r.TotalAmountInclTax=void 0!==m.quote.totalAmount&&""!==m.quote.totalAmount?Math.abs(parseFloat(m.quote.totalAmount).toFixed(2)):"0.00",r.ViewingPeriod=b}var v=t.genericController.getCustomerInformation(m);void 0!==v&&(r.Hardware=v.Hardware,r.Insurance=v.Insurance,r.SmartcardNumber=v.SmartCardNumber),r.NextPaymentDate=void 0===m.dueDate||""===m.dueDate?"":new moment(m.dueDate).format("DD/MM/YYYY")}Ember.isEmpty(r.SmartCardNumber)&&(Ember.isEmpty(e.SmartcardNumber)?r.SmartcardNumber=r.IsSplit?n.SmartcardNumber:t.get("smartcardNumber"):r.SmartcardNumber=r.IsSplit?n.SmartcardNumber:e.SmartcardNumber),(t.data.enableFiscalization||t.data.enableInvoice)&&((r.IsCashSale||"1"===r.IsRefund)&&e.BusinessUnit&&Ember.isEmpty(r.BusinessUnit)&&(r.BusinessUnit=e.BusinessUnit.toUpperCase()),(r.IsSplit||r.IsCashSale||!n.Address)&&(r.Address=n.CustomerAddress),r.IsFiscalInvoice=!1),s.push(r)})}return s},retrieveSmartcardForReceipt:function(e){var t,a,s=this;return e&&e.customer&&e.customer.account&&e.customer.account.products.length>0?t=e.customer.account.products:e&&e.account&&e.account.products.length>0?t=e.account.products:e&&e.quotes&&e.quotes.length>0&&Komodo.Services.queryService.getJSON("/AccountProfile/Get?id="+e.customerNumber,{async:!1}).done(function(e){$.each(e.Account,function(e,t){$.each(t.ListOfAgreement.Agreement,function(e,o){$.each(o.ListOfHardware.Hardware,function(e,o){$.each(o.ListOfService.Service,function(e,n){n&&n.ProductDetail&&n.ProductDetail.Type&&"PRINCIPAL"===n.ProductDetail.Type.toUpperCase()&&(3===t.AccountTypeId&&o&&o.SmartcardDetail&&!Ember.isEmpty(o.SmartcardDetail.Name)?(s.set("smartcardNumber",o.LinkedSmartcard),a=o.LinkedSmartcard):(s.set("smartcardNumber",o.SerialNumber),a=o.SerialNumber))})})})})}).fail(function(e){var t=JSON.stringify(e);Komodo.log("Get Account Profile ajax call failed. Error: "+t)}),t&&$.each(t,function(e,t){new $.Deferred;"PRINCIPAL"===t.productType.toUpperCase()&&(Ember.isEmpty(t.smartcardNumber)?Ember.isEmpty(t)||Ember.isEmpty(t.hardware)||-1===t.hardware.toUpperCase().indexOf("DEVICE")||Komodo.Services.queryService.getJSON("/AccountProfile/GetAgreementDetailViews?agreementDetailId="+t.productId,{async:!1}).done(function(e){$.each(e.AgreementDetailViewCollection,function(e,t){s.set("smartcardNumber",t.ProvisionedDevices)})}).error(function(e){var t=JSON.stringify(e);Komodo.log("GetAgreementDetailViews ajax call failed. Error: "+t)}):(s.set("smartcardNumber",t.smartcardNumber),a=t.smartcardNumber))}),a},setNoteToProductId:function(e){var t,a=this,s=a.get("paymentNotes");Ember.isEmpty(e)||Ember.isEmpty(e.account)||(Ember.isEmpty(e.account.products)||($(e.account.products).each(function(e,a){"PRINCIPAL"===a.productType.toUpperCase()&&"PENDING REMOVAL"!==a.productStatus.toUpperCase()&&(t=a.productId)}),a.setNotes(s,"ProductId",t)),a.setNotes(s,"BusinessUnit",e.businessUnit))},setNotes:function(e,t,a){var s=this;e.set(t,a),s.set("paymentNotes",e)},populateSingleReceipts:function(e){var t=[],a=e.SplitPayments;if(void 0!==a&&null!==a){var s=[],o=void 0;$(a).each(function(e,t){-1===jQuery.inArray(t.CustomerId,s)&&s.push(t.CustomerId)}),$($.makeArray(s)).each(function(e,s){var n=$.grep(a,function(e){return e.CustomerId===s});if(n&&n.length>0){o=n[0];var r=0,i=0,l=0,c=0,u=[],h=[];$(n).each(function(e,t){h.push(t.ReceiptNumber),void 0!==t.Amount&&void 0!==t.Amount.Value&&(r=parseFloat(r)+parseFloat(t.Amount.Value)),void 0!==t.Amount.ListOfTax&&null!==t.Amount.ListOfTax&&$(t.Amount.ListOfTax).each(function(e,t){u.pushObject(t)}),void 0!==t.AmountTendered&&void 0!==t.AmountTendered.Value&&(l=parseFloat(l)+parseFloat(t.AmountTendered.Value)),void 0!==t.ChangeOwed&&void 0!==t.ChangeOwed.Value&&(c=parseFloat(c)+parseFloat(t.ChangeOwed.Value))});var d=0;$($.makeArray(u)).each(function(e,t){d+=parseFloat(t.Amount)}),i=parseFloat(r)-parseFloat(d),o.ReceiptNumber=h.join("/"),o.Amount.Value=parseFloat(r).toFixed(2),o.Amount.ValueWithoutTax=parseFloat(i).toFixed(2),o.Amount.ListOfTax=u,o.AmountTendered.Value=parseFloat(l).toFixed(2),o.ChangeOwed.Value=parseFloat(c).toFixed(2)}t.push(o)}),1===s.length&&1===t.length&&(t[0].AmountTendered.Value=parseFloat(e.AmountTendered.Value).toFixed(2),t[0].ChangeOwed.Value=parseFloat(e.ChangeOwed.Value).toFixed(2))}return t},populateOfflineReceiptModel:function(){var e=this,t=this.get("data"),a=[],s=Komodo.Models.OnlineTill.ReceiptModel.create();s.IsReprint=0,s.IsCancelled=0,s.IsRefund=0,s.IsOffline=1,s.ReceiptDate=(new moment).format("DD/MM/YYYY h:mm"),s.CashierName=e.userName(),s.ReceiptNumber="0",s.CustomerID=t.customerNumber,s.MethodOfPayment=t.methodOfPayment,s.Amount=parseFloat(t.amountTendered).toFixed(2),s.TotalAmountExclTax="0.00",s.TotalAmountInclTax="0.00",s.Tax=0;var o=t.allowedCurrencies.find(function(e){return e.key===t.currency.key});return s.Currency=void 0!==o&&null!==o?o.value:"",s.ExchangeRate=void 0!==o&&null!==o?o.rate:"",s.AccountID="",s.CustomerName="",s.Address="",s.CellNumber="",s.Change="0.00",s.Package="",s.ViewingPeriod="",s.Hardware="",s.Insurance="",s.SmartcardNumber="",s.NextPaymentDate="",a.push(s),a},setEmailReceiptDetailIfEmailReceiptAllowed:function(e){var t=this;if(e){var a=!0===t.data.enableFiscalization?GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION",!1):GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION"),s=!0===t.data.enableFiscalization?GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT",!1):GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT"),o=!0===t.data.enableFiscalization?GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME",!1):GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME"),n=!0===t.data.enableFiscalization?GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE",!1):GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE"),r=!0===t.data.enableFiscalization?GetOLTConstantsForFiscal("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE",!1):GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE");void 0===a||""===a.trim()||void 0===s||""===s.trim()||void 0===o||""===o.trim()||void 0===n||""===n.trim()||void 0===r||""===r.trim()?t.data.set("enableEmailReceipt",!1):t.data.set("enableEmailReceipt",!0)}},getPrinterTypeFromShiftDetails:function(e,t){var a="";return $.each(e,function(e,s){s.printerName.toUpperCase()===t.toUpperCase()&&(a=s.printerType)}),a},shiftdata:void 0,paymentCountByPaymentTypes:[],cancelPaymentCountByPaymentTypes:[],
quoteStatuses:[],shiftTypes:[],shiftStatuses:[],banks:[],bankBranches:[],rdChequeStatuses:[],rdChequeStatusReasons:[],hide:!1,disabled:!0,fileRecordCount:0,shiftBannerVisible:!1,customerBannerVisible:!1,isRefund:!1,autoPopulateFlag:!0,rdCustomer:void 0,cachePrinter:void 0,amountRegExPattern:"^[0-9]{1,15}(.([0-9])([0-9]){0,1}?)?$",printerKey:"Printer",speedpointKey:"Speedpoint",cancelReason:"Incorrect Capture",resultAccountMessage:{ResponseMessage:{Payload:{ListOfAccount:{Account:[]},CustomerUID:void 0}}},resultSRQMessage:{ResponseMessage:{Payload:{CustomerSRQ:[]}}},resultQuoteMessage:{ResponseMessage:{Payload:{ListOfQuotation:{Quotation:[]}}}},resultInvoiceMessage:{ResponseMessage:{Payload:{ListOfInvoices:{Invoice:[]}}}},actions:{newProcess:function(){this.startNewProcess()},addCustomer:function(){this.addCustomer()},cashPayment:function(e,t){this.cashPayment(e,t)},submitRealTimeOption:function(){this.submitRealTimeOption()},closeShift:function(){this.closeShift()},shiftDetails:function(){var e=this,t=e.get("shiftdata");void 0!==t&&null!==t&&(t.set("shiftDetails",[]),t.set("cancelledPayments",[]),e.retrieveShiftPaymentsEvent(t,1,"ShiftDetails",!0))},interimShiftReport:function(){var e=this,t=e.get("data"),a=e.get("shiftdata");t.isOffLine?this.interimShiftReport():void 0!==a&&null!==a&&(a.set("shiftDetails",[]),a.set("cancelledPayments",[]),e.retrieveShiftPaymentsEvent(a,1,"InterimShiftReport",!0),e.shiftPaymentAction("InterimShiftReport"))},makePayment:function(){this.set("isRefund",!1),this.makePayment()},refundPayment:function(){var e=this,t=e.get("data");if(t.paymentType===kl.value("locale.onlinetill:home.subTitleCashSales")&&void 0!==t.quoteStatus&&null!==t.quoteStatus&&"OPEN"!==t.quoteStatus){var a=kl.value(e._localeBase+"shift.messageInvoiceRefundStatusVaildate");return Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"home.title"),a,Komodo.Controls.MessageBoxOkButtons,e,"modelPayment","danger"),!1}var s=Komodo.Models.OnlineTill.SupervisorApprovalModel.create(),o=Komodo.Application.ModalPaneController.create();o.popup(kl.value(e._localeBase+"home.subTitleRefundPayment"),"supervisorApproval",{context:{data:s,ok:function(){var t=this;t.data.set("disableAction",!0),e.genericController.validateUserClaim(e.country,t.data.supervisorUsername,t.data.passCode,e._supervisorClaim).done(function(a){void 0!==a?e.data.cashierName===t.data.supervisorUsername?(t.data.set("disableAction",!1),alert(kl.value(e._localeBase+"customer.unauthoriseError"))):(o.close(),e.set("isRefund",!0),e.makePayment()):(t.data.set("disableAction",!1),alert(kl.value(e._localeBase+"customer.accessDenied")))})},cancel:function(){o.close()}}})},viewQuoteDetails:function(e){this.viewQuoteDetails(e)},viewProductDetails:function(e){this.viewProductDetails(e)},removeCustomer:function(e){this.removeCustomer(e)},retrieveQuote:function(){this.retrieveQuote()},retrieveQuoteHardware:function(){this.retrieveQuoteHardware()},showHideShiftDetails:function(){this.showHideShiftDetails()},showHideCustomerDetails:function(){this.showHideCustomerDetails()},readTextFile:function(e){e.error?($(".file-upload-item:last").remove(),Komodo.Controls.MessageBoxController.show(kl.value(controller._localeBase+"home.title"),kl.value(controller._localeBase+"payment.fileError")+" "+e.error.message,Komodo.Controls.MessageBoxOkButtons,this,"modelPayment","danger")):this.readCSVContent(e.content)},showBlockingBusyIndicator:function(){this.showBlockingBusyIndicator()},hideBusyIndicator:function(){this.hideBusyIndicator()},useCredit:function(){this.useCredit()}}}),Komodo.Services.localizationService.registerNamespace("locale.onlinetill");