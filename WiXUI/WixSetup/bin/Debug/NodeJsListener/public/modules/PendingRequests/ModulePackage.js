Komodo.Models.PendingRequestsModel=Ember.Object.extend({init:function(){this.filterSelection=void 0,this.requestDate=void 0,this.baseAmount=void 0,this.requestedBy=void 0,this.customerId=void 0,this.transactionType=void 0,this.requestStatus=void 0,this.ledgerAccount=void 0,this.ftComment=void 0,this.id=void 0,this.paymentReferenceNumber=void 0,this.requestComment=void 0,this.check=!1,this.filterJournalsBy(),this._super()},filterjournals:void 0,filterRequest:[],dependents:[],filterJournalsBy:function(){this.filterRequest.clear(),this.filterRequest.addObject("Created By"),this.filterRequest.addObject("Date"),this.filterRequest.addObject("Status"),this.filterRequest.addObject("Customer")}}),Komodo.Models.PendingRequestsViewModel=Ember.Object.extend({init:function(){this.pendingRequestGrid=[],this.selectedGridItem=void 0,this.commandGridItem=void 0,this.commandGridItemType=void 0,this.prComment=void 0,this.filterJournalsBy=[],this.filterjournalsChanged=[],this._super()}}),Komodo.Application.PendingRequestsRoute=Komodo.UI.Route.extend({useCaseName:"pendingRequests",useCaseDisplayName:"FT Approval Requests",init:function(){this.useCaseDisplayName="FT Approval Requests",this._super()}}),Komodo.Services.pendingRequestsService=Ember.Object.create({init:function(){},publishEvent:function(e,t,n,i){var o=$.Deferred(),s={eventName:n,eventVersion:i,eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,s).done(function(){o.resolve()}).fail(function(e){o.fail(e)}),o},ftPendingRequest:void 0,setFTpendingRequests:function(e){this.set("ftPendingRequest",e)},getPendingRequests:function(){return this.get("ftPendingRequest")}}),Ember.TEMPLATES.PendingRequestsView=Ember.Handlebars.template(function(e,t,n,i,o){function s(e,t){t.buffer.push("\r\n    Submit\r\n    ")}function d(e,t){t.buffer.push("Cancel")}function r(e,t){t.buffer.push("\r\n    Go To Approve Page\r\n    ")}function a(e,t){t.buffer.push("\r\n    Go To Reject Page\r\n    ")}function l(e,t){t.buffer.push("Approve/Decline")}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,Ember.Handlebars.helpers),o=o||{};var u,p=this.escapeExpression,c=this;return o.buffer.push('<div class="no-banner-padding" style="display:block" >\r\n    <p class="komodo-heading" id="Heading" >FT Approval Requests</p>\r\n    <hr/>\r\n  <table>\r\n    <tr>\r\n      <td style="width:600px">\r\n        '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.Select",{hash:{tabindex:"2",valueBinding:"filterjournals",label:"Filter Journals By:",id:"cmbFilterJournals",contentBinding:"data.filterRequest",optionLabelPath:"content",optionValuePath:"content",prompt:"filter journal by..."},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",id:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",prompt:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t,id:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,prompt:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n      </td>\r\n      <td style="width:600px">\r\n        '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.Select",{hash:{tabindex:"2",valueBinding:"filterSelection",label:"Filter Selection:",contentBinding:"dependents",optionLabelPath:"content",optionValuePath:"content",selectionBinding:"filterSelection",prompt:"filter Selection..."},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",contentBinding:"STRING",optionLabelPath:"STRING",optionValuePath:"STRING",selectionBinding:"STRING",prompt:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t,contentBinding:t,optionLabelPath:t,optionValuePath:t,selectionBinding:t,prompt:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n     </td>\r\n    </tr>\r\n  </table>\r\n  <b /> \r\n  <div id="approveDiv" style="display:none">\r\n    '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.DataGrid",{hash:{title:"Approve Pending Requests",canSort:!0,pageSize:10,performsValidation:!1,canDelete:!1,canEdit:!1,canSelect:!0,selectedItemBinding:"approvePendingRequestViewModelObj.selectedGridItem",commandItemBinding:"approvePendingRequestViewModelObj.commandGridItem",commandItemTypeBinding:"approvePendingRequestViewModelObj.commandGridItemType",contentBinding:"approvePendingRequestViewModelObj.pendingRequestGrid",columnsBinding:"approvePendingTransactionsGridColumns"},hashTypes:{title:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING"},hashContexts:{title:t,canSort:t,pageSize:t,performsValidation:t,canDelete:t,canEdit:t,canSelect:t,selectedItemBinding:t,commandItemBinding:t,commandItemTypeBinding:t,contentBinding:t,columnsBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n    <br/>\r\n    "),u=n.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"100",action:"approvePendingRequest"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:c.noop,fn:c.program(1,s,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push("\r\n    "),u=n.view.call(t,"Komodo.Controls.Button",{hash:{action:"cancelApproveButton"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:c.noop,fn:c.program(3,d,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push('\r\n    </div>\r\n  <div id="declineDiv" style="display:none">\r\n    '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.DataGrid",{hash:{title:"Reject Pending Requests",canSort:!0,pageSize:10,performsValidation:!1,canDelete:!1,canEdit:!0,canSelect:!0,selectedItemBinding:"declinePendingRequestViewModelObj.selectedGridItem",commandItemBinding:"declinePendingRequestViewModelObj.commandGridItem",commandItemTypeBinding:"declinePendingRequestViewModelObj.commandGridItemType",contentBinding:"declinePendingRequestViewModelObj.pendingRequestGrid",columnsBinding:"declinePendingTransactionsGridColumns"},hashTypes:{title:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING"},hashContexts:{title:t,canSort:t,pageSize:t,performsValidation:t,canDelete:t,canEdit:t,canSelect:t,selectedItemBinding:t,commandItemBinding:t,commandItemTypeBinding:t,contentBinding:t,columnsBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n    <br/>\r\n    "),u=n.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"100",action:"declinePendingRequest"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:c.noop,fn:c.program(1,s,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push("\r\n    "),u=n.view.call(t,"Komodo.Controls.Button",{hash:{action:"cancelDeclineButton"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:c.noop,fn:c.program(3,d,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push('\r\n  </div> \r\n  <div id="commentArea" style="display:none">\r\n    '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.LabelField",{hash:{label:"Comment:",id:"lblComment"},hashTypes:{label:"STRING",id:"STRING"},hashContexts:{label:t,id:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n    "),o.buffer.push(p(n.view.call(t,"Komodo.Controls.CoreTextArea",{hash:{valueBinding:"pendingRequestViewModelObj.prComment",rows:"5",id:"txtComment",label:"~locale.pendingrequests:pendingRequestsTab.prComment~"},hashTypes:{valueBinding:"STRING",rows:"STRING",id:"STRING",label:"STRING"},hashContexts:{valueBinding:t,rows:t,id:t,label:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push('\r\n  </div>\r\n  <br/>\r\n  <div id="commentButtons" style="display:none">\r\n    '),u=n.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"100",action:"approveButton"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:c.noop,fn:c.program(5,r,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push("\r\n    "),u=n.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"100",action:"declineButton"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:c.noop,fn:c.program(7,a,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push('\r\n  </div>\r\n  <div id="ftHistory" style="display:block">\r\n    '),o.buffer.push(p(n.view.call(t,"Komodo.Controls.DataGrid",{hash:{title:"Approval Journals History",canSort:!0,pageSize:10,performsValidation:!1,canDelete:!1,canEdit:!1,canSelect:!0,selectedItemBinding:"approvalRequestViewModelObj.selectedGridItem",commandItemBinding:"approvalRequestViewModelObj.commandGridItem",commandItemTypeBinding:"approvalRequestViewModelObj.commandGridItemType",contentBinding:"approvalRequestViewModelObj.pendingRequestGrid",columnsBinding:"approvalTransactionsGridColumns"},hashTypes:{title:"STRING",canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",canSelect:"BOOLEAN",selectedItemBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING"},hashContexts:{title:t,canSort:t,pageSize:t,performsValidation:t,canDelete:t,canEdit:t,canSelect:t,selectedItemBinding:t,commandItemBinding:t,commandItemTypeBinding:t,contentBinding:t,columnsBinding:t},contexts:[t],types:["ID"],data:o}))),o.buffer.push("\r\n    <br/>\r\n    \x3c!--"),u=n.view.call(t,"Komodo.Controls.Button",{hash:{action:"commentOpen"},hashTypes:{action:"STRING"},hashContexts:{action:t},inverse:c.noop,fn:c.program(9,l,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),o.buffer.push("--\x3e\r\n  </div>\r\n\r\n</div>\r\n\r\n"),""}),Komodo.Application.PendingRequestsView=Komodo.UI.View.extend({viewKey:"PendingRequestsView",templateName:"PendingRequestsView"}),Komodo.Application.PendingRequestsController=Komodo.UI.Controller.extend({localePendingRequestsTab:"locale.pendingrequests:pendingRequestsTab.",localelinkText:"locale.pendingrequests:linkText.",status:void 0,init:function(){this._super()},mapPendingRequests:function(e){currentObject=this,this.get("approvalRequestViewModelObj").pendingRequestGrid.clear(),this.get("pendingRequestViewModelObj").pendingRequestGrid.clear(),this.get("approvePendingRequestViewModelObj").pendingRequestGrid.clear(),this.get("declinePendingRequestViewModelObj").pendingRequestGrid.clear();var t=Komodo.Services.securityService.get("currentUser").substring(3);"Hwidi.Mogodi"!==t&&(document.getElementById("commentButtons").style.display="block");for(var n=0;n<e.length;n++)if("samuel.serongwa"===t||"vanessa.gwama"===t||"Hwidi.Mogodi"===t){var i=Komodo.Models.PendingRequestsModel.create();i.set("requestDate",currentObject.getFormattedDate(e[n].RequestDate));var o=parseFloat(e[n].BaseAmount,10).toFixed(2);i.set("requestedBy",e[n].RequestedBy),i.set("baseAmount",o),i.set("id",e[n].Id),i.set("customerId",e[n].CustomerId),i.set("transactionType",e[n].TransactionType),i.set("requestStatus",e[n].RequestStatus),i.set("requestComment",e[n].RequestComment),i.set("ftComment",e[n].FtComment),i.set("ledgerAccount",e[n].LedgerAccount),i.set("paymentReferenceNumber",e[n].PaymentReferenceNumber),this.get("approvalRequestViewModelObj").pendingRequestGrid.addObject(i),"Pending"===e[n].RequestStatus&&"Pending"===i.requestStatus&&(this.get("pendingRequestViewModelObj").pendingRequestGrid.addObject(i),this.get("approvePendingRequestViewModelObj").pendingRequestGrid.addObject(i),this.get("declinePendingRequestViewModelObj").pendingRequestGrid.addObject(i))}else if("dumsile.mnguni"==t||"letticia.selokela"==t){var o=parseFloat(e[n].BaseAmount,10).toFixed(2),s=Math.abs(o);if(s<5001){var i=Komodo.Models.PendingRequestsModel.create();i.set("requestDate",currentObject.getFormattedDate(e[n].RequestDate)),i.set("requestedBy",e[n].RequestedBy),i.set("baseAmount",o),i.set("id",e[n].Id),i.set("customerId",e[n].CustomerId),i.set("transactionType",e[n].TransactionType),i.set("requestStatus",e[n].RequestStatus),i.set("requestComment",e[n].RequestComment),i.set("ftComment",e[n].FtComment),i.set("ledgerAccount",e[n].LedgerAccount),i.set("paymentReferenceNumber",e[n].PaymentReferenceNumber),this.get("approvalRequestViewModelObj").pendingRequestGrid.addObject(i),"Pending"===e[n].RequestStatus&&"Pending"===i.requestStatus&&(this.get("pendingRequestViewModelObj").pendingRequestGrid.addObject(i),this.get("approvePendingRequestViewModelObj").pendingRequestGrid.addObject(i),this.get("declinePendingRequestViewModelObj").pendingRequestGrid.addObject(i))}}},filterjournals:void 0,dependents:[],filterjournalsChanged:function(){this.dependents.clear();var e=this;"Date"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.approvalRequestViewModelObj.pendingRequestGrid.forEach(function(t){e.dependents.addObject(t.requestDate)})):"Status"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.approvalRequestViewModelObj.pendingRequestGrid.forEach(function(t){e.dependents.addObject(t.requestStatus)})):"Created By"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.approvalRequestViewModelObj.pendingRequestGrid.forEach(function(t){e.dependents.addObject(t.requestedBy)})):"Customer"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.approvalRequestViewModelObj.pendingRequestGrid.forEach(function(t){e.dependents.addObject(t.customerId)})):(this.dependents.clear(),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder))}.observes("filterjournals"),gridDataHolder:[],filterSelection:void 0,displayFilterOption:function(){var e=this;"Date"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.requestDate===e.filterSelection})),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvalRequestViewModelObj.pendingRequestGrid,function(t){return t.requestDate===e.filterSelection})),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.declinePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.requestDate===e.filterSelection}))):"Status"===this.filterjournals?(this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvalRequestViewModelObj.pendingRequestGrid,function(t){return t.requestStatus===e.filterSelection}))):"Created By"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.requestedBy===e.filterSelection})),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvalRequestViewModelObj.pendingRequestGrid,function(t){return t.requestedBy===e.filterSelection})),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.declinePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.requestedBy===e.filterSelection}))):"Customer"===this.filterjournals?(this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.customerId===e.filterSelection})),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",$.grep(this.approvalRequestViewModelObj.pendingRequestGrid,function(t){return t.customerId===e.filterSelection})),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",$.grep(this.declinePendingRequestViewModelObj.pendingRequestGrid,function(t){return t.customerId===e.filterSelection}))):(this.dependents.clear(),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder))}.observes("filterSelection"),start:function(){Komodo.log("Constructing Pending Requests Controller"),this.registerModel("approvalRequestViewModelObj",Komodo.Models.PendingRequestsViewModel),this.registerModel("pendingRequestViewModelObj",Komodo.Models.PendingRequestsViewModel),this.registerModel("approvePendingRequestViewModelObj",Komodo.Models.PendingRequestsViewModel),this.registerModel("declinePendingRequestViewModelObj",Komodo.Models.PendingRequestsViewModel),this.registerModel("data",Komodo.Models.PendingRequestsModel),this.set("processVersion","v1.1"),this.set("processName","Pending Requests"),this._super(),this.gridHolder=this.approvalRequestViewModelObj.pendingRequestGrid,this.gridDataHolder=this.pendingRequestViewModelObj.pendingRequestGrid,this.rejectedGridHolder=this.declinePendingRequestViewModelObj.pendingRequestGrid,this.publishRetrieveFTApprovalRequestEvent(),this.approvalTransactionsGridColumns=[Komodo.Controls.DataGridColumn.create({name:"requestDate",title:"Request Date",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestedBy",title:"Requested By",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"baseAmount",title:"Base Amount",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"customerId",title:"Customer ID",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"transactionType",title:"Transaction Type",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestStatus",title:"Request Status",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestComment",title:"Request Comment",canEdit:!0,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ftComment",title:"FT Comment",canEdit:!0,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ledgerAccount",title:"Ledger Account",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"paymentReferenceNumber",title:"Reverse FT ID",canEdit:!1,width:"100px"})],this.pendingTransactionsGridColumns=[Komodo.Controls.DataGridColumn.create({name:"requestDate",title:"Request Date",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestedBy",title:"Requested By",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"baseAmount",title:"Base Amount",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"customerId",title:"Customer ID",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"transactionType",title:"Transaction Type",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestStatus",title:"Request Status",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestComment",title:"Request Comment",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ledgerAccount",title:"Ledger Account",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"paymentReferenceNumber",title:"Reverse FT ID",canEdit:!1,width:"100px"})],this.approvePendingTransactionsGridColumns=[Komodo.Controls.DataGridColumn.create({name:"check",title:"",canEdit:!0,isAlwaysEditing:!0,width:"20px",type:"bool"}),Komodo.Controls.DataGridColumn.create({name:"requestDate",title:"Request Date",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestedBy",title:"Requested By",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"baseAmount",title:"Base Amount",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"customerId",title:"Customer ID",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"transactionType",title:"Transaction Type",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestStatus",title:"Request Status",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestComment",title:"Request Comment",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ledgerAccount",title:"Ledger Account",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"paymentReferenceNumber",title:"Reverse FT ID",canEdit:!1,width:"100px"})],this.declinePendingTransactionsGridColumns=[Komodo.Controls.DataGridColumn.create({name:"check",title:"",canEdit:!0,isAlwaysEditing:!0,width:"20px",type:"bool"}),Komodo.Controls.DataGridColumn.create({name:"requestDate",title:"Request Date",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestedBy",title:"Requested By",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"baseAmount",title:"Base Amount",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"customerId",title:"Customer ID",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"transactionType",title:"Transaction Type",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestStatus",title:"Request Status",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"requestComment",title:"Request Comment",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ftComment",title:"FT Comment",canEdit:!0,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"ledgerAccount",title:"Ledger Account",canEdit:!1,width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"paymentReferenceNumber",title:"Reverse FT ID",canEdit:!1,width:"100px"})],this.showBlockingBusyIndicator()},actions:{declineButton:function(){document.getElementById("commentButtons").style.display="none",document.getElementById("ftHistory").style.display="none",document.getElementById("declineDiv").style.display="block"},approveButton:function(){document.getElementById("commentButtons").style.display="none",document.getElementById("ftHistory").style.display="none",document.getElementById("approveDiv").style.display="block"},cancelApproveButton:function(){document.getElementById("approveDiv").style.display="none",document.getElementById("ftHistory").style.display="block",document.getElementById("commentButtons").style.display="block";for(var e=this.get("approvePendingRequestViewModelObj").pendingRequestGrid,t=0;t<e.length;t++)e[t].set("check",!1)},cancelDeclineButton:function(){document.getElementById("declineDiv").style.display="none",document.getElementById("ftHistory").style.display="block",document.getElementById("commentButtons").style.display="block";for(var e=this.get("declinePendingRequestViewModelObj").pendingRequestGrid,t=0;t<e.length;t++)e[t].set("check",!1)},declinePendingRequest:function(){var e=$.grep(this.declinePendingRequestViewModelObj.pendingRequestGrid,function(e){return!0===e.check});if(e.length>0){for(var t=!0,n=0;n<e.length;n++)e[n].ftComment||(t=!1);if(t){var i=this;Komodo.Controls.MessageBoxController.show("Decline Pending Request","Are you sure you want to proceed?",Komodo.Controls.MessageBoxYesNoButtons,this,void 0,"alert").response=function(t){"yes"==t&&(i.publishSetPendingRequestListEvent(i,"Rejected",void 0,e),i.getFTApprovalRequests(i),document.getElementById("declineDiv").style.display="none",document.getElementById("ftHistory").style.display="block",document.getElementById("commentButtons").style.display="block")}}else Komodo.Controls.MessageBoxController.show("FT Approval Requests","Please Enter Comment For All Selected FT Approval Requests",Komodo.Controls.MessageBoxOkButtons,i,1,"alert")}else Komodo.Controls.MessageBoxController.show("Decline Pending Request","Please check FT Requests that you want to Decline on the check boxes",Komodo.Controls.MessageBoxOkButtons,this,void 0,"alert");i.filterSelection(),i.filterjournalsChanged(),this.dependents.clear(),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder)},approvePendingRequest:function(){var e=$.grep(this.approvePendingRequestViewModelObj.pendingRequestGrid,function(e){return!0===e.check});if(e.length>0){var t=this;Komodo.Controls.MessageBoxController.show("Approve Pending Request","Are you sure you want to proceed?",Komodo.Controls.MessageBoxYesNoButtons,this,void 0,"alert").response=function(n){"yes"==n&&(t.publishSetPendingRequestListEvent(t,"Approved","Valid Transaction",e),t.getFTApprovalRequests(t),document.getElementById("approveDiv").style.display="none",document.getElementById("ftHistory").style.display="block",document.getElementById("commentButtons").style.display="block")}}else Komodo.Controls.MessageBoxController.show("Approve Pending Request","Please check FT Requests that you want to Approve on the check boxes",Komodo.Controls.MessageBoxOkButtons,this,void 0,"alert");t.filterjournalsChanged(),t.filterSelection(),this.dependents.clear(),this.approvePendingRequestViewModelObj.set("pendingRequestGrid",this.gridHolder),this.approvalRequestViewModelObj.set("pendingRequestGrid",this.gridDataHolder),this.declinePendingRequestViewModelObj.set("pendingRequestGrid",this.rejectedGridHolder)},commentOpen:function(){"Hwidi.Mogodi"!=Komodo.Services.securityService.get("currentUser").substring(3)?(document.getElementById("pendingDetailsDiv").style.display="block",document.getElementById("commentButtons").style.display="block",document.getElementById("ftHistory").style.display="none"):Komodo.Controls.MessageBoxController.show("FT Approval Requests","You Do Not Have Rights To Perfom This Action",Komodo.Controls.MessageBoxOkButtons,self,1,"alert")}},getFTApprovalRequests:function(e){setTimeout(function(){e.publishRefreshFTApprovalRequestEvent(),e.showBlockingBusyIndicator()},3e3)},publishRetrieveFTApprovalRequestEvent:function(){var e=this,t=Komodo.Models.RetrieveFTApprovalRequests.create(),n=Komodo.Models.FTApprovalRequest.create(),i=Komodo.canonicalFacadeFactory(t,["Country","FTApprovalRequest"]);i.set("Country","deves02"),i.set("FTApprovalRequest",n),Komodo.Services.pendingRequestsService.publishEvent(e,t,"RetrieveFTApprovalRequests","v1").done(function(){Komodo.log("RetrieveFTApprovalRequests() : published.")}).fail(function(e){Komodo.log("RetrieveFTApprovalRequests() : failed."),alert(e)})},publishRefreshFTApprovalRequestEvent:function(){var e=this,t=Komodo.Models.RetrieveFTApprovalRequests.create(),n=Komodo.Models.FTApprovalRequest.create(),i=Komodo.canonicalFacadeFactory(t,["Country","FTApprovalRequest"]);i.set("Country","deves02"),i.set("FTApprovalRequest",n),Komodo.Services.pendingRequestsService.publishEvent(e,t,"RetrieveFTApprovalRequests","v1").done(function(){Komodo.log("RetrieveFTApprovalRequests() : published.")}).fail(function(e){Komodo.log("RetrieveFTApprovalRequests() : failed."),alert(e)})},messageFTApprovalRequestRetrievedReceived:function(e){var t=Komodo.Services.pendingRequestsService;e&&e.ResponseMessage&&e.ResponseMessage.Payload&&e.ResponseMessage.Payload.FTApprovalRequest&&e.ResponseMessage.Payload.FTApprovalRequest.ListOfFTApprovalRequest?(t.setFTpendingRequests(e),this.mapPendingRequests(e.ResponseMessage.Payload.FTApprovalRequest.ListOfFTApprovalRequest)):t.setFTpendingRequests(void 0)},publishSetPendingRequestListEvent:function(e,t,n,i){var o=Komodo.Models.SetFTApprovalStatus.create(),s=Komodo.canonicalFacadeFactory(o,["Country","ListOfFTApprovalStatus"]),d=Komodo.Models.ListOfFTApprovalStatus.create();if(i){for(var r=0;r<i.length;r++){var a=Komodo.Models.FTApprovalStatus.create();a.FTApprovalRequestId=i[r].id,n?(a.StatusChangeComment=n,i[r].set("ftComment",n)):a.StatusChangeComment=i[r].ftComment,a.NewStatus=t,a.Extended="0",a.FinancialTransactionId=i[r].paymentReferenceNumber,d.FTApprovalStatus.addObject(a)}o.ListOfFTApprovalStatus=d,s.set("Country","deves02"),s.set("ListOfFTApprovalStatus",d);Komodo.Services.pendingRequestsService.publishEvent(e,o,"SetFTApprovalStatus","v1").done(function(){Komodo.log("SetFTApprovalStatus() : published."),Komodo.Controls.MessageBoxController.show("FT Approval Requests","Status has been changed to "+t,Komodo.Controls.MessageBoxOkButtons,e,1,"success")}).fail(function(e){Komodo.log("SetFTApprovalStatus() : failed."),alert(e)}),e.setStatusOfSelectedFts(i,t)}},setStatusOfSelectedFts:function(e,t){if(e)for(var n=0;n<e.length;n++)e[n].set("requestStatus",t);this.get("approvePendingRequestViewModelObj").pendingRequestGrid.clear(),this.get("declinePendingRequestViewModelObj").pendingRequestGrid.clear(),this.reMapPendingRequests()},reMapPendingRequests:function(){for(var e=this.get("approvalRequestViewModelObj").pendingRequestGrid,t=0;t<e.length;t++)if("Pending"===e[t].requestStatus){var n=Komodo.Models.PendingRequestsModel.create();n.set("requestDate",e[t].requestDate),n.set("requestedBy",e[t].requestedBy),n.set("baseAmount",e[t].baseAmount),n.set("id",e[t].id),n.set("customerId",e[t].customerId),n.set("transactionType",e[t].transactionType),n.set("requestStatus",e[t].requestStatus),n.set("requestComment",e[t].requestComment),n.set("ftComment",e[t].ftComment),n.set("ledgerAccount",e[t].ledgerAccount),n.set("paymentReferenceNumber",e[t].paymentReferenceNumber),this.get("approvePendingRequestViewModelObj").pendingRequestGrid.addObject(n),this.get("declinePendingRequestViewModelObj").pendingRequestGrid.addObject(n)}},getFormattedDate:function(e){var t="";if("0001-01-01T00:00:00"===e)return"";if(e){var n=e.split("T"),i=new Date(n[0]);t=i.getDate()+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i.getMonth()]+" "+i.getFullYear()}return t},showBlockingBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,7e3,"blocking",this)},top:function(){this._super()}}),Komodo.Services.localizationService.registerNamespace("locale.pendingrequests");