Komodo.Services.QuotationService=function(){this.retrieveLookup=function(e,t){var a=$.Deferred(),o={eventName:"RetrieveLookup",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.retrieveProducts=function(e,t){var a=$.Deferred(),o={eventName:"RetrieveProducts",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.CalculateQuotationPrice=function(e,t){var a=$.Deferred(),o={eventName:"CalculateQuotationPrice",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.GenerateQuotation=function(e,t){var a=$.Deferred(),o={eventName:"GenerateQuotation",eventVersion:"v2",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.SearchQuotation=function(e,t){var a=$.Deferred(),o={eventName:"RetrieveQuotations",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.SendQuotation=function(e,t){var a=$.Deferred(),o={eventName:"SendQuotation",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.acceptQuotation=function(e,t){var a=$.Deferred(),o={eventName:"AcceptQuotation",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.payZeroValueDevice=function(e,t){Komodo.log("Updating Search Quotation Controller"),e.set("processVersion","v1"),e.set("processName","ZeroValueDevice");var a=$.Deferred(),o={eventName:"PaymentCreatedEvent",processName:"ZeroValueDevice",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},this.createZeroValueDeviceSale=function(e,t){Komodo.log("Updating Search Quotation Controller"),e.set("processVersion","v1"),e.set("processName","NotifyZeroValueDeviceSaleCreated");var a=$.Deferred(),o={eventName:"NotifyZeroValueDeviceSaleCreated",processName:"NotifyZeroValueDeviceSaleCreated",eventVersion:"v1",eventValidityInMinutes:0,eventPriority:null};return e.sendMessage(t,o).done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a}},Komodo.Services.QuotationServiceForConstant=Ember.Object.extend(Komodo.Dependency,{productConstant:void 0,customerConstant:void 0,init:function(){this._super(),this.requiresDependency("_cachedDataService",{singleton:Komodo.Services.cachedDataService}),this.requiresDependency("_uiService",{singleton:Komodo.Services.uiService}),this.fetchConstantDataSetFromAdele("ManageViewingConstants"),this.fetchConstantDataSetFromAdele("ManageCustomerConstants")},getCachedDataService:function(){return this.get("_cachedDataService")},getUIService:function(){return this.get("_uiService")},fetchConstantDataSetFromAdele:function(e){var t=this,a=$.Deferred();return Ember.isEmpty(t.get("productConstant"))||Ember.isEmpty(t.get("customerConstant"))?function(e){t.getCachedDataService().fetch(e,{domain:t.getUIService().getController("application").get("_selectedCountryId"),qualifier:"global"}).done(function(o){t.set("ManageViewingConstants"===e?"productConstant":"customerConstant",o),a.resolve(o)}).fail(function(t){Komodo.error("[CLARITY CONSTANT SERVICE ERROR] : failed to retrieve data for dataset :"+e+"ERROR : "+t),a.reject(t)})}(e):a.resolve(t.get("ManageViewingConstants"===e?"productConstant":"customerConstant")),a},getValueFromConstant:function(e,t){var a=this,o=void 0;try{var i=a.get("ProductsConstants"===e?"productConstant":"customerConstant");Ember.isEmpty(a.get("productConstant"))||Ember.isEmpty(a.get("customerConstant"))?Komodo.error("[CLARITY CONSTANT ERROR] : constant dataset empty: "+e):o=$.grep(i,function(e){return e.key==t})[0].value}catch(e){Komodo.error("[CLARITY CONSTANT ERROR] : failed to retrieve data for "+t+" ERROR: "+e)}return o="null"===o?"":"undefined"===o?void 0:o}}),Komodo.Services.QuotationServiceForConstant=Komodo.Services.QuotationServiceForConstant.create(),Ember.TEMPLATES.ZeroSaleSupervisorApprovalView=Ember.Handlebars.template(function(e,t,a,o,i){function r(e,t){var o,i;return t.buffer.push("\r\n            "),t.buffer.push(c((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"Authorise",i):d.call(e,"loc","Authorise",i)))),t.buffer.push("\r\n      "),""}function n(e,t){var o,i;return t.buffer.push("\r\n      "),t.buffer.push(c((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"Cancel",i):d.call(e,"loc","Cancel",i)))),t.buffer.push("\r\n      "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),i=i||{};var s,d=a.helperMissing,c=this.escapeExpression,l=this;return i.buffer.push('<table border="0" cellspacing="2" cellpadding="2" width="100%">\r\n    <tr>\r\n        <td>\r\n            <fieldset>\r\n                '),i.buffer.push(c(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.supervisorAuthorazation~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:t,class:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push('\r\n                <hr />\r\n                <table border="0" cellspacing="5" cellpadding="5" width="100%">\r\n                    <tr>\r\n                        <td style="padding-right: 10px">'),i.buffer.push(c(a.view.call(t,"Komodo.Controls.TextField",{hash:{tabindex:"200",valueBinding:"data.supervisorUsername",label:"~locale.quotation:searchQuotation.supervisorUsername~",validatorBinding:"view.context.validators.supervisorUsernameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:t,valueBinding:t,label:t,validatorBinding:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push("\r\n                        </td>\r\n                        <td>"),i.buffer.push(c(a.view.call(t,"Komodo.Controls.TextField",{hash:{type:"password",tabindex:"201",valueBinding:"data.passCode",label:"~locale.quotation:searchQuotation.passCode~",validatorBinding:"view.context.validators.passCodeValidator"},hashTypes:{type:"STRING",tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{type:t,tabindex:t,valueBinding:t,label:t,validatorBinding:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push('\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n            </fieldset>\r\n        </td>\r\n    </tr>\r\n    <tr>\r\n        <td align="right">'),s=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"203",action:"authorise",disabledBinding:"data.disableAction"},hashTypes:{tabindex:"STRING",action:"STRING",disabledBinding:"STRING"},hashContexts:{tabindex:t,action:t,disabledBinding:t},inverse:l.noop,fn:l.program(1,r,i),contexts:[t],types:["ID"],data:i}),(s||0===s)&&i.buffer.push(s),i.buffer.push("\r\n      "),s=a.view.call(t,"Komodo.Controls.Button",{hash:{tabindex:"204",action:"cancel"},hashTypes:{tabindex:"STRING",action:"STRING"},hashContexts:{tabindex:t,action:t},inverse:l.noop,fn:l.program(3,n,i),contexts:[t],types:["ID"],data:i}),(s||0===s)&&i.buffer.push(s),i.buffer.push("\r\n        </td>\r\n    </tr>\r\n</table>"),""}),Ember.TEMPLATES.ShowQuantityView=Ember.Handlebars.template(function(e,t,a,o,i){function r(e,t){var o;return t.buffer.push("\r\n    <tr>\r\n      "),o=a.if.call(e,"item.isShort",{hash:{},hashTypes:{},hashContexts:{},inverse:u.program(4,s,t),fn:u.program(2,n,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    </tr>\r\n    "),""}function n(e,t){var o;return t.buffer.push('\r\n      <td width="75">\r\n        <b>\r\n          <font color="red">'),o=a._triageMustache.call(e,"item.name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('</font>\r\n        </b>\r\n      </td>\r\n      <td width="25">\r\n        <b>\r\n          <font color="red">'),o=a._triageMustache.call(e,"item.qty",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</font>\r\n        </b>\r\n      </td>\r\n      "),""}function s(e,t){var o;return t.buffer.push('\r\n      <td width="75">\r\n        <b> '),o=a._triageMustache.call(e,"item.name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('</b>\r\n      </td>\r\n      <td width="25">\r\n        '),o=a._triageMustache.call(e,"item.qty",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("<br />\r\n      </td>\r\n      "),""}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),i=i||{};var d,c,l,u=this,h=a.helperMissing,p=this.escapeExpression;return i.buffer.push('<div>\r\n  <table width="250">\r\n    <tr>\r\n      <td colspan="2" >\r\n        <b>\r\n          <font size="2" >\r\n            '),d=a._triageMustache.call(t,"view.context.valMessage",{hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["ID"],data:i}),(d||0===d)&&i.buffer.push(d),i.buffer.push("\r\n          </font>\r\n        </b>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <b> "),i.buffer.push(p((c=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:i},c?c.call(t,"locale.quotation:createQuotation.product",l):h.call(t,"loc","locale.quotation:createQuotation.product",l)))),i.buffer.push("</b>\r\n      </td>\r\n      <td>\r\n        <b>"),i.buffer.push(p((c=a.loc||t&&t.loc,l={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:i},c?c.call(t,"locale.quotation:createQuotation.quantity",l):h.call(t,"loc","locale.quotation:createQuotation.quantity",l)))),i.buffer.push("</b>\r\n      </td>\r\n    </tr>\r\n    "),d=a.each.call(t,"item","in","view.context.array",{hash:{},hashTypes:{},hashContexts:{},inverse:u.noop,fn:u.program(1,r,i),contexts:[t,t,t],types:["ID","ID","ID"],data:i}),(d||0===d)&&i.buffer.push(d),i.buffer.push("\r\n  </table>\r\n</div>\r\n"),""}),Ember.TEMPLATES.SearchQuotationView=Ember.Handlebars.template(function(e,t,a,o,i){function r(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(2,n,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function n(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:G.noop,fn:G.program(3,s,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{class:"komodo-text-align-top column-width"},hashTypes:{class:"STRING"},hashContexts:{class:e},inverse:G.noop,fn:G.program(5,d,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function s(e,t){return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.firstName~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.firstName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.mobile~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.phone"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.communicationFollowup~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.communicationFollowup"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.status~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.status"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function d(e,t){return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.lastName~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.lastName"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.email~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.email"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.chargePeriod~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.termOfPayment"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.VATNumber~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.VATNumber"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function c(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:searchQuotation.addressInformation~"},hashTypes:{title:"STRING"},hashContexts:{title:e},inverse:G.noop,fn:G.program(8,l,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function l(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(9,u,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function u(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:G.noop,fn:G.program(10,h,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{class:"komodo-text-align-top column-width"},hashTypes:{class:"STRING"},hashContexts:{class:e},inverse:G.noop,fn:G.program(13,m,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function h(e,t){var o;return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.country~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.country"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.city~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.city"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.postalCode~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.postalCode"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),o=a.if.call(e,"data.isAddressPhysical",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(11,p,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function p(e,t){return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.buildingName~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.building"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),""}function m(e,t){var o;return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.province~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.province"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.suburb~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.suburb"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),o=a.if.call(e,"data.isAddressPhysical",{hash:{},hashTypes:{},hashContexts:{},inverse:G.program(16,g,t),fn:G.program(14,f,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function f(e,t){return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.houseNumber~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.unit"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.street~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.street"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),""}function g(e,t){return t.buffer.push("\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.postBoxNumber~",class:"info-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"data.address.privateBag"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),""}function v(e,t){var o;return t.buffer.push("\r\n\r\n  "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.DataGrid",{hash:{canSort:!0,pageSize:10,performsValidation:!1,contentBinding:"data.productData",columnsBinding:"dataGridColumns"},hashTypes:{canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",contentBinding:"STRING",columnsBinding:"STRING"},hashContexts:{canSort:e,pageSize:e,performsValidation:e,contentBinding:e,columnsBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n  <br/>\r\n  <div class="float-right">\r\n    '),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:searchQuotation.sendQuoteVia~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{class:"phone-dropdown",contentBinding:"communicationMethods",optionValuePath:"content.Value",optionLabelPath:"content.Value",valueBinding:"data.communicationType",label:""},hashTypes:{class:"STRING",contentBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{class:e,contentBinding:e,optionValuePath:e,optionLabelPath:e,valueBinding:e,label:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n\r\n    <span class="komodo-language">'),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{contentBinding:"languages",disabledBinding:"isLanguagesDisabled",optionValuePath:"content.key",optionLabelPath:"content.value",valueBinding:"data.communicationLanguage",label:""},hashTypes:{contentBinding:"STRING",disabledBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",valueBinding:"STRING",label:"STRING"},hashContexts:{contentBinding:e,disabledBinding:e,optionValuePath:e,optionLabelPath:e,valueBinding:e,label:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</span>\r\n    "),o=a.if.call(e,"showSms",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(19,b,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),o=a.if.call(e,"showEmail",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(23,x,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n\r\n    <br/>\r\n    <table class="float-right">\r\n      <tr>\r\n        <td>\r\n          '),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreValidation",{hash:{valueBinding:"data.othCountryCode",validatorBinding:"validators.othCountryCodeValidator"},hashTypes:{valueBinding:"STRING",validatorBinding:"STRING"},hashContexts:{valueBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n          "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreValidation",{hash:{valueBinding:"data.othPhone",validatorBinding:"validators.othPhoneValidator"},hashTypes:{valueBinding:"STRING",validatorBinding:"STRING"},hashContexts:{valueBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n          "),o=a.if.call(e,"showEmail",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(26,S,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n        </td>\r\n      </tr>\r\n    </table>\r\n\r\n  </div>\r\n  <br/><br/>\r\n  "),""}function b(e,t){var o;return t.buffer.push("\r\n    "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{class:"phone-dropdown",disabled:"true",contentBinding:"contactDetailTypes",optionValuePath:"content.key",optionLabelPath:"content.value",valueBinding:"data.contactType"},hashTypes:{class:"STRING",disabled:"STRING",contentBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",valueBinding:"STRING"},hashContexts:{class:e,disabled:e,contentBinding:e,optionValuePath:e,optionLabelPath:e,valueBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("+"),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{valueBinding:"data.othCountryCode",class:"phone-code",id:"countryCode"},hashTypes:{valueBinding:"STRING",class:"STRING",id:"STRING"},hashContexts:{valueBinding:e,class:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{valueBinding:"data.othPhone",class:"phone-number",id:"phoneNumber"},hashTypes:{valueBinding:"STRING",class:"STRING",id:"STRING"},hashContexts:{valueBinding:e,class:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    "),o=a.unless.call(e,"viewOnlyPage",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(20,C,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),""}function C(e,t){var o;return t.buffer.push(" "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"sendQuotation",disabledBinding:"data.isButtonDisabled",class:"btn-success",size:"nextto-control"},hashTypes:{action:"STRING",disabledBinding:"STRING",class:"STRING",size:"STRING"},hashContexts:{action:e,disabledBinding:e,class:e,size:e},inverse:G.noop,fn:G.program(21,y,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" "),""}function y(e,t){var o,i;t.buffer.push(R((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:searchQuotation.sendquote",i):K.call(e,"loc","locale.quotation:searchQuotation.sendquote",i))))}function x(e,t){var o;return t.buffer.push("\r\n    "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{valueBinding:"data.othEmail",class:"input-medium",id:"otherEmail"},hashTypes:{valueBinding:"STRING",class:"STRING",id:"STRING"},hashContexts:{valueBinding:e,class:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    "),o=a.unless.call(e,"viewOnlyPage",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(24,T,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),""}function T(e,t){var o;return t.buffer.push("  "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"sendQuotation",disabledBinding:"data.isButtonDisabled",class:"btn-success",size:"nextto-control"},hashTypes:{action:"STRING",disabledBinding:"STRING",class:"STRING",size:"STRING"},hashContexts:{action:e,disabledBinding:e,class:e,size:e},inverse:G.noop,fn:G.program(21,y,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),""}function S(e,t){return t.buffer.push("\r\n          "),t.buffer.push(R(a.view.call(e,"Komodo.Controls.CoreValidation",{hash:{valueBinding:"data.othEmail",validatorBinding:"validators.othEmailValidator"},hashTypes:{valueBinding:"STRING",validatorBinding:"STRING"},hashContexts:{valueBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n          "),""}function I(e,t){var o;return t.buffer.push("\r\n    "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"printQuote"},hashTypes:{action:"STRING"},hashContexts:{action:e},inverse:G.noop,fn:G.program(29,P,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"payNow",disableBinding:"data.isDisablePayNowButton",visibleBinding:"viewPayNowButtons"},hashTypes:{action:"STRING",disableBinding:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,disableBinding:e,visibleBinding:e},inverse:G.noop,fn:G.program(31,D,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"createCustomer",disableBinding:"data.isDisableCreateCustomerButton"},hashTypes:{action:"STRING",disableBinding:"STRING"},hashContexts:{action:e,disableBinding:e},inverse:G.noop,fn:G.program(33,w,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"saveQuote"},hashTypes:{action:"STRING"},hashContexts:{action:e},inverse:G.noop,fn:G.program(35,N,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    "),""}function P(e,t){var o,i;t.buffer.push(R((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:searchQuotation.printQuote",i):K.call(e,"loc","locale.quotation:searchQuotation.printQuote",i))))}function D(e,t){var o,i;t.buffer.push(R((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:searchQuotation.payNow",i):K.call(e,"loc","locale.quotation:searchQuotation.payNow",i))))}function w(e,t){var o,i;t.buffer.push(R((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:searchQuotation.createCustomer",i):K.call(e,"loc","locale.quotation:searchQuotation.createCustomer",i))))}function N(e,t){var o,i;t.buffer.push(R((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:searchQuotation.saveQuote",i):K.call(e,"loc","locale.quotation:searchQuotation.saveQuote",i))))}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),i=i||{};var B,A,E,R=this.escapeExpression,G=this,K=a.helperMissing;return i.buffer.push('<div class="no-banner-padding">\r\n  <table width="100%">\r\n    <tr>\r\n      <td>\r\n        <p class="komodo-heading">'),i.buffer.push(R((A=a.loc||t&&t.loc,E={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:i},A?A.call(t,"locale.quotation:searchQuotation.searchQuotation",E):K.call(t,"loc","locale.quotation:searchQuotation.searchQuotation",E)))),i.buffer.push(" - "),
i.buffer.push(R(a.view.call(t,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"quotationUID"},hashTypes:{textBinding:"STRING"},hashContexts:{textBinding:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push('</p>\r\n      </td>\r\n      <td align="right">\r\n        '),i.buffer.push(R(a.view.call(t,"Komodo.Controls.Link",{hash:{tabindex:"18",text:"~locale.quotation:createQuotation.back~",href:"#/createQuotation"},hashTypes:{tabindex:"STRING",text:"STRING",href:"STRING"},hashContexts:{tabindex:t,text:t,href:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push("\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <hr/>\r\n  "),B=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:searchQuotation.customerInformation~"},hashTypes:{title:"STRING"},hashContexts:{title:t},inverse:G.noop,fn:G.program(1,r,i),contexts:[t],types:["ID"],data:i}),(B||0===B)&&i.buffer.push(B),i.buffer.push("\r\n\r\n  "),B=a.if.call(t,"data.VATNumber",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(7,c,i),contexts:[t],types:["ID"],data:i}),(B||0===B)&&i.buffer.push(B),i.buffer.push("\r\n\r\n  "),B=a.view.call(t,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:searchQuotation.basket~"},hashTypes:{title:"STRING"},hashContexts:{title:t},inverse:G.noop,fn:G.program(18,v,i),contexts:[t],types:["ID"],data:i}),(B||0===B)&&i.buffer.push(B),i.buffer.push('\r\n\r\n  <br/>\r\n  <div class="float-right">\r\n    '),B=a.unless.call(t,"viewOnlyPage",{hash:{},hashTypes:{},hashContexts:{},inverse:G.noop,fn:G.program(28,I,i),contexts:[t],types:["ID"],data:i}),(B||0===B)&&i.buffer.push(B),i.buffer.push("\r\n  </div>\r\n</div>"),""}),Ember.TEMPLATES.CreateQuotationView=Ember.Handlebars.template(function(e,t,a,o,i){function r(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.businessUnits~"},hashTypes:{title:"STRING"},hashContexts:{title:e},inverse:Pe.noop,fn:Pe.program(2,n,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function n(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(3,s,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function s(e,t){return t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.RadioButtonGroup",{hash:{contentBinding:"data.viewingPlatformData",label:"~locale.quotation:createQuotation.viewingPlatform~",displayPath:"title",valuePath:"value",valueBinding:"data.viewingPlatform",visibleBinding:"disableViewingPlatformData"},hashTypes:{contentBinding:"STRING",label:"STRING",displayPath:"STRING",valuePath:"STRING",valueBinding:"STRING",visibleBinding:"STRING"},hashContexts:{contentBinding:e,label:e,displayPath:e,valuePath:e,valueBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function d(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.customerInformation~",isCollapsedBinding:"data.isCustomerInformation"},hashTypes:{title:"STRING",isCollapsedBinding:"STRING"},hashContexts:{title:e,isCollapsedBinding:e},inverse:Pe.noop,fn:Pe.program(6,c,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n\r\n  "),o=a.if.call(e,"data.isAdressVisible",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(12,p,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.selectHardware~",isCollapsedBinding:"data.isSelectHardware",tabindex:"8"},hashTypes:{title:"STRING",isCollapsedBinding:"STRING",tabindex:"STRING"},hashContexts:{title:e,isCollapsedBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(15,f,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.subscriptionInformation~"},hashTypes:{title:"STRING"},hashContexts:{title:e},inverse:Pe.noop,fn:Pe.program(50,M,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.selectPackage~",isCollapsedBinding:"data.isSelectPackage",linksBinding:"collapsibleselectPackageViewLinks",tabindex:"14"},hashTypes:{title:"STRING",isCollapsedBinding:"STRING",linksBinding:"STRING",tabindex:"STRING"},hashContexts:{title:e,isCollapsedBinding:e,linksBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(52,_,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.selectXtraview~",isCollapsedBinding:"data.isSelectXtraview"},hashTypes:{title:"STRING",isCollapsedBinding:"STRING"},hashContexts:{title:e,isCollapsedBinding:e},inverse:Pe.noop,fn:Pe.program(75,ne,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.quotation:createQuotation.basket~",isCollapsed:!1},hashTypes:{title:"STRING",isCollapsed:"BOOLEAN"},hashContexts:{title:e,isCollapsed:e},inverse:Pe.noop,fn:Pe.program(89,be,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function c(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(7,l,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function l(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:Pe.noop,fn:Pe.program(8,u,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top column-width"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:Pe.noop,fn:Pe.program(10,h,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function u(e,t){return t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"1",valueBinding:"data.firstName",label:"~locale.quotation:createQuotation.firstName~",validatorBinding:"validators.firstNameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:createQuotation.mobile~",id:"phonelabel"},hashTypes:{text:"STRING",id:"STRING"},hashContexts:{text:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{class:"phone-dropdown",disable:"true",contentBinding:"contactDetailTypes",optionValuePath:"content.key",optionLabelPath:"content.value",valueBinding:"data.contactType"},hashTypes:{class:"STRING",disable:"STRING",contentBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",valueBinding:"STRING"},hashContexts:{class:e,disable:e,contentBinding:e,optionValuePath:e,optionLabelPath:e,valueBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("+"),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{tabindex:"3",valueBinding:"data.countryCode",class:"phone-code"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",class:"STRING"},hashContexts:{tabindex:e,valueBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextField",{hash:{class:"phone-number",tabindex:"4",valueBinding:"data.phone",id:"phoneprefix"},hashTypes:{class:"STRING",tabindex:"STRING",valueBinding:"STRING",id:"STRING"},hashContexts:{class:e,tabindex:e,valueBinding:e,id:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  <br/>"),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreValidation",{hash:{validatorBinding:"validators.countryCodeValidator"},hashTypes:{validatorBinding:"STRING"},hashContexts:{validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreValidation",{hash:{valueBinding:"data.phone",validatorBinding:"validators.phoneValidator"},hashTypes:{valueBinding:"STRING",validatorBinding:"STRING"},hashContexts:{valueBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  <br/>"),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"data.isVATChecked",tabindex:"8"},hashTypes:{checkedBinding:"STRING",tabindex:"STRING"},hashContexts:{checkedBinding:e,tabindex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:createQuotation.checkBoxLabel~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/><br/>\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"9",valueBinding:"data.VATNumber",label:"~locale.quotation:createQuotation.quoteVATNumber~",visibleBinding:"data.visibleVATNumberTextBox",validatorBinding:"validators.VATNumberValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",visibleBinding:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,visibleBinding:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("<br/>\r\n  "),""}function h(e,t){return t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"2",valueBinding:"data.lastName",label:"~locale.quotation:createQuotation.lastName~",validatorBinding:"validators.lastNameValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.TextField",{hash:{tabindex:"7",valueBinding:"data.email",label:"~locale.quotation:createQuotation.email~",validatorBinding:"validators.emailValidator"},hashTypes:{tabindex:"STRING",valueBinding:"STRING",label:"STRING",validatorBinding:"STRING"},hashContexts:{tabindex:e,valueBinding:e,label:e,validatorBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function p(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.CollapsibleView",{hash:{title:"~locale.customer:customerInformation.addressInfoHeading~"},hashTypes:{title:"STRING"},hashContexts:{title:e},inverse:Pe.noop,fn:Pe.program(13,m,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n\r\n  "),""}function m(e,t){return t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.Address",{hash:{addressListBinding:"addressInformation",showControls:!0,numberOfPhysicalAddressBinding:"physical",numberOfPostalAddressBinding:"postal",tabIndex:300},hashTypes:{addressListBinding:"STRING",showControls:"BOOLEAN",numberOfPhysicalAddressBinding:"STRING",numberOfPostalAddressBinding:"STRING",tabIndex:"INTEGER"},hashContexts:{addressListBinding:e,showControls:e,numberOfPhysicalAddressBinding:e,numberOfPostalAddressBinding:e,tabIndex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n  "),""}function f(e,t){var o,i,r;return t.buffer.push('\r\n  <table width="100%">\r\n    <tbody>\r\n      <tr>\r\n        <td>\r\n          <p class="sub-heading">'),t.buffer.push(Ie((i=a.loc||e&&e.loc,r={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},i?i.call(e,"locale.quotation:createQuotation.device",r):De.call(e,"loc","locale.quotation:createQuotation.device",r)))),t.buffer.push('</p>\r\n        </td>\r\n        <td></td>\r\n        <td></td>\r\n        <td>\r\n          <p class="sub-heading">'),t.buffer.push(Ie((i=a.loc||e&&e.loc,r={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},i?i.call(e,"locale.quotation:createQuotation.insurance",r):De.call(e,"loc","locale.quotation:createQuotation.insurance",r)))),t.buffer.push('</p>\r\n        </td>\r\n        <td >\r\n        </td>\r\n        <td >\r\n        </td>\r\n        <td>\r\n          <p class="sub-heading">'),t.buffer.push(Ie((i=a.loc||e&&e.loc,r={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},i?i.call(e,"locale.quotation:createQuotation.acessService",r):De.call(e,"loc","locale.quotation:createQuotation.acessService",r)))),t.buffer.push("</p>\r\n        </td>\r\n        <td>\r\n        </td>\r\n        <td>\r\n        </td>\r\n      </tr>\r\n      "),o=a.each.call(e,"item","in","productHardware",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(16,g,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    </tbody>\r\n  </table>\r\n  "),""}function g(e,t){var o;return t.buffer.push("\r\n      <tr>\r\n        <td>\r\n          <table>\r\n            <tr>\r\n                "),o=a.if.call(e,"data.disableHardware",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(20,C,t),fn:Pe.program(17,v,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n            </tr>\r\n          </table>\r\n        </td>\r\n        <td align="right">\r\n          <span style="color:#005E93; font-weight: bold; align:right">'),o=a._triageMustache.call(e,"item.details.Price.Value",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('</span>\r\n        </td>\r\n        <td width="10%">\r\n        </td>\r\n        '),o=a.if.call(e,"item.hasInsurance",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(34,A,t),fn:Pe.program(23,x,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n        "),o=a.if.call(e,"item.hasAccessService",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(34,A,t),fn:Pe.program(36,E,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n      </tr>\r\n      "),""}function v(e,t){var o;return t.buffer.push("\r\n              <td>"),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"9"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(18,b,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n              <td> "),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n                "),""}function b(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"10",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),""}function C(e,t){var o;return t.buffer.push("\r\n              <td>"),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"9"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(21,y,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n              <td> "),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n                "),""}function y(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"10",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),""}function x(e,t){var o;return t.buffer.push("\r\n        <td >\r\n          <table>\r\n            <tr>\r\n            "),o=a.if.call(e,"data.disableSubscription",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(29,D,t),fn:Pe.program(24,T,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n            </tr>\r\n          </table>\r\n        </td>\r\n        <td >\r\n        </td>\r\n        <td width="10%">\r\n        </td>\r\n        '),""}function T(e,t){var o;return t.buffer.push("\r\n              "),o=a.each.call(e,"item.insurance.details.price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(25,S,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            "),""}function S(e,t){var o;return t.buffer.push("\r\n              "),o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(26,I,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n              "),""}function I(e,t){var o;return t.buffer.push("\r\n              <td>"),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item.insurance",tabindex:"11"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(27,P,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('</td>\r\n              <td>\r\n                <span style="color:#005E93; font-weight: bold; align:right">'),o=a._triageMustache.call(e,"finalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</span>\r\n              </td>\r\n              "),""}function P(e,t){t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.insurance.details.Price.Value",checkedBinding:"item.insurance.isChecked",tabindex:"12",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t})))}function D(e,t){var o;return t.buffer.push("\r\n              "),o=a.each.call(e,"item.insurance.details.price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(30,w,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            "),""}function w(e,t){var o;return t.buffer.push("\r\n              "),o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(31,N,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n              "),""}function N(e,t){var o;return t.buffer.push("\r\n              <td>"),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item.insurance",tabindex:"11"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(32,B,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('</td>\r\n              <td>\r\n                <span style="color:#005E93; font-weight: bold; align:right">'),o=a._triageMustache.call(e,"finalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</span>\r\n              </td>\r\n              "),""}function B(e,t){t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.insurance.details.Price.Value",checkedBinding:"item.insurance.isChecked",tabindex:"12",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t})))}function A(e,t){t.buffer.push("\r\n        <td >\r\n        </td>\r\n        <td >\r\n        </td>\r\n        <td >\r\n        </td>\r\n        ")}function E(e,t){var o;return t.buffer.push("\r\n        <td>\r\n          <table>\r\n            <tr>\r\n                "),o=a.if.call(e,"data.disableSubscription",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(42,V,t),fn:Pe.program(37,R,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n              \r\n            </tr>\r\n          </table>\r\n        </td>\r\n        <td align="right">\r\n          '),o=a.each.call(e,"item.accessService.details.price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(47,k,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n        </td>\r\n        <td width="10%">\r\n        </td>\r\n        '),""}function R(e,t){var o;return t.buffer.push("\r\n                "),o=a.each.call(e,"item.accessService.details.price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(38,G,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n                "),""}function G(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(39,K,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function K(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item.accessService"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING"},hashContexts:{action:e,target:e,contextBinding:e},inverse:Pe.noop,fn:Pe.program(40,O,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.accessService.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                "),""}function O(e,t){t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.accessService.details.Name",checkedBinding:"item.accessService.isChecked",tabindex:"13",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t})))}function V(e,t){var o;return t.buffer.push("\r\n                "),o=a.each.call(e,"item.accessService.details.price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(43,Q,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n                "),""}function Q(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(44,F,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function F(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item.accessService"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING"},hashContexts:{action:e,target:e,contextBinding:e},inverse:Pe.noop,fn:Pe.program(45,L,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.accessService.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                "),""}function L(e,t){t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.accessService.details.Name",checkedBinding:"item.accessService.isChecked",tabindex:"13",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t})))}function k(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(48,U,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function U(e,t){var o;return t.buffer.push('<span style="color:#005E93; font-weight: bold; align:right">'),o=a._triageMustache.call(e,"finalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</span>"),""}function M(e,t){var o,i;return t.buffer.push("\r\n  <div>\r\n    <table>\r\n      <tr>\r\n        <td>\r\n          "),t.buffer.push(Ie((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:createQuotation.subscriptionInformationQuestion",i):De.call(e,"loc","locale.quotation:createQuotation.subscriptionInformationQuestion",i)))),t.buffer.push('\r\n        </td>\r\n      </tr>\r\n    </table>\r\n    <table width="100%">\r\n            <tr>\r\n              <td class="col-md-6">\r\n                 '),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.RadioButtonGroup",{hash:{contentBinding:"invoicePeriod",displayPath:"title",valuePath:"value",valueBinding:"data.chargePeriodValue",tabindex:"21"},hashTypes:{contentBinding:"STRING",displayPath:"STRING",valuePath:"STRING",valueBinding:"STRING",tabindex:"STRING"},hashContexts:{contentBinding:e,displayPath:e,valuePath:e,valueBinding:e,tabindex:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              </td>\r\n                <td class="col-md-3">\r\n                    <span style="font-family:Arial;font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:#CCCCCC; float:left">\r\n                        '),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:createQuotation.freeText~",visibleBinding:"visibleAnnualOfferText"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n                    </span>\r\n                </td>\r\n             \r\n              <td class="col-md-3">\r\n                  '),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.Select",{hash:{label:"~locale.quotation:createQuotation.stsPeriod~",contentBinding:"stsPeriod",optionValuePath:"content.value",optionLabelPath:"content.title",disabledBinding:"disableSTSPeriodSelect",valueBinding:"data.stsPeriodValue",visibleBinding:"visibleSTSPeriodSelect"},hashTypes:{label:"STRING",contentBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",disabledBinding:"STRING",valueBinding:"STRING",visibleBinding:"STRING"},hashContexts:{label:e,contentBinding:e,optionValuePath:e,optionLabelPath:e,disabledBinding:e,valueBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n\r\n          </table>\r\n  </div>\r\n  "),""}function _(e,t){var o,i,r;return t.buffer.push('\r\n  <table width="100%">\r\n    <tr>\r\n      <td>\r\n        <p class="sub-heading">'),t.buffer.push(Ie((i=a.loc||e&&e.loc,r={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},i?i.call(e,"locale.quotation:createQuotation.principalPackage",r):De.call(e,"loc","locale.quotation:createQuotation.principalPackage",r)))),t.buffer.push('</p>\r\n      </td>\r\n      <td>\r\n        <p class="sub-heading">'),t.buffer.push(Ie((i=a.loc||e&&e.loc,r={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},i?i.call(e,"locale.quotation:createQuotation.addonPackage",r):De.call(e,"loc","locale.quotation:createQuotation.addonPackage",r)))),t.buffer.push('</p>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td valign="top">\r\n        <table>\r\n          <tbody>\r\n            '),o=a.each.call(e,"item","in","productServiceNew",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(53,q,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n          </tbody>\r\n        </table>\r\n      </td>\r\n      <td valign="top">\r\n        <table>\r\n          <tbody>\r\n            '),o=a.each.call(e,"item","in","productAddOnNew",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(64,z,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n          </tbody>\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  "),""}function q(e,t){var o;return t.buffer.push("\r\n            "),o=a.if.call(e,"item.details.isShow",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(54,$,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            "),""}function $(e,t){var o;return t.buffer.push("\r\n            <tr>\r\n              <td>\r\n                <table>\r\n                  <tr>\r\n                      "),o=a.if.call(e,"data.disableSubscription",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(58,W,t),fn:Pe.program(55,H,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n\r\n                  </tr>\r\n                </table>\r\n              </td>\r\n              <td width="15%">\r\n              </td>\r\n              <td align="right">\r\n                '),o=a.each.call(e,"item.details.prices",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(61,X,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n            "),""}function H(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"15"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(56,j,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                      "),""}function j(e,t){return t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"16",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),""}function W(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",
tabindex:"15"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(59,Y,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                      "),""}function Y(e,t){return t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"16",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),""}function X(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(62,Z,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function Z(e,t){var o;return t.buffer.push('<span style="color:#005E93; font-weight: bold;">'),o=a._triageMustache.call(e,"finalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</span>"),""}function z(e,t){var o;return t.buffer.push("\r\n            "),o=a.if.call(e,"item.details.isShow",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(65,J,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            "),""}function J(e,t){var o;return t.buffer.push("\r\n            <tr>\r\n              <td>\r\n                <table>\r\n                  <tr>\r\n                      "),o=a.if.call(e,"data.disableSubscription",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(69,ae,t),fn:Pe.program(66,ee,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push('\r\n                  </tr>\r\n                </table>\r\n              </td>\r\n              <td width="15%">\r\n              </td>\r\n              <td align="right">\r\n                '),o=a.each.call(e,"item.details.prices",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(72,ie,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n              </td>\r\n            </tr>\r\n            "),""}function ee(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"17"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(67,te,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                      "),""}function te(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"18",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),""}function ae(e,t){var o;return t.buffer.push("\r\n                    <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"17"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(70,oe,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                    <td>"),o=a._triageMustache.call(e,"item.details.Name",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n                      "),""}function oe(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.Name",checkedBinding:"item.isChecked",tabindex:"18",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),""}function ie(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(73,re,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function re(e,t){var o;return t.buffer.push('<span style="color:#005E93; font-weight: bold">'),o=a._triageMustache.call(e,"finalAmount",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</span>"),""}function ne(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnLayoutView",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(76,se,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function se(e,t){var o;return t.buffer.push("\r\n  "),o=a.view.call(e,"Komodo.Controls.ColumnView",{hash:{classNames:"komodo-text-align-top"},hashTypes:{classNames:"STRING"},hashContexts:{classNames:e},inverse:Pe.noop,fn:Pe.program(77,de,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n  "),""}function de(e,t){var o;return t.buffer.push('\r\n  <table width="100%">\r\n    <tbody>\r\n      '),o=a.each.call(e,"item","in","productXtraviewService",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(78,ce,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n    </tbody>\r\n  </table>\r\n  "),""}function ce(e,t){var o;return t.buffer.push("\r\n      <tr>\r\n        <td>\r\n          <table>\r\n            <tr>\r\n                "),o=a.if.call(e,"data.disableSubscription",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.program(84,me,t),fn:Pe.program(79,le,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            </tr>\r\n          </table>\r\n        </td>\r\n      </tr>\r\n      "),""}function le(e,t){var o;return t.buffer.push("\r\n              "),o=a.each.call(e,"item.details.Price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(80,ue,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n                "),""}function ue(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(81,he,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function he(e,t){var o;return t.buffer.push("\r\n              <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"19"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(82,pe,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n              <td> "),o=a._triageMustache.call(e,"item.details.DisplayName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n              "),""}function pe(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.DisplayName",checkedBinding:"item.isChecked",tabindex:"20",disabled:!0},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),""}function me(e,t){var o;return t.buffer.push("\r\n              "),o=a.each.call(e,"item.details.Price",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(85,fe,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n                "),""}function fe(e,t){var o;o=a.if.call(e,"show",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(86,ge,t),contexts:[e],types:["ID"],data:t}),o||0===o?t.buffer.push(o):t.buffer.push("")}function ge(e,t){var o;return t.buffer.push("\r\n              <td> "),o=a.view.call(e,"Komodo.Controls.ActionView",{hash:{action:"activateGroup",target:"controller",contextBinding:"item",tabindex:"19"},hashTypes:{action:"STRING",target:"STRING",contextBinding:"STRING",tabindex:"STRING"},hashContexts:{action:e,target:e,contextBinding:e,tabindex:e},inverse:Pe.noop,fn:Pe.program(87,ve,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push(" </td>\r\n              <td> "),o=a._triageMustache.call(e,"item.details.DisplayName",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("</td>\r\n              "),""}function ve(e,t){return t.buffer.push(" "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{dataTitleBinding:"item.details.DisplayName",checkedBinding:"item.isChecked",tabindex:"20",disabled:!1},hashTypes:{dataTitleBinding:"STRING",checkedBinding:"STRING",tabindex:"STRING",disabled:"BOOLEAN"},hashContexts:{dataTitleBinding:e,checkedBinding:e,tabindex:e,disabled:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),""}function be(e,t){var o;return t.buffer.push("\r\n  "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.DataGrid",{hash:{canSort:!0,pageSize:10,performsValidation:!0,canDelete:!0,canEdit:!0,editMode:"line",canSelect:!0,selectedItemBinding:"data.selectedGridItem",contentBinding:"data.productData",columnsBinding:"dataGridColumns",commandItemBinding:"data.commandGridItem",commandItemTypeBinding:"data.deleteGridItem",showFooter:!0,footersBinding:"dataGridFooters"},hashTypes:{canSort:"BOOLEAN",pageSize:"INTEGER",performsValidation:"BOOLEAN",canDelete:"BOOLEAN",canEdit:"BOOLEAN",editMode:"STRING",canSelect:"BOOLEAN",selectedItemBinding:"STRING",contentBinding:"STRING",columnsBinding:"STRING",commandItemBinding:"STRING",commandItemTypeBinding:"STRING",showFooter:"BOOLEAN",footersBinding:"STRING"},hashContexts:{canSort:e,pageSize:e,performsValidation:e,canDelete:e,canEdit:e,editMode:e,canSelect:e,selectedItemBinding:e,contentBinding:e,columnsBinding:e,commandItemBinding:e,commandItemTypeBinding:e,showFooter:e,footersBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n  <table width="100%">\r\n    <tr>\r\n      <td align="left">\r\n        <table width="100%">\r\n          <tr>\r\n            <td>\r\n              '),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"data.isCommunicationFollowup",visibleBinding:"visibleCommunicationFollowup"},hashTypes:{checkedBinding:"STRING",visibleBinding:"STRING"},hashContexts:{checkedBinding:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n              "),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.quotation:createQuotation.communicationFollowup~",visibleBinding:"visibleCommunicationFollowup"},hashTypes:{text:"STRING",visibleBinding:"STRING"},hashContexts:{text:e,visibleBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n              <span class="komodo-language">'),t.buffer.push(Ie(a.view.call(e,"Komodo.Controls.CoreSelect",{hash:{contentBinding:"languages",optionValuePath:"content.key",optionLabelPath:"content.value",valueBinding:"data.language",visibleBinding:"showlanguageList",validatorBinding:"validators.languageValidator",prompt:" "},hashTypes:{contentBinding:"STRING",optionValuePath:"STRING",optionLabelPath:"STRING",valueBinding:"STRING",visibleBinding:"STRING",validatorBinding:"STRING",prompt:"STRING"},hashContexts:{contentBinding:e,optionValuePath:e,optionLabelPath:e,valueBinding:e,visibleBinding:e,validatorBinding:e,prompt:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</span>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </td>\r\n      <td class="float-right">\r\n        <table>\r\n          <tr>\r\n            <td>\r\n              '),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"clearBasket",tabindex:"45",visibleBinding:"data.isButtonVisible",class:"btn-inverse"},hashTypes:{action:"STRING",tabindex:"STRING",visibleBinding:"STRING",class:"STRING"},hashContexts:{action:e,tabindex:e,visibleBinding:e,class:e},inverse:Pe.noop,fn:Pe.program(90,Ce,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n              "),o=a.view.call(e,"Komodo.Controls.Button",{hash:{action:"addQuotation",disabledBinding:"disableQuotationButton",tabindex:"50",visibleBinding:"data.isButtonVisible"},hashTypes:{action:"STRING",disabledBinding:"STRING",tabindex:"STRING",visibleBinding:"STRING"},hashContexts:{action:e,disabledBinding:e,tabindex:e,visibleBinding:e},inverse:Pe.noop,fn:Pe.program(92,ye,t),contexts:[e],types:["ID"],data:t}),(o||0===o)&&t.buffer.push(o),t.buffer.push("\r\n            </td>\r\n          </tr>\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </table>\r\n  "),""}function Ce(e,t){var o,i;t.buffer.push(Ie((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:createQuotation.clearBasket",i):De.call(e,"loc","locale.quotation:createQuotation.clearBasket",i))))}function ye(e,t){var o,i;t.buffer.push(Ie((o=a.loc||e&&e.loc,i={hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["STRING"],data:t},o?o.call(e,"locale.quotation:createQuotation.generateQuotation",i):De.call(e,"loc","locale.quotation:createQuotation.generateQuotation",i))))}this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,Ember.Handlebars.helpers),i=i||{};var xe,Te,Se,Ie=this.escapeExpression,Pe=this,De=a.helperMissing;return i.buffer.push('<div class="no-banner-padding">\r\n    <span class="komodo-heading">'),i.buffer.push(Ie((Te=a.loc||t&&t.loc,Se={hash:{},hashTypes:{},hashContexts:{},contexts:[t],types:["STRING"],data:i},Te?Te.call(t,"locale.quotation:home.createQuote",Se):De.call(t,"loc","locale.quotation:home.createQuote",Se)))),i.buffer.push(' </span>\r\n    <span class="float-right">'),i.buffer.push(Ie(a.view.call(t,"Komodo.Controls.Link",{hash:{tabindex:"18",text:"~locale.quotation:createQuotation.back~",href:"#/home"},hashTypes:{tabindex:"STRING",text:"STRING",href:"STRING"},hashContexts:{tabindex:t,text:t,href:t},contexts:[t],types:["ID"],data:i}))),i.buffer.push("</span>\r\n    <hr/>\r\n  "),xe=a.if.call(t,"disableViewingPlatformData",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(1,r,i),contexts:[t],types:["ID"],data:i}),(xe||0===xe)&&i.buffer.push(xe),i.buffer.push("\r\n  "),xe=a.unless.call(t,"isNam",{hash:{},hashTypes:{},hashContexts:{},inverse:Pe.noop,fn:Pe.program(5,d,i),contexts:[t],types:["ID"],data:i}),(xe||0===xe)&&i.buffer.push(xe),i.buffer.push("\r\n</div>"),""}),Komodo.Application.SearchQuotationRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"searchQuotation",init:function(){this._super()}}),Komodo.Application.CreateQuotationRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"createQuotation",useCaseDisplayName:void 0,init:function(){this._super()}}),Komodo.UI.Route.registerRoutes(function(){this.resource("searchQuotation"),this.resource("createQuotation"),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.GetConnected,routeName:"createQuotation",title:kl.value("locale.quotation:home.hometitle"),type:Komodo.NavigationTypes.HomeTile,imageurl:"Content/Images/Home/getConnected.svg",desiredLocation:1}),Komodo.Services.navigationService.register({groupName:Komodo.NavigationGroupNames.GetConnected,routeName:"createQuotation",title:kl.value("locale.quotation:home.createQuote"),type:Komodo.NavigationTypes.HomeTileSubLink}),Komodo.Services.eventAggregator.subscribe("PublishCreateQuotation",function(e){Komodo.Services.uiService.getController("createQuotation").loadQuoteDetails(e),Komodo.Services.uiService.transitionTo("createQuotation")}),Komodo.Services.eventAggregator.subscribe("PublishCustomerQuotationUID",function(e){var t=Komodo.Services.uiService.getController("searchQuotation");Komodo.Services.uiService.transitionTo("searchQuotation"),t.setQuotationUID(e)})}),Komodo.Models.QuotationModule=Ember.Object.extend(LoggingMixin,{name:"Komodo.Models.QuotationModule"}),Komodo.Application.CreateQuotationView=Komodo.UI.View.extend({viewKey:"CreateQuotationView",click:function(e){$(e.target.parentElement.parentElement.parentElement).is("tr")&&this.get("controller").send("setRowIndex",e.target.parentElement.parentElement.parentElement.rowIndex)},focusIn:function(e){$(e.target.parentElement.parentElement.parentElement).is("tr")&&this.get("controller").send("setRowIndex",e.target.parentElement.parentElement.parentElement.rowIndex)}}),Komodo.Models.QuotationModule=Ember.Object.extend(LoggingMixin,{name:"Komodo.Models.QuotationModule"}),Komodo.Models.SearchQuotationModel=Ember.Object.extend({init:function(){this.country=void 0,this.QuotationUID=void 0,this.productData=[],this.acceptQuoteData=[],this.firstName=void 0,this.lastName=void 0,this.email=void 0,this.phone=void 0,this.communicationFollowup=void 0,this.termOfPayment=void 0,this.status=void 0,this.AcceptanceStatus=void 0,this.qutationTotalPrice=void 0,this.qutationQuantity=void 0,this.qutationServiceCost=void 0,this.qutationDeviceCost=void 0,this.isButtonVisible=!1,this.isDDLCommVisible=!1,this.communicationLanguage=void 0,this.communicationType=void 0,this.othEmail=void 0,this.othPhone=void 0,this.othCountryCode=void 0,this.contactType=void 0,this.province=void 0,this.city=void 0,this.suburb=void 0,this.postalCode=void 0,this.unitNumber=void 0,this.buildingName=void 0,this.street=void 0,this._super()}}),Komodo.Models.ZeroSaleSupervisorAthoriseModel=Ember.Object.extend({init:function(){this.supervisorUsername="",this.passCode="",this.approveShit=!1,this._super()}}),Komodo.Application.SearchQuotationView=Komodo.UI.View.extend({viewKey:"SearchQuotationView"}),Komodo.Models.QuotationModule.ProductGridData=Ember.Object.extend({init:function(){this.productUid=void 0,this.productName=void 0,this.productPrice=void 0,this.productQuantity=void 0,this.totalTax=void 0,this.totalPrice=void 0,this.productCategory=void 0,this.subscriptionCost=void 0,this.deviceCost=void 0,this.includedTax=void 0,this.productModel=void 0,this.actualCost=void 0,this.actualCostWithTax=void 0,this.actualIncludedTax=void 0,this.currencyId=void 0,productDetails=void 0,this._super()}}),Komodo.Models.QuotationModule.AcceptQuoteGridData=Ember.Object.extend({init:function(){this.Model=void 0,this.QuantityRequested=void 0,this.QuantityAvailable=void 0,this.Description=void 0,this._super()}}),Komodo.Application.ShowQuantityView=Komodo.UI.View.extend({viewKey:"ShowQuantityView"}),Komodo.Models.QuotationModule.CreateQuotationModel=Ember.Object.extend({init:function(){this.localeBase="locale.quotation:createQuotation.",this.firstName=void 0,this.lastName=void 0,this.email=void 0,this.countryCode=void 0,this.phone=void 0,this.customerRefNo=void 0,this.country=void 0,this.contactType=void 0,this.customerClass="1",this.chargePeriod=void 0,this.chargePeriodValue=void 0,this.visibleSTSPeriodSelect=void 0,this.productServices=[],this.productHardwares=[],this.productData=[],this.selectedGridItem=void 0,this.isButtonVisible=!1,this.getPriceButton=!1,this.isGenerateQuotationButtonEnable=!1,this.vat=void 0,this.totalPrice=void 0,this.quantity=void 0,this.serviceCost=void 0,this.deviceCost=void 0,this.includedTax=void 0,this.commandGridItem=void 0,this.deleteGridItem=void 0,this.radioButtonClass=[{title:kl.value(this.localeBase+"residential"),value:"1"}],this.isCustomerInformation=!1,this.isSelectHardware=!1,this.isSelectPackage=!1,this.isSelectXtraview=!1,this.isSelectCommunicationFollowup=!1,this.isBasket=!1,this.selectedCountryCode=void 0,this.countryCodeData=void 0,this.isXtraview=!1,this.XtraviewDetails=void 0,this.communicationFollowupData=[{title:kl.value(this.localeBase+"yes"),value:"1"},{title:kl.value(this.localeBase+"no"),value:"0"}],this.isCommunicationFollowup=void 0,this.visibleCommunicationFollowup=!1,this.language=void 0,this.debitOrderDay,this.viewingPlatformData=[{title:kl.value(this.localeBase+"dstv"),value:kl.value(this.localeBase+"dstv")},{title:kl.value(this.localeBase+"gotv"),value:kl.value(this.localeBase+"gotv")}],this.disableViewingPlatformData=!1,this.isNam=!1,this.isAdressVisible=void 0,this.isCountyNam=void 0,this.isChecked=!1,this.visibleVATNumberTextBox=!1,this.disableSubscription=void 0,this.disableHardware=void 0,this._super()}}),Komodo.Application.ZeroSaleSupervisorApprovalView=Komodo.UI.View.extend({viewKey:"ZeroSaleSupervisorApprovalView",templateName:"ZeroSaleSupervisorApprovalView"}),Komodo.Application.SearchQuotationController=Komodo.UI.Controller.extend({_localeBase:"locale.quotation:searchQuotation.",payNowPermission:"clarity://searchQuotation/accessPayNow",viewOnlyPermission:"clarity://searchQuotation/quoteViewOnly",supervisorClaim:"clarity://system/supervisor",init:function(){Komodo.log("Constructing Search Quotation Controller"),this.set("processVersion","v1.1"),this.set("processName","Search Quotation Process"),this.requiresDependency("_securityService",{singleton:Komodo.Services.securityService}),this.requiresDependency("_cacheRepository",{singleton:Komodo.Repositories.cacheRepository}),this.requiresDependency("_cachedDataService",{singleton:Komodo.Services.cachedDataService}),this._super()},start:function(){this.set("printers",[]),this.registerModel("data",Komodo.Models.SearchQuotationModel),this.get("data").set("isButtonDisabled",!0),this.set("normalComm",!0),this.get("data").set("othEmail",void 0),this.get("data").set("othPhone",void 0),this.registerValidator(this.get("data"),"othEmail",{minLength:6,maxLength:254,type:"string",displayName:kl.value(this._localeBase+"email"),regExPattern:Komodo.UI.Validators.RegExPatterns.Email}),this.registerValidator(this.get("data"),"othPhone",{type:"number",limitValueToType:!0,minLength:7,maxLength:10,displayName:kl.value(this._localeBase+"phoneNumber"),functions:Komodo.UI.Validators.numericValidator}),this.registerValidator(this.get("data"),"othCountryCode",{type:"number",limitValueToType:!0,minLength:2,maxLength:4,displayName:kl.value(this._localeBase+"countryCode"),functions:Komodo.UI.Validators.numericValidator}),this.registerValidator(this.get("data"),"termOfPayment",{type:"string"}),this.registerValidator(this.get("data"),"contactType",{type:"string"}),this.set("showEmail",!0),this.set("showSms",!1);var e,t=this;t.set("onSearchQuotation",!0),this.getCDMData(),this.getCurrency(),t.searchQuotation(),t.set("CSTLabel",void 0),t.set("LEVYLabel",void 0),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","ToggleVATLabel").done(function(a){switch(a){case!0:e=kl.value(t._localeBase+"vat");break;default:e=kl.value(t._localeBase+"tax")}}).fail(function(e){Komodo.Services.error("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("SAClarityRoles","RolesAndPermissions").done(function(e){switch(e){case!0:Komodo.Services.securityService.hasPermission(t.viewOnlyPermission)?t.set("viewOnlyPage",!0):Komodo.Services.securityService.hasPermission(t.payNowPermission)?t.set("viewPayNowButtons",!0):t.set("viewPayNowButtons",!1);break;default:t.set("viewPayNowButtons",!0)}}).fail(function(e){Komodo.Services.log("Error while checking permissions. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","LanguagesDisabled").done(function(e){t.set("isLanguagesDisabled",e)}).fail(function(e){Komodo.Services.error("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","twoTaxTier").done(function(e){t.set("twoTaxTier",e)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","isLevyApplicable").done(function(e){t.set("isLevyApplicable",e)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.queryService.getJSON("/PointOfSale/RetrieveUserPrinters?userName="+t.userName()).done(function(e){void 0!==e&&null!==e&&t.set("getprinters",e.Printers)}).error(function(e){var a=JSON.stringify(e),o=e.responseJSON.ExceptionMessage?e.responseJSON.ExceptionMessage:e.responseJSON.Message;Komodo.log("[ERROR] : RetrieveUserPrinters ajax call failed. Error: "+a),Komodo.Controls.MessageBoxController.show(kl.value(t.localGeneral+"moduleTitle"),"[ERROR] : RetrieveUserPrinters ajax call failed. Error: "+o,Komodo.Controls.MessageBoxOkButtons,t,"id5446674","danger")}),Komodo.Services.navigationService.get("hasActiveGroup")||Komodo.Services.navigationService.activateGroup(Komodo.NavigationGroupNames.GetConnected),t.get("twoTaxTier")?(t.set("CSTLabel",kl.value(t._localeBase+t.getValueFromConstant("CustomerTypesConstants","customerTypesConstants.CustomerQuoteConstants.TaxTypeDescription"))),this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalTax",title:e,width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalCST",title:t.get("CSTLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})]):t.get("isLevyApplicable")?(t.set("LEVYLabel",kl.value(t._localeBase+t.getValueFromConstant("CustomerTypesConstants","customerTypesConstants.CustomerQuoteConstants.TaxTypeDescription"))),this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalTax",title:e,width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalLEVY",title:t.get("LEVYLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})]):this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalTax",title:e,width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})],this.dataAcceptQuoteGridColumns=[Komodo.Controls.DataGridColumn.create({name:"Model",title:kl.value(this._localeBase+"deviceModel"),width:"170px"}),Komodo.Controls.DataGridColumn.create({name:"QuantityRequested",title:kl.value(this._localeBase+"qtyRequested"),width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"QuantityAvailable",title:kl.value(this._localeBase+"qtyAvailable"),width:"100px"}),Komodo.Controls.DataGridColumn.create({name:"Description",title:kl.value(this._localeBase+"description"),width:"170px"})],this._super()},getValueFromConstant:function(e,t){return Komodo.Services.QuotationServiceForConstant.getValueFromConstant(e,t)},getSecurityService:function(){return this.get("_securityService")},stop:function(){var e=this;this.clearData(),this.hideBusyIndicator(),this._super(),this.set("onSearchQuotation",!1);var t=["statuses","communicationLanguages","invoicePeriod","countries","isoData","contactDetailTypes","allcountries","languages","mobileCode"];t.forEach(function(t){e.set(t,[])},t)},clearData:function(){this.set("quotationUID",void 0),this.set("dataGridFooters",void 0)},searchQuotation:function(){return this.publishRetrieveQuotationsEvent()},getArrayItem:function(e){return e instanceof Array?e:[e]},createNewGridItem:function(){var e=Komodo.Models.QuotationModule.ProductGridData.create();this.set("newProductGridItem",e);var t=Komodo.Models.QuotationModule.AcceptQuoteGridData.create();this.set("newAcceptQuoteGridItem",t)},addGridRow:function(){0===this.data.productData.length?this.set("data.productData",[this.get("newProductGridItem")]):this.get("data.productData").pushObject(this.get("newProductGridItem")),this.createNewGridItem()},setQuotationUID:function(e){null!=e&&void 0!=e&&(this.registerModel("data",Komodo.Models.SearchQuotationModel),void 0===e.ResponseMessage?(this.set("quotationUID",e),this.get("onSearchQuotation")&&(this.getCDMData(),this.searchQuotation())):(this.set("quotationUID",e.ResponseMessage.Payload.Quotation.UID),this.get("onSearchQuotation")&&(this.getCDMData(),this.searchQuotation())),e.ResponseMessage&&e.ResponseMessage.Payload&&e.ResponseMessage.Payload.Lead&&e.ResponseMessage.Payload.Lead.CustomerUID&&(this.disableButton("createCustomer"),this.customerExists=!0))},hideSendQuotationButton:function(e){this.set("data.isButtonVisible",e)},showBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,12e5,"blocking",this)},hideBusyIndicator:function(){Komodo.Services.busyService.stop(this.get("processId"),"blocking")},getNewProcessID:function(){this.startNewProcess()},disableButton:function(e){"payNow"===e&&this.set("data.isDisablePayNowButton",!0),"createCustomer"===e&&this.set("data.isDisableCreateCustomerButton",!0),"acceptQuote"===e&&this.set("data.isDisableAcceptButton",!0)},enableButton:function(e){"payNow"===e&&this.set("data.isDisablePayNowButton",!1),"createCustomer"===e&&this.set("data.isDisableCreateCustomerButton",!1),"acceptQuote"===e&&this.set("data.isDisableAcceptButton",!1)},quoteStatusCheck:function(e){switch(e){case kl.value(this._localeBase+"active"):this.enableButton("payNow"),this.customerExists||this.enableButton("createCustomer"),this.enableButton("acceptQuote");break
;case kl.value(this._localeBase+"accepted"):var t=!1;$.each(this.data.productData,function(e,a){if("HARDWARE"==a.productCategory&&0==a.deviceCost)return t=!0,!1}),t?this.enableButton("payNow"):this.disableButton("payNow"),this.customerExists||this.enableButton("createCustomer"),this.disableButton("acceptQuote");break;case kl.value(this._localeBase+"rejected"):case kl.value(this._localeBase+"Expired"):this.disableButton("payNow"),this.disableButton("createCustomer"),this.disableButton("acceptQuote");break;case kl.value(this._localeBase+"completed"):this.disableButton("payNow"),this.customerExists||this.enableButton("createCustomer"),this.disableButton("acceptQuote")}},addQuoteGridRow:function(){0===this.data.acceptQuoteData.length?this.set("data.acceptQuoteData",[this.get("newAcceptQuoteGridItem")]):this.get("data.acceptQuoteData").pushObject(this.get("newAcceptQuoteGridItem")),this.createNewGridItem()},clearText:function(){var e=this;e.set("data.country",void 0),e.set("data.productData",[]),e.set("data.firstName",void 0),e.set("data.lastName",void 0),e.set("data.email",void 0),e.set("data.phone",void 0),e.set("data.status",void 0),e.set("data.qutationTotalPrice",void 0),e.set("data.qutationQuantity",void 0),e.set("data.qutationServiceCost",void 0),e.set("data.qutationDeviceCost",void 0),e.set("data.acceptQuoteData",[]),e.set("data.isDisablePayNowButton",!0),e.set("data.isDisableCreateCustomerButton",!0),e.set("data.isDisableAcceptButton",!0),e.set("data.isDDLCommVisible",!1),e.set("data.isButtonVisible",!1),e.set("oQuote",void 0)},setQuotationStatus:function(e){var t=this;t.statuses.forEach(function(a){a.key===e&&t.set("data.status",a.value)})},setTermOfPayment:function(e){var t=this;t.invoicePeriod.forEach(function(a){a.key===e&&t.get("data").set("termOfPayment",a.value)})},setFollowUplanguage:function(e){var t=this,a=void 0;return t.languages.forEach(function(t){t.key===e&&(a=t.value)}),a},getCDMData:function(){var e=void 0,t=void 0,a=void 0,o=this,i=void 0;e=Komodo.Services.uiService.getController("application").get("_selectedCountryId"),t=Komodo.Services.localizationService.getCurrentLanguage(),i=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),o.getCountryDetails(e,t,i),Komodo.Services.cachedDataService.fetch("QuotationStatus",{domain:e,qualifier:t}).done(function(i){o.set("statuses",[]),o.set("statuses",i),Komodo.Services.cachedDataService.fetch("Language",{domain:e,qualifier:t}).done(function(i){o.set("communicationLanguages",[]),o.set("communicationLanguages",i),Komodo.Services.cachedDataService.fetch("InvoicePeriod",{domain:e,qualifier:t}).done(function(i){o.set("invoicePeriod",[]),o.set("invoicePeriod",i),Komodo.Services.cachedDataService.fetch("CommunicationLanguage",{domain:e,qualifier:t}).done(function(i){o.languages.clear(),$.each(i,function(e,t){o.languages.addObject(t)}),Komodo.Services.cachedDataService.fetch("Location",{domain:e,qualifier:t}).done(function(i){var r=JSON.parse(i);o.set("countries",[]),$.each(r.Countries.Country,function(e,t){o.get("countries").addObject(t)}),Komodo.Services.cachedDataService.fetch("Country").done(function(i){o.set("isoData",[]),o.set("isoData",i),o.isoData.forEach(function(t){e===t.key&&(a=t.key)}),void 0!==a&&o.get("data").set("country",a),Komodo.Services.cachedDataService.fetch("ContactDetailType").done(function(e){o.set("contactDetailTypes",[]),o.set("contactDetailTypes",e)}).fail(function(){Komodo.error("[ERROR] : could not retrieve Contact Detail Type domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve CountryISO domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve Location domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve CommunicationLanguage domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve InvoicePeriod domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve Language domain = "+e+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve QuotationStatus domain = "+e+"/ qualifier = "+t)})},getCountryDetails:function(e,t,a){var o=this;Komodo.Services.cachedDataService.fetch("CountryDetail",{domain:e,qualifier:t}).done(function(e){var t=JSON.parse(e);o.get("data").set("othCountryCode",void 0),o.get("mobileCode").clear(),$.each(t.Countries.Country,function(e,t){t.CanonicalValue=t.CanonicalValue+"-"+t.DialingCode,o.get("mobileCode").addObject(t)}),o.dialingCode=$.grep(o.get("mobileCode"),function(e){return e.CanonicalValue.indexOf(a)>=0});var i=void 0;o.dialingCode.length>0&&(i=o.dialingCode[0].DialingCode),void 0!==i&&o.set("data.othCountryCode",i)}).fail(function(){Komodo.error("[ERROR] : could not retrieve hierarchical CDM data for CountryDetail")})},getCurrency:function(){var e=this;Komodo.Services.featureToggleService.isEnabled("ZeroSaleDevice","IsZeroSaleDeviceAllowed").done(function(t){t&&e.getCachedDataService().fetch("CurrencyDetail").done(function(t){var a=JSON.parse(t),o=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription");$.each(a.Currencies.Currency,function(t,a){a.CurrencyDescription.includes(o)&&e.set("_currencyCode",a.CanonicalValue)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve static CDM data for Location")})}).fail(function(e){Komodo.Services.log("Error while checking permissions. Error Details:"+e)})},zeroDeviceSaleCreated:function(e){var t,a,o;that=this,t=Komodo.Models.NotifyZeroValueDeviceSaleCreated.create();var i=Komodo.canonicalFacadeFactory(t,["Country","QuotationUID","ListOfQuotationLineItem","SupervisorUsername"]);return listOfQuotationLineItem=Komodo.Models.ListOfQuotationLineItem.create(),$.each(that.data.productData,function(e,t){if("HARDWARE"==t.productCategory&&0==t.deviceCost){var a=Komodo.Models.QuotationLineItem.create();a.Quantity=t.productQuantity,a.Product=Komodo.Models.Product.create(),a.Product.Details.UID=t.productUid,a.Product.Details.Name=t.productName,listOfQuotationLineItem.QuotationLineItem.push(a)}}),i.set("QuotationUID",that.get("quotationUID")),i.set("Country",that.get("data").get("country")),i.set("SupervisorUsername",e),i.set("ListOfQuotationLineItem",listOfQuotationLineItem),a=new Komodo.Services.QuotationService,this.getNewProcessID(),a.createZeroValueDeviceSale(this,t).done(function(){Komodo.log("publish NotifyZeroValueDeviceSaleCreated() : NotifyZeroValueDeviceSaleCreated event has been published."),o="NotifyZeroValueDeviceSaleCreated event has been published"}).fail(function(e){Komodo.error(e),o="NotifyZeroValueDeviceSaleCreated event has failed"}),o},zeroDeviceSale:function(){var e,t,a;that=this;var o=[];e=Komodo.Models.PaymentCreated.create();var i=Komodo.canonicalFacadeFactory(e,["Country","QuotationID","Username","ListOfPayment"]),r=Komodo.Models.PaymentCaptured.create();return r.set("QuotationID",that.get("quotationUID")),o.push(r),i.set("Country",that.get("data").get("country")),i.set("ListOfPayment",o),i.set("Username",Komodo.Services.securityService.get("domainUserName").substring(3)),t=new Komodo.Services.QuotationService,this.getNewProcessID(),t.payZeroValueDevice(this,e).done(function(){Komodo.log("publishPaymentCreatedEvent() : PaymentCreatedEvent event has been published."),a="Payment Created event has been published"}).fail(function(e){Komodo.error(e),a="Payment Created event has failed"}),a},zeroSaleSupervisorApproval:function(e){var t=this;if(t.data.status==kl.value(t._localeBase+"accepted")){var e={QuoteNumber:t.get("quotationUID"),CustomerNumber:e.CustomerNumber,Country:t.get("data").get("country"),FirstName:t.data.firstName,LastName:t.data.lastName,Email:t.data.email,phone:t.data.phone};Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",e),Komodo.Services.uiService.getController("searchQuotation").customer=void 0}else{var a=Komodo.Application.ModalPaneController.create();t.registerModel("approveZeroSale",Komodo.Models.ZeroSaleSupervisorAthoriseModel),t.getCustomerInfomation(e.CustomerNumber);var o=!1;$.each(t.data.productData,function(e,t){if(t.deviceCost>0||t.subscriptionCost>0)return o=!0,!1}),t.registerValidator(t.get("approveZeroSale"),"supervisorUsername",{isRequired:!0,displayName:kl.value("locale.quotation:searchQuotation.supervisorName"),minLength:1,maxLength:50}),t.registerValidator(t.get("approveZeroSale"),"passCode",{isRequired:!0,displayName:kl.value("locale.quotation:searchQuotation.passCode"),minLength:1,maxLength:50}),a.popup(kl.value("locale.quotation:searchQuotation.zerosaleDevice"),"ZeroSaleSupervisorApproval",{context:{data:t.get("approveZeroSale"),validators:t.validators,authorise:function(){var i=this;i.data.set("disableAction",!0),t.validateUserClaim(Komodo.Services.uiService.getController("application").get("_selectedCountryId"),i.data.supervisorUsername,i.data.passCode,t.supervisorClaim).done(function(r){void 0!==r?(a.close(),t.set("data.isDisablePayNowButton",!0),t.zeroDeviceSaleCreated(i.data.supervisorUsername),o?(Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",e),Komodo.Services.uiService.getController("searchQuotation").customer=void 0):(t.zeroDeviceSale(),t.showReceiptPopup(e))):(i.data.set("disableAction",!1),alert(kl.value(t._localeBase+"accessDenied")))})},cancel:function(){a.close()}}})}},actions:{sendQuotation:function(){if(!this.data.communicationLanguage)return void Komodo.Controls.MessageBoxController.show(kl.value("locale.quotation:quotation.useCaseTitle"),kl.value("locale.quotation:searchQuotation.languageMissing"),[Komodo.Controls.MessageBoxOkButton],this,"OK","danger");!1!==this.canSubmitData(this.data,kl.value("locale.quotation:searchQuotation.title"))&&this.publishSendQuotationEvent()},saveQuote:function(){Komodo.Services.uiService.transitionTo("home")},printQuote:function(){this.publishPrintQuotationEvent()},payNow:function(){var e=this,t=!1;$.each(e.data.productData,function(e,a){if(void 0!==a.productCategory&&""!==a.productCategory&&"HARDWARE"!==a.productCategory)return t=!0,!1});var a;if(t){Komodo.Controls.MessageBoxController.show(kl.value("locale.quotation:searchQuotation.messgTitleSearchQuotation"),kl.value("locale.quotation:searchQuotation.messgSearchQuotation"),Komodo.Controls.MessageBoxYesNoButtons,this,"delItem1","").response=function(t){"yes"===t?Komodo.Services.uiService.showModalPopup(kl.value("locale.customerprofile.customerprofile:general.customerProfilePopup"),"searchPrompt",{closeCallback:function(){a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone},e.set("customer",a)},canUserClose:!0,shouldStartAndStopController:!1}):(a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone,Address:e.get("data.address"),VATNumber:e.get("data.VATNumber")},Ember.isEmpty(a.Address)||(e.getCountryCanonicalByText(),e.get("_countries").forEach(function(e){a.Address.country==e.CanonicalValue&&(a.Address.country=e.CanonicalKey,$.each($.makeArray(e.Provinces.Province),function(e,t){a.Address.province==t.CanonicalValue&&(a.Address.province=t.CanonicalKey)}))})),Komodo.Services.eventAggregator.publish("PublishCreateCustomer",a),Komodo.Services.uiService.getController("searchQuotation").customer=void 0)}}else Komodo.Services.featureToggleService.isEnabled("ZeroSaleDevice","IsZeroSaleDeviceAllowed").done(function(t){if(t){var o=!1;if($.each(e.data.productData,function(e,t){if("HARDWARE"==t.productCategory&&0==t.deviceCost)return o=!0,!1}),o&&e.data.status!==kl.value(e._localeBase+"accepted")){Komodo.Controls.MessageBoxController.show(kl.value("locale.quotation:searchQuotation.messgTitleSearchQuotation"),kl.value("locale.quotation:searchQuotation.messgSearchQuotation"),Komodo.Controls.MessageBoxYesNoButtons,this,"delItem1","").response=function(t){"yes"===t?Komodo.Services.uiService.showModalPopup(kl.value("locale.customerprofile.customerprofile:general.customerProfilePopup"),"searchPrompt",{closeCallback:function(){a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone},e.set("customer",a)},canUserClose:!0,shouldStartAndStopController:!1}):(a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone,Address:e.get("data.address"),VATNumber:e.get("data.VATNumber")},Ember.isEmpty(a.Address)||(e.getCountryCanonicalByText(),e.get("_countries").forEach(function(e){a.Address.country==e.CanonicalValue&&(a.Address.country=e.CanonicalKey,$.each($.makeArray(e.Provinces.Province),function(e,t){a.Address.province==t.CanonicalValue&&(a.Address.province=t.CanonicalKey)}))})),Komodo.Services.eventAggregator.publish("PublishCreateCustomer",a),Komodo.Services.uiService.getController("searchQuotation").customer=void 0)}}else a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone},Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",a),Komodo.Services.uiService.getController("searchQuotation").customer=void 0}else a={QuoteNumber:e.get("quotationUID"),CustomerNumber:e.data.CustomerNumber,Country:e.get("data").get("country"),FirstName:e.data.firstName,LastName:e.data.lastName,Email:e.data.email,phone:e.data.phone},Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",a),Komodo.Services.uiService.getController("searchQuotation").customer=void 0}).fail(function(e){Komodo.Services.log("Error while checking permissions. Error Details:"+e)})},createCustomer:function(){var e=this,t={QuoteNumber:void 0,Country:this.get("data").get("country"),FirstName:this.data.firstName,LastName:this.data.lastName,Email:this.data.email,phone:this.data.phone,leadUid:this.leadUid,Address:this.get("data.address"),VATNumber:this.get("data.VATNumber")};Ember.isEmpty(t.Address)||(e.getCountryCanonicalByText(),e.get("_countries").forEach(function(e){t.Address.country==e.CanonicalValue&&(t.Address.country=e.CanonicalKey,$.each($.makeArray(e.Provinces.Province),function(e,a){t.Address.province==a.CanonicalValue&&(t.Address.province=a.CanonicalKey)}))})),Komodo.Services.eventAggregator.publish("PublishCreateCustomer",t)},acceptQuote:function(){this.set("data.isDisableAcceptButton",!0),this.publishAcceptQuoteEvent()}},getCountryCanonicalByText:function(){var e=this;e.getCachedDataService().fetch("Location").done(function(t){var a=JSON.parse(t);e.set("_countries",$.makeArray(a.Countries.Country))}).fail(function(){Komodo.error("[ERROR] : could not retrieve static CDM data for Location")})},getCachedDataService:function(){return this.get("_cachedDataService")},getProvinceByText:function(){var e,t=this,a=Ember.A(),o=Ember.A();t.set("_addressTypes",a),t.set("_provinces",o),t.getCachedDataService().fetch("Location").done(function(a){e=JSON.parse(a),t.set("_countries",$.makeArray(e.Countries.Country)),Ember.run(function(){$.each($.makeArray(e.Countries.Country),function(e,a){a.CanonicalKey===Komodo.Services.uiService.getController("application").get("_selectedCountryId")&&void 0!==a.Provinces&&t.set("_provinces",a.Provinces.Province)})})}).fail(function(){Komodo.error("[ERROR] : could not retrieve static CDM data for Location")})},getCachedDataService:function(){return this.get("_cachedDataService")},publishRetrieveQuotationsEvent:function(){var e,t,a=this;e=Komodo.Models.RetrieveQuotations.create(),a.leadUid=void 0;var o=Komodo.canonicalFacadeFactory(e,["Country","QuotationUID"]);void 0===a.get("data").get("country")&&a.get("data").set("country",Komodo.Services.uiService.getController("application").get("_selectedCountryId")),void 0!=a.get("data").get("country")&&void 0!=a.get("quotationUID")&&(o.set("Country",a.get("data").get("country")),o.set("QuotationUID",a.get("quotationUID")),a.getNewProcessID(),t=new Komodo.Services.QuotationService,a.showBusyIndicator(),t.SearchQuotation(a,e).done(function(){Komodo.log("publishRetrieveQuotationsEvent() : Search Quotation event has been published.")}).fail(function(e){Komodo.error(e)}),a.clearText())},publishAcceptQuoteEvent:function(){var e,t,a;e=Komodo.Models.QuotationAccepted.create();var o=Komodo.canonicalFacadeFactory(e,["Country","Quotation"]);return o.set("Country","Namibia"),o.set("Quotation",this.oQuote),t=new Komodo.Services.QuotationService,this.getNewProcessID(),t.acceptQuotation(this,e).done(function(){Komodo.log("publishAcceptQuotationEvent() : Accept Quotation event has been published."),a="Accept Quotation event has been published"}).fail(function(e){Komodo.error(e),a="Accept Quotation event has failed"}),a},messageQuotationStatusUpdatedReceived:function(e){var t,a=this;a.data.acceptQuoteData.clear();var o=Komodo.canonicalFacadeFactory(e.ResponseMessage.Payload,["ListOfProduct_Product","Status"]),i=o.get("ListOfProduct_Product"),r=o.get("Status");t=a.getArrayItem(i),t.length>0&&(a.createNewGridItem(),t.forEach(function(e){void 0!==e.Details.Name&&a.newAcceptQuoteGridItem.set("Model",e.Details.Name),void 0!==e.Details.ProductFeatures&&a.newAcceptQuoteGridItem.set("QuantityRequested",e.Details.ProductFeatures[0].Description),void 0!==e.Details.ProductFeatures&&a.newAcceptQuoteGridItem.set("QuantityAvailable",e.Details.ProductFeatures[1].Description),void 0!==e.Details.Description&&a.newAcceptQuoteGridItem.set("Description",e.Details.Description),a.addQuoteGridRow()})),a.set("data.AcceptanceStatus",r),r==kl.value(a._localeBase+"accepted")?(Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"acceptQuote"),"<strong>"+kl.value(this._localeBase+"acceptquoteSuccessMsg")+"</strong>"),a.set("data.status",r),a.quoteStatusCheck(kl.value(a._localeBase+"accepted"))):Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"acceptQuote"),"<strong>"+kl.value(this._localeBase+"acceptquoteFailMsg")+"</strong>")},communicationMethods:[{Key:"1",Value:"Email"},{Key:"2",Value:"SMS"}],publishSendQuotationEvent:function(){var e,t,a=this;e=Komodo.Models.SendQuotation.create();var o=Komodo.canonicalFacadeFactory(e,["Country","QuotationUID","CommunicationType","CommunicationLanguage","CommunicationValue"]);o.set("Country",a.get("data").get("country")),o.set("QuotationUID",a.get("quotationUID")),o.set("CommunicationType",a.get("data.communicationType")),o.set("CommunicationLanguage",a.get("data.communicationLanguage")),"Email"===a.get("data.communicationType")&&o.set("CommunicationValue",a.data.othEmail),"SMS"===a.get("data.communicationType")&&o.set("CommunicationValue",a.data.othCountryCode+a.data.othPhone),t=new Komodo.Services.QuotationService,a.getNewProcessID(),t.SendQuotation(a,e).done(function(){Komodo.log("publishSendQuotationEvent() : Send Quotation event has been published."),Komodo.Controls.MessageBoxController.show(kl.value(a._localeBase+"sendQuotation"),kl.value(a._localeBase+"quoteSent")+a.get("data.communicationType"))}).fail(function(e){Komodo.error(e)})},publishPrintQuotationEvent:function(){var e,t,a=this;e=Komodo.Models.SendQuotation.create();var o=Komodo.canonicalFacadeFactory(e,["Country","QuotationUID","CommunicationType","CommunicationLanguage"]);o.set("Country",a.get("data").get("country")),o.set("QuotationUID",a.get("quotationUID")),o.set("CommunicationType","Print"),o.set("CommunicationLanguage",a.get("data.communicationLanguage")),t=new Komodo.Services.QuotationService,a.getNewProcessID(),t.SendQuotation(a,e).done(function(){Komodo.log("publishPrintQuotationEvent() : Send Quotation event has been published."),a.showBusyIndicator()}).fail(function(e){Komodo.error(e)})},messageQuotationSentReceived:function(e){if(this.hideBusyIndicator(),void 0!=e.ResponseMessage.Payload.QuotationURL){var t=window.open(e.ResponseMessage.Payload.QuotationURL,"_blank");t.focus(),setTimeout(function(){t.close()},1e4)}},messageSendQuotationDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[RetrieveQuotationController.messageSendQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"title"),kl.value(this.mainLocaleBase+"messageSendQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5277673","danger")},messageRetrieveQuotationsDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[RetrieveQuotationController.messageRetrieveQuotationsDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"title"),kl.value(this.mainLocaleBase+"messageRetrieveQuotationsDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5077673","danger")},messageAcceptQuotationDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[RetrieveQuotationController.messageAcceptQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"title"),kl.value(this.mainLocaleBase+"messageAcceptQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5177673","danger")},messageFault:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[RetrieveQuotationController.messageSendQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"title"),kl.value(this.mainLocaleBase+"messageSendQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5277673","danger")},messageReceived:function(){this.hideBusyIndicator()},messageDeliveryFailure:function(e){this.hideBusyIndicator(),Komodo.UI.warn("[RetrieveQuotationController.messageSendQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"title"),kl.value(this.mainLocaleBase+"messageSendQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5277673","danger")},messageQuotationsRetrievedReceived:function(e){this.hideBusyIndicator();var t,a=(Komodo.Models.Quotation.create(),this);if(Komodo.Services.featureToggleService.isEnabled("CreateQuotation","ToggleVATLabel").done(function(e){switch(e){case!0:t=kl.value(a._localeBase+"vat");break;default:t=kl.value(a._localeBase+"tax")}}).fail(function(e){Komodo.Services.error("Error while checking feature toggle. Error Details:"+e)}),void 0!=e.ResponseMessage.Payload.ListOfQuotation.Quotation.ListOfQuotationLineItem){a.get("data").set("isDisableAcceptButton",!1),a.get("data").set("country",e.ResponseMessage.Payload.Country),a.get("data").set("communicationType","Email"),void 0!==e.ResponseMessage.Payload.Lead&&void 0!=e.ResponseMessage.Payload.Lead.Language?a.set("data.communicationLanguage",e.ResponseMessage.Payload.Lead.Language):a.set("data.communicationLanguage","1");var o=Komodo.canonicalFacadeFactory(e.ResponseMessage.Payload,["ListOfQuotation_Quotation_ListOfQuotationLineItem_QuotationLineItem","ListOfQuotation_Quotation_UID","ListOfQuotation_Quotation_CreateDate","ListOfQuotation_Quotation_ExpiryDate","ListOfQuotation_Quotation_AffectedAgreementIdentifier","ListOfQuotation_Quotation_LeadUID","ListOfQuotation_Quotation_TotalPrice","ListOfQuotation_Quotation_TotalPrice_ListOfTax","ListOfQuotation_Quotation_Status","ListOfQuotation_Quotation_TermOfPayment","ListOfQuotation_Quotation_StatusReason","ListOfQuotation_Quotation_FollowupFlag","Lead_PersonalDetail_FirstName","Lead_PersonalDetail_Surname","Lead_ListOfPhoneNumber_PhoneNumber_Number","Lead_ListOfPhoneNumber_PhoneNumber_Code","Lead_ListOfEmail_Email_Value","VATNumber","ListOfAddress"]);this.set("oQuote",e.ResponseMessage.Payload.ListOfQuotation.Quotation);var i=a.getArrayItem(o.get("ListOfQuotation_Quotation_ListOfQuotationLineItem_QuotationLineItem"));if(i.length>0){a.data.productData.clear(),a.createNewGridItem();var r=0,n=0,s=0,d=0,c=0,l=0;a.set("data.QuotationUID",o.get("ListOfQuotation_Quotation_UID")),"true"===o.get("ListOfQuotation_Quotation_FollowupFlag")?a.set("data.communicationFollowup",kl.value(this._localeBase+"yes")+","+a.setFollowUplanguage(a.get("data").get("communicationLanguage"))):a.set("data.communicationFollowup",kl.value(this._localeBase+"no")),void 0!==o.get("ListOfQuotation_Quotation_LeadUID")&&a.set("leadUid",o.get("ListOfQuotation_Quotation_LeadUID")),i.forEach(function(e){if(void 0!==e&&void 0!==e.Product){a.newProductGridItem.set("productUid",e.Product.Details.UID),a.newProductGridItem.set("productName",e.Product.Details.Name),a.newProductGridItem.set("productQuantity",e.Quantity),a.newProductGridItem.set("productCategory",e.Product.Details.Type),r+=parseInt(e.Quantity,10);var t=0,o=0,i=0;switch(e.Product.Details.Type){case"HARDWARE":void 0!==e.Product.Details.Price&&(a.newProductGridItem.set("deviceCost",e.QuotedUnitPrice.ValueWithoutTax),a.newProductGridItem.set("subscriptionCost",void 0),n=parseFloat(n)+parseFloat(e.QuotedUnitPrice.ValueWithoutTax),void 0!==e.QuotedUnitPrice.ListOfTax&&(a.getArrayItem(e.QuotedUnitPrice.ListOfTax).forEach(function(e){"LEVY"!==e.Type&&(t=parseFloat(t)+parseFloat(e.Amount))}),0===t?t="":(a.newProductGridItem.set("totalTax",parseFloat(t).toFixed(2)),d=parseFloat(d)+parseFloat(t))),a.get("isLevyApplicable")&&$.grep(e.QuotedUnitPrice.ListOfTax,function(e){return"LEVY"===e.Type}).length>0&&0!==(i=parseFloat($.grep(e.QuotedUnitPrice.ListOfTax,function(e){return"LEVY"===e.Type})[0].Amount).toFixed(2))&&(a.set("newProductGridItem.totalLEVY",parseFloat(i).toFixed(2)),l=parseFloat(l+i).toFixed(2)));break;case"ADDON":case"INSURANCE":case"ACCESS":case"PRINCIPAL":case"SERVICE":void 0!==e.Product.Details.Price&&(a.newProductGridItem.set("subscriptionCost",e.QuotedUnitPrice.ValueWithoutTax),a.newProductGridItem.set("deviceCost",void 0),s=parseFloat(s)+parseFloat(e.QuotedUnitPrice.ValueWithoutTax),void 0!==e.QuotedUnitPrice.ListOfTax&&(a.get("twoTaxTier")?t=parseFloat(t)+parseFloat(e.QuotedUnitPrice.ListOfTax[1].Amount):a.getArrayItem(e.QuotedUnitPrice.ListOfTax).forEach(function(e){"LEVY"!==e.Type&&(t=parseFloat(t)+parseFloat(e.Amount))}),0===t?t="":(a.newProductGridItem.set("totalTax",parseFloat(t).toFixed(2)),d=parseFloat(d)+parseFloat(t)),a.get("twoTaxTier")&&(o=parseFloat(o)+parseFloat(e.QuotedUnitPrice.ListOfTax[0].Amount),0===o?o="":(a.newProductGridItem.set("totalCST",parseFloat(o).toFixed(2)),c=parseFloat(c)+parseFloat(o))),a.get("isLevyApplicable")&&"PRINCIPAL"===e.Product.Details.Type&&(i=parseFloat(i)+parseFloat(e.QuotedUnitPrice.ListOfTax[1].Amount),0===i?i="":(a.newProductGridItem.set("totalLEVY",parseFloat(i).toFixed(2)),l=parseFloat(l)+parseFloat(i)))))}void 0!==e.TotalPrice&&a.newProductGridItem.set("totalPrice",parseFloat(e.TotalPrice.Value).toFixed(2)),a.addGridRow()}}),d=d>0?parseFloat(d).toFixed(2):"",c=c>0?parseFloat(c).toFixed(2):"",l=l>0?parseFloat(l).toFixed(2):"",s=s>0?parseFloat(s).toFixed(2):"",n=n>0?parseFloat(n).toFixed(2):"",a.newProductGridItem.set("productUid",void 0),a.newProductGridItem.set("productName",t+" "+kl.value(this._localeBase+"total")),a.newProductGridItem.set("productQuantity",void 0),a.newProductGridItem.set("productCategory",void 0),a.newProductGridItem.set("subscriptionCost",void 0),a.newProductGridItem.set("deviceCost",void 0),a.newProductGridItem.set("totalTax",d),a.get("twoTaxTier")&&a.newProductGridItem.set("totalCST",c),a.get("isLevyApplicable")&&a.newProductGridItem.set("totalLEVY",l),a.newProductGridItem.set("totalPrice",void 0),a.addGridRow(),a.set("data.qutationQuantity",r),a.set("data.qutationServiceCost",parseFloat(s).toFixed(2)),a.set("data.qutationDeviceCost",parseFloat(n).toFixed(2)),a.set("data.qutationTotalPrice",a.getArrayItem(e.ResponseMessage.Payload.ListOfQuotation.Quotation)[0].TotalPrice.Value),a.newProductGridItem.set("productUid",void 0),a.newProductGridItem.set("productName",kl.value(this._localeBase+"total")+"("+a.getArrayItem(e.ResponseMessage.Payload.ListOfQuotation.Quotation)[0].TotalPrice.CurrencyCode+")"),a.newProductGridItem.set("productQuantity",void 0),a.newProductGridItem.set("productCategory",void 0),a.newProductGridItem.set("subscriptionCost",s),a.newProductGridItem.set("deviceCost",n),a.newProductGridItem.set("totalTax",void 0),a.get("twoTaxTier")&&a.newProductGridItem.set("totalCST",void 0),a.newProductGridItem.set("totalPrice",a.getArrayItem(e.ResponseMessage.Payload.ListOfQuotation.Quotation)[0].TotalPrice.Value),a.get("isLevyApplicable")&&a.newProductGridItem.set("totalPrice",a.getArrayItem(e.ResponseMessage.Payload.ListOfQuotation.Quotation)[0].TotalPrice.Value),a.addGridRow(),void 0!==o.get("Lead_PersonalDetail_FirstName")&&a.set("data.firstName",o.get("Lead_PersonalDetail_FirstName"));var u="";if(void 0!==o.get("Lead_ListOfPhoneNumber_PhoneNumber_Code")&&(u=u+"+"+o.get("Lead_ListOfPhoneNumber_PhoneNumber_Code")),void 0!==o.get("Lead_ListOfPhoneNumber_PhoneNumber_Number")&&(u=u+" "+o.get("Lead_ListOfPhoneNumber_PhoneNumber_Number")),a.set("data.phone",u),a.set("data.lastName",o.get("Lead_PersonalDetail_Surname")),a.set("data.email",o.get("Lead_ListOfEmail_Email_Value")),a.set("data.othEmail",o.get("Lead_ListOfEmail_Email_Value")),a.setQuotationStatus(o.get("ListOfQuotation_Quotation_Status")),a.setTermOfPayment(o.get("ListOfQuotation_Quotation_TermOfPayment")),a.set("hideLabel",!0),void 0!==a.get("data.status")&&a.quoteStatusCheck(a.get("data.status")),void 0!==o.get("VATNumber")&&(a.set("data.VATNumber",o.get("VATNumber")),void 0!==o.get("ListOfAddress"))){var h=o.get("ListOfAddress.Address");a.set("data.address",Komodo.UI.addressFunctions.payloadToAddressModel(h)),a.set("data.street",h.Street),h.Type===Komodo.CanonicalValues.AddressTypes.Physical?a.set("data.isAddressPhysical",!0):a.set("data.isAddressPhysical",!1)}}}else Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"noQuoteFound"),kl.value(this._localeBase+"noQuoteFoundmessage")+a.get("quotationUID"),Komodo.Controls.MessageBoxOkButton,a,"id5446883","danger")},messageFailureMessageEventReceived:function(e){this.hideBusyIndicator(),Komodo.Controls.MessageBoxController.show(e.ResponseMessage.Payload.ListOfErrorDetails.ErrorType,e.ResponseMessage.Payload.ListOfErrorDetails.ErrorDescription,Komodo.Controls.MessageBoxOkButton,this,"id5446883","danger")},hideQuotationEditButton:function(){this.data.productData.length>0?this.set("data.disableEditButton",!1):this.set("data.disableEditButton",!0)}.observes("data.productData"),observeQuotationNumber:function(){this.set("hideLabel",!1)}.observes("data.QuotationUID"),methodOfCommunicationChanged:function(){if(void 0!==this.data.communicationType)switch(this.data.communicationType){case"Email":this.set("data.othPhone",void 0),this.set("data.othCountryCode",void 0),this.set("showEmail",!0),this.set("showSms",!1),this.get("data.email")&&this.set("data.othEmail",this.get("data.email")),this.get("data.othEmail")&&this.get("data.othEmail").length>0?this.set("data.isButtonDisabled",!1):this.set("data.isButtonDisabled",!0);break;case"SMS":this.set("data.othEmail",void 0),this.set("showSms",!0),this.set("showEmail",!1),this.get("data.phone")&&(this.set("data.othCountryCode",this.get("data.phone").split(" ")[0].replace("+","",-1)),this.set("data.othPhone",this.get("data.phone").split(" ")[1])),this.get("data.othPhone")&&this.get("data.othCountryCode")&&this.get("data.othPhone").length>0&&this.get("data.othCountryCode").length>0?this.set("data.isButtonDisabled",!1):this.set("data.isButtonDisabled",!0)}else this.set("data.isButtonDisabled",!0)}.observes("data.communicationType"),otherMobileNumberChanged:function(){switch(this.get("data.othPhone")){case void 0:case"":case null:this.set("data.isButtonDisabled",!0);break;default:
switch(this.get("data.othCountryCode")){case void 0:case"":case null:this.set("data.isButtonDisabled",!0);break;default:this.data.communicationType&&this.data.communicationLanguage&&this.data.othPhone.length<=10&&this.data.othPhone.length>=7&&this.data.othCountryCode.length<=4&&this.data.othCountryCode.length>=1?this.set("data.isButtonDisabled",!1):this.set("data.isButtonDisabled",!0)}}}.observes("data.othPhone","data.othCountryCode"),otherEmailChanged:function(){switch(this.get("data.othEmail")){case void 0:case"":case null:this.set("data.isButtonDisabled",!0);break;default:this.data.communicationType&&this.data.communicationLanguage&&this.get("validators.othEmailValidator.isValid")&&this.data.othEmail.length>=6&&this.data.othEmail.length<=254?this.set("data.isButtonDisabled",!1):this.set("data.isButtonDisabled",!0)}}.observes("data.othEmail"),validateUserClaim:function(e,t,a,o){var i=this,r=$.Deferred();return i.getSecurityService().authenticate(e,t,a).done(function(e){var a=void 0;$(e.permissions).each(function(r,n){n===o&&i.userName()!==t.substring(3)&&(a=e.sessionToken)}),r.resolve(a)}).fail(function(e){r.resolve(void 0)}),r},userName:function(){return Komodo.Services.securityService.get("domainUserName").substring(3)},getCustomerInfomation:function(e){var t=this;Komodo.Services.queryService.getJSON("/CustomerProfile/?customerId="+e,{async:!0}).done(function(e){e&&e.CustomerDetail&&t.data.set("CustomerInformation",e.CustomerDetail.PersonalDetail)}).error(function(e){var t=JSON.stringify(e);Komodo.log("[ERROR] : retrieveCustomer ajax call failed. Error: "+t)})},getCachePrinter:function(){var e=this;this.getCacheRepository().fetch(e.userName()+"PrinterDetails").done(function(t){t&&t.data&&(e.set("cachePrinter",t.data.Printer),e.set("cacheSpeedPoint",t.data.Speedpoint))})},printReceipt:function(e){var t=this,a={async:!1,type:"POST",cache:!1,url:KomodoConfiguration.localStorageApiUrl+"/printReceipt",dataType:"json",contentType:"application/json",data:JSON.stringify(e)};jQuery.ajax(a).done(function(){}).fail(function(e){var a=kl.value(t._localeBase+"shift.technicalError");e&&(void 0!==e.responseJSON?a=e.responseJSON.message:void 0!==e.statusText&&""!==e.statusText&&(a=e.statusText)),alert(a)})},emailReceipt:function(e,t){var a=this;if(e&&e.receiptData&&e.receiptData.length>=1){var o=[];$(e.receiptData).each(function(e,t){var i=Komodo.Models.PaymentCaptured.create();i.set("Country",a.get("data").get("country")),i.set("BusinessUnit",t.BusinessUnit),i.set("ReceiptNumber",t.ReceiptNumber),i.set("ReceiptDate",t.ReceiptDate),i.set("MethodOfPayment",t.MethodOfPayment),i.set("CustomerID",t.CustomerID),i.set("CustomerName",t.CustomerName),i.set("SmartcardNumber",t.SmartcardNumber),i.set("CellphoneNumber",t.CellNumber),i.set("Currency",t.Currency);var r=Komodo.Models.Price.create();r.set("CurrencyCode",t.Currency),r.set("Value",t.TotalAmountInclTax),r.set("ValueWithoutTax",t.TotalAmountExclTax),i.set("Amount",r);var n=Komodo.Models.Price.create();n.set("CurrencyCode",t.Currency),n.set("Value",t.Amount),i.set("AmountTendered",n);var s=Komodo.Models.Price.create();s.set("CurrencyCode",t.Currency),s.set("Value",t.Change),i.set("ChangeOwed",s),i.set("CashierName",t.CashierName),i.set("QuotationID",t.QuotationID),i.set("IsCashSale",t.IsCashSale),i.set("IsCancelled",t.IsCancelled),i.set("IsReprint",t.IsReprint),i.set("IsRefund",t.IsRefund),i.set("EmailReceiptDate",new moment(new Date).format("YYYYMMDD_hhmmss")),o.push(i)});var i=Ember.Object.create({ListOfPayment:o}),r=void 0;e.receiptData.length>1?r=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_SINGLE"):e.email.length>0?(r=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_ALTERNATE"),e.email.forEach(function(t){t.Value===e.selectedEmail&&t.IsPrimary&&(r=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_PRIMARY"))})):r=GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_EMAILTYPE_CAPTURED"),a.publishOutbondNotificationEvent({Payload:i},e.selectedEmail,r,t)}},publishOutbondNotificationEvent:function(e,t,a,o){var i=this,r=Komodo.Models.SendOutboundNotification.create(),n=Komodo.canonicalFacadeFactory(r,["Country","ListOfOutboundNotification"]);n.set("Country",i.get("country"));var s=Komodo.Models.ListOfOutboundNotification.create(),d=Komodo.canonicalFacadeFactory(s,["OutboundNotification"]),c=Komodo.Models.OutboundNotification.create(),l=Komodo.canonicalFacadeFactory(c,["BusinessEntity","BusinessUnit","Country","TemplateName","ListOfRecipient","ListOfAttachment","MessageData"]);l.set("BusinessEntity",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_APPLICATION")),l.set("BusinessUnit",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_BUSINESSUNIT")),l.set("Country",i.get("loggedInCountryName")),l.set("TemplateName",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_TEMPLATENAME")),l.set("MessageData",e);var u=Komodo.Models.ListOfRecipients.create(),h=Komodo.canonicalFacadeFactory(u,["Recipient"]),p=Komodo.Models.Recipient.create(),m=Komodo.canonicalFacadeFactory(p,["CommunicationType","Language","MessageUID","From","To","ScheduledDate","ExpiryDate","ListOfContext"]);m.set("Language",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_LANGUAGE")),m.set("CommunicationType",GetOLTConstants("OLTEmailReceiptConstants","EMAIL_RECEIPT_MF_COMMUNICATIONTYPE"));var f=Komodo.Models.ListOfContext.create(),g=Komodo.canonicalFacadeFactory(f,["Context"]),v=Komodo.Models.Context.create(),b=Komodo.canonicalFacadeFactory(v,["Value","ContextValueUri"]);return b.set("Value","Outcome"),b.set("ContextValueUri",a),g.set("Context",v),m.set("ListOfContext",f),m.set("To",t),h.set("Recipient",p),l.set("ListOfRecipient",u),d.set("OutboundNotification",c),n.set("ListOfOutboundNotification",s),Komodo.Services.OLTService.publishOLTEvent(i,r,"SendReceiptNotificationEvent","v1",!0).done(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has been published."),Komodo.Controls.MessageBoxController.show(kl.value(i._localeBase+"emailReceiptTitle"),kl.value(i._localeBase+"emailSentSuccessMsg"),Komodo.Controls.MessageBoxOkButton,i,"id5446673","success").response=function(e){i.showReceiptPopup(o)}}).fail(function(e){Komodo.log("publishsendOutbondNotificationEvent() : Send Receipt NotificationEvent event has failed."),Komodo.Controls.MessageBoxController.show(kl.value(i._localeBase+"emailReceiptTitle"),kl.value(i._localeBase+"report.emailSentFailureMsg"),Komodo.Controls.MessageBoxOkButton,i,"id5446673","danger").response=function(e){i.showReceiptPopup(o)}}),!0},getCachePrinter:function(){var e=this;this.getCacheRepository().fetch(e.userName()+"PrinterDetails").done(function(t){t&&t.data&&(e.set("cachePrinter",t.data.Printer),e.set("cacheSpeedPoint",t.data.Speedpoint))})},getCacheRepository:function(){return this.get("_cacheRepository")},updateCachePrinter:function(e,t){var a=this,o=!1;if(t&&(delete t.layout,e===a.printerKey&&(void 0===a.cachePrinter||t.key!==a.cachePrinter.key&&t.ipAddress!==a.cachePrinter.ipAddress)&&(o=!0,a.set("cachePrinter",t)),e===a.speedpointKey&&(void 0===a.cacheSpeedPoint||t.key!==a.cacheSpeedPoint.key&&t.ipAddress!==a.cacheSpeedPoint.ipAddress)&&(o=!0,a.set("cacheSpeedPoint",t)),o)){var i={Printer:a.cachePrinter,Speedpoint:a.cacheSpeedPoint};a.getCacheRepository().save(a.userName()+"PrinterDetails",i)}},showReceiptPopup:function(e){var t=this,a=(t.get("data"),[]),o=void 0,i=void 0;if(void 0!==e){a=[];var r=void 0;a=t.get("getprinters");var n=void 0,s=[];null==a&&void 0==a||($.each(a,function(e,t){n={key:t.PrinterName,value:t.PrinterName,PrinterType:t.PrinterType,IPAddress:t.IPAddress,layout:unescape(t.DefaultLayout)},s.pushObject(n),r=n}),s=s.sort(function(e,t){return e.key===t.key?0:+(e.key>t.key)||-1})),o=Komodo.Models.OnlineTill.PrintReceiptModel.create(),o.printers=s,o.selectedPrinter=r,o.receiptData=t.populateReceiptModel(e),o.displayEmailReceiptOption=!1,t.retrieveCustomerEmails(e.CustomerNumber);var d=t.get("customerEmails");o.displayEmailSelectList=void 0!=d,i=Komodo.Application.ModalPaneController.create(),i.popup(kl.value(t._localeBase+"printReceiptTitle"),"printReceipt",{context:{data:o,previewReceipt:function(){var e=window.open();e.document.write($("#printPreview").html()),e.print(),e.close()},printReceipt:function(){var e=this,a=$("#printPreview").children("table"),o="";$(a).each(function(e,t){o+=$(t).html()}),t.printReceipt({receiptText:o,printer:e.data.printer.key,printerType:e.data.printer.PrinterType,ipAddress:e.data.printer.IPAddress}),t.updateCachePrinter(t.printerKey,e.data.printer)},emailReceiptconfirm:function(){i.close(),o.email.length>0&&(o.selectedEmail=o.email[0]),t.displayEmailConfirmation(o,e)},cancel:function(){i.close()}},closeCallback:function(){var t=!1;if($.each(that.data.productData,function(e,a){if(a.deviceCost>0||a.subscriptionCost>0)return t=!0,!1}),t){var a={QuoteNumber:that.get("quotationUID"),CustomerNumber:e.CustomerNumber,Country:that.get("data").get("country"),FirstName:that.data.firstName,LastName:that.data.lastName,Email:that.data.email,phone:that.data.phone};Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",a),Komodo.Services.uiService.getController("searchQuotation").customer=void 0}}})}},displayEmailConfirmation:function(e,t){var a=this,o=Komodo.Application.ModalPaneController.create();if(e.displayEmailSelectList){a.retrieveCustomerEmails(e.receiptData[0].CustomerID);var i=a.get("customerEmails");void 0!=i&&(e.email=i)}a.registerValidator(e,"selectedEmail",{isRequired:!0,type:"string",regExPattern:Komodo.UI.Validators.RegExPatterns.Email,displayName:kl.value(a._localeBase+"reportEmail")}),o.popup(kl.value(a._localeBase+"emailReceiptTitle"),"emailReceiptConfirm",{context:{data:e,validators:a.validators,emailReceipt:function(){if(!1!==a.canSubmitData(e,kl.value(a._localeBase+"emailReceiptTitle"),{showInModal:!1})){var i=$("#printPreview").children("table"),r="";$(i).each(function(e,t){r+=$(t).html()}),o.close(),a.emailReceipt(e,t)}},cancel:function(){o.close(),a.showReceiptPopup(t)}}})},retrieveCustomerEmails:function(e){var t=this,a=e;t.get("processId")||t.startNewProcess(),Komodo.Services.queryService.getJSON("/CustomerProfile/?customerId="+e,{async:!1}).done(function(e){e&&e.CustomerDetail&&(void 0!==e.CustomerDetail.SubscriberSystemUID&&e.CustomerDetail.SubscriberSystemUID.SubscriberSystem.length>0&&(e.CustomerDetail.SubscriberSystemUID.SubscriberSystem[0].UID=a),e.CustomerDetail.SubscriberSystemUID.SubscriberSystem[0].UID.toString()===a&&e.CustomerDetail.ListOfEmail&&e.CustomerDetail.ListOfEmail.Email&&t.set("customerEmails",e.CustomerDetail.ListOfEmail.Email))}).error(function(e){var t=JSON.stringify(e);Komodo.log("[ERROR] : retrieveCustomer ajax call failed. Error: "+t)})},populateReceiptModel:function(e){var t=this,a=(t.get("data"),[]);if(void 0!==e&&null!==e){var o=Komodo.Models.OnlineTill.ReceiptModel.create();o.IsOffline=0,o.ReceiptDate=(new moment).format("DD/MM/YYYY h:mm"),o.CashierName=t.userName().toUpperCase(),o.QuotationID=void 0!=e.QuoteNumber?e.QuoteNumber:"",o.MethodOfPayment="N/A",o.IsCashSale=e.IsCashSale,o.IsSplit=e.IsSplit,o.Amount=parseFloat(0),o.TotalAmountExclTax="0.00",o.TotalAmountInclTax="0.00";var i=0;o.Tax=parseFloat(i);var r=this.get("_currencyCode");if(o.Currency=r,o.ExchangeRate=0,void 0!=e.CustomerNumber){var n=t.data.get("CustomerInformation");o.CustomerName=void 0!=n?(void 0!=n.FirstName?n.FirstName+" ":"")+n.Surname:"",o.ReceiptNumber=e.QuoteNumber,o.CustomerID=e.CustomerNumber,o.Change="0.00"}else o.CustomerName="",o.ReceiptNumber=e.QuotationUID;if(void 0!==e.productData){i=0;var s=0,d=[],c="";$(e.productData).each(function(e,t){"0.00"!==t.totalPrice&&"0"!==t.totalPrice||t.productName==="Total("+r+")"||(i+=parseFloat(t.taxAmount),s+=parseFloat(t.baseAmount),d.push(t.productName),void 0!==t.startDate&&void 0!==t.endDate&&(c=t.startDate.substring(0,10)+" - "+t.endDate.substring(0,10)))}),o.Hardware=d.join(",</br>"),o.Tax="0.00",o.ViewingPeriod=c}a.push(o)}return a},otherMethodOfCommunication:void 0,showEmail:!1,showSms:!1,otherComm:!1,communicationLanguages:[],customerExists:!1,normalComm:!0,hideButton:"false",hideLabel:!1,statuses:[],domainCountryCode:void 0,allcountries:[],languages:[],invoicePeriod:[],mobileCode:[],contactDetailTypes:[],viewPayNowButtons:!0,viewOnlyPage:!1,onSearchQuotation:!1,isLanguagesDisabled:!1,twoTaxTier:!1}),Komodo.Application.CreateQuotationController=Komodo.UI.Controller.extend({_localeBase:"locale.quotation:createQuotation.",disableViewingPlatformData:!1,addressInformation:[],init:function(){Komodo.log("Constructing Quotation controller"),this.set("processVersion","v1.1"),this.set("processName","Create Quotation process"),this._super()},start:function(){var e=this;e.createNewGridItem(),e.set("data",Komodo.Models.QuotationModule.CreateQuotationModel.create()),e.set("productHardware",[]),e.set("productService",[]),e.set("data.isVATChecked",!1),e.registerValidations(),e.get("data").set("chargePeriodValue","1"),e.get("data").set("stsPeriodValue","-1"),e.isSTSEnabled()?e.set("visibleSTSPeriodSelect",!0):e.set("visibleSTSPeriodSelect",!1),e.get("data").set("chargePeriod","1"),e.getCDMData(),e.set("disableQuotationButton",!1),e._super(),e._isStarting=!1,e.set("taxLabel",void 0),e.set("CSTLabel",void 0),e.set("LEVYLabel",void 0),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","ToggleVATLabel").done(function(t){switch(t){case!0:e.set("taxLabel",kl.value(e._localeBase+"vat"));break;default:e.set("taxLabel",kl.value(e._localeBase+"tax"))}}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","DoNotAllowDstvGotvSplit").done(function(t){switch(t){case!0:e.set("disableViewingPlatformData",!1);break;default:e.set("disableViewingPlatformData",!0),e.set("isNam",!0)}}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","ToggleVATClaim").done(function(t){e.set("data.acceptVatDetails",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","twoTaxTier").done(function(t){e.set("twoTaxTier",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","IsSubscriptionOnlyDStv").done(function(t){e.set("isSubscriptionOnlyDStv",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","IsSubscriptionOnlyGOtv").done(function(t){e.set("isSubscriptionOnlyGOtv",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","isLevyApplicable").done(function(t){e.set("isLevyApplicable",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),void 0===this.dataGridColumns&&(e.get("twoTaxTier")?(e.set("CSTLabel",kl.value(e._localeBase+e.getValueFromConstant("CustomerTypesConstants","customerTypesConstants.CustomerQuoteConstants.TaxTypeDescription"))),this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",validator:Komodo.UI.Validators.Validator.create({model:this.get("newProductGridItem"),options:{type:"number",maxLength:5,limitValueToType:!0,functions:[Komodo.UI.Validators.quantityValidator]}}),customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({controller:this,name:"includedTax",titleBinding:Ember.Binding.oneWay("controller.taxLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({controller:this,name:"cst",titleBinding:Ember.Binding.oneWay("controller.CSTLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})]):e.get("isLevyApplicable")?(e.set("LEVYLabel",kl.value(e._localeBase+e.getValueFromConstant("CustomerTypesConstants","customerTypesConstants.CustomerQuoteConstants.TaxTypeDescription"))),this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",validator:Komodo.UI.Validators.Validator.create({model:this.get("newProductGridItem"),options:{type:"number",maxLength:5,limitValueToType:!0,functions:[Komodo.UI.Validators.quantityValidator]}}),customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({controller:this,name:"includedTax",titleBinding:Ember.Binding.oneWay("controller.taxLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({controller:this,name:"levy",titleBinding:Ember.Binding.oneWay("controller.LEVYLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})]):this.dataGridColumns=[Komodo.Controls.DataGridColumn.create({name:"productName",title:kl.value(this._localeBase+"product"),width:"250px"}),Komodo.Controls.DataGridColumn.create({name:"productQuantity",title:kl.value(this._localeBase+"quantity"),canEdit:!0,width:"50px",validator:Komodo.UI.Validators.Validator.create({model:this.get("newProductGridItem"),options:{type:"number",maxLength:5,limitValueToType:!0,functions:[Komodo.UI.Validators.quantityValidator]}}),customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"subscriptionCost",title:kl.value(this._localeBase+"subscriptionCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"deviceCost",title:kl.value(this._localeBase+"deviceCost"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({controller:this,name:"includedTax",titleBinding:Ember.Binding.oneWay("controller.taxLabel"),width:"120px",customClass:"komodo-decimal"}),Komodo.Controls.DataGridColumn.create({name:"totalPrice",title:kl.value(this._localeBase+"total"),width:"120px",customClass:"komodo-decimal"})]),this.isQuoteForAnExistingCustomer(),this.setButtonVisibility()},getValueFromConstant:function(e,t){return Komodo.Services.QuotationServiceForConstant.getValueFromConstant(e,t)},validateQty:function(e,t){var a=$.Deferred(),o=this,i=!1,r=[],n="DStv"===o.data.viewingPlatform?o.getValueFromConstant("ProductsConstants","productsConstants.products.ViewingPlatform.DStv"):"GOtv"===o.data.viewingPlatform?o.getValueFromConstant("ProductsConstants","productsConstants.products.ViewingPlatform.GOtv"):null;o.get("showIndicator")&&o.showBusyIndicator();var s=Komodo.Services.securityService.get("domainUserName").substring(3);return Komodo.Services.queryService.getJSON("/SwapMaterialAvailability/GetMaterialStockAtLocation?material="+e+"&userName="+s+"&businessUnit="+n).done(function(e){if(e){var n=kl.value("locale.quotation:createQuotation.availableQuantityMsg"),s="";switch(e.MaterialQuantityDetailsList){case void 0:case null:case"":break;default:e.MaterialQuantityDetailsList instanceof Array||(e.MaterialQuantityDetailsList=[e.MaterialQuantityDetailsList]),e.MaterialQuantityDetailsList.forEach(function(e){var a={name:e.Material,qty:e.QuantityNew,isShort:!1};e.QuantityNew<t&&(a.isShort=!0,i=!0),$.each(o.get("productHardware"),function(t,o){if(o.details.Model===e.Material)return a.name=o.details.Name,!1}),r.addObject(a)}),o.get("showIndicator")?(o.hideBusyIndicator(),o.showPopUp(n,s,r)):i&&(s=kl.value(o.get("_localeBase")+"validateQuantityMsg"),o.showPopUp(n,s,r))}a.resolve()}}).fail(function(e){o.get("showIndicator")&&o.hideBusyIndicator();var t=JSON.stringify(e);Komodo.Controls.MessageBoxController.show(kl.value(o._localeBase+"useCaseTitle"),t,Komodo.Controls.MessageBoxOkButtons,o,"id57d986973","danger"),a.reject(e)}).error(function(e){o.get("showIndicator")&&o.hideBusyIndicator();var t=JSON.stringify(e);Komodo.Controls.MessageBoxController.show(kl.value(o._localeBase+"useCaseTitle"),t,Komodo.Controls.MessageBoxOkButtons,o,"id5798673","danger"),a.reject(e)}),a},showPopUp:function(e,t,a){Komodo.Services.uiService.showModalPopup(e,void 0,{view:Komodo.Application.ShowQuantityView,context:{valMessage:t,array:a},canUserClose:!0,shouldStartAndStopController:!1})},stop:function(){var e=this;this.clearAll(),this.ClearData(),this.get("addressInformation").clear(),this._super();var t=["countries","isoData","loggedInCountryId","contactDetailTypes","invoicePeriod","productService","productAddOn","currencyList","allAccessService","allInsurance","hardwarPproductsPriceHelperSet","languages","mobileCode","quoteInsuranceProducts","quoteProducts","quoteXtraviewProducts","hardwarPproductsPriceHelperSet","stsPeriod"];t.forEach(function(t){e.set(t,[])},t)},registerValidations:function(){var e=this;e.registerValidator(e.get("data"),"firstName",{type:"string",minLength:1,maxLength:50,functions:Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator}),e.registerValidator(e.get("data"),"lastName",{type:"string",minLength:2,maxLength:50,functions:Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator}),e.registerValidator(e.get("data"),"email",{type:"string",minLength:6,maxLength:254,displayName:kl.value(e._localeBase+"email"),regExPattern:Komodo.UI.Validators.RegExPatterns.Email}),e.registerValidator(e.get("data"),"phone",{type:"number",limitValueToType:!0,minLength:7,maxLength:10,displayName:kl.value(e._localeBase+"mobile"),regExPattern:"^[0-9]{7,10}$"}),e.registerValidator(e.get("data"),"countryCode",{type:"number",limitValueToType:!0,minLength:2,maxLength:4,displayName:kl.value(e._localeBase+"countryCode"),regExPattern:"^[0-9]{2,4}$"}),e.registerValidator(e.get("data"),"language",{type:"string",displayName:kl.value(e._localeBase+"preferredLanguage")}),e.registerValidator(e.get("data"),"chargePeriodValue",{type:"number",defaultValue:1}),e.registerValidator(e.get("data"),"stsPeriodValue",{type:"number",defaultValue:-1}),e.registerValidator(e.get("data"),"chargePeriod",{type:"number"}),e.registerValidator(e.get("data"),"contactType",{type:"string"}),e.registerValidator(e.get("data"),"isCommunicationFollowup",{type:"bool",displayName:kl.value(e._localeBase+"communicationFollowup")}),e.registerValidator(e.get("data"),"VATNumber",{type:"string",minLength:3,maxLength:11})},getCDMData:function(){var e=this,t=void 0,a=void 0,o=[],i=[];t=Komodo.Services.localizationService.getCurrentLanguage(),a=Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"),e.getCountryDetails(Komodo.Services.uiService.getController("application").get("_selectedCountryId"),t,a),Komodo.Services.cachedDataService.fetch("Location").done(function(a){var r=JSON.parse(a);e.set("countries",[]),e.set("countries",r.Countries.Country),Komodo.Services.cachedDataService.fetch("Country").done(function(a){e.set("isoData",[]),e.set("isoData",a),e.set("loggedInCountryId",$.grep(a,function(e){return e.key===Komodo.Services.queryService.getSelectedCountryId()})[0].key),Komodo.Services.cachedDataService.fetch("ContactDetailType").done(function(a){e.set("contactDetailTypes",[]),e.set("contactDetailTypes",a.sortBy("key")),e.isSTSEnabled()&&Komodo.Services.cachedDataService.fetch("ShortTermSubscriptionPeriod").done(function(t){e.set("stsPeriod",[]);var a={title:" ",value:"-1"};e.stsPeriod.addObject(a),$.each(t,function(t,o){a={title:o.value,value:o.key},e.stsPeriod.addObject(a)})}),Komodo.Services.cachedDataService.fetch("InvoicePeriod").done(function(a){e.set("invoicePeriod",[]),$.each(a,function(t,a){var o={title:a.value,value:a.key};e.invoicePeriod.addObject(o)}),e.set("productService",[]),e.set("productAddOn",[]),e.set("currencyList",[]),e.set("allAccessService",[]),e.set("allInsurance",[]),e.set("hardwarPproductsPriceHelperSet",[]),e.set("tempproductService",[]),Komodo.UI.cacheDataService.getQuotationProducts(e.productService,e.productAddOn,e.allInsurance,e.allAccessService,e.hardwarPproductsPriceHelperSet,e.currencyList,e.getValueFromConstant("ProductsConstants","productsConstants.products.MARKET_SEGMENT")).done(function(){$.each(e.hardwarPproductsPriceHelperSet,function(t,a){Ember.isEmpty($.grep(e.getValueFromConstant("ProductsConstants","productsConstants.products.DPP_QUOTE_REM_HARD_HACK").split(","),function(e){return e===a.Details.Model}))&&i.pushObject(a)}),e.set("hardwarPproductsPriceHelperSet",i),$.each(e.productAddOn,function(t,a){e.getValueFromConstant("ProductsConstants","productsConstants.products.DPP_ADD_ON_PROD_CAT")!==a.details.productCategory&&o.pushObject(a)}),e.set("productAddOn",o),e.set("tempproductService",e.productService),Komodo.Services.cachedDataService.fetch("CommunicationLanguage").done(function(t){e.set("languages",t),e.getHardwareInsuranceAndAccessServices(),e.chargePeriodValueChanged(),e.stsPeriodValueChanged(),Ember.isEmpty(e.productService[0])||e.getDefaultCurrency(e.productService[0].details.CurrencyCode),Komodo.Services.featureToggleService.isEnabled("EditPaymentDetails","RemovePaymentDay1").done(function(t){Komodo.Services.cachedDataService.fetch("InvoiceDay").done(function(a){e.get("debitOrderDays").clear(),a=a.sort(function(e,t){return parseInt(e.key,10)>parseInt(t.key,10)?1:parseInt(e.key,10)<parseInt(t.key,10)?-1:0}),$.each(a,function(a,o){"29"!==o.key&&("1"==o.key?t||e.get("debitOrderDays").addObject(o):e.get("debitOrderDays").addObject(o))}),Komodo.Services.cachedDataService.fetch("CountryBusinessUnitDeviceTypeRelationship").done(function(t){var a=JSON.parse(t);e.get("countryBusinessUnitDeviceTypeRelationship").clear(),e.set("countryBusinessUnitDeviceTypeRelationship",a.Country.BusinessUnits.BusinessUnit)}).fail(function(){Komodo.error("[ERROR] : could not retrieve CountryBusinessUnitDeviceTypeRelationship")})}).fail(function(){Komodo.error("[ERROR] : could not retrieve hierarchical CDM data for debitOrderDays")})}).fail(function(){Komodo.error("[ERROR] : could not retrieve debit order day from CDM")})}).fail(function(){Komodo.error("[ERROR] : could not retrieve InvoicePeriod domain = "+Komodo.Services.queryService.getSelectedCountryId()+"/ qualifier = "+t)})})}).fail(function(){Komodo.error("[ERROR] : could not retrieve InvoicePeriod domain = "+Komodo.Services.queryService.getSelectedCountryId()+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve ContactDetailType domain = "+Komodo.Services.queryService.getSelectedCountryId()+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve CountryISO domain = "+Komodo.Services.queryService.getSelectedCountryId()+"/ qualifier = "+t)})}).fail(function(){Komodo.error("[ERROR] : could not retrieve Location domain = "+Komodo.Services.queryService.getSelectedCountryId()+"/ qualifier = "+t)})},getCountryDetails:function(e,t,a){var o=this;Komodo.Services.cachedDataService.fetch("CountryDetail",{domain:e,qualifier:t}).done(function(e){var t=JSON.parse(e);o.get("data").set("countryCode",void 0),o.get("mobileCode").clear(),$.each(t.Countries.Country,function(e,t){t.CanonicalValue=t.CanonicalValue+"-"+t.DialingCode,o.get("mobileCode").addObject(t)}),o.dialingCode=$.grep(o.get("mobileCode"),function(e){return e.CanonicalValue.indexOf(a)>=0});var i=void 0;o.dialingCode.length>0&&(i=o.dialingCode[0].DialingCode),void 0!==i&&o.set("data.countryCode",i),void 0!==o.get("countryCodeTemp")&&o.set("data.countryCode",o.get("countryCodeTemp"))}).fail(function(){Komodo.error("[ERROR] : could not retrieve hierarchical CDM data for CountryDetail")})},getHardwareInsuranceAndAccessServices:function(){var e=this,t=Array();switch(e.hardwarPproductsPriceHelperSet){case void 0:case null:case"":break;default:var a=[],o=!0;e.hardwarPproductsPriceHelperSet.forEach(function(i){var r={isChecked:!1,details:void 0,hasAccessService:!1,accessService:void 0,hasInsurance:!1,insurance:void 0};r.details=i.Details,Ember.set(r.details,"Type","HARDWARE"),$.each(e.allAccessService,function(e,t){return void 0!==t.allowDevice&&""!==t.allowDevice&&!(a=t.allowDevice.split(","))instanceof Array&&(a=[a]),o=!0,$.each(a,function(e,a){if(a===i.Details.UID){$.each(t.prices,function(e,t){"1"===t.chargePeriod&&"1"===t.noOfUnitFrom&&parseInt(t.noOfUnitTo)>1?t.show=!0:"1"===t.chargePeriod&&"0"===t.noOfUnitFrom&&"0"===t.noOfUnitTo&&(t.show=!0)});var n={details:{Name:i.Details.Description+"-"+t.productDetails.name,UID:t.productDetails.productID,price:t.prices,Type:"ACCESS"},isChecked:!1};switch(n.details.price){case"":case void 0:case null:break;default:n.details.price&&(r.accessService=n,r.hasAccessService=!0)}o=!1}return o}),o}),$.each(e.allInsurance,function(e,t){if(!Ember.isEmpty(t.allowDevice))return a=t.allowDevice.split(","),!a instanceof Array&&(a=[a]),o=!0,$.each(a,function(e,a){if(a===i.Details.UID){var n=[];$.each(t.prices,function(e,t){t.deviceModel===i.Details.UID&&("1"===t.chargePeriod&&"1"===t.noOfUnitFrom&&parseInt(t.noOfUnitTo)>1?t.show=!0:"1"===t.chargePeriod&&"0"===t.noOfUnitFrom&&"0"===t.noOfUnitTo&&(t.show=!0),n.pushObject(t))});var s={details:{Name:i.Details.Description+"-"+t.productDetails.name,UID:t.productDetails.productID,price:n,Type:"INSURANCE"},isChecked:!1};switch(s.details.price){case void 0:case"":case null:break;default:s.details.price&&(r.insurance=s,r.hasInsurance=!0)}o=!1}return o}),o}),t.push(r)}),e.set("productHardware",t);var i,r=[];$.each(e.productService,function(t,a){a.details.UID===e.getValueFromConstant("ProductsConstants","productsConstants.products.PRINCIPAL_PRODUCT_ID")&&void 0!==a.details.prices&&$.each(a.details.prices,function(e,t){t.noOfUnitFrom>"1"&&t.noOfUnitTo>"1"&&("1"===t.chargePeriod||"12"===t.chargePeriod)&&(i=Komodo.UI.Class.Price.create(),i.amount=t.amount,i.discoundAmount=t.discoundAmount,i.chargePeriod=t.chargePeriod,i.finalAmount=t.finalAmount,i.noOfUnitFrom=t.noOfUnitFrom,i.noOfUnitTo=t.noOfUnitTo,i.show=t.show,i.chargePeriod=t.chargePeriod,i.deviceModel=t.deviceModel,i.taxType1=t.taxType1,i.taxType2=t.taxType2,i.taxType3=t.taxType3,r.pushObject(i))})});var n={isChecked:!1,details:{UID:"",Type:"SERVICE",Price:r,Name:"Xtraview",DisplayName:kl.value(e._localeBase+"xtraView"),Model:void 0}};e.productXtraviewService.clear(),e.productXtraviewService.pushObject(n)}},dataGridFooters:[[],[]],createDependentProperty:function(e,t){var a=this;t.forEach(function(t){void 0!==a.get("validators."+e)&&a.get("validators."+e).functions.addObject(t)}),void 0!==a.get("validators."+e)&&a.get("validators."+e).validate()},removeDependentProperty:function(e){var t=this;void 0!==t.get("validators."+e)&&(t.get("validators."+e).functions.clear(),t.get("validators."+e).validate())},isQuoteForAnExistingCustomer:function(){this.populateCustomerProfileInformation()},populateCustomerProfileInformation:function(){
var e=this,t=void 0,a=Komodo.Services.ProductAndServiceMaintenanceHelper.create();if(a.isCustomerIdIsAvailableToRetriveData()){var o=Komodo.Services.customerProfileService.getCustomerPersonalDetail();e.set("data.firstName",o.firstName),e.set("data.lastName",o.lastName),void 0!==o.email&&"-"!==o.email&&e.set("data.email",o.email),o.mobileNo&&(e.set("data.phone",o.mobileNo.split(" ")[1]),e.set("data.countryCode",o.mobileNo.split(" ")[0])),this.set("data.customerRefNo",a.getCustomerIdToRetrieveData());var i=Komodo.Application.CustomerInformationMapper.create();i.readCustomerPersonalInformation(Komodo.Services.customerProfileService.currentCustomerDetails),t=i.readCustomerAddressInformation(Komodo.Services.customerProfileService.currentCustomerDetails),e.get("addressInformation").clear(),t.forEach(function(t){t.type===Komodo.CanonicalValues.AddressTypes.Physical&&(e.get("addressInformation").pushObject(Komodo.UI.addressFunctions.getAddressModel(t)),e.set("data.isAdressVisible",!0))});try{$.each(Komodo.Services.customerProfileService.getFinancialAccounts().ResponseMessage.Payload.ListOfAccount.Account,function(t,a){Ember.isEmpty(a.InvoiceDay)||(e.set("data.debitOrderDay",a.InvoiceDay+""),e.set("data.disableDebitOrderDay",!0))})}catch(e){}return!0}return!1},clearGridFooter:function(){this.dataGridFooters[0].clear(),this.dataGridFooters[1].clear()},setGridFooter:function(e,t,a,o,i,r,n,s,d){var c=this;void 0!=this.dataGridFooters[d]&&this.dataGridFooters[d].clear(),(0==o||null==o||isNaN(o))&&(o=null),(0==i||null==i||isNaN(i))&&(i=null),(0==r||null==r||isNaN(r))&&(r=null),(0==n||null==n||isNaN(n))&&(n=null),(0==a||null==a||isNaN(a))&&(a=null),(0==s||null==s||isNaN(s))&&(s=null),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:e,columnSpan:1})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:void 0,columnSpan:1})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:a,columnSpan:1,customClass:"komodo-decimal"})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:o,columnSpan:1,customClass:"komodo-decimal"})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:i,columnSpan:1,customClass:"komodo-decimal"})),c.get("twoTaxTier")&&this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:r,columnSpan:1,customClass:"komodo-decimal"})),c.get("isLevyApplicable")&&this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:n,columnSpan:1,customClass:"komodo-decimal"})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:s,columnSpan:1,customClass:"komodo-decimal"})),this.get("dataGridFooters")[d].addObject(Komodo.Controls.DataGridFooterColumn.create({content:void 0,columnSpan:1}))},createNewGridItem:function(){var e=Komodo.Models.QuotationModule.ProductGridData.create();return this.set("newProductGridItem",e),!0},addProductToGrid:function(e,t,a,o,i,r){var n=this;n.set("newProductGridItem.productUid",e),n.set("newProductGridItem.productName",t),n.set("newProductGridItem.productModel",a),n.set("newProductGridItem.productQuantity",o),n.set("newProductGridItem.productCategory",i),n.setCostForLineItem(i,r),n.addGridRow(),n.set("allowQuoteGeneration",!1),n.setButtonVisibility()},setCostForLineItem:function(productCategory,prices){var that=this,subscriptionCost,price;switch(productCategory){case"SERVICE":case"ADDON":case"PRINCIPAL":case"INSURANCE":price=$.grep(prices,function(e){return!0===e.show})[0];var taxAmmount=0,cstAmmount=0,levyAmount=0,chargePeriodPrice=$.grep(prices,function(e){return("1"===e.chargePeriod||"3"===e.chargePeriod||"1000"===e.chargePeriod)&&e.show&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(prices,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):that.get("isLevyApplicable")&&"PRINCIPAL"===productCategory?(levyAmount=that.getValueFromConstant("ProductsConstants","productsConstants.products.LEVY_AMOUNT"),taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):that.get("isLevyApplicable")&&"PRINCIPAL"===productCategory?(levyAmount=that.getValueFromConstant("ProductsConstants","productsConstants.products.LEVY_AMOUNT"),taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;that.get("twoTaxTier")?that.set("newProductGridItem.subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):that.get("isLevyApplicable")&&"PRINCIPAL"===productCategory?that.set("newProductGridItem.subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(levyAmount))).toFixed(2)):that.set("newProductGridItem.subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2)),that.set("newProductGridItem.includedTax","0"==taxAmmount?"":parseFloat(taxAmmount).toFixed(2)),that.get("twoTaxTier")?that.set("newProductGridItem.cst","0"==cstAmmount?"":parseFloat(cstAmmount).toFixed(2)):that.get("isLevyApplicable")&&"PRINCIPAL"===productCategory&&that.set("newProductGridItem.levy","0"==levyAmount?"":parseFloat(levyAmount).toFixed(2)),that.set("newProductGridItem.totalPrice",parseFloat(price.finalAmount).toFixed(2)),that.get("twoTaxTier")?that.set("newProductGridItem.actualCost",parseFloat(price.finalAmount-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):that.set("newProductGridItem.actualCost",parseFloat(price.finalAmount-taxAmmount).toFixed(2)),that.set("newProductGridItem.actualCostWithTax",parseFloat(price.finalAmount).toFixed(2)),that.set("newProductGridItem.price",price);break;case"ACCESS":price=$.grep(prices,function(e){return!0===e.show})[0];var taxAmmount=0,cstAmmount=0,chargePeriodPrice=$.grep(prices,function(e){return"1"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(prices,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;that.get("twoTaxTier")?that.set("newProductGridItem.subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):that.set("newProductGridItem.subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2)),that.set("newProductGridItem.includedTax","0"==taxAmmount?"":parseFloat(taxAmmount).toFixed(2)),that.get("twoTaxTier")&&that.set("newProductGridItem.cst","0"==cstAmmount?"":parseFloat(cstAmmount).toFixed(2)),that.set("newProductGridItem.totalPrice",parseFloat(price.finalAmount).toFixed(2)),that.get("twoTaxTier")?that.set("newProductGridItem.actualCost",parseFloat(price.finalAmount-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):that.set("newProductGridItem.actualCost",parseFloat(price.finalAmount-taxAmmount).toFixed(2)),that.set("newProductGridItem.actualCostWithTax",parseFloat(price.finalAmount).toFixed(2)),that.set("newProductGridItem.price",price);break;case"HARDWARE":price=prices,that.set("newProductGridItem.deviceCost",parseFloat(price.ValueWithoutTax).toFixed(2)),that.get("isLevyApplicable")&&$.grep(price.ListOfTax,function(e){return"LEVY"===e.Type}).length>0?that.set("newProductGridItem.includedTax",parseFloat(1*price.Value-1*price.ValueWithoutTax-$.grep(price.ListOfTax,function(e){return"LEVY"===e.Type})[0].Amount).toFixed(2)):that.set("newProductGridItem.includedTax",parseFloat(1*price.Value-1*price.ValueWithoutTax).toFixed(2)),that.set("newProductGridItem.totalPrice",parseFloat(price.Value*that.get("data.chargePeriod")).toFixed(2)),that.set("newProductGridItem.actualCost",parseFloat(price.ValueWithoutTax).toFixed(2)),that.set("newProductGridItem.actualCostWithTax",parseFloat(price.Value).toFixed(2)),that.set("newProductGridItem.price",price)}},getDefaultCurrency:function(e){var t=this;$.each(t.currencyList,function(a,o){if(o.SystemKey===e)return void(t.currencyName=o.CanonicalValue)})},addGridRow:function(){this.data.productData.pushObject(this.get("newProductGridItem")),this.createNewGridItem(),this.updateFooter()},updateFooter:function(){var e,t=this,a=0,o=0,i=0,r=0,n=0,s=0;Komodo.Services.featureToggleService.isEnabled("CreateQuotation","ToggleVATLabel").done(function(a){switch(a){case!0:e=kl.value(t._localeBase+"vat");break;default:e=kl.value(t._localeBase+"tax")}}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),$.each(t.data.productData,function(e,t){switch(t.productCategory){case"HARDWARE":s=parseFloat(1*s+1*t.deviceCost).toFixed(2);break;default:n=parseFloat(1*n+1*t.subscriptionCost).toFixed(2)}void 0!==t.includedTax&&(a=parseFloat(1*a+1*t.includedTax).toFixed(2)),void 0!==t.cst&&(o=parseFloat(1*o+1*t.cst).toFixed(2)),void 0!==t.levy&&(i=parseFloat(1*i+1*t.levy).toFixed(2)),r=parseFloat(1*r+1*t.totalPrice).toFixed(2)}),t.setGridFooter(e+" "+kl.value(this._localeBase+"total"),null,null,null,a,o,i,null,0),t.setGridFooter(kl.value(this._localeBase+"total")+"("+t.currencyName+")",null,n,s,null,null,null,r,1),t.get("data").set("totalPrice",r)},isProductAdded:function(e,t){var a=this,o=!0;return a.data.productData.length>0&&$.each(a.data.productData,function(a,i){return i.productName===e&&i.productCategory===t&&(o=!1),o}),!o},removeProduct:function(e){if(this.data.productData.length>0){var t=this;t.data.productData.forEach(function(a){a.productName===e&&t.data.productData.removeObject(a)})}},getArrayItem:function(e){return e instanceof Array?e:[e]},getNewProcessID:function(){this.startNewProcess()},showBusyIndicator:function(){Komodo.Services.busyService.start(!0,this.get("processId"),Komodo.Services.busyIndicatorTypes.Busy,12e5,"blocking",this)},hideBusyIndicator:function(){Komodo.Services.busyService.stop(this.get("processId"),"blocking")},setButtonVisibility:function(){var e=this;Ember.isEmpty(e.get("data.productData"))||e.get("data.productData").length<1?e.set("data.isButtonVisible",!1):e.get("data.productData").length>0?(e.set("data.isButtonVisible",!0),e.set("disableQuotationButton",!1)):(e.set("data.isButtonVisible",!1),e.set("disableQuotationButton",!0))},ClearDataOnCheckbox:function(){var e=this;e.set("data.firstName",void 0),e.set("data.lastName",void 0),e.set("data.email",void 0),e.set("data.VATNumber",void 0),e.set("data.phone",void 0)},ClearData:function(){var e=this;e.set("data.country",void 0),e.set("data.firstName",void 0),e.set("data.lastName",void 0),e.set("data.email",void 0),e.set("data.countryCode",void 0),e.set("data.phone",void 0),e.set("data.customerClass",void 0),e.set("data.productServices",[]),e.set("data.productHardwares",[]),e.set("data.productAddOn",[]),e.set("data.productData",[]),e.set("data.language",void 0),e.set("dataGridFooters.dataGridColumns",void 0),e.set("dataGridColumns",void 0),e.clearGridFooter(),e.quoteInsuranceProducts.clear(),e.quoteProducts.clear(),e.quoteXtraviewProducts.clear(),e.set("data.isCommunicationFollowup",!1),e.removeDependentProperty("isCommunicationFollowupValidator");var t;if(e.productHardware)for(t=0;t<e.productHardware.length;t++)Ember.set(e.productHardware[t],"isChecked",!1);if(this.productService)for(t=0;t<e.productService.length;t++)Ember.set(e.productService[t],"isChecked",!1);if(this.productAddOn)for(t=0;t<e.productAddOn.length;t++)Ember.set(e.productAddOn[t],"isChecked",!1);if(this.productXtraviewService)for(t=0;t<e.productXtraviewService.length;t++)Ember.set(e.productXtraviewService[t],"isChecked",!1)},setCheckBox:function(e,t){e.forEach(function(e){void 0!=e&&e.details.Name==t&&Ember.set(e,"isChecked",!1)})},setInsuranceCheckBox:function(e,t){$.each(e,function(e,a){a.hasInsurance&&a.insurance.details.Name==t&&Ember.set(a.insurance,"isChecked",!1)})},setAccessCheckBox:function(e,t){e.forEach(function(e,a){a.hasAccessService&&a.accessService.details.Name==t&&Ember.set(a.accessService,"isChecked",!1)})},getQuotationData:function(){var that=this,currencyCode=that.currencyName,payloadQuotation=Komodo.Models.Quotation.create(),payloadQuotationFacade=Komodo.canonicalFacadeFactory(payloadQuotation,["ListOfQuotationLineItem_QuotationLineItem","TotalPrice","FollowupFlag","TermOfPayment","BusinessUnit","Category","VATNumber"]),listOfQuotationLineItem=[],listOfAllQuotationLineItemTax=[],listOfAllQuotationLineItemTaxTemp=[],payloadTotalPriceOfQuotationLineItem=Komodo.Models.Price.create(),payloadTotalPriceOfQuotationLineItemFacade=Komodo.canonicalFacadeFactory(payloadTotalPriceOfQuotationLineItem,["CurrencyCode","Value","ValueWithoutTax","ListOfTax"]);that.data.productData.forEach(function(e){var t=[],a=[],o=[],i=void 0,r=void 0,n=void 0,s=!0;void 0!=e.deviceCost?(s=!0,void 0!=that.hardwarPproductsPriceHelperSet&&null!=that.hardwarPproductsPriceHelperSet&&that.hardwarPproductsPriceHelperSet.forEach(function(d){return d.Details.UID==e.productUid&&d.Details.Name===e.productName&&(t.clear(),a.clear(),n=d.Details.Model,void 0!=d.Details.Price.ListOfTax&&void 0==d.Details.Price.ListOfTax.length&&(d.Details.Price.ListOfTax=[d.Details.Price.ListOfTax]),d.Details.Price.ListOfTax.forEach(function(n){i=Komodo.Models.Tax.create(),r=Komodo.canonicalFacadeFactory(i,["Type","Percent","Amount"]),r.set("Type",n.Type),r.set("Percent",n.Percent),r.set("Amount",parseFloat(n.Amount*e.productQuantity).toFixed(2)),t.push(i),listOfAllQuotationLineItemTax.push({Type:i.Type,Percent:i.Percent,Amount:i.Amount});var s=Komodo.Models.Tax.create(),d=Komodo.canonicalFacadeFactory(s,["Type","Percent","Amount"]);d.set("Type",n.Type),d.set("Percent",n.Percent),d.set("Amount",parseFloat(n.Amount).toFixed(2)),a.push(s),o.push(s)}),s=!1),s})):(t.clear(),a.clear(),void 0!==e.price.taxType1&&(i=Komodo.Models.Tax.create(),r=Komodo.canonicalFacadeFactory(i,["Type","Percent","Amount"]),r.set("Type",e.price.taxType1.type),r.set("Amount",e.price.taxType1.amount),r.set("Percent",e.price.taxType1.percent),t.push(i),a.push(i),o.push(i),listOfAllQuotationLineItemTax.push({Type:i.Type,Percent:i.Percent,Amount:i.Amount})),void 0!==e.price.taxType2&&(i=Komodo.Models.Tax.create(),r=Komodo.canonicalFacadeFactory(i,["Type","Percent","Amount"]),r.set("Type",e.price.taxType2.type),r.set("Amount",e.price.taxType2.amount),r.set("Percent",e.price.taxType2.percent),t.push(i),a.push(i),o.push(i),listOfAllQuotationLineItemTax.push({Type:i.Type,Percent:i.Percent,Amount:i.Amount})),void 0!==e.price.taxType3&&(i=Komodo.Models.Tax.create(),r=Komodo.canonicalFacadeFactory(i,["Type","Percent","Amount"]),r.set("Type",e.price.taxType3.type),r.set("Amount",e.price.taxType3.amount),r.set("Percent",e.price.taxType3.percent),t.push(i),a.push(i),o.push(i),listOfAllQuotationLineItemTax.push({Type:i.Type,Percent:i.Percent,Amount:i.Amount})),that.get("isLevyApplicable")&&void 0!==e.levy&&(i=Komodo.Models.Tax.create(),r=Komodo.canonicalFacadeFactory(i,["Type","Percent","Amount"]),r.set("Type","LEVY"),r.set("Amount","12"===e.price.chargePeriod?parseFloat(12*e.levy).toFixed(2):e.levy),r.set("Percent","0"),t.push(i),a.push(i),o.push(i),listOfAllQuotationLineItemTax.push({Type:i.Type,Percent:i.Percent,Amount:i.Amount})));var d=Komodo.Models.Price.create(),c=Komodo.canonicalFacadeFactory(d,["CurrencyCode","Value","ValueWithoutTax","ListOfTax"]);c.set("CurrencyCode",currencyCode),c.set("Value",e.actualCostWithTax),c.set("ValueWithoutTax",e.actualCost),c.set("ListOfTax",a);var l=Komodo.Models.Price.create(),u=Komodo.canonicalFacadeFactory(l,["CurrencyCode","Value","ValueWithoutTax","ListOfTax"]);u.set("CurrencyCode",currencyCode),u.set("Value",e.totalPrice),u.set("ValueWithoutTax",parseFloat(e.actualCost*e.productQuantity).toFixed(2)),u.set("ListOfTax",t);var h=Komodo.Models.ProductDetail.create(),p=Komodo.canonicalFacadeFactory(h,["UID","Type","Name","Price","Model"]),m=Komodo.Models.Price.create();m.set("CurrencyCode",currencyCode),m.set("Value",e.actualCostWithTax),m.set("ValueWithoutTax",e.actualCost),m.set("ListOfTax",o),p.set("UID",e.productUid),p.set("Type",e.productCategory),p.set("Name",e.productName),p.set("Price",m),p.set("Model",n);var f=Komodo.Models.QuotationLineItem.create(),g=Komodo.canonicalFacadeFactory(f,["Quantity","QuotedUnitPrice","Product_Details","TotalPrice"]);g.set("Quantity",e.productQuantity),g.set("Product_Details",h),g.set("QuotedUnitPrice",d),g.set("TotalPrice",l),listOfQuotationLineItem.push(f)}),payloadTotalPriceOfQuotationLineItemFacade.set("CurrencyCode",currencyCode);var totalTaxForAllQuoationLineItem=0,totalCSTForAllQuoationLineItem=0,totalLEVYForAllQuoationLineItem=0,totalCostForAllQuoationLineItem=0,totalCostWithoutTaxForAllQuoationLineItem;return void 0!=that.get("dataGridFooters")&&(void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[0][4]&&null!==that.get("dataGridFooters")[0][4].content&&(totalTaxForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[0][4].content).toFixed(2)),that.get("twoTaxTier")&&void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[0][5]&&null!==that.get("dataGridFooters")[0][5].content&&(totalCSTForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[0][5].content).toFixed(2)),that.get("twoTaxTier")&&void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[1][6]&&null!==that.get("dataGridFooters")[1][6].content&&(totalCostForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[1][6].content).toFixed(2)),that.get("isLevyApplicable")&&void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[0][5]&&null!==that.get("dataGridFooters")[0][5].content&&(totalLEVYForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[0][5].content).toFixed(2)),that.get("isLevyApplicable")?void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[1][6]&&null!==that.get("dataGridFooters")[1][6].content&&(totalCostForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[1][6].content).toFixed(2)):void 0!==that.get("dataGridFooters")[0]&&void 0!==that.get("dataGridFooters")[1][5]&&null!==that.get("dataGridFooters")[1][5].content&&(totalCostForAllQuoationLineItem=parseFloat(that.get("dataGridFooters")[1][5].content).toFixed(2))),$.each(listOfAllQuotationLineItemTax,function(e,t){if(0==e)listOfAllQuotationLineItemTaxTemp.push(t);else{var a=!1;$.each(listOfAllQuotationLineItemTaxTemp,function(e,o){o.Type==t.Type&&(o.Amount=parseFloat(1*o.Amount+1*t.Amount).toFixed(2),a=!0)}),a||listOfAllQuotationLineItemTaxTemp.push(t)}}),totalCostWithoutTaxForAllQuoationLineItem=that.get("twoTaxTier")?parseFloat(1*totalCostForAllQuoationLineItem-(eval(1*totalTaxForAllQuoationLineItem)+eval(1*totalCSTForAllQuoationLineItem))).toFixed(2):that.get("isLevyApplicable")?parseFloat(1*totalCostForAllQuoationLineItem-(eval(1*totalTaxForAllQuoationLineItem)+eval(1*totalLEVYForAllQuoationLineItem))).toFixed(2):parseFloat(1*totalCostForAllQuoationLineItem-1*totalTaxForAllQuoationLineItem).toFixed(2),payloadTotalPriceOfQuotationLineItemFacade.set("Value",totalCostForAllQuoationLineItem),payloadTotalPriceOfQuotationLineItemFacade.set("ValueWithoutTax",totalCostWithoutTaxForAllQuoationLineItem),payloadTotalPriceOfQuotationLineItemFacade.set("ListOfTax",listOfAllQuotationLineItemTaxTemp),void 0!==that.get("data").get("isCommunicationFollowup")&&!0===that.get("data").get("isCommunicationFollowup")?payloadQuotationFacade.set("FollowupFlag",!0):payloadQuotationFacade.set("FollowupFlag",!1),payloadQuotationFacade.set("ListOfQuotationLineItem_QuotationLineItem",listOfQuotationLineItem),payloadQuotationFacade.set("TotalPrice",payloadTotalPriceOfQuotationLineItem),payloadQuotationFacade.set("TermOfPayment",that.get("data").get("chargePeriodValue")),payloadQuotationFacade.set("VATNumber",that.get("data").get("VATNumber")),payloadQuotationFacade.set("BusinessUnit",that.data.viewingPlatform),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","isSalesOnly").done(function(e){switch(e){case!0:payloadQuotationFacade.set("Category",that.getValueFromConstant("ProductsConstants","productsConstants.products.Sales"));break;case!1:that.get("isHardwareCategory")&&that.get("isSubscriptionCategory")?payloadQuotationFacade.set("Category",that.getValueFromConstant("ProductsConstants","productsConstants.products.SalesMixed")):that.get("isHardwareCategory")?payloadQuotationFacade.set("Category",that.getValueFromConstant("ProductsConstants","productsConstants.products.SalesDevice")):that.get("isSubscriptionCategory")&&payloadQuotationFacade.set("Category",that.getValueFromConstant("ProductsConstants","productsConstants.products.SalesPackage"))}}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),payloadQuotation},actions:{addQuotation:function(){var e=this;e.isAddressCaptured()&&(e.get("data.acceptVatDetails")||e.validationCheckForQuoteTotal())&&!1!==e.canSubmitData(e.data,kl.value(e._localeBase+"useCaseTitle"),{showInModal:!0})&&(e.publishGenerateQuotationEvent(),e.set("data.isGenerateQuotationButtonEnable",!0))},activateGroup:function(e){var t,a=e._context,o=a.details,i=this;if(!a.isChecked)return i.removeProduct(o.Name),void(i.isKenyaBusinessUnit()&&"DStv"===i.data.viewingPlatform&&(0===$.grep($.grep(i.productHardware,function(e){return!0===e.hasAccessService}),function(e){return e.accessService.isChecked}).length&&0===$.grep($.grep(i.productHardware,function(e){return!0===e.hasInsurance}),function(e){return e.insurance.isChecked}).length&&0===$.grep(i.productServiceNew,function(e){return e.isChecked}).length&&0===$.grep(i.productAddOnNew,function(e){return e.isChecked}).length&&0===$.grep(i.productXtraviewService,function(e){return e.isChecked}).length&&0===$.grep(i.productHardware,function(e){return e.isChecked}).length?(i.get("data").set("disableHardware",!1),i.get("data").set("disableSubscription",!1)):0===$.grep($.grep(i.productHardware,function(e){return!0===e.hasAccessService}),function(e){return e.accessService.isChecked}).length&&0===$.grep($.grep(i.productHardware,function(e){return!0===e.hasInsurance}),function(e){return e.insurance.isChecked}).length&&0===$.grep(i.productServiceNew,function(e){return e.isChecked}).length&&0===$.grep(i.productAddOnNew,function(e){return e.isChecked}).length&&0===$.grep(i.productXtraviewService,function(e){return e.isChecked}).length&&(0===$.grep(i.productHardware,function(e){return e.isChecked}).length?i.get("data").set("disableSubscription",!1):i.get("data").set("disableHardware",!1))));switch(o.Type){case"ADDON":case"PRINCIPAL":i.isKenyaBusinessUnit()&&"DStv"===i.data.viewingPlatform?i.get("data").set("disableHardware",!0):i.get("data").set("disableHardware",!1),t=void 0,$.each(o.prices,function(e,a){return a.show&&(t=a),!a.show}),i.addProductToGrid(o.UID,o.Name,void 0,1,o.Type,o.prices);break;case"INSURANCE":case"ACCESS":i.isKenyaBusinessUnit()&&"DStv"===i.data.viewingPlatform?i.get("data").set("disableHardware",!0):i.get("data").set("disableHardware",!1),i.addProductToGrid(o.UID,o.Name,void 0,1,o.Type,o.price);break;case"HARDWARE":i.set("showIndicator",!0),i.isKenyaBusinessUnit()&&"DStv"===i.data.viewingPlatform?i.get("data").set("disableSubscription",!0):i.get("data").set("disableSubscription",!1),i.validateQty(o.Model,1).done(function(){i.addProductToGrid(o.UID,o.Name,o.Model,1,o.Type,o.Price),i.set("showIndicator",!1)});break;case"SERVICE":i.isKenyaBusinessUnit()&&"DStv"===i.data.viewingPlatform?i.get("data").set("disableHardware",!0):i.get("data").set("disableHardware",!1),i.addProductToGrid(o.UID,o.Name,void 0,1,o.Type,o.Price)}},setRowIndex:function(e){this.set("rowIndex",e-1)},clearBasket:function(){this.clearAll()}},clearAll:function(){var e=this;Ember.set(e.data,"productData",[]),e.productHardware.forEach(function(e){Ember.set(e,"isChecked",!1),e.hasAccessService&&Ember.set(e.accessService,"isChecked",!1),e.hasInsurance&&Ember.set(e.insurance,"isChecked",!1)}),e.productService.forEach(function(e){Ember.set(e,"isChecked",!1)}),Ember.isEmpty(e.productAddOn)||e.productAddOn.forEach(function(e){Ember.set(e,"isChecked",!1)}),Ember.isEmpty(e.productXtraviewService)||e.productXtraviewService.forEach(function(e){Ember.set(e,"isChecked",!1)}),e.removeDependentProperty("isCommunicationFollowupValidator"),e.clearGridFooter()},publishGenerateQuotationEvent:function(){var e,t,a=this;a.checkCategory(),e=Komodo.Models.GenerateQuotation.create();var o=Komodo.canonicalFacadeFactory(e,["Country","Quotation","Lead"]);if(void 0!==a.loggedInCountryId){o.set("Country",a.loggedInCountryId);var i=a.getQuotationData();o.set("Quotation",i);var r=Komodo.Models.Lead.create(),n=Komodo.canonicalFacadeFactory(r,["ListOfPhoneNumber_PhoneNumber","ListOfEmail_Email","PersonalDetail","CustomerUID","Language","ListOfAddress"]);n.set("ListOfAddress",Komodo.UI.addressFunctions.getAddressCollection(a.get("addressInformation")));var s=[],d=Komodo.Models.PhoneNumber.create(),c=Komodo.canonicalFacadeFactory(d,["Code","Number"]);switch(a.get("data").get("phone")){case void 0:case"":case null:c.set("Number",""),c.set("Code","");break;default:switch(a.get("data").get("countryCode")){case void 0:case"":case null:c.set("Number",""),c.set("Code","");break;default:c.set("Number",a.data.get("phone").trim()),c.set("Code",a.data.countryCode.trim())}}s.push(d),n.set("ListOfPhoneNumber_PhoneNumber",s),n.set("CustomerUID",a.data.get("customerRefNo")),n.set("Language",a.data.get("language"));var l=[],u=Komodo.Models.Email.create(),h=Komodo.canonicalFacadeFactory(u,["Value"]);switch(a.get("data").get("email")){case void 0:case"":case null:h.set("Value","");break;default:h.set("Value",a.data.get("email"))}l.push(u),n.set("ListOfEmail_Email",l);var p=Komodo.Models.PersonalDetail.create(),m=Komodo.canonicalFacadeFactory(p,["FirstName","Surname"]);void 0!=a.data.get("firstName")?(m.set("FirstName",a.get("data").get("firstName")),m.set("Surname",a.get("data").get("lastName"))):(m.set("FirstName",""),m.set("Surname","")),n.set("PersonalDetail",p),o.set("Lead",r),a.getNewProcessID(),t=new Komodo.Services.QuotationService,t.GenerateQuotation(a,e).done(function(){Komodo.log("Event Published "+new Date),Komodo.log("publishGenerateQuotationEvent() : Generate Quotation event has been published."),a.showBusyIndicator(),a.set("disableQuotationButton",!0)}).fail(function(){Komodo.log("publishGenerateQuotationEvent() :Generate Quotation event has been failed.")})}},messageGenerateQuotationDeliveryFailure:function(e){this.hideBusyIndicator(),this.set("disableQuotationButton",!1),Komodo.UI.warn("[CreateQuotationController.messageGenerateQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"useCaseTitle"),kl.value(this._localeBase+"messageGenerateQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5798673","danger")},messageFault:function(e){this.hideBusyIndicator(),this.set("disableQuotationButton",!1),Komodo.UI.warn("[CreateQuotationController.messageGenerateQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"useCaseTitle"),kl.value(this._localeBase+"messageGenerateQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5798673","danger")},messageReceived:function(){this.hideBusyIndicator()},messageDeliveryFailure:function(e){this.hideBusyIndicator(),this.set("disableQuotationButton",!1),Komodo.UI.warn("[CreateQuotationController.messageGenerateQuotationDeliveryFailure] : messageId = "+e.messageId),Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"useCaseTitle"),kl.value(this._localeBase+"messageGenerateQuotationDeliveryFailure"),Komodo.Controls.MessageBoxOkButtons,this,"id5798673","danger")},messageQuotationGeneratedReceived:function(e){Komodo.log("Received "+new Date);var t=this;void 0!=e.ResponseMessage.Payload.Quotation.UID?(t.hideBusyIndicator(),t.set("countryCodeTemp",void 0),Komodo.Services.eventAggregator.publish("PublishCustomerQuotationUID",e)):(t.hideBusyIndicator(),Komodo.Controls.MessageBoxController.show(kl.value("locale.quotation:home.createQuote"),kl.value(this._localeBase+"noQuoteGeneration"))),t.get("data").set("isGenerateQuotationButtonEnable",!1)},messageFailureMessageEventReceived:function(e){this.hideBusyIndicator(),this.set("disableQuotationButton",!1),Komodo.Controls.MessageBoxController.show(e.ResponseMessage.Payload.ListOfErrorDetails.ErrorType,e.ResponseMessage.Payload.ListOfErrorDetails.ErrorDescription,Komodo.Controls.MessageBoxOkButtons,this,"id2366673","danger")},fistNameLastNameObserverForValidation:function(){var e=this,t=!1;e.get("data.acceptVatDetails")?e.get("data").get("isVATChecked")&&(t=!0):(e.get("data").totalPrice>=5e3||e.get("data").get("isVATChecked"))&&(t=!0),Ember.empty(e.data.firstName)&&Ember.empty(e.data.lastName)?Ember.empty(e.data.firstName)&&Ember.empty(e.data.lastName)&&(t||(e.removeDependentProperty("firstNameValidator"),e.removeDependentProperty("lastNameValidator"))):(e.createDependentProperty("firstNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("lastNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]))}.observes("data.firstName","data.lastName"),mobileNumberAndEmailObserverForValidation:function(){var e=this;Ember.empty(e.data.phone)&&Ember.empty(e.data.email)?(Ember.empty(e.data.phone)||Ember.empty(e.data.email))&&(e.removeDependentProperty("countryCodeValidator"),e.set("visibleCommunicationFollowup",!1)):(e.createDependentProperty("countryCodeValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.RegExValidator]),e.set("visibleCommunicationFollowup",!0)),e.set("data.isCommunicationFollowup",!1);var t=this.data.phone;void 0!=this.data.phone&&0==this.data.phone.charAt(0)&&(t=t.replace(/^0+/,""),this.set("data.phone",t))}.observes("data.phone","data.email"),checkBoxObserverForValidation:function(){var e=this;e.get("data.isVATChecked")?(e.createDependentProperty("firstNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),
e.createDependentProperty("lastNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("phoneValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.get("data.acceptVatDetails")||e.createDependentProperty("emailValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.RegExValidator]),e.createDependentProperty("VATNumberValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.set("data.isAdressVisible",!0),e.data.set("visibleVATNumberTextBox",!0)):(e.removeDependentProperty("firstNameValidator"),e.removeDependentProperty("lastNameValidator"),e.removeDependentProperty("phoneValidator"),e.get("data.acceptVatDetails")||e.removeDependentProperty("emailValidator"),e.removeDependentProperty("VATNumberValidator"),e.data.set("visibleVATNumberTextBox",!1),Ember.isEmpty(e.get("data.customerRefNo"))&&(e.set("data.isAdressVisible",!1),e.ClearDataOnCheckbox()),e.createDependentProperty("phoneValidator",[Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.createDependentProperty("emailValidator",[Komodo.UI.Validators.RegExValidator]))}.observes("data.isVATChecked"),validationCheckForQuoteTotal:function(){var e=this;if(1*e.get("data.totalPrice")>=5e3){if(e.createDependentProperty("firstNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("lastNameValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("phoneValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.createDependentProperty("emailValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.RegExValidator]),!e.get("data.isVATChecked"))return Komodo.Controls.MessageBoxController.show(kl.value(e._localeBase+"VATDetails"),kl.value(e._localeBase+"vatDetailsCaptured"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","warning"),e.set("data.isVATChecked",!0),!1;e.createDependentProperty("VATNumberValidator",[Komodo.UI.Validators.RequiredValidator,Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.set("data.isAdressVisible",!0),e.data.set("visibleVATNumberTextBox",!0)}else e.get("data.isVATChecked")||(e.removeDependentProperty("phoneValidator"),e.removeDependentProperty("emailValidator"),e.createDependentProperty("firstNameValidator",[Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("lastNameValidator",[Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator,Komodo.UI.Validators.firstNameAndLastNameExtendedAlphaValidator]),e.createDependentProperty("phoneValidator",[Komodo.UI.Validators.MinLengthValidator,Komodo.UI.Validators.MaxLengthValidator]),e.createDependentProperty("emailValidator",[Komodo.UI.Validators.RegExValidator]),e.removeDependentProperty("VATNumberValidator"),e.set("data.isAdressVisible",!1));return!0},followupChanged:function(){var e=this;e.set("data.language",void 0),!0===e.data.isCommunicationFollowup?(e.createDependentProperty("languageValidator",[Komodo.UI.Validators.RequiredValidator]),void 0!==e.get("data.phone")&&""!==e.get("data.phone")||void 0!==e.get("data.email")&&""!==e.get("data.email")?e.set("showlanguageList",!0):(e.set("showlanguageList",!0),Komodo.Controls.MessageBoxController.show(kl.value("locale.quotation:home.createQuote"),kl.value(e._localeBase+"phoneOrEmailIsMandatory"),[Komodo.Controls.MessageBoxOkButton],this,"OK","alert"))):(e.removeDependentProperty("languageValidator"),e.set("showlanguageList",!1))}.observes("data.isCommunicationFollowup"),disableValidator:function(){this.removeDependentProperty("languageValidator")}.observes("data.language"),productQuantityObserver:function(){var e=this;0==e.get("data.productData.length")&&e.set("data.isCommunicationFollowup",!1),e.updateGrid(),Ember.isEmpty(e.get("data"))||Ember.isEmpty(e.get("data.productData"))||Ember.isEmpty(e.data.productData[e.get("rowIndex")])||Ember.isEmpty(e.data.productData[e.get("rowIndex")].productCategory)||"HARDWARE"!==e.data.productData[e.get("rowIndex")].productCategory||Ember.isEmpty(e.data.productData[e.get("rowIndex")].productQuantity)||Ember.isEmpty(e.data.productData[e.get("rowIndex")].productModel)||e.get("showIndicator")||e.validateQty(e.data.productData[e.get("rowIndex")].productModel,e.data.productData[e.get("rowIndex")].productQuantity)}.observes("data.productData.@each.productQuantity"),gridDelete:function(){if("delete"==this.get("data.deleteGridItem")){var e=this.data.commandGridItem.get("productCategory"),t=this.data.commandGridItem.get("productName");switch(e){case"HARDWARE":this.setCheckBox(this.productHardware,t);break;case"SERVICE":case"PRINCIPAL":this.setCheckBox(this.productService,t),this.setCheckBox(this.productXtraviewService,t);break;case"ADDON":this.setCheckBox(this.productAddOn,t);break;case"INSURANCE":this.setInsuranceCheckBox(this.productHardware,t);break;case"ACCESS":this.setAccessCheckBox(this.productHardware,t)}switch(this.updateFooter(),this.data.productData.length){case 0:this.clearAll();break;case 1:void 0===this.data.productData[0].get("productCategory")&&this.data.productData.clear()}}}.observes("data.deleteGridItem"),hideFooterRow:function(){var e=this;0===e.get("data.productData").length&&e.clearGridFooter()}.observes("data.productData.length"),debitOrderDayChanged:function(){var e=this;Ember.isEmpty(e.get("data.debitOrderDay"))?(e.updateGrid(),e.set("allowQuoteGeneration",!0)):e.set("allowQuoteGeneration",!1),e.setButtonVisibility()}.observes("data.debitOrderDay"),stsPeriodValueChanged:function(){var that=this;that.isSTSEnabled()?(that.set("visibleSTSPeriodSelect",!0),that.showPackages(eval(that.data.chargePeriodValue)),that.updateGrid()):(that.set("visibleSTSPeriodSelect",!1),that.get("data").set("stsPeriodValue","-1"))}.observes("data.stsPeriodValue"),chargePeriodValueChanged:function(){var that=this;switch(Ember.isEmpty(that.data.chargePeriodValue)||(that.clearAll(),that.isKenyaBusinessUnit()&&(that.get("data").set("disableHardware",!1),that.get("data").set("disableSubscription",!1)),that.showPackages(eval(that.data.chargePeriodValue)),that.showAddOns(eval(that.data.chargePeriodValue)),that.showInsurenceAccessServices(eval(that.data.chargePeriodValue)),that.showXtraviewService(eval(that.data.chargePeriodValue))),that.get("data").set("stsPeriodValue","-1"),that.data.chargePeriodValue){case"12":that.set("visibleAnnualOfferText",!0),that.set("disableSTSPeriodSelect",!0),that.get("data").set("chargePeriod",11),that.updateGrid();break;case"3":that.set("visibleAnnualOfferText",!1),that.set("disableSTSPeriodSelect",!0),that.get("data").set("chargePeriod",3),that.updateGrid();break;case kl.value("locale.quotation:stsChargePeriod"):that.isSTSEnabled()?(that.set("visibleAnnualOfferText",!1),that.set("disableSTSPeriodSelect",!1),that.get("data").set("chargePeriod",kl.value("locale.quotation:stsChargePeriod")),that.updateGrid()):(that.set("visibleAnnualOfferText",!1),that.set("visibleSTSPeriodSelect",!1));break;case"1":default:that.set("visibleAnnualOfferText",!1),that.set("disableSTSPeriodSelect",!0),that.get("data").set("chargePeriod",1),that.updateGrid()}that.set("allowQuoteGeneration",!1),that.setButtonVisibility()}.observes("data.chargePeriodValue"),selectDStvOrGOtv:function(){var e=this;Ember.isEmpty(e.data.viewingPlatform)||(e.set("GOtvDStvSelectedNam",e.data.viewingPlatform),e.set("isNam",!1),e.get("data").set("chargePeriodValue","1"),e.get("data").set("stsPeriodValue","-1"),e.get("data").set("chargePeriod","1"),e.isSTSEnabled()?e.set("visibleSTSPeriodSelect",!0):e.set("visibleSTSPeriodSelect",!1),e.getHardwareInsuranceAndAccessServicesForAll(),e.chargePeriodValueChanged(),e.stsPeriodValueChanged())}.observes("data.viewingPlatform"),showPackages:function(e){var t=this,a=[];Ember.A();t.productServiceNew.clear(),t.propertyWillChange("productServiceNew"),Komodo.Services.featureToggleService.isEnabled("CreateQuotation","DoNotAllowDstvGotvSplit").done(function(o){if(o)Ember.isEmpty(t.GOtvDStvSelectedNam)&&(a=t.getPackagesForChargePeriod(t.GOtvDStvSelectedNam+"_QUOTE",e),t.productServiceNew=a,t.propertyDidChange("productServiceNew"));else{!t.get("isSubscriptionOnlyDStv")&&t.GOtvDStvSelectedNam===t.getValueFromConstant("ProductsConstants","productsConstants.products.DStv_QUOTE")||!t.get("isSubscriptionOnlyGOtv")&&t.GOtvDStvSelectedNam===t.getValueFromConstant("ProductsConstants","productsConstants.products.GOtv_QUOTE")?a=t.getPackagesForChargePeriodAndPlatform(t.GOtvDStvSelectedNam+"_QUOTE",e):(t.get("isSubscriptionOnlyDStv")||t.get("isSubscriptionOnlyGOtv"))&&(a=t.getPackagesForChargePeriod(t.GOtvDStvSelectedNam+"_QUOTE",e));var i=[];$.each(a,function(e,t){-1===$.inArray(t,i)&&i.push(t)}),i.length>0&&(t.productServiceNew=i,t.propertyDidChange("productServiceNew"))}}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)})},getPackagesForChargePeriodAndPlatform:function(viewingPlatform,chargePeriod){var that=this,tempPackages=[];return $.grep(that.hardwarPproductsPriceHelperSet,function(e){return-1!==$.inArray(e.Details.ProfitSegment,that.deviceTypeArray)}).length>0&&that.GOtvDStvSelectedNam===that.getValueFromConstant("ProductsConstants","productsConstants.products."+viewingPlatform)&&that.hardwarPproductsPriceHelperSet.forEach(function(entry){entry.Details.ProfitSegment!==that.deviceTypeArray[0]&&entry.Details.ProfitSegment!==that.deviceTypeArray[1]||$.each(that.productService,function(index,product){if(void 0!==product.allowDevice){var token=product.allowDevice.split(",");!token instanceof Array&&(token=[token]);var serviceAdded=!0;$.each(token,function(keyToken,decoder){if(decoder===entry.Details.UID){var flagSet=!1;product.details.isShow=!1,void 0!==product.details.prices&&$.each(product.details.prices,function(keyPrices,price){price.show=!1,chargePeriod===kl.value("locale.quotation:stsChargePeriod")&&price.stsId!==that.get("data").get("stsPeriodValue")||(chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&!flagSet?(price.show=!0,product.details.isShow=!0,flagSet=!0):chargePeriod!==eval(price.chargePeriod)||"0"!==price.noOfUnitFrom||"0"!==price.noOfUnitTo||flagSet||(price.show=!0,product.details.isShow=!0,flagSet=!0))}),tempPackages.pushObject(product)}})}})}),tempPackages},getPackagesForChargePeriod:function(viewingPlatform,chargePeriod){var that=this,tempPackages=[],tempProductServices=[];return tempProductServices=Ember.isEmpty(that.GOtvDStvSelectedNam)?that.productService:$.grep(that.productService,function(e){return that.GOtvDStvSelectedNam===that.getValueFromConstant("ProductsConstants","productsConstants.products.DStv_QUOTE")?e.details.productCategory!==that.getValueFromConstant("ProductsConstants","productsConstants.products.GOTV_PRODUCT_CATEGORY_ID"):e.details.productCategory===that.getValueFromConstant("ProductsConstants","productsConstants.products.GOTV_PRODUCT_CATEGORY_ID")}),$.each(tempProductServices,function(index,product){var flagSet=!1;product.details.isShow=!1,void 0!==product.details.prices&&$.each(product.details.prices,function(keyPrices,price){price.show=!1,chargePeriod===kl.value("locale.quotation:stsChargePeriod")&&price.stsId!==that.get("data").get("stsPeriodValue")||(chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&!flagSet?(price.show=!0,product.details.isShow=!0,flagSet=!0):chargePeriod!==eval(price.chargePeriod)||"0"!==price.noOfUnitFrom||"0"!==price.noOfUnitTo||flagSet||(price.show=!0,product.details.isShow=!0,flagSet=!0))}),tempPackages.pushObject(product)}),tempPackages},showAddOns:function(chargePeriod){var that=this,tempAddOnPackages=[],uniqueAddOns=[];that.propertyWillChange("productAddOnNew"),"zaf"!==Komodo.Services.queryService.getSelectedCountryId()?$.each(that.productServiceNew,function(key,productService){$.each(that.productAddOn,function(index,addOnProduct){void 0!==addOnProduct.allowProduct&&(token=addOnProduct.allowProduct.split(",")),!token instanceof Array&&(token=[token]),$.each(token,function(keyToken,addOns){if(addOns===productService.details.UID){var flagSet=!1;addOnProduct.details.isShow=!1,void 0!==addOnProduct.details.prices&&$.each(addOnProduct.details.prices,function(keyPrices,price){price.show=!1,chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&!flagSet?(price.show=!0,addOnProduct.details.isShow=!0,flagSet=!0):chargePeriod!==eval(price.chargePeriod)||"0"!==price.noOfUnitFrom||"0"!==price.noOfUnitTo||flagSet||(price.show=!0,addOnProduct.details.isShow=!0,flagSet=!0)}),tempAddOnPackages.pushObject(addOnProduct)}})})}):$.each(that.productAddOn,function(index,addOnProduct){var flagSet=!1;addOnProduct.details.isShow=!1,void 0!==addOnProduct.details.prices&&$.each(addOnProduct.details.prices,function(keyPrices,price){price.show=!1,chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&!flagSet?(price.show=!0,addOnProduct.details.isShow=!0,flagSet=!0):chargePeriod!==eval(price.chargePeriod)||"0"!==price.noOfUnitFrom||"0"!==price.noOfUnitTo||flagSet||(price.show=!0,addOnProduct.details.isShow=!0,flagSet=!0)}),tempAddOnPackages.pushObject(addOnProduct)}),$.each(tempAddOnPackages,function(e,t){-1===$.inArray(t,uniqueAddOns)&&uniqueAddOns.push(t)}),that.productAddOnNew.clear(),that.productAddOnNew=uniqueAddOns,that.propertyDidChange("productAddOnNew")},showInsurenceAccessServices:function(chargePeriod){var that=this,tempProductHardware=[];that.propertyWillChange("productHardware");var flagSet;$.each(that.productHardware,function(index,productHardware){flagSet=!1,productHardware.hasInsurance&&void 0!==productHardware.insurance.details.price&&$.each(productHardware.insurance.details.price,function(keyPrices,price){price.show=!1,chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&!flagSet?(price.show=!0,flagSet=!0):chargePeriod!==eval(price.chargePeriod)||"0"!==price.noOfUnitFrom||"0"!==price.noOfUnitTo||flagSet||(price.show=!0,flagSet=!0)}),productHardware.hasAccessService&&void 0!==productHardware.accessService.details.price&&$.each(productHardware.accessService.details.price,function(keyPrices,price){price.show=!1,chargePeriod===eval(price.chargePeriod)&&"1"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1?price.show=!0:chargePeriod===eval(price.chargePeriod)&&"0"===price.noOfUnitFrom&&"0"===price.noOfUnitTo&&(price.show=!0)}),tempProductHardware.pushObject(productHardware)}),that.productHardware.clear(),that.productHardware=tempProductHardware,that.propertyDidChange("productHardware")},showXtraviewService:function(chargePeriod){var that=this,tempxtraviewPackages=[];that.propertyWillChange("productXtraviewService"),$.each(that.productXtraviewService,function(index,xtraViewProduct){void 0!==xtraViewProduct.details.Price&&$.each(xtraViewProduct.details.Price,function(keyPrices,price){price.show=!1,chargePeriod===eval(price.chargePeriod)&&"2"===price.noOfUnitFrom&&parseInt(price.noOfUnitTo)>1&&(price.show=!0)}),tempxtraviewPackages.pushObject(xtraViewProduct)}),that.productXtraviewService.clear(),that.productXtraviewService=tempxtraviewPackages,that.propertyDidChange("productXtraviewService")},getDeviceTypeArray:function(){var e=this;e.deviceTypeArray.clear(),e.get("countryBusinessUnitDeviceTypeRelationship").length>0&&$.each(e.get("countryBusinessUnitDeviceTypeRelationship"),function(t,a){a.CanonicalValue===e.data.viewingPlatform&&(a.DeviceTypes.DeviceType.length>0?$.each(a.DeviceTypes.DeviceType,function(t,a){Ember.isEmpty(a.CanonicalValue)||e.deviceTypeArray.addObject(a.CanonicalValue)}):e.deviceTypeArray.addObject(a.DeviceTypes.DeviceType.CanonicalValue))})},updateGrid:function(){var that=this,subscriptionCost=0;switch(that.get("data.productData")){case void 0:case null:case"":break;default:switch(that.get("data.productData").length){case 0:case void 0:case null:case"":break;default:$.each(that.get("data.productData"),function(index,product){switch(product.productCategory){case"HARDWARE":isNaN(parseFloat(product.actualCostWithTax*product.productQuantity).toFixed(2))||Ember.set(product,"totalPrice",parseFloat(product.actualCostWithTax*product.productQuantity).toFixed(2)),that.get("isLevyApplicable")&&$.grep(product.price.ListOfTax,function(e){return"LEVY"===e.Type}).length>0&&(Ember.set(product,"levy",parseFloat($.grep(product.price.ListOfTax,function(e){return"LEVY"===e.Type})[0].Amount).toFixed(2)),Ember.set(product,"totalPrice",parseFloat(product.actualCostWithTax*product.productQuantity).toFixed(2)));break;case"ACCESS":var prodPackage=$.grep(that.productHardware,function(e){if(e.hasAccessService)return e.accessService.details.UID===product.productUid})[0];if(void 0!==prodPackage){var price=$.grep(prodPackage.accessService.details.price,function(e){return!0===e.show})[0],taxAmmount=0,cstAmmount=0,chargePeriodPrice=$.grep(prodPackage.accessService.details.price,function(e){return"1"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(prodPackage.accessService.details.price,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;product.set("totalPrice",parseFloat(price.finalAmount*product.productQuantity).toFixed(2)),that.get("twoTaxTier")?product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2))}break;case"SERVICE":var price=$.grep(that.productXtraviewService[0].details.Price,function(e){return!0===e.show})[0];if(void 0!==price){var chargePeriodPrice=$.grep(that.productXtraviewService[0].details.Price,function(e){return"1"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0],taxAmmount=0,cstAmmount=0;if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(that.productXtraviewService[0].details.Price,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;product.set("totalPrice",parseFloat(price.finalAmount*product.productQuantity).toFixed(2)),that.get("twoTaxTier")?product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2))}break;case"ADDON":var prodPackage=$.grep(that.productAddOn,function(e){return e.details.UID===product.productUid})[0];if(void 0!==prodPackage){var price=$.grep(prodPackage.details.prices,function(e){return!0===e.show})[0],chargePeriodPrice=$.grep(prodPackage.details.prices,function(e){return"1"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0],taxAmmount=0,cstAmmount=0;if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(prodPackage.details.prices,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;product.set("totalPrice",parseFloat(price.finalAmount*product.productQuantity).toFixed(2)),that.get("twoTaxTier")?product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2))}break;case"PRINCIPAL":case"ACCESS":var prodPackage=$.grep(that.productService,function(e){return e.details.UID===product.productUid})[0];if(void 0!==prodPackage){var price=$.grep(prodPackage.details.prices,function(e){return!0===e.show})[0],taxAmmount=0,cstAmmount=0,levyAmount=0,chargePeriodPrice=$.grep(prodPackage.details.prices,function(e){return("1"===e.chargePeriod||"3"===e.chargePeriod||"1000"===e.chargePeriod)&&e.show&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(prodPackage.details.prices,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):that.get("isLevyApplicable")&&"PRINCIPAL"===product.productCategory?(taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,levyAmount=parseFloat(that.getValueFromConstant("ProductsConstants","productsConstants.products.LEVY_AMOUNT")).toFixed(2)):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):that.get("isLevyApplicable")&&"PRINCIPAL"===product.productCategory?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount,levyAmount="3"===chargePeriodPrice.chargePeriod?parseFloat(that.getValueFromConstant("ProductsConstants","productsConstants.products.LEVY_AMOUNT")*that.get("data.chargePeriod")).toFixed(2):parseFloat(that.getValueFromConstant("ProductsConstants","productsConstants.products.LEVY_AMOUNT")).toFixed(2)):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;that.get("isLevyApplicable")&&"PRINCIPAL"===product.productCategory?(product.set("levy",levyAmount),3===that.get("data.chargePeriod")?product.set("totalPrice",parseFloat(product.productQuantity*(parseFloat(price.finalAmount)+parseFloat(levyAmount))).toFixed(2)):product.set("totalPrice",parseFloat(product.productQuantity*(parseFloat(price.finalAmount)+parseFloat(levyAmount*(11===that.get("data.chargePeriod")?12:that.get("data.chargePeriod"))))).toFixed(2))):product.set("totalPrice",parseFloat(price.finalAmount*product.productQuantity).toFixed(2)),that.get("twoTaxTier")?product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2))}break;case"INSURANCE":var prodPackage=$.grep($.grep(that.productHardware,function(e){if(e.hasInsurance)return e.insurance.details.UID===product.productUid&&e.insurance.details.Name===product.productName}),function(e){return!0===e.insurance.isChecked});void 0!==prodPackage&&$.each(prodPackage,function(index,insuranceproduct){var price=$.grep(insuranceproduct.insurance.details.price,function(e){return!0===e.show})[0],taxAmmount=0,cstAmmount=0,chargePeriodPrice=$.grep(insuranceproduct.insurance.details.price,function(e){return"1"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];if(Ember.isEmpty(chargePeriodPrice)){var annualPrice=$.grep(insuranceproduct.insurance.details.price,function(e){return"12"===e.chargePeriod&&e.noOfUnitFrom===price.noOfUnitFrom&&e.noOfUnitTo===price.noOfUnitTo})[0];subscriptionCost=annualPrice.amount/12,that.get("twoTaxTier")?(cstAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12,taxAmmount=Ember.isEmpty(annualPrice.taxType2)?"0":annualPrice.taxType2.amount/12):taxAmmount=Ember.isEmpty(annualPrice.taxType1)?"0":annualPrice.taxType1.amount/12}else subscriptionCost=chargePeriodPrice.finalAmount,that.get("twoTaxTier")?(taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType2)?"0":chargePeriodPrice.taxType2.amount,cstAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount):taxAmmount=Ember.isEmpty(chargePeriodPrice.taxType1)?"0":chargePeriodPrice.taxType1.amount;product.set("totalPrice",parseFloat(price.finalAmount*product.productQuantity).toFixed(2)),that.get("twoTaxTier")?product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-(eval(taxAmmount)+eval(cstAmmount))).toFixed(2)):product.set("subscriptionCost",parseFloat(eval(subscriptionCost)-taxAmmount).toFixed(2))})}}),that.updateFooter()}}},checkCategory:function(){var e=this;switch(e.set("isHardwareCategory",!1),e.set("isSubscriptionCategory",!1),e.get("data.productData")){case void 0:case null:case"":break;default:switch(e.get("data.productData").length){case 0:case void 0:case null:case"":break;default:$.each(e.get("data.productData"),function(t,a){switch(a.productCategory){case"HARDWARE":e.set("isHardwareCategory",!0);break;case"ADDON":case"PRINCIPAL":e.set("isSubscriptionCategory",!0);break;case"SERVICE":case"ACCESS":case"INSURANCE":e.isKenyaBusinessUnit()&&"DStv"===e.data.viewingPlatform?e.set("isSubscriptionCategory",!0):(e.set("isHardwareCategory",!0),e.set("isSubscriptionCategory",!0))}})}}},collapsibleselectPackageViewLinks:function(){return[{href:"http://www.dstv.com/topic/compare-packages-20150713",title:kl.value(this._localeBase+"comparePackagesLink")}]}.property(),getHardwareInsuranceAndAccessServicesForAll:function(){var e=this,t=Array();switch(e.getDeviceTypeArray(),e.hardwarPproductsPriceHelperSet){case void 0:case null:case"":break;default:var a=[],o=!0,i=[],r=[];if(e.propertyWillChange("productServiceNew"),e.propertyWillChange("productAddOnNew"),$.grep(e.hardwarPproductsPriceHelperSet,function(t){return-1!=e.deviceTypeArray.indexOf(t.Details.ProfitSegment)}).length>0){$.grep(e.hardwarPproductsPriceHelperSet,function(t){return-1!=e.deviceTypeArray.indexOf(t.Details.ProfitSegment)}).forEach(function(r){var n={isChecked:!1,details:void 0,hasAccessService:!1,accessService:void 0,hasInsurance:!1,insurance:void 0};n.details=r.Details,Ember.set(n.details,"Type","HARDWARE"),$.each(e.allAccessService,function(e,t){return void 0!==t.allowDevice&&""!==t.allowDevice&&!(a=t.allowDevice.split(","))instanceof Array&&(a=[a]),o=!0,$.each(a,function(e,a){if(a===r.Details.UID){$.each(t.prices,function(e,t){"1"===t.chargePeriod&&"1"===t.noOfUnitFrom&&parseInt(t.noOfUnitTo)>1?t.show=!0:"1"===t.chargePeriod&&"0"===t.noOfUnitFrom&&"0"===t.noOfUnitTo&&(t.show=!0)});var i={details:{Name:r.Details.Description+"-"+t.productDetails.name,UID:t.productDetails.productID,price:t.prices,Type:"ACCESS"},isChecked:!1};switch(i.details.price){case"":case void 0:case null:break;default:i.details.price&&(n.accessService=i,n.hasAccessService=!0)}o=!1}return o}),o}),$.each(e.allInsurance,function(e,t){if(void 0!==t.allowDevice)return a=t.allowDevice.split(","),!a instanceof Array&&(a=[a]),o=!0,$.each(a,function(e,a){if(a===r.Details.UID){var i=[];$.each(t.prices,function(e,t){t.deviceModel===r.Details.UID&&("1"===t.chargePeriod&&"1"===t.noOfUnitFrom&&parseInt(t.noOfUnitTo)>1?t.show=!0:"1"===t.chargePeriod&&"0"===t.noOfUnitFrom&&"0"===t.noOfUnitTo&&(t.show=!0),i.pushObject(t))});var s={details:{Name:r.Details.Description+"-"+t.productDetails.name,UID:t.productDetails.productID,price:i,Type:"INSURANCE"},isChecked:!1};switch(s.details.price){case void 0:case"":case null:break;default:s.details.price&&(n.insurance=s,n.hasInsurance=!0)}o=!1}return o}),o}),$.each(e.productService,function(t,n){void 0!==n.allowDevice&&(a=n.allowDevice.split(","),!a instanceof Array&&(a=[a]),o=!0,$.each(a,function(t,a){if(a===r.Details.UID){var o=!1;n.details.isShow=!1,void 0!==n.details.prices&&$.each(n.details.prices,function(t,a){a.show=!1,a.chargePeriod===e.data.chargePeriodValue&&"1"===a.noOfUnitFrom&&parseInt(a.noOfUnitTo)>1&&!o?(a.show=!0,n.details.isShow=!0,o=!0):a.chargePeriod!==e.data.chargePeriodValue||"0"!==a.noOfUnitFrom||"0"!==a.noOfUnitTo||o||(a.show=!0,n.details.isShow=!0,o=!0)}),i.pushObject(n)}}))}),t.push(n)});var n=[],s=[];$.each(i,function(t,i){-1===$.inArray(i,n)&&(n.push(i),$.each(e.productAddOn,function(t,n){void 0!==n.allowProduct&&(a=n.allowProduct.split(",")),!a instanceof Array&&(a=[a]),o=!0,$.each(a,function(t,a){if(a===i.details.UID){var o=!1;n.details.isShow=!1,void 0!==n.details.prices&&$.each(n.details.prices,function(t,a){a.show=!1,a.chargePeriod===e.data.chargePeriodValue&&"1"===a.noOfUnitFrom&&parseInt(a.noOfUnitTo)>1&&!o?(a.show=!0,n.details.isShow=!0,o=!0):a.chargePeriod!==e.data.chargePeriodValue||"0"!==a.noOfUnitFrom||"0"!==a.noOfUnitTo||o||(a.show=!0,n.details.isShow=!0,o=!0)}),r.pushObject(n)}})}))}),e.productServiceNew.clear(),e.productServiceNew=n,e.propertyDidChange("productServiceNew"),$.each(r,function(e,t){-1===$.inArray(t,s)&&s.push(t)}),e.productAddOnNew.clear(),e.productAddOnNew=s,e.propertyDidChange("productAddOnNew")}e.set("productHardware",t);var d,c=[];e.GOtvDStvSelectedNam!==e.getValueFromConstant("ProductsConstants","productsConstants.products.GOtv_QUOTE")&&$.each(e.productService,function(t,a){a.details.UID===e.getValueFromConstant("ProductsConstants","productsConstants.products.PRINCIPAL_PRODUCT_ID")&&void 0!==a.details.prices&&$.each(a.details.prices,function(e,t){t.noOfUnitFrom>"1"&&t.noOfUnitTo>"1"&&("1"===t.chargePeriod||"12"===t.chargePeriod)&&(d=Komodo.UI.Class.Price.create(),d.amount=t.amount,d.discoundAmount=t.discoundAmount,d.chargePeriod=t.chargePeriod,d.finalAmount=t.finalAmount,d.noOfUnitFrom=t.noOfUnitFrom,d.noOfUnitTo=t.noOfUnitTo,d.show=t.show,d.chargePeriod=t.chargePeriod,d.deviceModel=t.deviceModel,d.taxType1=t.taxType1,d.taxType2=t.taxType2,d.taxType3=t.taxType3,
c.pushObject(d))})});var l={isChecked:!1,details:{UID:"",Type:"SERVICE",Price:c,Name:"Xtraview",DisplayName:kl.value(e._localeBase+"xtraView"),Model:void 0}};e.productXtraviewService.clear(),e.productXtraviewService.pushObject(l)}},isAddressCaptured:function(){var e=this;return!e.get("data.isVATChecked")||0!=e.get("addressInformation").length||(Komodo.Controls.MessageBoxController.show(kl.value(e.get("_localeBase")+"useCaseTitle"),kl.value(e.get("_localeBase")+"captureAddress"),Komodo.Controls.MessageBoxOkButtons,this,"id5446673","warning"),!1)},isKenyaBusinessUnit:function(){var e=this;return Komodo.Services.featureToggleService.isEnabled("createQuotation","isKenyaBusinessUnit").done(function(t){e.set("result",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),e.result},isSTSEnabled:function(){var e=this;return Komodo.Services.featureToggleService.isEnabled("createQuotation","isSTSEnabled").done(function(t){e.set("result",t)}).fail(function(e){Komodo.Services.log("Error while checking feature toggle. Error Details:"+e)}),e.result},addressInformationObserver:function(){var e=this;0===e.get("addressInformation.length")&&(e.set("postal",1),e.set("physical",1)),$.each(e.get("addressInformation"),function(t,a){switch(a.addressType){case Komodo.CanonicalValues.AddressTypes.Physical:return e.set("physical",1),e.set("postal",0),!1;case Komodo.CanonicalValues.AddressTypes.Postal:return e.set("postal",1),e.set("physical",0),!1}})}.observes("addressInformation.@each.type"),countryCodeChanged:function(){this.registerValidator(this.get("data"),"phone",{type:"number",minLength:7,maxLength:this.get("data.countryCode")===Komodo.CountryCode.LesothoCountryCode?11:10,displayName:kl.value(this._localeBase+"mobile"),limitValueToType:!0,functions:Komodo.UI.Validators.numericValidator})}.observes("data.countryCode"),mobileCode:[],dialingCode:void 0,quoteInsuranceProducts:[],quoteProducts:[],contactDetailTypes:[],quoteXtraviewProducts:[],submitQuotation:null,busy:!1,published:!1,visibleCommunicationFollowup:!1,showlanguageList:!1,debitOrderDaylabel:void 0,debitOrderDays:[],loggedInCountryId:void 0,countryCodeTemp:void 0,invoicePeriod:[],stsPeriod:[],editQuotelanguage:void 0,hardwarPproductsPriceHelperSet:[],languages:[],currencyList:[],allAccessService:[],productXtraviewService:[],allInsurance:[],currencyName:void 0,disableQuotationButton:!0,allowQuoteGeneration:!1,productService:[],productAddOn:[],visibleAnnualOfferText:!1,disableSTSPeriodSelect:!0,profitSegment:[],GOtvDStvSelectedNam:void 0,productServiceNew:[],productAddOnNew:[],deviceTypeArray:[],isHardwareCategory:!1,isSubscriptionCategory:!1,physical:1,postal:1,countryBusinessUnitDeviceTypeRelationship:[],twoTaxTier:!1,isSubscriptionOnlyDStv:!1,isSubscriptionOnlyGOtv:!1}),Komodo.Services.localizationService.registerNamespace("locale.quotation");