var ElasticSearchConfiguration={indexsettings:{indexName:"namibia_esindex",searchType:"_search",requestMethod:"POST"},documentType:{customer:"customerprofile",quote:"quotation",caseDetails:"casedetail",agent:"agent",device:"device"},searchQuery:{query:'{"from" : "pageFrom", "size": "pageSize",  "query": { "query_string": { "default_field": "_all", "default_operator": "AND", "analyze_wildcard": true, "query": "searchText" } }}',token:"AND"},highlightSearchResult:{cssClass:"search-highlight",htmlTag:"span"}};Komodo.Models.SearchRequest=Ember.Object.extend({init:function(){this.Searchcountry=void 0,this.Pagefrom=void 0,this.PageSize=void 0,this.DefaultField=void 0,this.DefaultOperator=void 0,this.SearchText=void 0,this.ElasticSearchUrl=void 0,this.IndexName=void 0,this.DocumentType=void 0,this.Query=void 0,this.SearchType=void 0,this.RequestMethod=void 0,this.TotalCount=void 0,this.TotalSeconds=void 0,this.DisplayStatistics=void 0,this.isNextButtonVisible=void 0,this.isPreviousButtonVisible=void 0,this.Displaycurrentpagerange=void 0,this.resultMsg=void 0,this.filterMessage=void 0,this.customerchecked=void 0,this.quotechecked=void 0,this.casechecked=void 0,this.agentchecked=void 0,this.devicechecked=void 0,this._super()}}),Komodo.Models.SearchRequestForBaseSystem=Ember.Object.extend({init:function(){this.uid=void 0,this.searchEntity=void 0,this.isUpdated=!1,this._super()}}),Komodo.Models.SearchResultModel=Ember.Object.extend({init:function(){this.searchField1=void 0,this.searchField2=void 0,this.searchField3=void 0,this.searchField4=void 0,this.searchField5=void 0,this.searchField6=void 0,this.searchField7=void 0,this.searchField8=void 0,this.searchField9=void 0,this.isDstv=!1,this.isGotv=!1,this.customerClass=void 0,this._super()}}),Komodo.Application.SearchControlRoute=Komodo.UI.RestrictedRoute.extend({useCaseName:"searchControl",useCaseDisplayName:kl.value("locale.customerprofile.customerprofile:searchcontrol.mSearch"),init:function(){this._super()}}),Komodo.UI.Route.registerRoutes(function(){this.resource("searchControl"),Komodo.Services.eventAggregator.subscribe(Komodo.EventNames.searchRequested,function(e){var t=Komodo.Services.uiService.getController("searchControl");t.get("isInitiated")||(t.SearchRequestedReceived(e),t.set("isInitiated",!0))}),Komodo.Services.eventAggregator.subscribe("ElasticSearchDataReceived",function(e){var t=Komodo.Services.uiService.getController("searchControl");1==t.get("isInitiated")&&(t.viewBindingMethodForSingleSearch(e),t.set("isInitiated",!1),t.callPopup())}),Komodo.Services.eventAggregator.subscribe(Komodo.EventNames.userLoggedOut,function(){var e=Komodo.Services.uiService.get("applicationController");Ember.set(e,"searchText","")})}),Komodo.Services.ElasticSearchFetchService=function(){this.retrieveElasticSearchData=function(e){Komodo.Services.queryService.getJSON("/ElasticSearch/GetElasticSearchData?from="+e.get("Pagefrom")+"&size="+e.get("PageSize")+"&documentType="+e.get("DocumentType")+"&default_field="+e.get("DefaultField")+"&searchText="+e.get("SearchText")+"&default_operator="+e.get("DefaultOperator")).done(function(e){Komodo.Services.eventAggregator.publish("ElasticSearchDataReceived",e)}).error(function(e){var t=JSON.stringify(e);Komodo.log("retrieveElasticSearchData ajax call failed. Error: "+t),Komodo.Services.eventAggregator.publish("ElasticSearchDataReceived",null)})}},Ember.TEMPLATES.SearchControlView=Ember.Handlebars.template(function(e,t,s,r,o){function a(e,t){var r;return t.buffer.push('\r\n<div class="modal-max-size">\r\n    <p class="sub-heading">'),t.buffer.push(S(s._triageMustache.call(e,"view.context.searchRequest.resultMsg",{hash:{unescaped:"true"},hashTypes:{unescaped:"STRING"},hashContexts:{unescaped:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</p>\r\n    <p class="sub-heading">'),t.buffer.push(S(s._triageMustache.call(e,"view.context.searchRequest.filterMessage",{hash:{unescaped:"true"},hashTypes:{unescaped:"STRING"},hashContexts:{unescaped:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("</p>\r\n    "),r=s.each.call(e,"item","in","view.context.searchResultSet",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(2,i,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n    <br/>\r\n    "),r=s.if.call(e,"searchResultSet.length",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(8,l,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n</div>\r\n"),""}function i(e,t){var r;return t.buffer.push("\r\n    "),r=s.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"item",action:"searchResultSelected",class:"mobile-searchresults"},hashTypes:{contentBinding:"STRING",action:"STRING",class:"STRING"},hashContexts:{contentBinding:e,action:e,class:e},inverse:C.noop,fn:C.program(3,n,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n    "),""}function n(e,t){var r;return t.buffer.push('\r\n    <div class="row">\r\n        <div class="col-sm-12">\r\n            '),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.searchField1",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.searchField4",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push(" \r\n            "),r=s.if.call(e,"item.isDstv",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(4,h,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n             "),r=s.if.call(e,"item.isGotv",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(6,c,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n            "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{textBinding:"item.searchField9",class:"searchresults-type"},hashTypes:{textBinding:"STRING",class:"STRING"},hashContexts:{textBinding:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('  \r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-sm-6 sub-heading">\r\n            '),r=s._triageMustache.call(e,"item.searchField2",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push(" "),r=s._triageMustache.call(e,"item.searchField3",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n        </div>\r\n          <div class="col-sm-3">\r\n            '),r=s._triageMustache.call(e,"item.searchField5",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n        </div>\r\n        <div class="col-sm-3">\r\n            '),r=s._triageMustache.call(e,"item.searchField6",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-sm-6">\r\n            '),r=s._triageMustache.call(e,"item.searchField7",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push(' \r\n        </div>\r\n        <div class="col-sm-6">\r\n            '),r=s._triageMustache.call(e,"item.searchField8",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n        </div>\r\n    </div>\r\n    "),""}function h(e,t){t.buffer.push('\r\n            <img src="Content\\Images\\dstv-blue.svg" class="search-results-img"/>\r\n             ')}function c(e,t){t.buffer.push('\r\n        \r\n                <img src="Content\\Images\\gotv-alt.svg" class="search-results-img"/>\r\n           \r\n            ')}function l(e,t){return t.buffer.push('\r\n    <div class="table-responsive">\r\n        '),t.buffer.push(S(s.view.call(e,"Komodo.Controls.Pager",{hash:{mode:"virtual",contentLengthBinding:"_totalHits",pageSelectedAction:"pageSelected",itemsPerPage:"5",visiblePageCount:"10"},hashTypes:{mode:"STRING",contentLengthBinding:"STRING",pageSelectedAction:"STRING",itemsPerPage:"STRING",visiblePageCount:"STRING"},hashContexts:{mode:e,contentLengthBinding:e,pageSelectedAction:e,itemsPerPage:e,visiblePageCount:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n    </div>\r\n    "),""}function u(e,t){var r;return t.buffer.push('\r\n<div class="modal-max-size">\r\n  <p class="sub-heading">'),t.buffer.push(S(s._triageMustache.call(e,"view.context.searchRequest.resultMsg",{hash:{unescaped:"true"},hashTypes:{unescaped:"STRING"},hashContexts:{unescaped:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</p>\r\n  <p class="sub-heading">'),t.buffer.push(S(s._triageMustache.call(e,"view.context.searchRequest.filterMessage",{hash:{unescaped:"true"},hashTypes:{unescaped:"STRING"},hashContexts:{unescaped:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('</p>\r\n  <table width="80%" style="display:none">\r\n    <tr>\r\n      <td>        \r\n        '),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.displayResult~",class:"sub-heading"},hashTypes:{text:"STRING",class:"STRING"},hashContexts:{text:e,class:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td >\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"view.context.searchRequest.customerchecked"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.customer~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td >\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"view.context.searchRequest.quotechecked"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.quote~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td >\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"view.context.searchRequest.casechecked"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.case~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td >\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"view.context.searchRequest.agentchecked"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.agent~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n      </td>\r\n      <td >\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreCheckbox",{hash:{checkedBinding:"view.context.searchRequest.devicechecked"},hashTypes:{checkedBinding:"STRING"},hashContexts:{checkedBinding:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n        "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.CoreTextLabel",{hash:{text:"~locale.customerprofile.customerprofile:searchcontrol.device~"},hashTypes:{text:"STRING"},hashContexts:{text:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push('\r\n      </td>\r\n    </tr>\r\n\r\n  </table>\r\n  <br/>\r\n \r\n  <table width="98%" id="searchresultsid">\r\n    <tbody>\r\n      '),r=s.each.call(e,"item","in","view.context.searchResultSet",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(11,d,t),contexts:[e,e,e],types:["ID","ID","ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n      </tbody>\r\n\r\n  </table>\r\n  <br/>\r\n "),r=s.if.call(e,"searchResultSet.length",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(17,p,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n</div>\r\n\r\n"),""}function d(e,t){var r;return t.buffer.push("\r\n      <tr>\r\n      <td>\r\n        "),r=s.view.call(e,"Komodo.Controls.ActionView",{hash:{contentBinding:"item",action:"searchResultSelected"},hashTypes:{contentBinding:"STRING",action:"STRING"},hashContexts:{contentBinding:e,action:e},inverse:C.noop,fn:C.program(12,g,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n      </td>\r\n    </tr>\r\n      "),""}function g(e,t){var r;return t.buffer.push('\r\n\r\n        <table width="100%"  class="komodo-searchresults">\r\n          <tr >\r\n            <td class="sub-heading" width="30%">\r\n              '),r=s._triageMustache.call(e,"item.searchField2",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push(" "),r=s._triageMustache.call(e,"item.searchField3",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n            </td>\r\n            <td width="30%">\r\n              '),r=s._triageMustache.call(e,"item.searchField4",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n            </td>\r\n            <td width="20%">\r\n              '),r=s._triageMustache.call(e,"item.searchField5",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n            </td>\r\n            <td width="8%" >\r\n             '),r=s.if.call(e,"item.isDstv",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(13,f,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n             "),r=s.if.call(e,"item.isGotv",{hash:{},hashTypes:{},hashContexts:{},inverse:C.noop,fn:C.program(15,m,t),contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n            </td>\r\n            <td width="12%" class="searchresults-type">\r\n              '),r=s._triageMustache.call(e,"item.searchField1",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n            </td>\r\n          </tr>\r\n          <tr>\r\n            <td>\r\n              "),r=s._triageMustache.call(e,"item.searchField7",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n            </td>\r\n            <td>\r\n              "),r=s._triageMustache.call(e,"item.searchField8",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n            </td>\r\n            <td >\r\n              "),r=s._triageMustache.call(e,"item.searchField6",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push('\r\n            </td>\r\n            <td colspan="2">\r\n              '),r=s._triageMustache.call(e,"item.searchField9",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("\r\n            </td>\r\n          </tr>\r\n        </table>\r\n        "),""}function f(e,t){t.buffer.push('\r\n              <span style="float:left;">\r\n                    <img src="Content\\Images\\dstv-blue.svg" width="50px"/>\r\n              </span>\r\n             ')}function m(e,t){t.buffer.push('\r\n              <span  style="float:left;">\r\n                <img src="Content\\Images\\gotv-alt.svg" width="50px"/>\r\n              </span>\r\n             ')}function p(e,t){return t.buffer.push("\r\n  "),t.buffer.push(S(s.view.call(e,"Komodo.Controls.Pager",{hash:{mode:"virtual",contentLengthBinding:"_totalHits",pageSelectedAction:"pageSelected",itemsPerPage:"5",visiblePageCount:"10"},hashTypes:{mode:"STRING",contentLengthBinding:"STRING",pageSelectedAction:"STRING",itemsPerPage:"STRING",visiblePageCount:"STRING"},hashContexts:{mode:e,contentLengthBinding:e,pageSelectedAction:e,itemsPerPage:e,visiblePageCount:e},contexts:[e],types:["ID"],data:t}))),t.buffer.push("\r\n   "),""}this.compilerInfo=[4,">= 1.0.0"],s=this.merge(s,Ember.Handlebars.helpers),o=o||{};var v,S=this.escapeExpression,C=this;return v=s.if.call(t,"isMobileDevice",{hash:{},hashTypes:{},hashContexts:{},inverse:C.program(10,u,o),fn:C.program(1,a,o),contexts:[t],types:["ID"],data:o}),(v||0===v)&&o.buffer.push(v),o.buffer.push("\r\n"),""}),Komodo.Application.SearchControlView=Komodo.UI.View.extend({viewKey:"SearchControlView"}),Komodo.Application.SearchControlController=Komodo.UI.Controller.extend({_localeBase:"locale.customer:customerInformation.",lstCaseStatus:[],init:function(){this._super();var e=this;this.set("pageFrom",void 0),this.set("pageSize",KomodoConfiguration.elasticSearchConfig.numberOfRecords),this.set("currentPage",1),this.set("searchContext",void 0),this.set("totalCount",0),this.set("searchResultSet",Ember.A()),this.set("searchResultPopUp",null),this.set("searchingValue",""),this.set("searchEntity",""),this.set("filterEntity",""),this.set("customertype",[]),this.set("loggedInCountryName",""),this.set("loggedInCountryId",""),this.set("requiredcallback",!1),Komodo.log("Constructing Search controller"),this.set("processVersion","v1.1"),this.set("processName","Multichoice Search Module"),this.set("searchTerm",""),this.set("callPopup",""),this.requiresDependency("_cacheRepository",{singleton:Komodo.Repositories.cacheRepository}),this.requiresDependency("_queryService",{singleton:Komodo.Services.queryService}),this.requiresDependency("_systemService",{singleton:Komodo.Services.systemService}),this.getEventAggregator().subscribe(Komodo.EventNames.searchRequested,function(t){e.SearchRequestedReceived(t)}),this.getEventAggregator().subscribe("ElasticSearchDataReceived",function(t){e.viewBindingMethodForSingleSearch(t)})},start:function(){this.set("country",Komodo.Services.uiService.getController("application").get("_selectedCountryId")),this.set("searchRequest",Komodo.Models.SearchRequest.create()),this.registerModel("recentCustomersListModel",Komodo.Models.RecentCustomersListModel),this.getCDMDataForES(),this.fillCaseStatusLookup(),this.set("searchResultPopUp",null),this.searchRequest.set("isButtonVisible","false"),this.set("pageFrom",0),this.set("currentPage",1),this.set("_dataBaseCount",0),this.set("_loadFirstPage",!1),this.set("loggedInCountryId",Komodo.Services.uiService.getController("application").get("_selectedCountryId")),this._super()},createSearchRequest:function(e){this.searchRequest.set("SearchText",e),this.searchRequest.set("Searchcountry",this.get("loggedInCountryName")),this.searchRequest.set("Pagefrom",this.get("_dataBaseCount")),this.set("pageSize",parseInt(KomodoConfiguration.elasticSearchConfig.numberOfRecords)),this.searchRequest.set("PageSize",this.get("pageSize"));var t=this.get("searchEntity");return t=void 0===t?"":t,this.searchRequest.set("DocumentType",t),this.searchRequest.set("DefaultField",KomodoConfiguration.elasticSearchConfig.default_field),this.searchRequest.set("DefaultOperator",KomodoConfiguration.elasticSearchConfig.default_operator),this.searchRequest.set("filterMessage",""!==t?"Filtered by "+this.get("filterEntity"):""),this.searchRequest},getQueryService:function(){return this.get("_queryService")},getSystemService:function(){return this.get("_systemService")},isMobileDevice:function(){return this.getSystemService().get("isMobile")}.property(),getCallbackFunctionForPopup:function(){var e=this,t=function(){e.searchResultPopUp=Komodo.Services.uiService.showModalPopup(kl.value(this._localeBase+"searchResult"),null,{view:Komodo.Application.SearchControlView,context:e,canUserClose:!0})};return this.loadSearchContext(),t},loadSearchContext:function(){this.set("searchContext",{data:{searchResultSet:this.get("searchResultSet"),searchRequest:this.get("searchRequest")}})},loadSearchResult:function(e,t){if(this.get("searchResultSet").clear(),this.set("_totalHits",0),""!=e&&void 0!=e){var s=this.setSearchString(e);this.set("pageSize",parseInt(KomodoConfiguration.elasticSearchConfig.numberOfRecords));var r=this.createSearchRequest(s),o=new Komodo.Services.ElasticSearchFetchService;null==r.Searchcountry&&""==r.Searchcountry||(o.retrieveElasticSearchData(r),this.set("_loadFirstPage",!0))}},setSearchString:function(e){var t=$.trim(e);if(t=t.split("-").join("").replace(/[^a-zA-Z0-9.\u002D\u00C0-\u00C3\u00C7-\u00CA\u00CC-\u00CD\u00D2-\u00D5\u00D2-\u00D5\u00D9-\u00DA\u00DC\u00E0-\u00E3\u00E7-\u00EA\u00EC-\u00ED\u00F2-\u00F5\u00F9-\u00FA\u00FC\s]/g," "),t.length>0)if("0"==t.charAt(0)&&(t=t.slice(1)),-1!=t.toString().indexOf(" ")){for(var s=t.split(" "),r=s[0].toString()+"*",o=1;o<s.length;o++)r=r+" "+ElasticSearchConfiguration.searchQuery.token+" "+s[o].toString()+"*";t=r}else t+="*";return t},setButtonVisibility:function(){this.searchRequest.set("isNextButtonVisible",!1),this.searchRequest.set("isPreviousButtonVisible",!1);var e=parseInt(KomodoConfiguration.elasticSearchConfig.numberOfRecords),t=this.get("currentPage"),s=this.searchRequest.get("TotalCount");s>0&&this.searchResultSet.length&&this.searchResultSet.length>0?this.searchRequest.set("resultMsg",""):(this.searchRequest.set("resultMsg",kl.value(this._localeBase+"searchNoResultFound")),this.searchRequest.set("filterMessage","")),this.searchResultSet.length&&this.searchResultSet.length>0&&(this.showNextButton(t,e,s),this.showPreviousButton(t,e,s))},showNextButton:function(e,t,s){e*t<s?this.searchRequest.set("isNextButtonVisible",!0):this.searchRequest.set("isNextButtonVisible",!1)},showPreviousButton:function(e){1===e?this.searchRequest.set("isPreviousButtonVisible",!1):this.searchRequest.set("isPreviousButtonVisible",!0)},fillCaseStatusLookup:function(){var e=this;Komodo.Services.cachedDataService.fetch("CaseStatus").done(function(t){e.set("lstCaseStatus",t)})},viewBindingMethodForSingleSearch:function(e){if(this.get("searchResultSet").clear(),null!=e){var t=0;if(e.hits&&e.hits.hits&&e.hits.hits.length>0){t+=e.hits.total,this.searchRequest.set("TotalCount",t);for(var s=e.hits.hits,r=0;r<s.length;r++){var o=this.bindSearchResult(s[r]);o&&this.get("searchResultSet").addObject(o)}t>200?this.set("_totalHits",200):this.set("_totalHits",t),this.setButtonVisibility()}else this.get("searchResultSet").length<=0&&(this.searchRequest.set("resultMsg",kl.value(this._localeBase+"searchNoResultFound")),this.searchRequest.set("filterMessage","")),this.searchRequest.set("isNextButtonVisible",!1),this.searchRequest.set("isPreviousButtonVisible",!1)}else this.get("searchResultSet").length<=0&&(this.searchRequest.set("resultMsg",kl.value(this._localeBase+"searchNoResultFound")),this.searchRequest.set("filterMessage",""))},bindSearchResult:function(e){if(void 0!=e){var t=Komodo.Models.SearchResultModel.create();return e._type.toLowerCase()===ElasticSearchConfiguration.documentType.customer.toLowerCase()?t=this.bindCustomerSearchResult(e._source):e._type.toLowerCase()===ElasticSearchConfiguration.documentType.quote.toLowerCase()?t=this.bindQuoteSearchResult(e._source):e._type.toLowerCase()===ElasticSearchConfiguration.documentType.caseDetails.toLowerCase()&&(t=this.bindCaseSearchResult(e._source)),t.searchField1?t:null}return null},bindCustomerSearchResult:function(e){var t=Komodo.Models.SearchResultModel.create();t.set("searchField1","Customer");var s="",r=this.getRegExToCreateSearchValue(),o=this.getTokenToHighlightSearchResult();void 0!=e.Class?t.set("customerClass",e.Class):t.set("customerClass",""),void 0!=e.Title?t.set("title",e.Title):t.set("title",""),void 0!=e.FirstName?(s=e.FirstName?e.FirstName.replace(r,o):"",t.set("searchField2",s.htmlSafe())):t.set("searchField2",""),void 0!=e.Surname?(s=e.Surname?e.Surname.replace(r,o):"",t.set("searchField3",s.htmlSafe())):t.set("searchField3",""),void 0!=e.BusinessUnit&&(s=e.BusinessUnit?e.BusinessUnit.replace(r,o):"","DSTV"==e.BusinessUnit.toUpperCase()&&t.set("isDstv",!0),"GOTV"==e.BusinessUnit.toUpperCase()&&t.set("isGotv",!0)),void 0!=e.CustomerNumber?(s=e.CustomerNumber?e.CustomerNumber.replace(r,o):"",t.set("searchField4",s.htmlSafe())):t.set("searchField4",""),void 0!=e.IdentityValue?(s=e.IdentityValue?e.IdentityValue.replace(r,o):"",t.set("searchField5",s.htmlSafe()),Komodo.Services.securityService.hasPermission("clarity://customerModule/hideIdentityNumber")&&t.set("searchField5",Komodo.UI.MaskInputs.maskValues("*","3",e.IdentityValue,6))):t.set("searchField5",""),void 0!=e.ListOfAddress&&e.ListOfAddress.length&&e.ListOfAddress.length>0?(s=e.ListOfAddress[0].City?e.ListOfAddress[0].City.replace(r,o):"",t.set("searchField6",s.htmlSafe())):t.set("searchField6","");var a="";if(void 0!=e.ListOfPhoneNumber&&e.ListOfPhoneNumber.length&&e.ListOfPhoneNumber.length>0)for(var i=0;i<e.ListOfPhoneNumber.length;i++){var n=e.ListOfPhoneNumber[i].Code?e.ListOfPhoneNumber[i].Code.replace(r,o):"",h=e.ListOfPhoneNumber[i].Number?e.ListOfPhoneNumber[i].Number.replace(r,o):"";s=n&&h?n+"-"+h:n+h,s=s||"-",a+=i===e.ListOfPhoneNumber.length-1?s:s+"</br>"}else a+="";t.set("searchField7",a.htmlSafe());var c="";if(void 0!=e.ListOfEmail&&e.ListOfEmail.length&&e.ListOfEmail.length>0)for(var l=0;l<e.ListOfEmail.length;l++)s=e.ListOfEmail[l]?e.ListOfEmail[l].replace(r,o):" - ",c+=l===e.ListOfEmail.length-1?s:s+"</br>";else c="";t.set("searchField8",c.htmlSafe());var u=e.CustomerType;return void 0!=u?(u=""!=u?u:"-",t.set("searchField9",u.htmlSafe())):t.set("searchField9",""),t},bindQuoteSearchResult:function(e){var t=Komodo.Models.SearchResultModel.create();t.set("searchField1","Quote");var s="",r=this.getRegExToCreateSearchValue(),o=this.getTokenToHighlightSearchResult();e.QuotationNo?(e.QuotationNo=e.QuotationNo.replace(this.get("loggedInCountryId").substring(0,3).toUpperCase(),this.get("loggedInCountryId").substring(0,3).toUpperCase()+"-"),s=e.QuotationNo.replace(r,o)):s="",t.set("searchField4",s.htmlSafe());var a="";if(void 0!=e.ListOfPhoneNumber&&e.ListOfPhoneNumber.length&&e.ListOfPhoneNumber.length>0)for(var i=0;i<e.ListOfPhoneNumber.length;i++){var n=e.ListOfPhoneNumber[i].Code?e.ListOfPhoneNumber[i].Code.replace(r,o):"",h=e.ListOfPhoneNumber[i].Number?e.ListOfPhoneNumber[i].Number.replace(r,o):"";s=n&&h?n+"-"+h:n+h,s=s||"-",a+=i===e.ListOfPhoneNumber.length-1?s:s+"</br>"}else a+="";t.set("searchField7",a.htmlSafe()),void 0!=e.LastName?(s=e.LastName?e.LastName.replace(r,o):"",t.set("searchField2",s.htmlSafe())):t.set("searchField2",""),t.set("searchField3",""),void 0!=e.Status?(s=e.Status?e.Status.replace(r,o):" - ",t.set("searchField5",s.htmlSafe())):t.set("searchField5",""),t.set("searchField6","");var c="";if(void 0!=e.EmailIds&&e.EmailIds.length&&e.EmailIds.length>0)for(var l=0;l<e.EmailIds.length;l++)s=e.EmailIds[l]?e.EmailIds[l].replace(r,o):" - ",c+=l===e.EmailIds.length-1?s:s+"</br>";else c="";return t.set("searchField8",c.htmlSafe()),t.set("searchField9",""),t},bindCaseSearchResult:function(e){var t=this,s=Komodo.Models.SearchResultModel.create();s.set("searchField1","Case");var r="",o=this.getRegExToCreateSearchValue(),a=this.getTokenToHighlightSearchResult();return e.CaseId?(e.CaseId=e.CaseId.substring(0,e.CustomerNumber.length)+"-"+e.CaseId.substring(e.CustomerNumber.length,e.CaseId.length),r=e.CaseId.replace(o,a)):r="",s.set("searchField4",r.htmlSafe()),s.set("searchField3",""),r="",r=e.FirstName?e.FirstName.replace(o,a):"",s.set("searchField2",r.htmlSafe()),r="",e.Status?(t.lstCaseStatus!=[]&&$.each(t.lstCaseStatus,function(t,s){e.Status==s.key&&(e.Status=s.value)}),r=e.Status.replace(o,a)):r="",s.set("searchField5",r.htmlSafe()),s.set("searchField6",""),r="",r=e.PhoneNumber?e.PhoneNumber.replace(o,a):"",s.set("searchField7",r.htmlSafe()),s.set("searchField8",""),s.set("searchField9",""),s},removeHtmlFromSearchFields:function(e){var t=new RegExp(this.getPreTagForHighLightSearchResult(),"g"),s=new RegExp(this.getPostTagForHighLightSearchResult(),"g");return e.replace(t,"").replace(s,"")},fillCustomerProfile:function(e){var t=Komodo.Models.CustomerDetailsModel.create(),s=this.removeHtmlFromSearchFields(e.searchField4.toString());t.set("customerNo",this.getSearchFieldValueAfterColon(s)),t.set("searchRequired",!0),void 0!=e.customerClass?t.set("customerClass",e.customerClass):t.set("customerClass","-"),Komodo.Services.customerProfileService.setCustomerPersonalDetail&&(Komodo.Services.customerProfileService.setCustomerPersonalDetail(t),Komodo.Services.customerProfileService.setCustomerDataSource("search-control"))},getSearchFieldValueAfterColon:function(e){if(""!=e&&void 0!=e){var t=e.indexOf(":");if(t<0)return e;return e.substring(t+1).trim()}},getPreTagForHighLightSearchResult:function(){return"<"+ElasticSearchConfiguration.highlightSearchResult.htmlTag+" class='"+ElasticSearchConfiguration.highlightSearchResult.cssClass+"' >"},getPostTagForHighLightSearchResult:function(){return"</"+ElasticSearchConfiguration.highlightSearchResult.htmlTag+">"},getRegExToCreateSearchValue:function(){return new RegExp("("+this.get("searchingValue").replace(/[^a-zA-Z0-9]/g,"")+")","gi")},getTokenToHighlightSearchResult:function(){return this.getPreTagForHighLightSearchResult()+"$1"+this.getPostTagForHighLightSearchResult()},SearchRequestedReceived:function(e){if(this.start(),""!=e.searchTerm.trim())if(this.set("searchingValue",e.searchTerm),ElasticSearchConfiguration.documentType[e.searchType]){this.set("searchEntity",ElasticSearchConfiguration.documentType[e.searchType]),this.set("filterEntity",e.searchType);var t=this.getCallbackFunctionForPopup();this.set("searchTerm",e.searchTerm),this.set("callPopup",t),this.loadSearchResult(e.searchTerm,t)}else{if("general"!=e.searchType.toLowerCase())return;this.set("searchEntity",""),this.set("filterEntity","");var t=this.getCallbackFunctionForPopup();this.set("searchTerm",e.searchTerm),this.set("callPopup",t),this.loadSearchResult(e.searchTerm,t)}else Komodo.Controls.MessageBoxController.show(kl.value(this._localeBase+"searchInformation"),kl.value(this._localeBase+"searchText"),Komodo.Controls.MessageBoxOkButton,this,"id5446673","danger")},actions:{pageSelected:function(e){if(0==this.get("_loadFirstPage")){var t=this.setSearchString(this.get("searchingValue")),s=this.createSearchRequest(t);new Komodo.Services.ElasticSearchFetchService;null==s.Searchcountry&&""==s.Searchcountry||Komodo.Services.queryService.getJSON("/ElasticSearch/GetElasticSearchData?from="+(e.pageNumber-1)*KomodoConfiguration.elasticSearchConfig.numberOfRecords+"&size="+s.get("PageSize")+"&documentType="+s.get("DocumentType")+"&default_field="+s.get("DefaultField")+"&searchText="+s.get("SearchText")+"&default_operator="+s.get("DefaultOperator")).done(function(e){Komodo.Services.uiService.getController("searchControl").viewBindingMethodForSingleSearch(e)})}else this.set("_loadFirstPage",!1)},searchResultSelected:function(e){switch(KomodoConfiguration.AllowToVisibleNavigationPanel&&($("#sidebar").show(),$("#sitesearchbutton").show()),
Komodo.Services.uiService.set("applicationController.searchText",void 0),e.get("content").searchField1.toLowerCase()){case"customer":Komodo.Services.customerProfileService.setIsCustomerAuthorised(!1);var t=Komodo.Models.SearchRequestForBaseSystem.create();t.set("searchEntity",e.get("content").searchField1);var s=this.removeHtmlFromSearchFields(e.get("content").searchField4.toString());if(""!=s){var r=this.getSearchFieldValueAfterColon(s);t.set("uid",r)}if(this.get("searchResultPopUp").close(),this.fillCustomerProfile(e.get("content")),this.savetoRecentCustomer(e),"searchQuotation"===Komodo.Services.uiService.getCurrentRouteName()&&void 0!==Komodo.Services.uiService.getController("searchQuotation").customer)Komodo.Services.uiService.getController("searchQuotation").customer.CustomerNumber=r,Komodo.Services.featureToggleService.isEnabled("ZeroSaleDevice","IsZeroSaleDeviceAllowed").done(function(e){if(e){var t=!1,s=Komodo.Services.uiService.getController("searchQuotation").data.productData;$.each(s,function(e,s){if("HARDWARE"==s.productCategory&&0==s.deviceCost)return t=!0,!1}),t?Komodo.Services.uiService.getController("searchQuotation").zeroSaleSupervisorApproval(Komodo.Services.uiService.getController("searchQuotation").customer):(Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",Komodo.Services.uiService.getController("searchQuotation").customer),Komodo.Services.uiService.getController("searchQuotation").customer=void 0)}else Komodo.Services.eventAggregator.publish("PublishPaymentForQuotation",Komodo.Services.uiService.getController("searchQuotation").customer),Komodo.Services.uiService.getController("searchQuotation").customer=void 0}).fail(function(e){Komodo.log("Error while checking feature toggle. Error Details:"+e)});else{var o=Komodo.Services.uiService.getController("customerProfileContainer");o.checkResidentialCustomer(),o.getPotentialOffers(),"commercial"==e.get("content").customerClass.toLowerCase()||"1"==e.get("content").customerClass||"national deal"==e.get("content").customerClass.toLowerCase()||"9"==e.get("content").customerClass?(Komodo.Services.eventAggregator.publish("PublishCommercialSearchRequest",t,e.get("content")),Komodo.Services.eventAggregator.publish(Komodo.EventNames.customTypeChanged,"commercial")):"csi"==e.get("content").customerClass.toLowerCase()||"4"==e.get("content").customerClass?(Komodo.Services.eventAggregator.publish("PublishCsiSearchRequest",t,e.get("content")),Komodo.Services.eventAggregator.publish(Komodo.EventNames.customTypeChanged,"csi")):"dealer"==e.get("content").customerClass.toLowerCase()||"6"==e.get("content").customerClass?Komodo.Services.eventAggregator.publish("PublishDealerSearchRequest",t,e.get("content")):"specialist"==e.get("content").customerClass.toLowerCase()||"3"==e.get("content").customerClass?(Komodo.Services.eventAggregator.publish("PublishSpecialistSearchRequest",t,e.get("content")),Komodo.Services.eventAggregator.publish(Komodo.EventNames.customTypeChanged,"specialist")):(Komodo.Services.eventAggregator.publish("PublishCustomerSearchRequest",t,e.get("content")),"residential"!=e.get("content").customerClass.toLowerCase()&&"2"!=e.get("content").customerClass||Komodo.Services.eventAggregator.publish(Komodo.EventNames.customTypeChanged,"residential"))}break;case"quote":var a=Komodo.Models.SearchRequestForBaseSystem.create();a.set("searchEntity",e.get("content").searchField1);var i=this.removeHtmlFromSearchFields(e.get("content").searchField4.toString());""!=i&&(i=this.getSearchFieldValueAfterColon(i),a.set("uid",i));var n=this.get("searchResultPopUp");n.close(),Komodo.Services.eventAggregator.publish("PublishCustomerQuotationUID",i);break;case"case":var h=Komodo.Models.SearchRequestForBaseSystem.create();h.set("searchEntity",e.get("content").searchField1);var i=this.removeHtmlFromSearchFields(e.get("content").searchField4.toString());""!=i&&(i=this.getSearchFieldValueAfterColon(i),h.set("uid",i));var n=this.get("searchResultPopUp");n.close(),Komodo.Services.eventAggregator.publish("PublishCustomerCaseUID",i)}},goToNextPage:function(){var e=this.get("searchingValue"),t=this;void 0!=e&&this.pageFrom+this.pageSize<this.searchRequest.get("TotalCount")&&(this.pageFrom=this.get("pageFrom")+parseInt(this.get("pageSize")),this.currentPage=this.currentPage+1,this.loadSearchResult(e,function(){t.loadSearchContext()}))},goToPreviousPage:function(){var e=this.get("searchingValue"),t=this;void 0!=e&&this.get("currentPage")>1?(this.pageFrom=this.pageFrom-parseInt(this.pageSize),this.currentPage=this.currentPage-1,this.loadSearchResult(e,function(){t.loadSearchContext()})):this.searchRequest.set("isPreviousDisable",!0)}},getCustomerTypeText:function(e){for(var t=this.get("customertype"),s=0;s<t.length;s++)if(t[s].key==e)return t[s].value;return""},populateCustomerType:function(){var e=this;Komodo.Services.cachedDataService.fetch("CustomerType",{domain:e.loggedInCountryId,qualifier:Komodo.Services.localizationService.getCurrentLanguage()}).done(function(t){e.get("customertype").clear(),$.each(t,function(t,s){e.get("customertype").addObject(s)})}).fail(function(){Komodo.log("could not retrieve customertype")})},getCDMDataForES:function(){var e=this;e.populateCustomerType(),e.set("loggedInCountryName",Komodo.Services.uiService.getController("application").get("_selectedCountryDescription"))},savetoRecentCustomer:function(e){self=this;var t=self.isNullReturnEmpty(e.get("content").title)+" "+self.isNullReturnEmpty(this.removeHtmlFromSearchFields(e.get("content").searchField2.toString()))+" "+self.isNullReturnEmpty(this.removeHtmlFromSearchFields(e.get("content").searchField3.toString()))+","+e.get("content").customerClass.toString();self.set("selectedItem",t);var s=[];self.set("country",Komodo.Services.uiService.getController("application").get("_selectedCountryId")),Komodo.Repositories.cacheRepository.fetch(Komodo.CacheKeys.selectedCountry).done(function(e){var t={domain:self.country,qualifier:Komodo.Services.localizationService.getCurrentLanguage()};Komodo.Services.cachedDataService.fetch("CountryISO").done(function(e){self.set("isoData",[]),self.set("isoData",e);var r=void 0;!self.isoData instanceof Array&&(self.isoData=[self.isoData]),self.isoData.forEach(function(e){t.domain===e.value&&(r=e.key)}),void 0!=r&&(self.country=r),s[0]={key:Komodo.Services.customerProfileService.personalDetails.customerNo,value:self.get("selectedItem")},self.getCacheRepository().fetch(Komodo.Services.securityService.get("domainUserName").substring(3)+self.country).done(function(e){for(var t=0;t<e.data.length;t++)if(s[0].key==e.data[t].key){e.data.splice(t,1);break}e.data.length>=KomodoConfiguration.recentCustomerCount&&e.data.splice(e.data.length-1,1),e.data.unshift(s[0]),self.getCacheRepository().save(Komodo.Services.securityService.get("domainUserName").substring(3)+self.country,e.data),self.set("recentCustomersListModel.listData",e.data)}).fail(function(e){e.indexOf("No data found for key")>0&&self.getCacheRepository().save(Komodo.Services.securityService.get("domainUserName").substring(3)+self.country,s)})})})},isNullReturnEmpty:function(e){return null==e||""==e||void 0==e?"":e},getCacheRepository:function(){return this.get("_cacheRepository")},_virtualPagerPageContent:Ember.A(),_totalHits:void 0,stop:function(){this.lstCaseStatus=[],this._super()}});